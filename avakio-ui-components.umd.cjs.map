{"version":3,"file":"avakio-ui-components.umd.cjs","sources":["../src/components/avakio/avakio-popup/avakio-popup.tsx","../src/components/avakio/avakio-portlet/avakio-portlet.tsx","../node_modules/lucide-react/dist/esm/shared/src/utils.js","../node_modules/lucide-react/dist/esm/defaultAttributes.js","../node_modules/lucide-react/dist/esm/Icon.js","../node_modules/lucide-react/dist/esm/createLucideIcon.js","../node_modules/lucide-react/dist/esm/icons/calendar.js","../node_modules/lucide-react/dist/esm/icons/check.js","../node_modules/lucide-react/dist/esm/icons/chevron-down.js","../node_modules/lucide-react/dist/esm/icons/chevron-left.js","../node_modules/lucide-react/dist/esm/icons/chevron-right.js","../node_modules/lucide-react/dist/esm/icons/chevron-up.js","../node_modules/lucide-react/dist/esm/icons/chevrons-left.js","../node_modules/lucide-react/dist/esm/icons/chevrons-right.js","../node_modules/lucide-react/dist/esm/icons/chevrons-up-down.js","../node_modules/lucide-react/dist/esm/icons/clock.js","../node_modules/lucide-react/dist/esm/icons/copy.js","../node_modules/lucide-react/dist/esm/icons/ellipsis-vertical.js","../node_modules/lucide-react/dist/esm/icons/eye-off.js","../node_modules/lucide-react/dist/esm/icons/eye.js","../node_modules/lucide-react/dist/esm/icons/file.js","../node_modules/lucide-react/dist/esm/icons/folder-open.js","../node_modules/lucide-react/dist/esm/icons/folder.js","../node_modules/lucide-react/dist/esm/icons/grip-vertical.js","../node_modules/lucide-react/dist/esm/icons/minus.js","../node_modules/lucide-react/dist/esm/icons/pen.js","../node_modules/lucide-react/dist/esm/icons/plus.js","../node_modules/lucide-react/dist/esm/icons/search.js","../node_modules/lucide-react/dist/esm/icons/send.js","../node_modules/lucide-react/dist/esm/icons/trash-2.js","../node_modules/lucide-react/dist/esm/icons/x.js","../src/components/ui/button.tsx","../src/components/ui/input.tsx","../src/components/ui/popover.tsx","../src/lib/utils.ts","../src/components/avakio/ui-controls/avakio-datepicker/avakio-datepicker.tsx","../src/components/avakio/ui-controls/avakio-checkbox/avakio-checkbox.tsx","../src/components/avakio/ui-controls/avakio-button/avakio-button.tsx","../src/components/avakio/ui-controls/avakio-colorpicker/avakio-colorpicker.tsx","../src/components/avakio/ui-controls/avakio-combo/avakio-combo.tsx","../src/components/avakio/ui-controls/avakio-counter/avakio-counter.tsx","../src/components/avakio/ui-controls/avakio-daterangepicker/avakio-daterangepicker.tsx","../src/components/avakio/ui-controls/avakio-gridsuggest/avakio-gridsuggest.tsx","../src/components/avakio/ui-controls/avakio-multicombo/avakio-multicombo.tsx","../src/components/avakio/ui-controls/avakio-richselect/avakio-richselect.tsx","../src/components/avakio/ui-controls/avakio-slider/avakio-slider.tsx","../src/components/avakio/data-presentation/avakio-property/avakio-property.tsx","../src/components/avakio/ui-controls/avakio-calendar/avakio-calendar.tsx","../src/components/avakio/avakio-scheduler/avakio-scheduler.tsx","../src/components/avakio/avakio-sidebar/avakio-sidebar.tsx","../src/components/avakio/data-presentation/avakio-comment/avakio-comment.tsx","../src/components/ui/select.tsx","../src/components/avakio/data-presentation/avakio-datatable/AvakioDataTable.tsx","../src/components/avakio/data-presentation/avakio-timeline/avakio-timeline.tsx","../src/components/avakio/data-presentation/avakio-tree/avakio-tree.tsx","../src/components/avakio/layouts/avakio-absolute-layout/avakio-absolute-layout.tsx","../src/components/avakio/layouts/avakio-grid/avakio-grid.tsx","../src/components/avakio/layouts/avakio-layout/avakio-layout.tsx","../src/components/avakio/layouts/avakio-resizer/avakio-resizer.tsx","../src/components/avakio/ui-controls/avakio-doublelist/avakio-doublelist.tsx","../src/components/avakio/ui-controls/avakio-fieldset/avakio-fieldset.tsx","../src/components/avakio/ui-controls/avakio-label/avakio-label.tsx","../src/components/avakio/ui-controls/avakio-multitext/avakio-multitext.tsx","../src/components/avakio/ui-controls/avakio-radio/avakio-radio.tsx","../src/components/avakio/ui-controls/avakio-segmented-button/avakio-segmented-button.tsx","../src/components/avakio/ui-controls/avakio-switch-button/avakio-switch-button.tsx","../src/components/avakio/ui-controls/avakio-tabbar/avakio-tabbar.tsx","../src/components/avakio/ui-controls/avakio-text/avakio-text.tsx","../src/components/avakio/ui-controls/avakio-toggle-button/avakio-toggle-button.tsx","../src/components/avakio/ui-widgets/avakio-accordion/avakio-accordion.tsx","../src/components/avakio/ui-widgets/avakio-bullet-graph/avakio-bullet-graph.tsx","../src/components/avakio/ui-widgets/avakio-carousel/avakio-carousel.tsx","../src/components/avakio/ui-widgets/avakio-chart/avakio-chart.tsx","../src/components/avakio/ui-widgets/avakio-dashboard/avakio-dashboard.tsx","../src/components/avakio/ui-widgets/avakio-excel-viewer/avakio-excel-viewer.tsx","../src/components/avakio/ui-widgets/avakio-form/avakio-form.tsx","../src/components/avakio/ui-widgets/avakio-gage/avakio-gage.tsx","../src/components/avakio/ui-widgets/avakio-googlemap/avakio-googlemap.tsx","../src/components/avakio/ui-widgets/avakio-grouplist/avakio-grouplist.tsx","../src/components/avakio/ui-widgets/avakio-hint/avakio-hint.tsx","../src/components/avakio/views/avakio-view/avakio-view.tsx","../src/components/avakio/ui-widgets/avakio-view-header/avakio-view-header.tsx","../src/components/avakio/views/avakio-multiview/avakio-multiview.tsx","../src/components/avakio/views/avakio-template/avakio-template.tsx"],"sourcesContent":["import React, { useEffect, useMemo, useRef, useState } from \"react\";\r\nimport { createPortal } from \"react-dom\";\r\nimport \"./avakio-popup.css\";\r\n\r\nexport type AvakioPopupProps = {\r\n  open: boolean;\r\n  anchorRef?: React.RefObject<HTMLElement | null>;\r\n  anchorRect?: DOMRect;\r\n  x?: number;\r\n  y?: number;\r\n  offset?: { x?: number; y?: number };\r\n  width?: number | string;\r\n  height?: number | string;\r\n  theme?: string;\r\n  modal?: boolean;\r\n  closeOnOutside?: boolean;\r\n  closeOnEsc?: boolean;\r\n  onClose?: () => void;\r\n  className?: string;\r\n  style?: React.CSSProperties;\r\n  children: React.ReactNode;\r\n  /** ID of the component */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n};\r\n\r\nconst clamp = (value: number, min: number, max: number) => Math.min(Math.max(value, min), max);\r\n\r\nexport function AvakioPopup({\r\n  open,\r\n  anchorRef,\r\n  anchorRect,\r\n  x,\r\n  y,\r\n  offset,\r\n  width,\r\n  height,\r\n  theme,\r\n  modal,\r\n  closeOnOutside = true,\r\n  closeOnEsc = true,\r\n  onClose,\r\n  className,\r\n  style,\r\n  children,\r\n  id,\r\n  testId,\r\n}: AvakioPopupProps) {\r\n  const popupRef = useRef<HTMLDivElement>(null);\r\n  const [coords, setCoords] = useState({ top: 0, left: 0 });\r\n\r\n  const numericWidth = useMemo(() => {\r\n    if (typeof width === \"number\") return width;\r\n    if (typeof width === \"string\") {\r\n      const parsed = parseInt(width, 10);\r\n      return isNaN(parsed) ? 320 : parsed;\r\n    }\r\n    return 320;\r\n  }, [width]);\r\n\r\n  useEffect(() => {\r\n    if (!open) return;\r\n\r\n    const updatePosition = () => {\r\n      let nextLeft = typeof x === \"number\" ? x : (window.innerWidth - numericWidth) / 2;\r\n      let nextTop = typeof y === \"number\" ? y : 96;\r\n\r\n      if (anchorRef?.current) {\r\n        const rect = anchorRef.current.getBoundingClientRect();\r\n        nextLeft = rect.left + (offset?.x ?? 0);\r\n        nextTop = rect.bottom + (offset?.y ?? 8);\r\n      } else if (anchorRect) {\r\n        nextLeft = anchorRect.left + (offset?.x ?? 0);\r\n        nextTop = anchorRect.bottom + (offset?.y ?? 8);\r\n      }\r\n\r\n      const maxLeft = Math.max(8, window.innerWidth - numericWidth - 8);\r\n      nextLeft = clamp(nextLeft, 8, maxLeft);\r\n      nextTop = Math.max(8, nextTop);\r\n\r\n      setCoords({ top: nextTop, left: nextLeft });\r\n    };\r\n\r\n    updatePosition();\r\n    window.addEventListener(\"resize\", updatePosition);\r\n    window.addEventListener(\"scroll\", updatePosition, true);\r\n    return () => {\r\n      window.removeEventListener(\"resize\", updatePosition);\r\n      window.removeEventListener(\"scroll\", updatePosition, true);\r\n    };\r\n  }, [open, anchorRef, anchorRect, x, y, offset, numericWidth]);\r\n\r\n  useEffect(() => {\r\n    if (!open || !closeOnEsc) return;\r\n    const onKey = (e: KeyboardEvent) => {\r\n      if (e.key === \"Escape\") onClose?.();\r\n    };\r\n    window.addEventListener(\"keydown\", onKey);\r\n    return () => window.removeEventListener(\"keydown\", onKey);\r\n  }, [open, closeOnEsc, onClose]);\r\n\r\n  useEffect(() => {\r\n    if (!open || !closeOnOutside) return;\r\n    const handleClick = (e: MouseEvent) => {\r\n      if (!popupRef.current) return;\r\n      if (popupRef.current.contains(e.target as Node)) return;\r\n      onClose?.();\r\n    };\r\n    document.addEventListener(\"mousedown\", handleClick, true);\r\n    return () => document.removeEventListener(\"mousedown\", handleClick, true);\r\n  }, [open, closeOnOutside, onClose]);\r\n\r\n  if (!open) return null;\r\n\r\n  const popupNode = (\r\n    <>\r\n      {modal && (\r\n        <div\r\n          className=\"avakio-popup-overlay\"\r\n          data-admin-theme={theme}\r\n          onClick={closeOnOutside ? onClose : undefined}\r\n        />\r\n      )}\r\n      <div\r\n        ref={popupRef}\r\n        id={id}\r\n        data-testid={testId}\r\n        className={[\"avakio-popup\", className || \"\"].join(\" \").trim()}\r\n        data-admin-theme={theme}\r\n        style={{\r\n          top: coords.top,\r\n          left: coords.left,\r\n          width: width ?? `${numericWidth}px`,\r\n          height,\r\n          ...style,\r\n        }}\r\n      >\r\n        {children}\r\n      </div>\r\n    </>\r\n  );\r\n\r\n  return createPortal(popupNode, document.body);\r\n}\r\n\r\nexport default AvakioPopup;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useMemo, useState } from \"react\";\r\nimport \"./avakio-portlet.css\";\r\n\r\nexport const avakioPortletThemes = [\"material\", \"flat\", \"compact\", \"dark\", \"ocean\", \"sunset\"] as const;\r\nexport type AvakioPortletTheme = (typeof avakioPortletThemes)[number];\r\n\r\nexport type PortletColumn = {\r\n  id: string;\r\n  title: string;\r\n};\r\n\r\nexport type PortletItem = {\r\n  id: string;\r\n  title: string;\r\n  content: React.ReactNode;\r\n  columnId: string;\r\n};\r\n\r\nexport interface AvakioPortletBoardProps {\r\n  columns: PortletColumn[];\r\n  items: PortletItem[];\r\n  onMove?: (itemId: string, toColumnId: string) => void;\r\n  className?: string;\r\n  style?: React.CSSProperties;\r\n  theme?: AvakioPortletTheme;\r\n  /** ID of the component */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n}\r\n\r\nexport function AvakioPortletBoard({ columns, items, onMove, className, style, theme, id, testId }: AvakioPortletBoardProps) {\r\n  const [draggingId, setDraggingId] = useState<string | null>(null);\r\n\r\n  const grouped = useMemo(() => {\r\n    const map: Record<string, PortletItem[]> = {};\r\n    columns.forEach((c) => {\r\n      map[c.id] = [];\r\n    });\r\n    items.forEach((item) => {\r\n      if (!map[item.columnId]) map[item.columnId] = [];\r\n      map[item.columnId].push(item);\r\n    });\r\n    return map;\r\n  }, [columns, items]);\r\n\r\n  const handleDragStart = (id: string) => (ev: React.DragEvent<HTMLDivElement>) => {\r\n    setDraggingId(id);\r\n    ev.dataTransfer.effectAllowed = \"move\";\r\n    ev.dataTransfer.setData(\"text/plain\", id);\r\n  };\r\n\r\n  const handleDragOver = (ev: React.DragEvent<HTMLDivElement>) => {\r\n    ev.preventDefault();\r\n    ev.dataTransfer.dropEffect = \"move\";\r\n  };\r\n\r\n  const handleDrop = (columnId: string) => (ev: React.DragEvent<HTMLDivElement>) => {\r\n    ev.preventDefault();\r\n    const itemId = ev.dataTransfer.getData(\"text/plain\") || draggingId;\r\n    if (itemId && onMove) {\r\n      onMove(itemId, columnId);\r\n    }\r\n    setDraggingId(null);\r\n  };\r\n\r\n  return (\r\n    <div\r\n      id={id}\r\n      data-testid={testId}\r\n      className={[\"avakio-portlet\", className].filter(Boolean).join(\" \")}\r\n      style={style}\r\n      data-admin-theme={theme}\r\n    >\r\n      <div className=\"avakio-portlet-grid\">\r\n        {columns.map((col) => (\r\n          <div\r\n            key={col.id}\r\n            className=\"avakio-portlet-column\"\r\n            onDragOver={handleDragOver}\r\n            onDrop={handleDrop(col.id)}\r\n            data-column-id={col.id}\r\n            data-testid={`portlet-column-${col.id}`}\r\n          >\r\n            <div className=\"avakio-portlet-column-header\">{col.title}</div>\r\n            <div className=\"avakio-portlet-column-body\">\r\n              {grouped[col.id]?.map((item) => {\r\n                const dragging = draggingId === item.id;\r\n                return (\r\n                  <div\r\n                    key={item.id}\r\n                    className={\"avakio-portlet-item\" + (dragging ? \" avakio-portlet-item-dragging\" : \"\")}\r\n                    draggable\r\n                    onDragStart={handleDragStart(item.id)}\r\n                    onDragEnd={() => setDraggingId(null)}\r\n                    data-testid={`portlet-item-${item.id}`}\r\n                  >\r\n                    <div className=\"avakio-portlet-item-title\">{item.title}</div>\r\n                    <div className=\"avakio-portlet-item-content\">{item.content}</div>\r\n                  </div>\r\n                );\r\n              })}\r\n              {(!grouped[col.id] || grouped[col.id].length === 0) && (\r\n                <div className=\"avakio-portlet-empty\">Drop items here</div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nconst toKebabCase = (string) => string.replace(/([a-z0-9])([A-Z])/g, \"$1-$2\").toLowerCase();\nconst toCamelCase = (string) => string.replace(\n  /^([A-Z])|[\\s-_]+(\\w)/g,\n  (match, p1, p2) => p2 ? p2.toUpperCase() : p1.toLowerCase()\n);\nconst toPascalCase = (string) => {\n  const camelCase = toCamelCase(string);\n  return camelCase.charAt(0).toUpperCase() + camelCase.slice(1);\n};\nconst mergeClasses = (...classes) => classes.filter((className, index, array) => {\n  return Boolean(className) && className.trim() !== \"\" && array.indexOf(className) === index;\n}).join(\" \").trim();\nconst hasA11yProp = (props) => {\n  for (const prop in props) {\n    if (prop.startsWith(\"aria-\") || prop === \"role\" || prop === \"title\") {\n      return true;\n    }\n  }\n};\n\nexport { hasA11yProp, mergeClasses, toCamelCase, toKebabCase, toPascalCase };\n//# sourceMappingURL=utils.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nvar defaultAttributes = {\n  xmlns: \"http://www.w3.org/2000/svg\",\n  width: 24,\n  height: 24,\n  viewBox: \"0 0 24 24\",\n  fill: \"none\",\n  stroke: \"currentColor\",\n  strokeWidth: 2,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\"\n};\n\nexport { defaultAttributes as default };\n//# sourceMappingURL=defaultAttributes.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport { forwardRef, createElement } from 'react';\nimport defaultAttributes from './defaultAttributes.js';\nimport { mergeClasses, hasA11yProp } from './shared/src/utils.js';\n\nconst Icon = forwardRef(\n  ({\n    color = \"currentColor\",\n    size = 24,\n    strokeWidth = 2,\n    absoluteStrokeWidth,\n    className = \"\",\n    children,\n    iconNode,\n    ...rest\n  }, ref) => createElement(\n    \"svg\",\n    {\n      ref,\n      ...defaultAttributes,\n      width: size,\n      height: size,\n      stroke: color,\n      strokeWidth: absoluteStrokeWidth ? Number(strokeWidth) * 24 / Number(size) : strokeWidth,\n      className: mergeClasses(\"lucide\", className),\n      ...!children && !hasA11yProp(rest) && { \"aria-hidden\": \"true\" },\n      ...rest\n    },\n    [\n      ...iconNode.map(([tag, attrs]) => createElement(tag, attrs)),\n      ...Array.isArray(children) ? children : [children]\n    ]\n  )\n);\n\nexport { Icon as default };\n//# sourceMappingURL=Icon.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport { forwardRef, createElement } from 'react';\nimport { mergeClasses, toKebabCase, toPascalCase } from './shared/src/utils.js';\nimport Icon from './Icon.js';\n\nconst createLucideIcon = (iconName, iconNode) => {\n  const Component = forwardRef(\n    ({ className, ...props }, ref) => createElement(Icon, {\n      ref,\n      iconNode,\n      className: mergeClasses(\n        `lucide-${toKebabCase(toPascalCase(iconName))}`,\n        `lucide-${iconName}`,\n        className\n      ),\n      ...props\n    })\n  );\n  Component.displayName = toPascalCase(iconName);\n  return Component;\n};\n\nexport { createLucideIcon as default };\n//# sourceMappingURL=createLucideIcon.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M8 2v4\", key: \"1cmpym\" }],\n  [\"path\", { d: \"M16 2v4\", key: \"4m81vk\" }],\n  [\"rect\", { width: \"18\", height: \"18\", x: \"3\", y: \"4\", rx: \"2\", key: \"1hopcy\" }],\n  [\"path\", { d: \"M3 10h18\", key: \"8toen8\" }]\n];\nconst Calendar = createLucideIcon(\"calendar\", __iconNode);\n\nexport { __iconNode, Calendar as default };\n//# sourceMappingURL=calendar.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [[\"path\", { d: \"M20 6 9 17l-5-5\", key: \"1gmf2c\" }]];\nconst Check = createLucideIcon(\"check\", __iconNode);\n\nexport { __iconNode, Check as default };\n//# sourceMappingURL=check.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [[\"path\", { d: \"m6 9 6 6 6-6\", key: \"qrunsl\" }]];\nconst ChevronDown = createLucideIcon(\"chevron-down\", __iconNode);\n\nexport { __iconNode, ChevronDown as default };\n//# sourceMappingURL=chevron-down.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [[\"path\", { d: \"m15 18-6-6 6-6\", key: \"1wnfg3\" }]];\nconst ChevronLeft = createLucideIcon(\"chevron-left\", __iconNode);\n\nexport { __iconNode, ChevronLeft as default };\n//# sourceMappingURL=chevron-left.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [[\"path\", { d: \"m9 18 6-6-6-6\", key: \"mthhwq\" }]];\nconst ChevronRight = createLucideIcon(\"chevron-right\", __iconNode);\n\nexport { __iconNode, ChevronRight as default };\n//# sourceMappingURL=chevron-right.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [[\"path\", { d: \"m18 15-6-6-6 6\", key: \"153udz\" }]];\nconst ChevronUp = createLucideIcon(\"chevron-up\", __iconNode);\n\nexport { __iconNode, ChevronUp as default };\n//# sourceMappingURL=chevron-up.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"m11 17-5-5 5-5\", key: \"13zhaf\" }],\n  [\"path\", { d: \"m18 17-5-5 5-5\", key: \"h8a8et\" }]\n];\nconst ChevronsLeft = createLucideIcon(\"chevrons-left\", __iconNode);\n\nexport { __iconNode, ChevronsLeft as default };\n//# sourceMappingURL=chevrons-left.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"m6 17 5-5-5-5\", key: \"xnjwq\" }],\n  [\"path\", { d: \"m13 17 5-5-5-5\", key: \"17xmmf\" }]\n];\nconst ChevronsRight = createLucideIcon(\"chevrons-right\", __iconNode);\n\nexport { __iconNode, ChevronsRight as default };\n//# sourceMappingURL=chevrons-right.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"m7 15 5 5 5-5\", key: \"1hf1tw\" }],\n  [\"path\", { d: \"m7 9 5-5 5 5\", key: \"sgt6xg\" }]\n];\nconst ChevronsUpDown = createLucideIcon(\"chevrons-up-down\", __iconNode);\n\nexport { __iconNode, ChevronsUpDown as default };\n//# sourceMappingURL=chevrons-up-down.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M12 6v6l4 2\", key: \"mmk7yg\" }],\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"10\", key: \"1mglay\" }]\n];\nconst Clock = createLucideIcon(\"clock\", __iconNode);\n\nexport { __iconNode, Clock as default };\n//# sourceMappingURL=clock.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"rect\", { width: \"14\", height: \"14\", x: \"8\", y: \"8\", rx: \"2\", ry: \"2\", key: \"17jyea\" }],\n  [\"path\", { d: \"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2\", key: \"zix9uf\" }]\n];\nconst Copy = createLucideIcon(\"copy\", __iconNode);\n\nexport { __iconNode, Copy as default };\n//# sourceMappingURL=copy.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"1\", key: \"41hilf\" }],\n  [\"circle\", { cx: \"12\", cy: \"5\", r: \"1\", key: \"gxeob9\" }],\n  [\"circle\", { cx: \"12\", cy: \"19\", r: \"1\", key: \"lyex9k\" }]\n];\nconst EllipsisVertical = createLucideIcon(\"ellipsis-vertical\", __iconNode);\n\nexport { __iconNode, EllipsisVertical as default };\n//# sourceMappingURL=ellipsis-vertical.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49\",\n      key: \"ct8e1f\"\n    }\n  ],\n  [\"path\", { d: \"M14.084 14.158a3 3 0 0 1-4.242-4.242\", key: \"151rxh\" }],\n  [\n    \"path\",\n    {\n      d: \"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143\",\n      key: \"13bj9a\"\n    }\n  ],\n  [\"path\", { d: \"m2 2 20 20\", key: \"1ooewy\" }]\n];\nconst EyeOff = createLucideIcon(\"eye-off\", __iconNode);\n\nexport { __iconNode, EyeOff as default };\n//# sourceMappingURL=eye-off.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0\",\n      key: \"1nclc0\"\n    }\n  ],\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"3\", key: \"1v7zrd\" }]\n];\nconst Eye = createLucideIcon(\"eye\", __iconNode);\n\nexport { __iconNode, Eye as default };\n//# sourceMappingURL=eye.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z\",\n      key: \"1oefj6\"\n    }\n  ],\n  [\"path\", { d: \"M14 2v5a1 1 0 0 0 1 1h5\", key: \"wfsgrz\" }]\n];\nconst File = createLucideIcon(\"file\", __iconNode);\n\nexport { __iconNode, File as default };\n//# sourceMappingURL=file.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2\",\n      key: \"usdka0\"\n    }\n  ]\n];\nconst FolderOpen = createLucideIcon(\"folder-open\", __iconNode);\n\nexport { __iconNode, FolderOpen as default };\n//# sourceMappingURL=folder-open.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z\",\n      key: \"1kt360\"\n    }\n  ]\n];\nconst Folder = createLucideIcon(\"folder\", __iconNode);\n\nexport { __iconNode, Folder as default };\n//# sourceMappingURL=folder.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"circle\", { cx: \"9\", cy: \"12\", r: \"1\", key: \"1vctgf\" }],\n  [\"circle\", { cx: \"9\", cy: \"5\", r: \"1\", key: \"hp0tcf\" }],\n  [\"circle\", { cx: \"9\", cy: \"19\", r: \"1\", key: \"fkjjf6\" }],\n  [\"circle\", { cx: \"15\", cy: \"12\", r: \"1\", key: \"1tmaij\" }],\n  [\"circle\", { cx: \"15\", cy: \"5\", r: \"1\", key: \"19l28e\" }],\n  [\"circle\", { cx: \"15\", cy: \"19\", r: \"1\", key: \"f4zoj3\" }]\n];\nconst GripVertical = createLucideIcon(\"grip-vertical\", __iconNode);\n\nexport { __iconNode, GripVertical as default };\n//# sourceMappingURL=grip-vertical.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [[\"path\", { d: \"M5 12h14\", key: \"1ays0h\" }]];\nconst Minus = createLucideIcon(\"minus\", __iconNode);\n\nexport { __iconNode, Minus as default };\n//# sourceMappingURL=minus.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z\",\n      key: \"1a8usu\"\n    }\n  ]\n];\nconst Pen = createLucideIcon(\"pen\", __iconNode);\n\nexport { __iconNode, Pen as default };\n//# sourceMappingURL=pen.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M5 12h14\", key: \"1ays0h\" }],\n  [\"path\", { d: \"M12 5v14\", key: \"s699le\" }]\n];\nconst Plus = createLucideIcon(\"plus\", __iconNode);\n\nexport { __iconNode, Plus as default };\n//# sourceMappingURL=plus.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"m21 21-4.34-4.34\", key: \"14j7rj\" }],\n  [\"circle\", { cx: \"11\", cy: \"11\", r: \"8\", key: \"4ej97u\" }]\n];\nconst Search = createLucideIcon(\"search\", __iconNode);\n\nexport { __iconNode, Search as default };\n//# sourceMappingURL=search.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z\",\n      key: \"1ffxy3\"\n    }\n  ],\n  [\"path\", { d: \"m21.854 2.147-10.94 10.939\", key: \"12cjpa\" }]\n];\nconst Send = createLucideIcon(\"send\", __iconNode);\n\nexport { __iconNode, Send as default };\n//# sourceMappingURL=send.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M10 11v6\", key: \"nco0om\" }],\n  [\"path\", { d: \"M14 11v6\", key: \"outv1u\" }],\n  [\"path\", { d: \"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6\", key: \"miytrc\" }],\n  [\"path\", { d: \"M3 6h18\", key: \"d0wm0j\" }],\n  [\"path\", { d: \"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\", key: \"e791ji\" }]\n];\nconst Trash2 = createLucideIcon(\"trash-2\", __iconNode);\n\nexport { __iconNode, Trash2 as default };\n//# sourceMappingURL=trash-2.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M18 6 6 18\", key: \"1bl5f8\" }],\n  [\"path\", { d: \"m6 6 12 12\", key: \"d8bk6v\" }]\n];\nconst X = createLucideIcon(\"x\", __iconNode);\n\nexport { __iconNode, X as default };\n//# sourceMappingURL=x.js.map\n","import React from 'react';\r\n\r\nexport const Button = ({ children, className, ...props }: any) => (\r\n  <button className={className} {...props}>\r\n    {children}\r\n  </button>\r\n);\r\n","import React from 'react';\r\n\r\nexport const Input = ({ className, ...props }: any) => (\r\n  <input className={className} {...props} />\r\n);\r\n","import * as React from 'react';\r\n\r\nexport interface PopoverProps {\r\n  children?: React.ReactNode;\r\n  open?: boolean;\r\n  onOpenChange?: (open: boolean) => void;\r\n}\r\n\r\nexport const Popover: React.FC<PopoverProps> = ({ children }) => {\r\n  return <div className=\"relative\">{children}</div>;\r\n};\r\n\r\nexport interface PopoverTriggerProps {\r\n  asChild?: boolean;\r\n  children?: React.ReactNode;\r\n}\r\n\r\nexport const PopoverTrigger: React.FC<PopoverTriggerProps> = ({ children }) => {\r\n  return <div>{children}</div>;\r\n};\r\n\r\nexport interface PopoverContentProps {\r\n  className?: string;\r\n  align?: 'start' | 'center' | 'end';\r\n  children?: React.ReactNode;\r\n}\r\n\r\nexport const PopoverContent: React.FC<PopoverContentProps> = ({ className, children }) => {\r\n  return (\r\n    <div className={`absolute z-50 w-72 rounded-md border bg-white p-4 shadow-md ${className || ''}`}>\r\n      {children}\r\n    </div>\r\n  );\r\n};\r\n","export function cn(...classes: any[]) {\r\n  return classes.filter(Boolean).join(' ');\r\n}\r\n","import React, { useState, useMemo, useEffect, useRef } from 'react';\r\nimport { ChevronLeft, ChevronRight, Clock, Calendar as CalendarIcon } from 'lucide-react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Popover, PopoverContent, PopoverTrigger } from '@/components/ui/popover';\r\nimport { cn } from '@/lib/utils';\r\nimport './avakio-datepicker.css';\r\n\r\nexport interface AvakioDatePickerProps {\r\n  value?: string;\r\n  onChange: (value: string) => void;\r\n  className?: string;\r\n  showTime?: boolean; // If false, only returns date (YYYY-MM-DD), if true returns full ISO datetime\r\n  /** ID of the component */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n  /** Label displayed in the trigger button */\r\n  label?: string;\r\n  /** Placeholder when no date is selected */\r\n  placeholder?: string;\r\n  /** Use inline calendar instead of dropdown (legacy mode) */\r\n  inline?: boolean;\r\n}\r\n\r\nconst formatDisplayDate = (value: string | null | undefined, showTime: boolean) => {\r\n  if (!value) return \"â€”\";\r\n  const d = new Date(value);\r\n  if (Number.isNaN(d.getTime())) return value;\r\n  if (showTime) {\r\n    return d.toLocaleString(undefined, { \r\n      year: \"numeric\", \r\n      month: \"short\", \r\n      day: \"numeric\",\r\n      hour: \"2-digit\",\r\n      minute: \"2-digit\"\r\n    });\r\n  }\r\n  return d.toLocaleDateString(undefined, { year: \"numeric\", month: \"short\", day: \"numeric\" });\r\n};\r\n\r\n// Internal calendar component (can be used inline or in popover)\r\nfunction AvakioDatePickerCalendar({ \r\n  value, \r\n  onChange, \r\n  className, \r\n  showTime = true \r\n}: { \r\n  value?: string; \r\n  onChange: (value: string) => void; \r\n  className?: string; \r\n  showTime?: boolean;\r\n}) {\r\n  const selectedDate = value ? new Date(value) : null;\r\n  const [viewDate, setViewDate] = useState(selectedDate || new Date());\r\n\r\n  const monthNames = [\r\n    'January', 'February', 'March', 'April', 'May', 'June',\r\n    'July', 'August', 'September', 'October', 'November', 'December'\r\n  ];\r\n\r\n  const weekDays = ['SU', 'MO', 'TU', 'WE', 'TH', 'FR', 'SA'];\r\n\r\n  const { year, month } = useMemo(() => ({\r\n    year: viewDate.getFullYear(),\r\n    month: viewDate.getMonth()\r\n  }), [viewDate]);\r\n\r\n  const calendarDays = useMemo(() => {\r\n    const firstDay = new Date(year, month, 1);\r\n    const lastDay = new Date(year, month + 1, 0);\r\n    const startDay = firstDay.getDay();\r\n    const daysInMonth = lastDay.getDate();\r\n    const daysInPrevMonth = new Date(year, month, 0).getDate();\r\n\r\n    const days: Array<{ day: number; isCurrentMonth: boolean; date: Date }> = [];\r\n\r\n    // Previous month days\r\n    for (let i = startDay - 1; i >= 0; i--) {\r\n      days.push({\r\n        day: daysInPrevMonth - i,\r\n        isCurrentMonth: false,\r\n        date: new Date(year, month - 1, daysInPrevMonth - i)\r\n      });\r\n    }\r\n\r\n    // Current month days\r\n    for (let i = 1; i <= daysInMonth; i++) {\r\n      days.push({\r\n        day: i,\r\n        isCurrentMonth: true,\r\n        date: new Date(year, month, i)\r\n      });\r\n    }\r\n\r\n    // Next month days to fill the grid\r\n    const remainingDays = 42 - days.length; // 6 rows * 7 days\r\n    for (let i = 1; i <= remainingDays; i++) {\r\n      days.push({\r\n        day: i,\r\n        isCurrentMonth: false,\r\n        date: new Date(year, month + 1, i)\r\n      });\r\n    }\r\n\r\n    return days;\r\n  }, [year, month]);\r\n\r\n  const handlePrevMonth = () => {\r\n    setViewDate(new Date(year, month - 1, 1));\r\n  };\r\n\r\n  const handleNextMonth = () => {\r\n    setViewDate(new Date(year, month + 1, 1));\r\n  };\r\n\r\n  const handleDateSelect = (date: Date) => {\r\n    const newDate = new Date(date);\r\n    if (showTime) {\r\n      // Include time in the result\r\n      if (selectedDate) {\r\n        newDate.setHours(selectedDate.getHours());\r\n        newDate.setMinutes(selectedDate.getMinutes());\r\n      } else {\r\n        newDate.setHours(0);\r\n        newDate.setMinutes(0);\r\n      }\r\n      newDate.setSeconds(0);\r\n      newDate.setMilliseconds(0);\r\n      onChange(newDate.toISOString());\r\n    } else {\r\n      // Return only date without time (YYYY-MM-DD)\r\n      const year = newDate.getFullYear();\r\n      const month = String(newDate.getMonth() + 1).padStart(2, '0');\r\n      const day = String(newDate.getDate()).padStart(2, '0');\r\n      onChange(`${year}-${month}-${day}`);\r\n    }\r\n  };\r\n\r\n  const handleTimeChange = (hours: number, minutes: number) => {\r\n    const date = selectedDate ? new Date(selectedDate) : new Date();\r\n    date.setHours(hours);\r\n    date.setMinutes(minutes);\r\n    date.setSeconds(0);\r\n    date.setMilliseconds(0);\r\n    onChange(date.toISOString());\r\n  };\r\n\r\n  const handleToday = () => {\r\n    const now = new Date();\r\n    now.setSeconds(0);\r\n    now.setMilliseconds(0);\r\n    onChange(now.toISOString());\r\n    setViewDate(now);\r\n  };\r\n\r\n  const handleClear = () => {\r\n    onChange('');\r\n  };\r\n\r\n  const isSelected = (date: Date) => {\r\n    if (!selectedDate) return false;\r\n    return (\r\n      date.getDate() === selectedDate.getDate() &&\r\n      date.getMonth() === selectedDate.getMonth() &&\r\n      date.getFullYear() === selectedDate.getFullYear()\r\n    );\r\n  };\r\n\r\n  const isToday = (date: Date) => {\r\n    const today = new Date();\r\n    return (\r\n      date.getDate() === today.getDate() &&\r\n      date.getMonth() === today.getMonth() &&\r\n      date.getFullYear() === today.getFullYear()\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className={cn('avakio-datepicker-container', className)}>\r\n      {/* Navigation */}\r\n      <div className=\"avakio-dp-nav\">\r\n        <button\r\n          type=\"button\"\r\n          onClick={handlePrevMonth}\r\n          className=\"avakio-dp-nav-btn\"\r\n        >\r\n          <ChevronLeft className=\"h-4 w-4\" />\r\n        </button>\r\n        <div className=\"avakio-dp-nav-label\">\r\n          {monthNames[month]} {year}\r\n        </div>\r\n        <button\r\n          type=\"button\"\r\n          onClick={handleNextMonth}\r\n          className=\"avakio-dp-nav-btn\"\r\n        >\r\n          <ChevronRight className=\"h-4 w-4\" />\r\n        </button>\r\n      </div>\r\n\r\n      {/* Weekday headers */}\r\n      <div className=\"avakio-dp-weekdays\">\r\n        {weekDays.map(day => (\r\n          <div key={day} className=\"avakio-dp-weekday\">\r\n            {day}\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n      {/* Calendar grid */}\r\n      <div className=\"avakio-dp-days\">\r\n        {calendarDays.map((dayInfo, index) => (\r\n          <button\r\n            key={index}\r\n            type=\"button\"\r\n            onClick={() => handleDateSelect(dayInfo.date)}\r\n            className={cn(\r\n              'avakio-dp-day',\r\n              !dayInfo.isCurrentMonth && 'avakio-dp-day-outside',\r\n              isSelected(dayInfo.date) && 'avakio-dp-day-selected',\r\n              isToday(dayInfo.date) && !isSelected(dayInfo.date) && 'avakio-dp-day-today'\r\n            )}\r\n          >\r\n            {dayInfo.day}\r\n          </button>\r\n        ))}\r\n      </div>\r\n\r\n      {/* Time picker */}\r\n      {showTime && (\r\n      <div className=\"avakio-dp-time\">\r\n        <div className=\"avakio-dp-time-header\">\r\n          <Clock className=\"h-4 w-4\" />\r\n          <span className=\"avakio-dp-time-display\">\r\n            {selectedDate ? (\r\n              (() => {\r\n                const hours = selectedDate.getHours();\r\n                const minutes = selectedDate.getMinutes();\r\n                const ampm = hours >= 12 ? 'PM' : 'AM';\r\n                const displayHours = hours % 12 || 12;\r\n                return `${displayHours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')} ${ampm}`;\r\n              })()\r\n            ) : '00:00 AM'}\r\n          </span>\r\n        </div>\r\n        <div className=\"avakio-dp-time-inputs\">\r\n          <Input\r\n            type=\"number\"\r\n            min=\"0\"\r\n            max=\"23\"\r\n            placeholder=\"00\"\r\n            value={selectedDate ? selectedDate.getHours().toString().padStart(2, '0') : ''}\r\n            onChange={(e) => {\r\n              if (!e.target.value) return;\r\n              const hours = Math.max(0, Math.min(23, parseInt(e.target.value) || 0));\r\n              const minutes = selectedDate ? selectedDate.getMinutes() : 0;\r\n              handleTimeChange(hours, minutes);\r\n            }}\r\n            className=\"avakio-dp-time-input\"\r\n            disabled={!selectedDate}\r\n          />\r\n          <span className=\"avakio-dp-time-separator\">:</span>\r\n          <Input\r\n            type=\"number\"\r\n            min=\"0\"\r\n            max=\"59\"\r\n            placeholder=\"00\"\r\n            value={selectedDate ? selectedDate.getMinutes().toString().padStart(2, '0') : ''}\r\n            onChange={(e) => {\r\n              if (!e.target.value) return;\r\n              const minutes = Math.max(0, Math.min(59, parseInt(e.target.value) || 0));\r\n              const hours = selectedDate ? selectedDate.getHours() : 0;\r\n              handleTimeChange(hours, minutes);\r\n            }}\r\n            className=\"avakio-dp-time-input\"\r\n            disabled={!selectedDate}\r\n          />\r\n        </div>\r\n        {!selectedDate && (\r\n          <p className=\"avakio-dp-hint\">Select a date first</p>\r\n        )}\r\n      </div>\r\n      )}\r\n\r\n      {/* Action buttons - always visible */}\r\n      <div className=\"avakio-dp-actions\">\r\n        <Button\r\n          type=\"button\"\r\n          variant=\"ghost\"\r\n          size=\"sm\"\r\n          onClick={handleToday}\r\n          className=\"avakio-dp-action-btn\"\r\n        >\r\n          Today\r\n        </Button>\r\n        <Button\r\n          type=\"button\"\r\n          variant=\"ghost\"\r\n          size=\"sm\"\r\n          onClick={handleClear}\r\n          className=\"avakio-dp-action-btn\"\r\n        >\r\n          Clear\r\n        </Button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// Main exported component - dropdown version by default\r\nexport function AvakioDatePicker({ \r\n  value, \r\n  onChange, \r\n  className, \r\n  showTime = true, \r\n  id, \r\n  testId,\r\n  label = \"Date\",\r\n  placeholder = \"Select date\",\r\n  inline = false\r\n}: AvakioDatePickerProps) {\r\n  const [open, setOpen] = useState(false);\r\n  const rootRef = useRef<HTMLDivElement | null>(null);\r\n  const [themeAttr, setThemeAttr] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    const host = rootRef.current;\r\n    if (!host) return;\r\n    const nearest = host.closest('[data-admin-theme]') as HTMLElement | null;\r\n    setThemeAttr(nearest?.getAttribute('data-admin-theme') ?? null);\r\n\r\n    if (!nearest) return;\r\n    const observer = new MutationObserver(() => {\r\n      setThemeAttr(nearest.getAttribute('data-admin-theme') ?? null);\r\n    });\r\n    observer.observe(nearest, { attributes: true, attributeFilter: ['data-admin-theme'] });\r\n    return () => observer.disconnect();\r\n  }, []);\r\n\r\n  const displayValue = formatDisplayDate(value, showTime);\r\n\r\n  // If inline mode, render the calendar directly\r\n  if (inline) {\r\n    return (\r\n      <div \r\n        ref={rootRef}\r\n        id={id} \r\n        data-testid={testId} \r\n        className={cn('avakio-dp-inline', className)}\r\n        data-admin-theme={themeAttr || undefined}\r\n      >\r\n        <AvakioDatePickerCalendar \r\n          value={value} \r\n          onChange={onChange} \r\n          showTime={showTime} \r\n        />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Dropdown mode (default)\r\n  return (\r\n    <div\r\n      ref={rootRef}\r\n      id={id}\r\n      data-testid={testId}\r\n      className={cn('avakio-dp', className)}\r\n      data-admin-theme={themeAttr || undefined}\r\n    >\r\n      <Popover open={open} onOpenChange={setOpen}>\r\n        <PopoverTrigger asChild>\r\n          <button type=\"button\" className=\"avakio-dp-trigger\">\r\n            <div className=\"avakio-dp-trigger-label\">\r\n              <CalendarIcon size={16} />\r\n              <span>{label}</span>\r\n            </div>\r\n            <div className=\"avakio-dp-trigger-value\">\r\n              {value ? displayValue : <span className=\"avakio-dp-placeholder\">{placeholder}</span>}\r\n            </div>\r\n          </button>\r\n        </PopoverTrigger>\r\n        <PopoverContent\r\n          className=\"avakio-dp-popover\"\r\n          align=\"start\"\r\n          data-admin-theme={themeAttr || undefined}\r\n        >\r\n          <AvakioDatePickerCalendar \r\n            value={value} \r\n            onChange={(val) => {\r\n              onChange(val);\r\n              // Auto-close after selection if not showing time\r\n              if (!showTime && val) {\r\n                setOpen(false);\r\n              }\r\n            }} \r\n            showTime={showTime} \r\n          />\r\n          <div className=\"avakio-dp-footer\">\r\n            <button \r\n              type=\"button\" \r\n              className=\"avakio-dp-footer-action\" \r\n              onClick={() => {\r\n                onChange('');\r\n                setOpen(false);\r\n              }}\r\n            >\r\n              Clear\r\n            </button>\r\n            <button \r\n              type=\"button\" \r\n              className=\"avakio-dp-footer-action avakio-dp-footer-action-primary\" \r\n              onClick={() => setOpen(false)}\r\n            >\r\n              Done\r\n            </button>\r\n          </div>\r\n        </PopoverContent>\r\n      </Popover>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useEffect, useMemo, useRef, useState } from 'react';\r\nimport './avakio-checkbox.css';\r\n\r\nexport type AvakioCheckboxSize = 'sm' | 'md';\r\n\r\nexport interface AvakioCheckboxProps extends Omit<React.InputHTMLAttributes<HTMLInputElement>, 'size' | 'onChange'> {\r\n  checked?: boolean;\r\n  defaultChecked?: boolean;\r\n  indeterminate?: boolean;\r\n  label?: string;\r\n  description?: string;\r\n  size?: AvakioCheckboxSize;\r\n  error?: string;\r\n  required?: boolean;\r\n  onChange?: (checked: boolean) => void;\r\n  /** Padding (number for all sides, string for CSS, or [top, right, bottom, left]) */\r\n  padding?: string | number | [number, number, number, number];\r\n  /** Margin (number for all sides, string for CSS, or [top, right, bottom, left]) */\r\n  margin?: string | number | [number, number, number, number];\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n}\r\n\r\nexport function AvakioCheckbox({\r\n  id,\r\n  name,\r\n  value,\r\n  checked,\r\n  defaultChecked,\r\n  indeterminate = false,\r\n  label,\r\n  description,\r\n  size = 'md',\r\n  disabled = false,\r\n  error,\r\n  required = false,\r\n  className = '',\r\n  onChange,\r\n  padding,\r\n  margin,\r\n  testId,\r\n  ...rest\r\n}: AvakioCheckboxProps) {\r\n  const isControlled = checked !== undefined;\r\n  const [internalChecked, setInternalChecked] = useState<boolean>(defaultChecked ?? false);\r\n  const checkboxRef = useRef<HTMLInputElement>(null);\r\n\r\n  const isChecked = isControlled ? !!checked : internalChecked;\r\n\r\n  useEffect(() => {\r\n    if (checkboxRef.current) {\r\n      checkboxRef.current.indeterminate = indeterminate && !isChecked;\r\n    }\r\n  }, [indeterminate, isChecked]);\r\n\r\n  const status = useMemo(() => {\r\n    if (indeterminate && !isChecked) return 'indeterminate';\r\n    return isChecked ? 'checked' : 'unchecked';\r\n  }, [indeterminate, isChecked]);\r\n\r\n  const handleToggle = () => {\r\n    if (disabled) return;\r\n    if (!isControlled) {\r\n      setInternalChecked((prev) => (indeterminate ? true : !prev));\r\n    }\r\n    const next = indeterminate ? true : !isChecked;\r\n    onChange?.(next);\r\n  };\r\n\r\n  const handleKeyDown = (e: React.KeyboardEvent<HTMLDivElement>) => {\r\n    if (e.key === ' ' || e.key === 'Enter') {\r\n      e.preventDefault();\r\n      handleToggle();\r\n    }\r\n  };\r\n\r\n  const handleIconClick = (e: React.MouseEvent<HTMLSpanElement>) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    handleToggle();\r\n  };\r\n\r\n  // Handle padding\r\n  const paddingStyle = padding\r\n    ? typeof padding === 'number'\r\n      ? `${padding}px`\r\n      : Array.isArray(padding)\r\n      ? `${padding[0]}px ${padding[1]}px ${padding[2]}px ${padding[3]}px`\r\n      : padding\r\n    : undefined;\r\n\r\n  // Handle margin\r\n  const marginStyle = margin\r\n    ? typeof margin === 'number'\r\n      ? `${margin}px`\r\n      : Array.isArray(margin)\r\n      ? `${margin[0]}px ${margin[1]}px ${margin[2]}px ${margin[3]}px`\r\n      : margin\r\n    : undefined;\r\n\r\n  const containerStyle: React.CSSProperties = {\r\n    ...(paddingStyle && { padding: paddingStyle }),\r\n    ...(marginStyle && { margin: marginStyle }),\r\n  };\r\n\r\n  return (\r\n    <label\r\n      data-testid={testId}\r\n      className={[\r\n        'avakio-checkbox',\r\n        `avakio-checkbox-${size}`,\r\n        disabled ? 'avakio-checkbox-disabled' : '',\r\n        error ? 'avakio-checkbox-error' : '',\r\n        className,\r\n      ].filter(Boolean).join(' ')}\r\n      htmlFor={id}\r\n      data-status={status}\r\n      style={containerStyle}\r\n    >\r\n      <div\r\n        className=\"avakio-checkbox-box\"\r\n        role=\"checkbox\"\r\n        tabIndex={disabled ? -1 : 0}\r\n        aria-checked={status === 'indeterminate' ? 'mixed' : isChecked}\r\n        aria-disabled={disabled}\r\n        aria-invalid={!!error}\r\n        onKeyDown={handleKeyDown}\r\n        onClick={handleToggle}\r\n      >\r\n        <input\r\n          ref={checkboxRef}\r\n          id={id}\r\n          name={name}\r\n          value={value}\r\n          type=\"checkbox\"\r\n          checked={isChecked}\r\n          onChange={() => {}}\r\n          disabled={disabled}\r\n          tabIndex={-1}\r\n          {...rest}\r\n        />\r\n        <span className=\"avakio-checkbox-mark\" onClick={handleIconClick} />\r\n      </div>\r\n\r\n      {(label || description || error) && (\r\n        <div className=\"avakio-checkbox-text\">\r\n          <div className=\"avakio-checkbox-label-row\">\r\n            {label && <span className=\"avakio-checkbox-label\">{label}</span>}\r\n            {required && <span className=\"avakio-checkbox-required\">*</span>}\r\n          </div>\r\n          {description && <div className=\"avakio-checkbox-description\">{description}</div>}\r\n          {error && <div className=\"avakio-checkbox-error-text\">{error}</div>}\r\n        </div>\r\n      )}\r\n    </label>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useRef } from 'react';\r\nimport './avakio-button.css';\r\n\r\nexport type AvakioButtonVariant = 'primary' | 'secondary' | 'outline' | 'ghost' | 'danger';\r\nexport type AvakioButtonSize = 'sm' | 'md' | 'lg';\r\nexport type AvakioButtonType = 'default' | 'icon' | 'iconButton' | 'iconTop';\r\nexport type AvakioButtonAlign = 'left' | 'center' | 'right';\r\nexport type AvakioButtonTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\n\r\nexport interface AvakioButtonProps extends React.ButtonHTMLAttributes<HTMLButtonElement> {\r\n  /** Button text (children override this) */\r\n  label?: string;\r\n  /** Left icon */\r\n  icon?: React.ReactNode;\r\n  /** Right icon */\r\n  iconRight?: React.ReactNode;\r\n  /** Visual style variant */\r\n  variant?: AvakioButtonVariant;\r\n  /** Button size */\r\n  size?: AvakioButtonSize;\r\n  /** Full width button */\r\n  block?: boolean;\r\n  /** Loading state with spinner */\r\n  loading?: boolean;\r\n  /** Badge notification */\r\n  badge?: string | number;\r\n  /** Auto-adjust width to content */\r\n  autowidth?: boolean;\r\n  /** Tooltip text */\r\n  tooltip?: string;\r\n  /** Button type/layout */\r\n  buttonType?: AvakioButtonType;\r\n  /** Text alignment */\r\n  align?: AvakioButtonAlign;\r\n  /** Image URL for image button */\r\n  image?: string;\r\n  /** Keyboard hotkey (e.g., 'ctrl+s') */\r\n  hotkey?: string;\r\n  /** Popup menu ID or component */\r\n  popup?: string | React.ReactNode;\r\n  /** Value for form submission */\r\n  value?: string;\r\n  /** Name for form submission */\r\n  name?: string;\r\n  /** ID of the button */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n  /** Theme variant */\r\n  theme?: AvakioButtonTheme;\r\n}\r\n\r\nexport function AvakioButton({\r\n  label,\r\n  icon,\r\n  iconRight,\r\n  variant = 'primary',\r\n  size = 'md',\r\n  block = false,\r\n  loading = false,\r\n  badge,\r\n  disabled,\r\n  className = '',\r\n  children,\r\n  autowidth = false,\r\n  tooltip,\r\n  buttonType = 'default',\r\n  align = 'center',\r\n  image,\r\n  hotkey,\r\n  popup,\r\n  value,\r\n  name,\r\n  id,\r\n  testId,\r\n  theme,\r\n  onClick,\r\n  ...rest\r\n}: AvakioButtonProps) {\r\n  const isDisabled = disabled || loading;\r\n  const buttonRef = useRef<HTMLButtonElement>(null);\r\n\r\n  // Handle hotkey\r\n  React.useEffect(() => {\r\n    if (!hotkey) return;\r\n\r\n    const handleKeyDown = (e: KeyboardEvent) => {\r\n      const keys = hotkey.toLowerCase().split('+');\r\n      const ctrl = keys.includes('ctrl') || keys.includes('control');\r\n      const shift = keys.includes('shift');\r\n      const alt = keys.includes('alt');\r\n      const key = keys[keys.length - 1];\r\n\r\n      if (\r\n        (ctrl === (e.ctrlKey || e.metaKey)) &&\r\n        shift === e.shiftKey &&\r\n        alt === e.altKey &&\r\n        e.key.toLowerCase() === key\r\n      ) {\r\n        e.preventDefault();\r\n        buttonRef.current?.click();\r\n      }\r\n    };\r\n\r\n    document.addEventListener('keydown', handleKeyDown);\r\n    return () => document.removeEventListener('keydown', handleKeyDown);\r\n  }, [hotkey]);\r\n\r\n  const buttonTypeClass = buttonType === 'icon' || buttonType === 'iconButton' ? 'icon' : buttonType === 'iconTop' ? 'icon-top' : 'default';\r\n\r\n  return (\r\n    <button\r\n      ref={buttonRef}\r\n      id={id}\r\n      data-testid={testId}\r\n      data-admin-theme={theme}\r\n      className={[\r\n        'avakio-button',\r\n        `avakio-button-${variant}`,\r\n        `avakio-button-${size}`,\r\n        `avakio-button-type-${buttonTypeClass}`,\r\n        `avakio-button-align-${align}`,\r\n        block ? 'avakio-button-block' : '',\r\n        autowidth ? 'avakio-button-autowidth' : '',\r\n        loading ? 'avakio-button-loading' : '',\r\n        image ? 'avakio-button-image' : '',\r\n        className,\r\n      ].filter(Boolean).join(' ')}\r\n      disabled={isDisabled}\r\n      title={tooltip}\r\n      value={value}\r\n      name={name}\r\n      onClick={onClick}\r\n      {...rest}\r\n    >\r\n      <span className=\"avakio-button-inner\">\r\n        {loading && <span className=\"avakio-button-spinner\" aria-hidden />}\r\n        {image && <img src={image} alt=\"\" className=\"avakio-button-image-el\" />}\r\n        {icon && <span className=\"avakio-button-icon-left\">{icon}</span>}\r\n        {(children || label) && <span className=\"avakio-button-label\">{children ?? label}</span>}\r\n        {badge !== undefined && <span className=\"avakio-button-badge\">{badge}</span>}\r\n        {iconRight && <span className=\"avakio-button-icon-right\">{iconRight}</span>}\r\n        {hotkey && <span className=\"avakio-button-hotkey\">{hotkey}</span>}\r\n      </span>\r\n      {popup && typeof popup === 'string' && <div className=\"avakio-button-popup-ref\" data-popup={popup} />}\r\n    </button>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useEffect, useMemo, useRef, useState } from 'react';\r\nimport './avakio-colorpicker.css';\r\n\r\nexport interface AvakioColorPickerPreset {\r\n  label?: string;\r\n  value: string; // e.g. #1ca1c1\r\n}\r\n\r\nexport interface AvakioColorPickerProps {\r\n  id?: string;\r\n  value?: string;\r\n  defaultValue?: string;\r\n  onChange?: (color: string) => void;\r\n  label?: string;\r\n  description?: string;\r\n  error?: string;\r\n  disabled?: boolean;\r\n  readOnly?: boolean;\r\n  required?: boolean;\r\n  presets?: AvakioColorPickerPreset[];\r\n  allowCustomInput?: boolean;\r\n  showPreview?: boolean;\r\n  className?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n}\r\n\r\nconst normalizeHex = (hex: string) => {\r\n  if (!hex) return '';\r\n  const cleaned = hex.trim();\r\n  if (/^#?[0-9a-fA-F]{6}$/.test(cleaned)) {\r\n    return cleaned.startsWith('#') ? cleaned : `#${cleaned}`;\r\n  }\r\n  if (/^#?[0-9a-fA-F]{3}$/.test(cleaned)) {\r\n    const c = cleaned.replace('#', '');\r\n    const expanded = `#${c[0]}${c[0]}${c[1]}${c[1]}${c[2]}${c[2]}`;\r\n    return expanded;\r\n  }\r\n  return '';\r\n};\r\n\r\nexport function AvakioColorPicker({\r\n  id,\r\n  value,\r\n  defaultValue = '#1ca1c1',\r\n  onChange,\r\n  label,\r\n  description,\r\n  error,\r\n  disabled = false,\r\n  readOnly = false,\r\n  required = false,\r\n  presets = [],\r\n  allowCustomInput = true,\r\n  showPreview = true,\r\n  className = '',\r\n  testId,\r\n}: AvakioColorPickerProps) {\r\n  const isControlled = value !== undefined;\r\n  const [internal, setInternal] = useState<string>(normalizeHex(defaultValue) || '#1ca1c1');\r\n  const inputRef = useRef<HTMLInputElement>(null);\r\n\r\n  const currentColor = isControlled ? normalizeHex(value || '') || '#1ca1c1' : internal;\r\n\r\n  useEffect(() => {\r\n    if (!isControlled && !internal) {\r\n      setInternal('#1ca1c1');\r\n    }\r\n  }, [isControlled, internal]);\r\n\r\n  const allPresets = useMemo(() => {\r\n    if (presets.length) return presets;\r\n    return [\r\n      { label: 'Cyan', value: '#1ca1c1' },\r\n      { label: 'Blue', value: '#3b82f6' },\r\n      { label: 'Indigo', value: '#6366f1' },\r\n      { label: 'Violet', value: '#8b5cf6' },\r\n      { label: 'Emerald', value: '#10b981' },\r\n      { label: 'Amber', value: '#f59e0b' },\r\n      { label: 'Orange', value: '#f57c00' },\r\n      { label: 'Red', value: '#ef4444' },\r\n      { label: 'Gray', value: '#9ca3af' },\r\n      { label: 'Dark', value: '#111827' },\r\n    ];\r\n  }, [presets]);\r\n\r\n  const handleSelect = (hex: string) => {\r\n    const normalized = normalizeHex(hex);\r\n    if (!normalized) return;\r\n    if (!isControlled) {\r\n      setInternal(normalized);\r\n    }\r\n    onChange?.(normalized);\r\n  };\r\n\r\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const val = e.target.value;\r\n    const normalized = normalizeHex(val);\r\n    if (!isControlled) {\r\n      setInternal(val);\r\n    }\r\n    if (normalized) {\r\n      onChange?.(normalized);\r\n    }\r\n  };\r\n\r\n  const handleNativeChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const val = e.target.value;\r\n    handleSelect(val);\r\n  };\r\n\r\n  return (\r\n    <div\r\n      data-testid={testId}\r\n      className={[\r\n        'avakio-colorpicker',\r\n        disabled ? 'avakio-colorpicker-disabled' : '',\r\n        error ? 'avakio-colorpicker-error' : '',\r\n        className,\r\n      ].filter(Boolean).join(' ')}\r\n      data-color={currentColor}\r\n    >\r\n      {(label || description || error) && (\r\n        <div className=\"avakio-colorpicker-header\">\r\n          <div className=\"avakio-colorpicker-label-row\">\r\n            {label && <span className=\"avakio-colorpicker-label\">{label}</span>}\r\n            {required && <span className=\"avakio-colorpicker-required\">*</span>}\r\n          </div>\r\n          {description && <div className=\"avakio-colorpicker-description\">{description}</div>}\r\n          {error && <div className=\"avakio-colorpicker-error-text\">{error}</div>}\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"avakio-colorpicker-body\">\r\n        {showPreview && (\r\n          <div className=\"avakio-colorpicker-preview\" style={{ backgroundColor: currentColor }} aria-label=\"Color preview\" />\r\n        )}\r\n\r\n        <div className=\"avakio-colorpicker-controls\">\r\n          <input\r\n            ref={inputRef}\r\n            type=\"color\"\r\n            className=\"avakio-colorpicker-native\"\r\n            value={currentColor}\r\n            onChange={handleNativeChange}\r\n            disabled={disabled || readOnly}\r\n            aria-label=\"Pick color\"\r\n          />\r\n\r\n          {allowCustomInput && (\r\n            <input\r\n              type=\"text\"\r\n              className=\"avakio-colorpicker-hex\"\r\n              value={currentColor}\r\n              onChange={handleInputChange}\r\n              disabled={disabled || readOnly}\r\n              maxLength={7}\r\n              aria-label=\"Hex value\"\r\n            />\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {allPresets.length > 0 && (\r\n        <div className=\"avakio-colorpicker-swatches\" aria-label=\"Color presets\">\r\n          {allPresets.map((preset) => (\r\n            <button\r\n              key={preset.value}\r\n              type=\"button\"\r\n              className=\"avakio-colorpicker-swatch\"\r\n              style={{ backgroundColor: preset.value }}\r\n              onClick={() => handleSelect(preset.value)}\r\n              disabled={disabled || readOnly}\r\n              aria-label={preset.label || preset.value}\r\n            >\r\n              <span className=\"avakio-colorpicker-swatch-inner\" />\r\n              {currentColor.toLowerCase() === preset.value.toLowerCase() && (\r\n                <span className=\"avakio-colorpicker-swatch-active\" />\r\n              )}\r\n            </button>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useState, useRef, useEffect, useCallback } from 'react';\r\nimport { ChevronDown, X, Search } from 'lucide-react';\r\nimport './avakio-combo.css';\r\n\r\nexport interface AvakioComboOption {\r\n  id: string | number;\r\n  value: string;\r\n  [key: string]: any;\r\n}\r\n\r\nexport interface AvakioComboProps {\r\n  id?: string;\r\n  value?: string | number;\r\n  options: AvakioComboOption[] | string[];\r\n  onChange?: (value: string | number, option?: AvakioComboOption) => void;\r\n  onInputChange?: (inputValue: string) => void;\r\n  placeholder?: string;\r\n  label?: string;\r\n  labelAlign?: 'left' | 'right';\r\n  labelWidth?: number;\r\n  disabled?: boolean;\r\n  readonly?: boolean;\r\n  filterMode?: 'startsWith' | 'contains' | 'custom';\r\n  customFilter?: (option: AvakioComboOption, inputValue: string) => boolean;\r\n  template?: (option: AvakioComboOption) => React.ReactNode;\r\n  width?: number | string;\r\n  maxHeight?: number;\r\n  required?: boolean;\r\n  error?: string;\r\n  className?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n}\r\n\r\nexport function AvakioCombo({\r\n  id,\r\n  value,\r\n  options = [],\r\n  onChange,\r\n  onInputChange,\r\n  placeholder = 'Select or type...',\r\n  label,\r\n  labelAlign = 'left',\r\n  labelWidth = 100,\r\n  disabled = false,\r\n  readonly = false,\r\n  filterMode = 'contains',\r\n  customFilter,\r\n  template,\r\n  width,\r\n  maxHeight = 300,\r\n  required = false,\r\n  error,\r\n  className = '',\r\n  testId,\r\n}: AvakioComboProps) {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [inputValue, setInputValue] = useState('');\r\n  const [highlightedIndex, setHighlightedIndex] = useState(-1);\r\n  const [selectedOption, setSelectedOption] = useState<AvakioComboOption | null>(null);\r\n  const inputRef = useRef<HTMLInputElement>(null);\r\n  const dropdownRef = useRef<HTMLDivElement>(null);\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n\r\n  // Normalize options to AvakioComboOption format\r\n  const normalizedOptions: AvakioComboOption[] = options.map((opt) => {\r\n    if (typeof opt === 'string') {\r\n      return { id: opt, value: opt };\r\n    }\r\n    return opt;\r\n  });\r\n\r\n  // Initialize selected option based on value prop\r\n  useEffect(() => {\r\n    if (value !== undefined && value !== null && value !== '') {\r\n      const option = normalizedOptions.find(\r\n        (opt) => opt.id === value || opt.value === value\r\n      );\r\n      if (option) {\r\n        setSelectedOption(option);\r\n        setInputValue(option.value);\r\n      }\r\n    } else {\r\n      setSelectedOption(null);\r\n      setInputValue('');\r\n    }\r\n  }, [value]);\r\n\r\n  // Filter options based on input\r\n  const filteredOptions = normalizedOptions.filter((option) => {\r\n    if (!inputValue) return true;\r\n\r\n    if (customFilter) {\r\n      return customFilter(option, inputValue);\r\n    }\r\n\r\n    const searchValue = inputValue.toLowerCase();\r\n    const optionValue = option.value.toLowerCase();\r\n\r\n    switch (filterMode) {\r\n      case 'startsWith':\r\n        return optionValue.startsWith(searchValue);\r\n      case 'contains':\r\n      default:\r\n        return optionValue.includes(searchValue);\r\n    }\r\n  });\r\n\r\n  // Handle input change\r\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const newValue = e.target.value;\r\n    setInputValue(newValue);\r\n    setIsOpen(true);\r\n    setHighlightedIndex(-1);\r\n    \r\n    onInputChange?.(newValue);\r\n  };\r\n\r\n  // Handle option selection\r\n  const handleSelectOption = (option: AvakioComboOption) => {\r\n    setSelectedOption(option);\r\n    setInputValue(option.value);\r\n    setIsOpen(false);\r\n    setHighlightedIndex(-1);\r\n    \r\n    onChange?.(option.id, option);\r\n  };\r\n\r\n  // Handle clear\r\n  const handleClear = (e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    setSelectedOption(null);\r\n    setInputValue('');\r\n    setIsOpen(false);\r\n    \r\n    onChange?.('', undefined);\r\n    inputRef.current?.focus();\r\n  };\r\n\r\n  // Handle keyboard navigation\r\n  const handleKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\r\n    if (disabled || readonly) return;\r\n\r\n    switch (e.key) {\r\n      case 'ArrowDown':\r\n        e.preventDefault();\r\n        if (!isOpen) {\r\n          setIsOpen(true);\r\n        } else {\r\n          setHighlightedIndex((prev) =>\r\n            prev < filteredOptions.length - 1 ? prev + 1 : prev\r\n          );\r\n        }\r\n        break;\r\n\r\n      case 'ArrowUp':\r\n        e.preventDefault();\r\n        if (isOpen) {\r\n          setHighlightedIndex((prev) => (prev > 0 ? prev - 1 : -1));\r\n        }\r\n        break;\r\n\r\n      case 'Enter':\r\n        e.preventDefault();\r\n        if (isOpen && highlightedIndex >= 0 && filteredOptions[highlightedIndex]) {\r\n          handleSelectOption(filteredOptions[highlightedIndex]);\r\n        }\r\n        break;\r\n\r\n      case 'Escape':\r\n        e.preventDefault();\r\n        setIsOpen(false);\r\n        setHighlightedIndex(-1);\r\n        break;\r\n\r\n      case 'Tab':\r\n        setIsOpen(false);\r\n        break;\r\n    }\r\n  };\r\n\r\n  // Scroll highlighted option into view\r\n  useEffect(() => {\r\n    if (highlightedIndex >= 0 && dropdownRef.current) {\r\n      const highlightedElement = dropdownRef.current.children[highlightedIndex] as HTMLElement;\r\n      if (highlightedElement) {\r\n        highlightedElement.scrollIntoView({\r\n          block: 'nearest',\r\n          behavior: 'smooth',\r\n        });\r\n      }\r\n    }\r\n  }, [highlightedIndex]);\r\n\r\n  // Close dropdown when clicking outside\r\n  useEffect(() => {\r\n    const handleClickOutside = (event: MouseEvent) => {\r\n      if (\r\n        containerRef.current &&\r\n        !containerRef.current.contains(event.target as Node)\r\n      ) {\r\n        setIsOpen(false);\r\n        setHighlightedIndex(-1);\r\n      }\r\n    };\r\n\r\n    document.addEventListener('mousedown', handleClickOutside);\r\n    return () => document.removeEventListener('mousedown', handleClickOutside);\r\n  }, []);\r\n\r\n  const renderOption = (option: AvakioComboOption) => {\r\n    if (template) {\r\n      return template(option);\r\n    }\r\n    return option.value;\r\n  };\r\n\r\n  return (\r\n    <div\r\n      ref={containerRef}\r\n      data-testid={testId}\r\n      className={`avakio-combo-wrapper ${className}`}\r\n      style={{ width: width || '100%' }}\r\n    >\r\n      {label && (\r\n        <label\r\n          htmlFor={id}\r\n          className={`avakio-combo-label avakio-combo-label-${labelAlign}`}\r\n          style={{ width: labelWidth }}\r\n        >\r\n          {label}\r\n          {required && <span className=\"avakio-combo-required\">*</span>}\r\n        </label>\r\n      )}\r\n      <div className=\"avakio-combo-container\">\r\n        <div\r\n          className={`avakio-combo-input-wrapper ${isOpen ? 'open' : ''} ${\r\n            error ? 'error' : ''\r\n          } ${disabled ? 'disabled' : ''}`}\r\n        >\r\n          <Search className=\"avakio-combo-search-icon\" size={16} />\r\n          <input\r\n            ref={inputRef}\r\n            id={id}\r\n            type=\"text\"\r\n            className=\"avakio-combo-input\"\r\n            value={inputValue}\r\n            onChange={handleInputChange}\r\n            onKeyDown={handleKeyDown}\r\n            onFocus={() => !readonly && setIsOpen(true)}\r\n            placeholder={placeholder}\r\n            disabled={disabled}\r\n            readOnly={readonly}\r\n            required={required}\r\n          />\r\n          {inputValue && !disabled && !readonly && (\r\n            <button\r\n              type=\"button\"\r\n              className=\"avakio-combo-clear-btn\"\r\n              onClick={handleClear}\r\n              tabIndex={-1}\r\n            >\r\n              <X size={16} />\r\n            </button>\r\n          )}\r\n          <button\r\n            type=\"button\"\r\n            className=\"avakio-combo-toggle-btn\"\r\n            onClick={() => !disabled && !readonly && setIsOpen(!isOpen)}\r\n            disabled={disabled}\r\n            tabIndex={-1}\r\n          >\r\n            <ChevronDown size={16} className={isOpen ? 'rotate' : ''} />\r\n          </button>\r\n        </div>\r\n\r\n        {isOpen && !disabled && !readonly && (\r\n          <div\r\n            className=\"avakio-combo-dropdown\"\r\n            style={{ maxHeight }}\r\n          >\r\n            <div ref={dropdownRef} className=\"avakio-combo-options\">\r\n              {filteredOptions.length > 0 ? (\r\n                filteredOptions.map((option, index) => (\r\n                  <div\r\n                    key={option.id}\r\n                    className={`avakio-combo-option ${\r\n                      highlightedIndex === index ? 'highlighted' : ''\r\n                    } ${selectedOption?.id === option.id ? 'selected' : ''}`}\r\n                    onClick={() => handleSelectOption(option)}\r\n                    onMouseEnter={() => setHighlightedIndex(index)}\r\n                  >\r\n                    {renderOption(option)}\r\n                  </div>\r\n                ))\r\n              ) : (\r\n                <div className=\"avakio-combo-no-options\">No options found</div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {error && <div className=\"avakio-combo-error-message\">{error}</div>}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useEffect, useState } from 'react';\r\nimport './avakio-counter.css';\r\nimport { Minus, Plus } from 'lucide-react';\r\n\r\ntype Size = 'sm' | 'md' | 'lg';\r\n\r\nexport interface AvakioCounterProps {\r\n  id?: string;\r\n  value?: number;\r\n  defaultValue?: number;\r\n  step?: number;\r\n  min?: number;\r\n  max?: number;\r\n  label?: string;\r\n  labelPosition?: 'left' | 'top';\r\n  labelWidth?: number;\r\n  description?: string;\r\n  error?: string;\r\n  required?: boolean;\r\n  disabled?: boolean;\r\n  readOnly?: boolean;\r\n  size?: Size;\r\n  allowInput?: boolean;\r\n  onChange?: (value: number) => void;\r\n  className?: string;\r\n  /** Padding (number for all sides, string for CSS, or [top, right, bottom, left]) */\r\n  padding?: string | number | [number, number, number, number];\r\n  /** Margin (number for all sides, string for CSS, or [top, right, bottom, left]) */\r\n  margin?: string | number | [number, number, number, number];\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n}\r\n\r\nexport function AvakioCounter({\r\n  id,\r\n  value,\r\n  defaultValue = 0,\r\n  step = 1,\r\n  min,\r\n  max,\r\n  label,\r\n  labelPosition = 'top',\r\n  labelWidth = 100,\r\n  description,\r\n  error,\r\n  required = false,\r\n  disabled = false,\r\n  readOnly = false,\r\n  size = 'md',\r\n  allowInput = true,\r\n  onChange,\r\n  className = '',\r\n  padding,\r\n  margin,\r\n  testId,\r\n}: AvakioCounterProps) {\r\n  const isControlled = value !== undefined;\r\n  const [internal, setInternal] = useState<number>(value ?? defaultValue);\r\n\r\n  useEffect(() => {\r\n    if (isControlled && value !== undefined) {\r\n      setInternal(value);\r\n    }\r\n  }, [isControlled, value]);\r\n\r\n  const clamp = (val: number) => {\r\n    let next = val;\r\n    if (min !== undefined) next = Math.max(next, min);\r\n    if (max !== undefined) next = Math.min(next, max);\r\n    return next;\r\n  };\r\n\r\n  const current = clamp(internal);\r\n\r\n  const emitChange = (next: number) => {\r\n    if (!isControlled) {\r\n      setInternal(next);\r\n    }\r\n    onChange?.(next);\r\n  };\r\n\r\n  const handleStep = (delta: number) => {\r\n    if (disabled || readOnly) return;\r\n    const next = clamp(current + delta * step);\r\n    emitChange(next);\r\n  };\r\n\r\n  const handleInput = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    if (disabled || readOnly) return;\r\n    const raw = e.target.value;\r\n    if (raw === '') {\r\n      if (!isControlled) setInternal(NaN);\r\n      return;\r\n    }\r\n    const parsed = Number(raw);\r\n    if (Number.isNaN(parsed)) return;\r\n    emitChange(clamp(parsed));\r\n  };\r\n\r\n  const displayValue = Number.isNaN(current) ? '' : current;\r\n  const canDecrement = min === undefined ? true : displayValue === '' ? true : displayValue > min;\r\n  const canIncrement = max === undefined ? true : displayValue === '' ? true : displayValue < max;\r\n\r\n  // Handle padding\r\n  const paddingStyle = padding\r\n    ? typeof padding === 'number'\r\n      ? `${padding}px`\r\n      : Array.isArray(padding)\r\n      ? `${padding[0]}px ${padding[1]}px ${padding[2]}px ${padding[3]}px`\r\n      : padding\r\n    : undefined;\r\n\r\n  // Handle margin\r\n  const marginStyle = margin\r\n    ? typeof margin === 'number'\r\n      ? `${margin}px`\r\n      : Array.isArray(margin)\r\n      ? `${margin[0]}px ${margin[1]}px ${margin[2]}px ${margin[3]}px`\r\n      : margin\r\n    : undefined;\r\n\r\n  const containerStyle: React.CSSProperties = {\r\n    ...(paddingStyle && { padding: paddingStyle }),\r\n    ...(marginStyle && { margin: marginStyle }),\r\n  };\r\n\r\n  return (\r\n    <div\r\n      data-testid={testId}\r\n      className={[\r\n        'avakio-counter',\r\n        `avakio-counter-${size}`,\r\n        `avakio-counter-label-${labelPosition}`,\r\n        disabled ? 'avakio-counter-disabled' : '',\r\n        error ? 'avakio-counter-error' : '',\r\n        className,\r\n      ].filter(Boolean).join(' ')}\r\n      style={containerStyle}\r\n    >\r\n      {(label || description || error) && labelPosition === 'top' && (\r\n        <div className=\"avakio-counter-header\">\r\n          <div className=\"avakio-counter-label-row\">\r\n            {label && <span className=\"avakio-counter-label\">{label}</span>}\r\n            {required && <span className=\"avakio-counter-required\">*</span>}\r\n          </div>\r\n          {description && <div className=\"avakio-counter-description\">{description}</div>}\r\n          {error && <div className=\"avakio-counter-error-text\">{error}</div>}\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"avakio-counter-content\">\r\n        {label && labelPosition === 'left' && (\r\n          <div className=\"avakio-counter-label-left\" style={{ width: labelWidth }}>\r\n            <span className=\"avakio-counter-label\">{label}</span>\r\n            {required && <span className=\"avakio-counter-required\">*</span>}\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"avakio-counter-body\">\r\n        <button\r\n          type=\"button\"\r\n          className=\"avakio-counter-btn\"\r\n          onClick={() => handleStep(-1)}\r\n          disabled={disabled || readOnly || !canDecrement}\r\n          aria-label=\"Decrease\"\r\n        >\r\n          <Minus size={16} />\r\n        </button>\r\n\r\n        <input\r\n          id={id}\r\n          type=\"number\"\r\n          className=\"avakio-counter-input\"\r\n          value={displayValue}\r\n          onChange={handleInput}\r\n          disabled={disabled || readOnly || !allowInput}\r\n          readOnly={!allowInput}\r\n          min={min}\r\n          max={max}\r\n          step={step}\r\n          aria-live=\"polite\"\r\n        />\r\n\r\n        <button\r\n          type=\"button\"\r\n          className=\"avakio-counter-btn\"\r\n          onClick={() => handleStep(1)}\r\n          disabled={disabled || readOnly || !canIncrement}\r\n          aria-label=\"Increase\"\r\n        >\r\n          <Plus size={16} />\r\n        </button>\r\n      </div>\r\n\r\n      {labelPosition === 'left' && (description || error) && (\r\n        <div className=\"avakio-counter-footer\">\r\n          {description && <div className=\"avakio-counter-description\">{description}</div>}\r\n          {error && <div className=\"avakio-counter-error-text\">{error}</div>}\r\n        </div>\r\n      )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useEffect, useMemo, useRef, useState } from \"react\";\r\nimport { Calendar as CalendarIcon } from \"lucide-react\";\r\nimport { Popover, PopoverContent, PopoverTrigger } from '@/components/ui/popover';\r\nimport { AvakioDatePicker } from \"../avakio-datepicker/avakio-datepicker\";\r\nimport \"./avakio-daterangepicker.css\";\r\n\r\nexport type AvakioDateRange = {\r\n  start: string | null; // ISO or YYYY-MM-DD\r\n  end: string | null;\r\n};\r\n\r\nexport type PresetRange = {\r\n  label: string;\r\n  range: () => AvakioDateRange;\r\n};\r\n\r\nexport interface AvakioDateRangePickerProps {\r\n  value?: AvakioDateRange;\r\n  defaultValue?: AvakioDateRange;\r\n  onChange?: (range: AvakioDateRange) => void;\r\n  presets?: PresetRange[];\r\n  allowSingleDay?: boolean;\r\n  showTime?: boolean;\r\n  className?: string;\r\n  /** ID of the component */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n}\r\n\r\nconst formatDate = (value: string | null) => {\r\n  if (!value) return \"â€”\";\r\n  const d = new Date(value);\r\n  if (Number.isNaN(d.getTime())) return value;\r\n  return d.toLocaleDateString(undefined, { year: \"numeric\", month: \"short\", day: \"numeric\" });\r\n};\r\n\r\nconst normalize = (range: AvakioDateRange, allowSingleDay: boolean): AvakioDateRange => {\r\n  if (!range.start || !range.end) return range;\r\n  const s = new Date(range.start);\r\n  const e = new Date(range.end);\r\n  if (s.getTime() > e.getTime()) return { start: range.end, end: range.start };\r\n  if (!allowSingleDay && s.getTime() === e.getTime()) return { start: range.start, end: null };\r\n  return range;\r\n};\r\n\r\nexport function AvakioDateRangePicker({\r\n  value,\r\n  defaultValue,\r\n  onChange,\r\n  presets,\r\n  allowSingleDay = true,\r\n  showTime = false,\r\n  className,\r\n  id,\r\n  testId,\r\n}: AvakioDateRangePickerProps) {\r\n  const isControlled = value !== undefined;\r\n  const [internalRange, setInternalRange] = useState<AvakioDateRange>(\r\n    value || defaultValue || { start: null, end: null }\r\n  );\r\n  const [open, setOpen] = useState(false);\r\n  const rootRef = useRef<HTMLDivElement | null>(null);\r\n  const [themeAttr, setThemeAttr] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    const host = rootRef.current;\r\n    if (!host) return;\r\n    const nearest = host.closest('[data-admin-theme]') as HTMLElement | null;\r\n    setThemeAttr(nearest?.getAttribute('data-admin-theme') ?? null);\r\n\r\n    if (!nearest) return;\r\n    const observer = new MutationObserver(() => {\r\n      setThemeAttr(nearest.getAttribute('data-admin-theme') ?? null);\r\n    });\r\n    observer.observe(nearest, { attributes: true, attributeFilter: ['data-admin-theme'] });\r\n    return () => observer.disconnect();\r\n  }, []);\r\n\r\n  const range = useMemo(\r\n    () => normalize(isControlled ? value! : internalRange, allowSingleDay),\r\n    [isControlled, value, internalRange, allowSingleDay]\r\n  );\r\n\r\n  const applyRange = (next: AvakioDateRange) => {\r\n    const normalized = normalize(next, allowSingleDay);\r\n    if (!isControlled) setInternalRange(normalized);\r\n    onChange?.(normalized);\r\n  };\r\n\r\n  const presetItems: PresetRange[] = presets || [\r\n    {\r\n      label: \"Today\",\r\n      range: () => {\r\n        const t = new Date();\r\n        const iso = t.toISOString();\r\n        return { start: iso, end: iso };\r\n      },\r\n    },\r\n    {\r\n      label: \"Last 7 days\",\r\n      range: () => {\r\n        const end = new Date();\r\n        const start = new Date();\r\n        start.setDate(end.getDate() - 6);\r\n        return { start: start.toISOString(), end: end.toISOString() };\r\n      },\r\n    },\r\n    {\r\n      label: \"This month\",\r\n      range: () => {\r\n        const now = new Date();\r\n        const start = new Date(now.getFullYear(), now.getMonth(), 1);\r\n        const end = new Date(now.getFullYear(), now.getMonth() + 1, 0);\r\n        return { start: start.toISOString(), end: end.toISOString() };\r\n      },\r\n    },\r\n    {\r\n      label: \"Clear\",\r\n      range: () => ({ start: null, end: null }),\r\n    },\r\n  ];\r\n\r\n  const handleStart = (next: string) => {\r\n    applyRange({ start: next, end: range?.end ?? null });\r\n  };\r\n\r\n  const handleEnd = (next: string) => {\r\n    applyRange({ start: range?.start ?? null, end: next });\r\n  };\r\n\r\n  const display = `${formatDate(range?.start)} â†’ ${formatDate(range?.end)}`;\r\n\r\n  return (\r\n    <div\r\n      ref={rootRef}\r\n      id={id}\r\n      data-testid={testId}\r\n      className={[\"avakio-drp\", className || \"\"].join(\" \")}\r\n      data-admin-theme={themeAttr || undefined}\r\n    >\r\n      <Popover open={open} onOpenChange={setOpen}>\r\n        <PopoverTrigger asChild>\r\n          <button type=\"button\" className=\"avakio-drp-trigger\">\r\n            <div className=\"avakio-drp-trigger-label\">\r\n              <CalendarIcon size={16} />\r\n              <span>Date Range</span>\r\n            </div>\r\n            <div className=\"avakio-drp-trigger-value\">{display}</div>\r\n          </button>\r\n        </PopoverTrigger>\r\n        <PopoverContent\r\n          className=\"avakio-drp-popover\"\r\n          align=\"center\"\r\n          data-admin-theme={themeAttr || undefined}\r\n        >\r\n          <div className=\"avakio-drp-panel\">\r\n            <div className=\"avakio-drp-col\">\r\n              <div className=\"avakio-drp-col-header\">From</div>\r\n              <div data-admin-theme={themeAttr || undefined}>\r\n                <AvakioDatePicker value={range?.start || \"\"} onChange={handleStart} showTime={showTime} inline />\r\n              </div>\r\n            </div>\r\n            <div className=\"avakio-drp-col\">\r\n              <div className=\"avakio-drp-col-header\">To</div>\r\n              <div data-admin-theme={themeAttr || undefined}>\r\n                <AvakioDatePicker value={range?.end || \"\"} onChange={handleEnd} showTime={showTime} inline />\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"avakio-drp-presets\">\r\n            {presetItems.map((p) => (\r\n              <button\r\n                key={p.label}\r\n                type=\"button\"\r\n                className=\"avakio-drp-preset\"\r\n                onClick={() => applyRange(p.range())}\r\n              >\r\n                {p.label}\r\n              </button>\r\n            ))}\r\n          </div>\r\n\r\n          <div className=\"avakio-drp-footer\">\r\n            <button type=\"button\" className=\"avakio-drp-action\" onClick={() => applyRange({ start: null, end: null })}>\r\n              Clear\r\n            </button>\r\n            <button type=\"button\" className=\"avakio-drp-action\" onClick={() => setOpen(false)}>\r\n              Close\r\n            </button>\r\n          </div>\r\n        </PopoverContent>\r\n      </Popover>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useState, useRef, useEffect } from 'react';\r\nimport { ChevronDown, X, Search } from 'lucide-react';\r\nimport './avakio-gridsuggest.css';\r\n\r\nexport interface AvakioGridSuggestColumn {\r\n  id: string;\r\n  header?: string;\r\n  width?: number | string;\r\n  template?: (value: any, item: any) => React.ReactNode;\r\n}\r\n\r\nexport interface AvakioGridSuggestOption {\r\n  id: string | number;\r\n  [key: string]: any;\r\n}\r\n\r\nexport interface AvakioGridSuggestBodyConfig {\r\n  columns?: AvakioGridSuggestColumn[];\r\n  autoConfig?: boolean;\r\n  header?: boolean;\r\n  borderless?: boolean;\r\n  scroll?: boolean;\r\n  autoheight?: boolean;\r\n  yCount?: number;\r\n  data?: AvakioGridSuggestOption[];\r\n}\r\n\r\nexport interface AvakioGridSuggestProps {\r\n  id?: string;\r\n  value?: string | number;\r\n  data?: AvakioGridSuggestOption[];\r\n  onChange?: (value: string | number, option?: AvakioGridSuggestOption) => void;\r\n  onInputChange?: (inputValue: string) => void;\r\n  placeholder?: string;\r\n  label?: string;\r\n  labelAlign?: 'left' | 'right';\r\n  labelWidth?: number;\r\n  disabled?: boolean;\r\n  readonly?: boolean;\r\n  textValue?: string; // Template string for display value (e.g., \"#name#\")\r\n  template?: (item: AvakioGridSuggestOption) => React.ReactNode;\r\n  width?: number | string;\r\n  body?: AvakioGridSuggestBodyConfig;\r\n  required?: boolean;\r\n  error?: string;\r\n  className?: string;\r\n  editable?: boolean; // Allow typing/filtering like combo\r\n  filterMode?: 'startsWith' | 'contains';\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n}\r\n\r\nexport function AvakioGridSuggest({\r\n  id,\r\n  value,\r\n  data = [],\r\n  onChange,\r\n  onInputChange,\r\n  placeholder = 'Select...',\r\n  label,\r\n  labelAlign = 'left',\r\n  labelWidth = 100,\r\n  disabled = false,\r\n  readonly = false,\r\n  textValue,\r\n  template,\r\n  width,\r\n  body = { autoConfig: true, header: true, borderless: false },\r\n  required = false,\r\n  error,\r\n  className = '',\r\n  editable = true,\r\n  filterMode = 'contains',\r\n  testId,\r\n}: AvakioGridSuggestProps) {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [inputValue, setInputValue] = useState('');\r\n  const [highlightedIndex, setHighlightedIndex] = useState(-1);\r\n  const [selectedOption, setSelectedOption] = useState<AvakioGridSuggestOption | null>(null);\r\n  const inputRef = useRef<HTMLInputElement>(null);\r\n  const dropdownRef = useRef<HTMLDivElement>(null);\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n\r\n  // Use body.data if provided, otherwise use data prop\r\n  const options = body?.data || data;\r\n\r\n  // Auto-generate columns if autoConfig is true\r\n  const columns: AvakioGridSuggestColumn[] = React.useMemo(() => {\r\n    if (body?.columns) {\r\n      return body.columns;\r\n    }\r\n    if (body?.autoConfig && options.length > 0) {\r\n      const firstItem = options[0];\r\n      return Object.keys(firstItem)\r\n        .filter((key) => key !== 'id')\r\n        .map((key) => ({\r\n          id: key,\r\n          header: key.charAt(0).toUpperCase() + key.slice(1),\r\n        }));\r\n    }\r\n    return [];\r\n  }, [body?.columns, body?.autoConfig, options]);\r\n\r\n  // Get display text from item based on textValue template or first non-id field\r\n  const getDisplayText = (item: AvakioGridSuggestOption): string => {\r\n    if (template) {\r\n      const rendered = template(item);\r\n      if (typeof rendered === 'string') return rendered;\r\n      return String(item[columns[0]?.id] || '');\r\n    }\r\n    if (textValue) {\r\n      // Parse template like \"#name#\" or \"#name# (#code#)\"\r\n      return textValue.replace(/#(\\w+)#/g, (_, key) => String(item[key] || ''));\r\n    }\r\n    // Default: use first column value\r\n    const firstCol = columns[0]?.id || Object.keys(item).find((k) => k !== 'id');\r\n    return firstCol ? String(item[firstCol]) : '';\r\n  };\r\n\r\n  // Initialize selected option based on value prop\r\n  useEffect(() => {\r\n    if (value !== undefined && value !== null && value !== '') {\r\n      const option = options.find((opt) => opt.id === value);\r\n      if (option) {\r\n        setSelectedOption(option);\r\n        setInputValue(getDisplayText(option));\r\n      }\r\n    } else {\r\n      setSelectedOption(null);\r\n      setInputValue('');\r\n    }\r\n  }, [value, options]);\r\n\r\n  // Filter options based on input (if editable)\r\n  const filteredOptions = options.filter((option) => {\r\n    if (!editable || !inputValue) return true;\r\n\r\n    const searchValue = inputValue.toLowerCase();\r\n    \r\n    // Search across all column values\r\n    return columns.some((col) => {\r\n      const cellValue = String(option[col.id] || '').toLowerCase();\r\n      switch (filterMode) {\r\n        case 'startsWith':\r\n          return cellValue.startsWith(searchValue);\r\n        case 'contains':\r\n        default:\r\n          return cellValue.includes(searchValue);\r\n      }\r\n    });\r\n  });\r\n\r\n  // Close dropdown when clicking outside\r\n  useEffect(() => {\r\n    const handleClickOutside = (event: MouseEvent) => {\r\n      if (containerRef.current && !containerRef.current.contains(event.target as Node)) {\r\n        setIsOpen(false);\r\n        // Reset input if no valid selection\r\n        if (selectedOption && editable) {\r\n          setInputValue(getDisplayText(selectedOption));\r\n        }\r\n      }\r\n    };\r\n\r\n    if (isOpen) {\r\n      document.addEventListener('mousedown', handleClickOutside);\r\n    }\r\n\r\n    return () => {\r\n      document.removeEventListener('mousedown', handleClickOutside);\r\n    };\r\n  }, [isOpen, selectedOption]);\r\n\r\n  // Handle keyboard navigation\r\n  useEffect(() => {\r\n    const handleKeyDown = (e: KeyboardEvent) => {\r\n      if (!isOpen) return;\r\n\r\n      switch (e.key) {\r\n        case 'ArrowDown':\r\n          e.preventDefault();\r\n          setHighlightedIndex((prev) =>\r\n            prev < filteredOptions.length - 1 ? prev + 1 : prev\r\n          );\r\n          break;\r\n        case 'ArrowUp':\r\n          e.preventDefault();\r\n          setHighlightedIndex((prev) => (prev > 0 ? prev - 1 : 0));\r\n          break;\r\n        case 'Enter':\r\n          e.preventDefault();\r\n          if (highlightedIndex >= 0 && highlightedIndex < filteredOptions.length) {\r\n            handleSelect(filteredOptions[highlightedIndex]);\r\n          }\r\n          break;\r\n        case 'Escape':\r\n          e.preventDefault();\r\n          setIsOpen(false);\r\n          if (selectedOption && editable) {\r\n            setInputValue(getDisplayText(selectedOption));\r\n          }\r\n          break;\r\n      }\r\n    };\r\n\r\n    if (isOpen) {\r\n      document.addEventListener('keydown', handleKeyDown);\r\n    }\r\n\r\n    return () => {\r\n      document.removeEventListener('keydown', handleKeyDown);\r\n    };\r\n  }, [isOpen, highlightedIndex, filteredOptions, selectedOption]);\r\n\r\n  // Scroll highlighted row into view\r\n  useEffect(() => {\r\n    if (isOpen && highlightedIndex >= 0 && dropdownRef.current) {\r\n      const highlightedRow = dropdownRef.current.querySelector(\r\n        `[data-row-index=\"${highlightedIndex}\"]`\r\n      ) as HTMLElement;\r\n      if (highlightedRow) {\r\n        highlightedRow.scrollIntoView({\r\n          block: 'nearest',\r\n          behavior: 'smooth',\r\n        });\r\n      }\r\n    }\r\n  }, [highlightedIndex, isOpen]);\r\n\r\n  const handleSelect = (option: AvakioGridSuggestOption) => {\r\n    setSelectedOption(option);\r\n    setInputValue(getDisplayText(option));\r\n    setIsOpen(false);\r\n    setHighlightedIndex(-1);\r\n    onChange?.(option.id, option);\r\n  };\r\n\r\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const newValue = e.target.value;\r\n    setInputValue(newValue);\r\n    onInputChange?.(newValue);\r\n    \r\n    if (!isOpen) {\r\n      setIsOpen(true);\r\n    }\r\n    setHighlightedIndex(0);\r\n  };\r\n\r\n  const handleClear = (e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    setSelectedOption(null);\r\n    setInputValue('');\r\n    onChange?.('' as any, undefined);\r\n    inputRef.current?.focus();\r\n  };\r\n\r\n  const handleToggle = () => {\r\n    if (!disabled && !readonly) {\r\n      setIsOpen(!isOpen);\r\n      if (!isOpen) {\r\n        setHighlightedIndex(0);\r\n        inputRef.current?.focus();\r\n      }\r\n    }\r\n  };\r\n\r\n  const showHeader = body?.header !== false;\r\n  const showBorderless = body?.borderless === true;\r\n  const enableScroll = body?.scroll === true;\r\n  const maxHeight = body?.yCount ? body.yCount * 40 : enableScroll ? 300 : undefined;\r\n\r\n  return (\r\n    <div\r\n      ref={containerRef}\r\n      data-testid={testId}\r\n      className={`avakio-gridsuggest ${className}`}\r\n      style={{ width }}\r\n      data-disabled={disabled}\r\n      data-readonly={readonly}\r\n      data-error={!!error}\r\n    >\r\n      {label && (\r\n        <label\r\n          className=\"avakio-gridsuggest-label\"\r\n          style={{\r\n            width: labelAlign === 'left' ? labelWidth : undefined,\r\n            textAlign: labelAlign,\r\n          }}\r\n        >\r\n          {label}\r\n          {required && <span className=\"avakio-gridsuggest-required\">*</span>}\r\n        </label>\r\n      )}\r\n\r\n      <div className=\"avakio-gridsuggest-wrapper\">\r\n        <div className=\"avakio-gridsuggest-input-wrapper\">\r\n          <input\r\n            ref={inputRef}\r\n            type=\"text\"\r\n            id={id}\r\n            className=\"avakio-gridsuggest-input\"\r\n            value={inputValue}\r\n            onChange={handleInputChange}\r\n            onFocus={() => !disabled && !readonly && setIsOpen(true)}\r\n            placeholder={placeholder}\r\n            disabled={disabled}\r\n            readOnly={readonly || !editable}\r\n            aria-haspopup=\"grid\"\r\n            aria-expanded={isOpen}\r\n            aria-label={label || 'Grid select input'}\r\n          />\r\n\r\n          <div className=\"avakio-gridsuggest-icons\">\r\n            {editable && <Search size={16} className=\"avakio-gridsuggest-search-icon\" />}\r\n            {inputValue && !disabled && !readonly && (\r\n              <button\r\n                type=\"button\"\r\n                className=\"avakio-gridsuggest-clear\"\r\n                onClick={handleClear}\r\n                aria-label=\"Clear selection\"\r\n              >\r\n                <X size={16} />\r\n              </button>\r\n            )}\r\n            <button\r\n              type=\"button\"\r\n              className=\"avakio-gridsuggest-toggle\"\r\n              onClick={handleToggle}\r\n              disabled={disabled}\r\n              aria-label=\"Toggle dropdown\"\r\n            >\r\n              <ChevronDown size={18} className={isOpen ? 'open' : ''} />\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {isOpen && (\r\n          <div\r\n            ref={dropdownRef}\r\n            className={`avakio-gridsuggest-dropdown ${showBorderless ? 'borderless' : ''}`}\r\n            style={{ maxHeight }}\r\n            role=\"grid\"\r\n          >\r\n            {filteredOptions.length === 0 ? (\r\n              <div className=\"avakio-gridsuggest-empty\">No data found</div>\r\n            ) : (\r\n              <div className=\"avakio-gridsuggest-table\">\r\n                {showHeader && (\r\n                  <div className=\"avakio-gridsuggest-header\">\r\n                    {columns.map((col) => (\r\n                      <div\r\n                        key={col.id}\r\n                        className=\"avakio-gridsuggest-header-cell\"\r\n                        style={{ width: col.width }}\r\n                      >\r\n                        {col.header || col.id}\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                )}\r\n\r\n                <div className={`avakio-gridsuggest-body ${enableScroll ? 'scrollable' : ''}`}>\r\n                  {filteredOptions.map((option, rowIndex) => {\r\n                    const isSelected = selectedOption?.id === option.id;\r\n                    const isHighlighted = rowIndex === highlightedIndex;\r\n\r\n                    return (\r\n                      <div\r\n                        key={option.id}\r\n                        data-row-index={rowIndex}\r\n                        className={`avakio-gridsuggest-row ${isSelected ? 'selected' : ''} ${\r\n                          isHighlighted ? 'highlighted' : ''\r\n                        }`}\r\n                        onClick={() => handleSelect(option)}\r\n                        role=\"row\"\r\n                        aria-selected={isSelected}\r\n                      >\r\n                        {columns.map((col) => (\r\n                          <div\r\n                            key={col.id}\r\n                            className=\"avakio-gridsuggest-cell\"\r\n                            style={{ width: col.width }}\r\n                            role=\"gridcell\"\r\n                          >\r\n                            {col.template\r\n                              ? col.template(option[col.id], option)\r\n                              : option[col.id]}\r\n                          </div>\r\n                        ))}\r\n                      </div>\r\n                    );\r\n                  })}\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {error && <div className=\"avakio-gridsuggest-error\">{error}</div>}\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useState, useRef, useEffect, useMemo } from 'react';\r\nimport { Check, ChevronDown, X } from 'lucide-react';\r\nimport { cn } from '@/lib/utils';\r\nimport './avakio-multicombo.css';\r\n\r\nexport interface AvakioMultiComboOption {\r\n  value: string;\r\n  label: string;\r\n}\r\n\r\ninterface AvakioMultiComboProps {\r\n  options: AvakioMultiComboOption[];\r\n  value: string[];\r\n  onChange: (value: string[]) => void;\r\n  placeholder?: string;\r\n  className?: string;\r\n  showCount?: boolean;\r\n  maxDisplayItems?: number;\r\n  disabled?: boolean;\r\n  /** ID of the component */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n}\r\n\r\nexport function AvakioMultiCombo({\r\n  options,\r\n  value = [],\r\n  onChange,\r\n  placeholder = \"Select items...\",\r\n  className,\r\n  showCount = false,\r\n  maxDisplayItems = 3,\r\n  disabled = false,\r\n  id,\r\n  testId\r\n}: AvakioMultiComboProps) {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n  const inputRef = useRef<HTMLInputElement>(null);\r\n\r\n  // Filter options based on search query\r\n  const filteredOptions = useMemo(() => {\r\n    if (!searchQuery.trim()) return options;\r\n    const query = searchQuery.toLowerCase();\r\n    return options.filter(opt => \r\n      opt.label.toLowerCase().includes(query) || \r\n      opt.value.toLowerCase().includes(query)\r\n    );\r\n  }, [options, searchQuery]);\r\n\r\n  // Get selected option labels\r\n  const selectedOptions = useMemo(() => {\r\n    return options.filter(opt => value.includes(opt.value));\r\n  }, [options, value]);\r\n\r\n  // Handle click outside to close\r\n  useEffect(() => {\r\n    const handleClickOutside = (event: MouseEvent) => {\r\n      if (containerRef.current && !containerRef.current.contains(event.target as Node)) {\r\n        setIsOpen(false);\r\n        setSearchQuery('');\r\n      }\r\n    };\r\n\r\n    if (isOpen) {\r\n      document.addEventListener('mousedown', handleClickOutside);\r\n    }\r\n\r\n    return () => {\r\n      document.removeEventListener('mousedown', handleClickOutside);\r\n    };\r\n  }, [isOpen]);\r\n\r\n  const handleToggleOption = (optionValue: string) => {\r\n    if (value.includes(optionValue)) {\r\n      onChange(value.filter(v => v !== optionValue));\r\n    } else {\r\n      onChange([...value, optionValue]);\r\n    }\r\n  };\r\n\r\n  const handleRemoveItem = (optionValue: string, e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    onChange(value.filter(v => v !== optionValue));\r\n  };\r\n\r\n  const handleClearAll = (e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    onChange([]);\r\n  };\r\n\r\n  const handleInputClick = () => {\r\n    if (!disabled) {\r\n      setIsOpen(true);\r\n      inputRef.current?.focus();\r\n    }\r\n  };\r\n\r\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    setSearchQuery(e.target.value);\r\n    if (!isOpen) {\r\n      setIsOpen(true);\r\n    }\r\n  };\r\n\r\n  const handleSelectAll = () => {\r\n    if (filteredOptions.length === 0) return;\r\n    const allFilteredValues = filteredOptions.map(opt => opt.value);\r\n    const allSelected = allFilteredValues.every(v => value.includes(v));\r\n    \r\n    if (allSelected) {\r\n      // Deselect all filtered items\r\n      onChange(value.filter(v => !allFilteredValues.includes(v)));\r\n    } else {\r\n      // Select all filtered items\r\n      const newValues = Array.from(new Set([...value, ...allFilteredValues]));\r\n      onChange(newValues);\r\n    }\r\n  };\r\n\r\n  const renderSelectedItems = () => {\r\n    if (selectedOptions.length === 0) {\r\n      return <span className=\"avakio-mc-placeholder\">{placeholder}</span>;\r\n    }\r\n\r\n    if (showCount) {\r\n      return (\r\n        <span className=\"avakio-mc-count\">\r\n          {selectedOptions.length} {selectedOptions.length === 1 ? 'item' : 'items'} selected\r\n        </span>\r\n      );\r\n    }\r\n\r\n    const displayItems = selectedOptions.slice(0, maxDisplayItems);\r\n    const remainingCount = selectedOptions.length - maxDisplayItems;\r\n\r\n    return (\r\n      <div className=\"avakio-mc-chips\">\r\n        {displayItems.map(opt => (\r\n          <span key={opt.value} className=\"avakio-mc-chip\">\r\n            <span className=\"avakio-mc-chip-label\">{opt.label}</span>\r\n            <button\r\n              type=\"button\"\r\n              className=\"avakio-mc-chip-remove\"\r\n              onClick={(e) => handleRemoveItem(opt.value, e)}\r\n              disabled={disabled}\r\n            >\r\n              <X className=\"h-3 w-3\" />\r\n            </button>\r\n          </span>\r\n        ))}\r\n        {remainingCount > 0 && (\r\n          <span className=\"avakio-mc-chip avakio-mc-chip-more\">\r\n            +{remainingCount} more\r\n          </span>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const allFilteredSelected = filteredOptions.length > 0 && \r\n    filteredOptions.every(opt => value.includes(opt.value));\r\n\r\n  return (\r\n    <div \r\n      ref={containerRef}\r\n      id={id}\r\n      data-testid={testId}\r\n      className={cn('avakio-multicombo', disabled && 'avakio-mc-disabled', className)}\r\n    >\r\n      {/* Input Area */}\r\n      <div \r\n        className={cn(\r\n          'avakio-mc-input-wrapper',\r\n          isOpen && 'avakio-mc-input-wrapper-open'\r\n        )}\r\n        onClick={handleInputClick}\r\n      >\r\n        <div className=\"avakio-mc-input-content\">\r\n          {!isOpen && renderSelectedItems()}\r\n          {isOpen && (\r\n            <input\r\n              ref={inputRef}\r\n              type=\"text\"\r\n              className=\"avakio-mc-search-input\"\r\n              value={searchQuery}\r\n              onChange={handleInputChange}\r\n              placeholder={selectedOptions.length > 0 ? \"Search...\" : placeholder}\r\n              disabled={disabled}\r\n            />\r\n          )}\r\n        </div>\r\n        <div className=\"avakio-mc-actions\">\r\n          {value.length > 0 && !disabled && (\r\n            <button\r\n              type=\"button\"\r\n              className=\"avakio-mc-clear-btn\"\r\n              onClick={handleClearAll}\r\n            >\r\n              <X className=\"h-4 w-4\" />\r\n            </button>\r\n          )}\r\n          <button\r\n            type=\"button\"\r\n            className=\"avakio-mc-toggle-btn\"\r\n            onClick={(e) => {\r\n              e.stopPropagation();\r\n              if (!disabled) {\r\n                setIsOpen(!isOpen);\r\n                if (!isOpen) {\r\n                  inputRef.current?.focus();\r\n                }\r\n              }\r\n            }}\r\n            disabled={disabled}\r\n          >\r\n            <ChevronDown className={cn('h-4 w-4', isOpen && 'avakio-mc-toggle-open')} />\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Dropdown List */}\r\n      {isOpen && (\r\n        <div className=\"avakio-mc-dropdown\">\r\n          {/* Select All Option */}\r\n          {filteredOptions.length > 0 && (\r\n            <div className=\"avakio-mc-select-all\">\r\n              <button\r\n                type=\"button\"\r\n                className=\"avakio-mc-option\"\r\n                onClick={handleSelectAll}\r\n              >\r\n                <div className={cn(\r\n                  'avakio-mc-checkbox',\r\n                  allFilteredSelected && 'avakio-mc-checkbox-checked'\r\n                )}>\r\n                  {allFilteredSelected && <Check className=\"h-3 w-3\" />}\r\n                </div>\r\n                <span className=\"avakio-mc-option-label avakio-mc-select-all-label\">\r\n                  {allFilteredSelected ? 'Deselect All' : 'Select All'}\r\n                </span>\r\n              </button>\r\n            </div>\r\n          )}\r\n\r\n          {/* Options List */}\r\n          <div className=\"avakio-mc-options\">\r\n            {filteredOptions.length > 0 ? (\r\n              filteredOptions.map(option => {\r\n                const isSelected = value.includes(option.value);\r\n                return (\r\n                  <button\r\n                    key={option.value}\r\n                    type=\"button\"\r\n                    className=\"avakio-mc-option\"\r\n                    onClick={() => handleToggleOption(option.value)}\r\n                  >\r\n                    <div className={cn(\r\n                      'avakio-mc-checkbox',\r\n                      isSelected && 'avakio-mc-checkbox-checked'\r\n                    )}>\r\n                      {isSelected && <Check className=\"h-3 w-3\" />}\r\n                    </div>\r\n                    <span className=\"avakio-mc-option-label\">{option.label}</span>\r\n                  </button>\r\n                );\r\n              })\r\n            ) : (\r\n              <div className=\"avakio-mc-no-results\">\r\n                {searchQuery ? 'No matches found' : 'No options available'}\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Footer with count */}\r\n          {value.length > 0 && (\r\n            <div className=\"avakio-mc-footer\">\r\n              {value.length} {value.length === 1 ? 'item' : 'items'} selected\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useState, useRef, useEffect } from 'react';\r\nimport { ChevronDown, X } from 'lucide-react';\r\nimport './avakio-richselect.css';\r\n\r\nexport interface AvakioRichSelectOption {\r\n  id: string | number;\r\n  value: string;\r\n  [key: string]: any;\r\n}\r\n\r\nexport interface AvakioRichSelectProps {\r\n  id?: string;\r\n  value?: string | number;\r\n  options: AvakioRichSelectOption[] | string[];\r\n  onChange?: (value: string | number, option?: AvakioRichSelectOption) => void;\r\n  placeholder?: string;\r\n  label?: string;\r\n  labelAlign?: 'left' | 'right';\r\n  labelWidth?: number;\r\n  disabled?: boolean;\r\n  readonly?: boolean;\r\n  template?: (option: AvakioRichSelectOption) => React.ReactNode;\r\n  width?: number | string;\r\n  maxHeight?: number;\r\n  yCount?: number; // Number of visible items in the list\r\n  required?: boolean;\r\n  error?: string;\r\n  className?: string;\r\n  clearable?: boolean;\r\n  /** Padding - can be a number (all sides), string, or array [top, right, bottom, left] */\r\n  padding?: string | number | [number, number, number, number];\r\n  /** Margin - can be a number (all sides), string, or array [top, right, bottom, left] */\r\n  margin?: string | number | [number, number, number, number];\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n}\r\n\r\nexport function AvakioRichSelect({\r\n  id,\r\n  value,\r\n  options = [],\r\n  onChange,\r\n  placeholder = 'Select...',\r\n  label,\r\n  labelAlign = 'left',\r\n  labelWidth = 100,\r\n  disabled = false,\r\n  readonly = false,\r\n  template,\r\n  width,\r\n  maxHeight = 300,\r\n  yCount,\r\n  required = false,\r\n  error,\r\n  className = '',\r\n  clearable = true,\r\n  padding,\r\n  margin,\r\n  testId,\r\n}: AvakioRichSelectProps) {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [highlightedIndex, setHighlightedIndex] = useState(-1);\r\n  const [selectedOption, setSelectedOption] = useState<AvakioRichSelectOption | null>(null);\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n  const dropdownRef = useRef<HTMLDivElement>(null);\r\n  const buttonRef = useRef<HTMLButtonElement>(null);\r\n\r\n  // Normalize options to AvakioRichSelectOption format\r\n  const normalizedOptions: AvakioRichSelectOption[] = options.map((opt) => {\r\n    if (typeof opt === 'string') {\r\n      return { id: opt, value: opt };\r\n    }\r\n    return opt;\r\n  });\r\n\r\n  // Initialize selected option based on value prop\r\n  useEffect(() => {\r\n    if (value !== undefined && value !== null && value !== '') {\r\n      const option = normalizedOptions.find(\r\n        (opt) => opt.id === value || opt.value === value\r\n      );\r\n      if (option) {\r\n        setSelectedOption(option);\r\n      }\r\n    } else {\r\n      setSelectedOption(null);\r\n    }\r\n  }, [value]);\r\n\r\n  // Close dropdown when clicking outside\r\n  useEffect(() => {\r\n    const handleClickOutside = (event: MouseEvent) => {\r\n      if (containerRef.current && !containerRef.current.contains(event.target as Node)) {\r\n        setIsOpen(false);\r\n      }\r\n    };\r\n\r\n    if (isOpen) {\r\n      document.addEventListener('mousedown', handleClickOutside);\r\n    }\r\n\r\n    return () => {\r\n      document.removeEventListener('mousedown', handleClickOutside);\r\n    };\r\n  }, [isOpen]);\r\n\r\n  // Handle keyboard navigation\r\n  useEffect(() => {\r\n    const handleKeyDown = (e: KeyboardEvent) => {\r\n      if (!isOpen) return;\r\n\r\n      switch (e.key) {\r\n        case 'ArrowDown':\r\n          e.preventDefault();\r\n          setHighlightedIndex((prev) =>\r\n            prev < normalizedOptions.length - 1 ? prev + 1 : prev\r\n          );\r\n          break;\r\n        case 'ArrowUp':\r\n          e.preventDefault();\r\n          setHighlightedIndex((prev) => (prev > 0 ? prev - 1 : 0));\r\n          break;\r\n        case 'Enter':\r\n          e.preventDefault();\r\n          if (highlightedIndex >= 0 && highlightedIndex < normalizedOptions.length) {\r\n            handleSelect(normalizedOptions[highlightedIndex]);\r\n          }\r\n          break;\r\n        case 'Escape':\r\n          e.preventDefault();\r\n          setIsOpen(false);\r\n          break;\r\n      }\r\n    };\r\n\r\n    if (isOpen) {\r\n      document.addEventListener('keydown', handleKeyDown);\r\n    }\r\n\r\n    return () => {\r\n      document.removeEventListener('keydown', handleKeyDown);\r\n    };\r\n  }, [isOpen, highlightedIndex, normalizedOptions]);\r\n\r\n  // Scroll highlighted item into view\r\n  useEffect(() => {\r\n    if (isOpen && highlightedIndex >= 0 && dropdownRef.current) {\r\n      const highlightedElement = dropdownRef.current.querySelector(\r\n        `[data-index=\"${highlightedIndex}\"]`\r\n      ) as HTMLElement;\r\n      if (highlightedElement) {\r\n        highlightedElement.scrollIntoView({\r\n          block: 'nearest',\r\n          behavior: 'smooth',\r\n        });\r\n      }\r\n    }\r\n  }, [highlightedIndex, isOpen]);\r\n\r\n  const handleSelect = (option: AvakioRichSelectOption) => {\r\n    setSelectedOption(option);\r\n    setIsOpen(false);\r\n    setHighlightedIndex(-1);\r\n    onChange?.(option.id, option);\r\n  };\r\n\r\n  const handleClear = (e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    setSelectedOption(null);\r\n    onChange?.('' as any, undefined);\r\n  };\r\n\r\n  const handleToggle = () => {\r\n    if (!disabled && !readonly) {\r\n      setIsOpen(!isOpen);\r\n      if (!isOpen) {\r\n        // Set highlighted index to current selection when opening\r\n        const currentIndex = normalizedOptions.findIndex(\r\n          (opt) => opt.id === selectedOption?.id\r\n        );\r\n        setHighlightedIndex(currentIndex >= 0 ? currentIndex : 0);\r\n      }\r\n    }\r\n  };\r\n\r\n  const displayValue = selectedOption ? selectedOption.value : '';\r\n  const calculatedMaxHeight = yCount\r\n    ? yCount * 40 // Approximate item height\r\n    : maxHeight;\r\n\r\n  return (\r\n    <div\r\n      ref={containerRef}\r\n      data-testid={testId}\r\n      className={`avakio-richselect ${className}`}\r\n      style={{\r\n        width,\r\n        padding: Array.isArray(padding) \r\n          ? `${padding[0]}px ${padding[1]}px ${padding[2]}px ${padding[3]}px`\r\n          : typeof padding === 'number' ? `${padding}px` : padding,\r\n        margin: Array.isArray(margin) \r\n          ? `${margin[0]}px ${margin[1]}px ${margin[2]}px ${margin[3]}px`\r\n          : typeof margin === 'number' ? `${margin}px` : margin,\r\n      }}\r\n      data-disabled={disabled}\r\n      data-readonly={readonly}\r\n      data-error={!!error}\r\n    >\r\n      {label && (\r\n        <label\r\n          className=\"avakio-richselect-label\"\r\n          style={{\r\n            width: labelAlign === 'left' ? labelWidth : undefined,\r\n            textAlign: labelAlign,\r\n          }}\r\n        >\r\n          {label}\r\n          {required && <span className=\"avakio-richselect-required\">*</span>}\r\n        </label>\r\n      )}\r\n\r\n      <div className=\"avakio-richselect-wrapper\">\r\n        <button\r\n          ref={buttonRef}\r\n          type=\"button\"\r\n          id={id}\r\n          className=\"avakio-richselect-button\"\r\n          onClick={handleToggle}\r\n          disabled={disabled}\r\n          aria-haspopup=\"listbox\"\r\n          aria-expanded={isOpen}\r\n          aria-label={label || 'Select option'}\r\n        >\r\n          <span className={`avakio-richselect-value ${!displayValue ? 'placeholder' : ''}`}>\r\n            {displayValue || placeholder}\r\n          </span>\r\n\r\n          <div className=\"avakio-richselect-icons\">\r\n            {clearable && selectedOption && !disabled && !readonly && (\r\n              <span\r\n                role=\"button\"\r\n                tabIndex={-1}\r\n                className=\"avakio-richselect-clear\"\r\n                onClick={handleClear}\r\n                aria-label=\"Clear selection\"\r\n              >\r\n                <X size={16} />\r\n              </span>\r\n            )}\r\n            <ChevronDown\r\n              size={18}\r\n              className={`avakio-richselect-toggle ${isOpen ? 'open' : ''}`}\r\n            />\r\n          </div>\r\n        </button>\r\n\r\n        {isOpen && (\r\n          <div\r\n            ref={dropdownRef}\r\n            className=\"avakio-richselect-dropdown\"\r\n            style={{ maxHeight: calculatedMaxHeight }}\r\n            role=\"listbox\"\r\n          >\r\n            {normalizedOptions.length === 0 ? (\r\n              <div className=\"avakio-richselect-empty\">No options available</div>\r\n            ) : (\r\n              normalizedOptions.map((option, index) => {\r\n                const isSelected = selectedOption?.id === option.id;\r\n                const isHighlighted = index === highlightedIndex;\r\n\r\n                return (\r\n                  <div\r\n                    key={option.id}\r\n                    data-index={index}\r\n                    className={`avakio-richselect-option ${isSelected ? 'selected' : ''} ${\r\n                      isHighlighted ? 'highlighted' : ''\r\n                    }`}\r\n                    onClick={() => handleSelect(option)}\r\n                    role=\"option\"\r\n                    aria-selected={isSelected}\r\n                  >\r\n                    {template ? template(option) : option.value}\r\n                  </div>\r\n                );\r\n              })\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {error && <div className=\"avakio-richselect-error\">{error}</div>}\r\n    </div>\r\n  );\r\n}\r\n\r\n// Helper methods for API compatibility\r\nexport const AvakioRichSelectAPI = {\r\n  getValue: (ref: React.RefObject<any>) => {\r\n    // Returns the ID of the selected option\r\n    return ref.current?.selectedOption?.id;\r\n  },\r\n  getText: (ref: React.RefObject<any>) => {\r\n    // Returns the text value of the selected option\r\n    return ref.current?.selectedOption?.value;\r\n  },\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useMemo, useState, useRef, useCallback } from \"react\";\r\nimport \"./avakio-slider.css\";\r\n\r\nexport type AvakioSliderValue = number | [number, number];\r\n\r\nexport interface AvakioSliderProps {\r\n  /** Single value or range [min, max] */\r\n  value?: AvakioSliderValue;\r\n  /** Default single value or range [min, max] */\r\n  defaultValue?: AvakioSliderValue;\r\n  /** Callback when value changes */\r\n  onChange?: (value: AvakioSliderValue) => void;\r\n  /** Minimum value */\r\n  min?: number;\r\n  /** Maximum value */\r\n  max?: number;\r\n  /** Step increment */\r\n  step?: number;\r\n  /** Enable range mode with two handles */\r\n  range?: boolean;\r\n  /** Disabled state */\r\n  disabled?: boolean;\r\n  /** Label text */\r\n  label?: string;\r\n  /** Description text */\r\n  description?: string;\r\n  /** Required field indicator */\r\n  required?: boolean;\r\n  /** Error message */\r\n  error?: string;\r\n  /** Show current value */\r\n  showValue?: boolean;\r\n  /** Custom value formatter */\r\n  formatValue?: (value: number) => string;\r\n  /** Mark positions on the track */\r\n  marks?: number[];\r\n  /** Size variant */\r\n  size?: \"sm\" | \"md\" | \"lg\";\r\n  /** ID of the component */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n  /** Theme */\r\n  theme?: string;\r\n}\r\n\r\nfunction clamp(val: number, min: number, max: number) {\r\n  return Math.min(Math.max(val, min), max);\r\n}\r\n\r\nexport function AvakioSlider({\r\n  value,\r\n  defaultValue,\r\n  onChange,\r\n  min = 0,\r\n  max = 100,\r\n  step = 1,\r\n  range = false,\r\n  disabled,\r\n  label,\r\n  description,\r\n  required,\r\n  error,\r\n  showValue = true,\r\n  formatValue,\r\n  marks,\r\n  size = \"md\",\r\n  id,\r\n  testId,\r\n  theme,\r\n}: AvakioSliderProps) {\r\n  const isControlled = value !== undefined;\r\n  \r\n  // Normalize value to always work with [low, high] internally for range mode\r\n  const normalizeToRange = (val: AvakioSliderValue | undefined, defaultMin: number, defaultMax: number): [number, number] => {\r\n    if (val === undefined) return [defaultMin, defaultMax];\r\n    if (Array.isArray(val)) return [clamp(val[0], min, max), clamp(val[1], min, max)];\r\n    return [min, clamp(val, min, max)];\r\n  };\r\n\r\n  const normalizeToSingle = (val: AvakioSliderValue | undefined, defaultVal: number): number => {\r\n    if (val === undefined) return defaultVal;\r\n    if (Array.isArray(val)) return val[1];\r\n    return clamp(val, min, max);\r\n  };\r\n\r\n  const [internalRange, setInternalRange] = useState<[number, number]>(() => \r\n    normalizeToRange(defaultValue, min, range ? max : min)\r\n  );\r\n  const [internalSingle, setInternalSingle] = useState<number>(() => \r\n    normalizeToSingle(defaultValue, min)\r\n  );\r\n\r\n  // Current values\r\n  const currentRange: [number, number] = isControlled \r\n    ? normalizeToRange(value, min, max)\r\n    : internalRange;\r\n  const currentSingle: number = isControlled \r\n    ? normalizeToSingle(value, min)\r\n    : internalSingle;\r\n\r\n  // Percentages for styling\r\n  const lowPercent = range ? ((currentRange[0] - min) / (max - min || 1)) * 100 : 0;\r\n  const highPercent = range \r\n    ? ((currentRange[1] - min) / (max - min || 1)) * 100\r\n    : ((currentSingle - min) / (max - min || 1)) * 100;\r\n\r\n  // Formatted display values\r\n  const formattedLow = useMemo(() => {\r\n    const val = range ? currentRange[0] : currentSingle;\r\n    return formatValue ? formatValue(val) : val.toString();\r\n  }, [range, currentRange, currentSingle, formatValue]);\r\n\r\n  const formattedHigh = useMemo(() => {\r\n    if (!range) return formattedLow;\r\n    return formatValue ? formatValue(currentRange[1]) : currentRange[1].toString();\r\n  }, [range, currentRange, formatValue, formattedLow]);\r\n\r\n  const safeMarks = useMemo(() => {\r\n    if (!marks || !marks.length) return [] as number[];\r\n    return marks.filter((m) => m >= min && m <= max);\r\n  }, [marks, min, max]);\r\n\r\n  // Handle change for single slider\r\n  const handleSingleChange = useCallback((next: number) => {\r\n    const clamped = clamp(next, min, max);\r\n    if (!isControlled) setInternalSingle(clamped);\r\n    onChange?.(clamped);\r\n  }, [min, max, isControlled, onChange]);\r\n\r\n  // Handle change for range slider\r\n  const handleRangeChange = useCallback((index: 0 | 1, next: number) => {\r\n    const clamped = clamp(next, min, max);\r\n    let newRange: [number, number];\r\n    \r\n    if (index === 0) {\r\n      // Low handle - ensure it doesn't exceed high\r\n      newRange = [Math.min(clamped, currentRange[1]), currentRange[1]];\r\n    } else {\r\n      // High handle - ensure it doesn't go below low\r\n      newRange = [currentRange[0], Math.max(clamped, currentRange[0])];\r\n    }\r\n    \r\n    if (!isControlled) setInternalRange(newRange);\r\n    onChange?.(newRange);\r\n  }, [min, max, currentRange, isControlled, onChange]);\r\n\r\n  // Track click handler for range mode\r\n  const trackRef = useRef<HTMLDivElement>(null);\r\n  const handleTrackClick = useCallback((e: React.MouseEvent<HTMLDivElement>) => {\r\n    if (disabled || !range || !trackRef.current) return;\r\n    \r\n    const rect = trackRef.current.getBoundingClientRect();\r\n    const percent = (e.clientX - rect.left) / rect.width;\r\n    const clickValue = min + percent * (max - min);\r\n    const snappedValue = Math.round(clickValue / step) * step;\r\n    \r\n    // Determine which handle is closer\r\n    const distToLow = Math.abs(snappedValue - currentRange[0]);\r\n    const distToHigh = Math.abs(snappedValue - currentRange[1]);\r\n    \r\n    if (distToLow <= distToHigh) {\r\n      handleRangeChange(0, snappedValue);\r\n    } else {\r\n      handleRangeChange(1, snappedValue);\r\n    }\r\n  }, [disabled, range, min, max, step, currentRange, handleRangeChange]);\r\n\r\n  // CSS custom properties for range progress\r\n  const sliderStyle = range\r\n    ? {\r\n        [\"--slider-progress-start\" as string]: `${lowPercent}%`,\r\n        [\"--slider-progress-end\" as string]: `${highPercent}%`,\r\n        [\"--slider-progress\" as string]: `${highPercent}%`,\r\n      }\r\n    : {\r\n        [\"--slider-progress\" as string]: `${highPercent}%`,\r\n      };\r\n\r\n  return (\r\n    <div\r\n      id={id}\r\n      data-testid={testId}\r\n      data-admin-theme={theme}\r\n      className={[\r\n        \"avakio-slider\",\r\n        `avakio-slider-${size}`,\r\n        range && \"avakio-slider-range\",\r\n        error && \"avakio-slider-error\",\r\n        disabled && \"avakio-slider-disabled\",\r\n      ].filter(Boolean).join(\" \")}\r\n      style={sliderStyle}\r\n    >\r\n      {(label || description) && (\r\n        <div className=\"avakio-slider-header\">\r\n          <div className=\"avakio-slider-label-row\">\r\n            {label && <span className=\"avakio-slider-label\">{label}</span>}\r\n            {required && <span className=\"avakio-slider-required\">*</span>}\r\n            {showValue && (\r\n              <span className=\"avakio-slider-value-chip\">\r\n                {range ? `${formattedLow} - ${formattedHigh}` : formattedLow}\r\n              </span>\r\n            )}\r\n          </div>\r\n          {description && <div className=\"avakio-slider-description\">{description}</div>}\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"avakio-slider-body\">\r\n        {range ? (\r\n          <>\r\n            {/* Low handle input */}\r\n            <input\r\n              type=\"range\"\r\n              className=\"avakio-slider-input avakio-slider-input-low\"\r\n              min={min}\r\n              max={max}\r\n              step={step}\r\n              value={currentRange[0]}\r\n              disabled={disabled}\r\n              onChange={(e) => handleRangeChange(0, Number(e.target.value))}\r\n              aria-label=\"Range minimum\"\r\n            />\r\n            {/* High handle input */}\r\n            <input\r\n              type=\"range\"\r\n              className=\"avakio-slider-input avakio-slider-input-high\"\r\n              min={min}\r\n              max={max}\r\n              step={step}\r\n              value={currentRange[1]}\r\n              disabled={disabled}\r\n              onChange={(e) => handleRangeChange(1, Number(e.target.value))}\r\n              aria-label=\"Range maximum\"\r\n            />\r\n          </>\r\n        ) : (\r\n          <input\r\n            type=\"range\"\r\n            className=\"avakio-slider-input\"\r\n            min={min}\r\n            max={max}\r\n            step={step}\r\n            value={currentSingle}\r\n            disabled={disabled}\r\n            onChange={(e) => handleSingleChange(Number(e.target.value))}\r\n          />\r\n        )}\r\n        \r\n        <div \r\n          ref={trackRef} \r\n          className=\"avakio-slider-track\"\r\n          onClick={range ? handleTrackClick : undefined}\r\n        >\r\n          {range ? (\r\n            <div \r\n              className=\"avakio-slider-progress avakio-slider-progress-range\" \r\n              style={{ \r\n                left: `${lowPercent}%`, \r\n                width: `${highPercent - lowPercent}%` \r\n              }}\r\n            />\r\n          ) : (\r\n            <div className=\"avakio-slider-progress\" />\r\n          )}\r\n          \r\n          {range ? (\r\n            <>\r\n              <div \r\n                className=\"avakio-slider-thumb avakio-slider-thumb-low\" \r\n                style={{ left: `${lowPercent}%` }} \r\n              />\r\n              <div \r\n                className=\"avakio-slider-thumb avakio-slider-thumb-high\" \r\n                style={{ left: `${highPercent}%` }} \r\n              />\r\n            </>\r\n          ) : (\r\n            <div className=\"avakio-slider-thumb\" style={{ left: `${highPercent}%` }} />\r\n          )}\r\n        </div>\r\n        \r\n        {safeMarks.length > 0 && (\r\n          <div className=\"avakio-slider-marks\">\r\n            {safeMarks.map((m) => {\r\n              const p = ((m - min) / (max - min || 1)) * 100;\r\n              const isInRange = range \r\n                ? m >= currentRange[0] && m <= currentRange[1]\r\n                : m <= currentSingle;\r\n              return (\r\n                <div \r\n                  key={m} \r\n                  className={`avakio-slider-mark ${isInRange ? 'avakio-slider-mark-active' : ''}`} \r\n                  style={{ left: `${p}%` }}\r\n                >\r\n                  <span className=\"avakio-slider-mark-dot\" />\r\n                  <span className=\"avakio-slider-mark-label\">{m}</span>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {error && <div className=\"avakio-slider-error-text\">{error}</div>}\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useEffect, useMemo, useRef, useState } from \"react\";\r\nimport \"./avakio-property.css\";\r\nimport { AvakioDatePicker } from \"../../ui-controls/avakio-datepicker/avakio-datepicker\";\r\nimport { AvakioCheckbox } from \"../../ui-controls/avakio-checkbox/avakio-checkbox\";\r\nimport { AvakioButton, AvakioButtonSize, AvakioButtonVariant } from \"../../ui-controls/avakio-button/avakio-button\";\r\nimport { AvakioColorPicker, AvakioColorPickerPreset } from \"../../ui-controls/avakio-colorpicker/avakio-colorpicker\";\r\nimport { AvakioCombo, AvakioComboOption } from \"../../ui-controls/avakio-combo/avakio-combo\";\r\nimport { AvakioCounter } from \"../../ui-controls/avakio-counter/avakio-counter\";\r\nimport { AvakioDateRangePicker, AvakioDateRange, PresetRange } from \"../../ui-controls/avakio-daterangepicker/avakio-daterangepicker\";\r\nimport { AvakioGridSuggest, AvakioGridSuggestBodyConfig, AvakioGridSuggestOption } from \"../../ui-controls/avakio-gridsuggest/avakio-gridsuggest\";\r\nimport { AvakioMultiCombo, AvakioMultiComboOption } from \"../../ui-controls/avakio-multicombo/avakio-multicombo\";\r\nimport { AvakioRichSelect, AvakioRichSelectOption } from \"../../ui-controls/avakio-richselect/avakio-richselect\";\r\nimport { AvakioSlider } from \"../../ui-controls/avakio-slider/avakio-slider\";\r\n\r\nexport type AvakioPropertyEditor =\r\n  | \"text\"\r\n  | \"number\"\r\n  | \"select\"\r\n  | \"checkbox\"\r\n  | \"combo\"\r\n  | \"colorpicker\"\r\n  | \"counter\"\r\n  | \"multicombo\"\r\n  | \"date\"\r\n  | \"datetime\"\r\n  | \"button\"\r\n  | \"daterangepicker\"\r\n  | \"gridsuggest\"\r\n  | \"slider\"\r\n  | \"textarea\";\r\n\r\nexport interface AvakioPropertyOption {\r\n  label: string;\r\n  value: string | number | boolean;\r\n}\r\n\r\nexport interface AvakioPropertyItem {\r\n  id: string;\r\n  label: string;\r\n  type?: AvakioPropertyEditor;\r\n  value?: string | number | boolean | string[] | AvakioDateRange | null;\r\n  placeholder?: string;\r\n  description?: string;\r\n  group?: string;\r\n  options?: AvakioPropertyOption[];\r\n  disabled?: boolean;\r\n  required?: boolean;\r\n  checkboxLabel?: string;\r\n  checkboxDescription?: string;\r\n  checkboxOnChange?: (checked: boolean, item: AvakioPropertyItem) => void;\r\n  buttonVariant?: AvakioButtonVariant;\r\n  buttonSize?: AvakioButtonSize;\r\n  buttonBadge?: string | number;\r\n  buttonIcon?: React.ReactNode;\r\n  buttonIconRight?: React.ReactNode;\r\n  buttonBlock?: boolean;\r\n  buttonLabel?: string;\r\n  buttonOnClick?: (item: AvakioPropertyItem) => void;\r\n  comboOptions?: AvakioComboOption[] | string[];\r\n  comboOnChange?: (value: string | number, option: AvakioComboOption | undefined, item: AvakioPropertyItem) => void;\r\n  comboOnInputChange?: (inputValue: string, item: AvakioPropertyItem) => void;\r\n  comboPlaceholder?: string;\r\n  comboLabel?: string;\r\n  comboLabelAlign?: \"left\" | \"right\";\r\n  comboLabelWidth?: number;\r\n  comboDisabled?: boolean;\r\n  comboReadOnly?: boolean;\r\n  comboFilterMode?: \"startsWith\" | \"contains\" | \"custom\";\r\n  comboCustomFilter?: (option: AvakioComboOption, inputValue: string) => boolean;\r\n  comboTemplate?: (option: AvakioComboOption) => React.ReactNode;\r\n  comboWidth?: number | string;\r\n  comboMaxHeight?: number;\r\n  comboRequired?: boolean;\r\n  comboError?: string;\r\n  comboClassName?: string;\r\n  selectOptions?: AvakioRichSelectOption[] | string[];\r\n  selectOnChange?: (value: string | number, option: AvakioRichSelectOption | undefined, item: AvakioPropertyItem) => void;\r\n  selectPlaceholder?: string;\r\n  selectDisabled?: boolean;\r\n  selectReadOnly?: boolean;\r\n  selectTemplate?: (option: AvakioRichSelectOption) => React.ReactNode;\r\n  selectWidth?: number | string;\r\n  selectMaxHeight?: number;\r\n  selectYCount?: number;\r\n  selectRequired?: boolean;\r\n  selectError?: string;\r\n  selectClassName?: string;\r\n  selectClearable?: boolean;\r\n  counterDefaultValue?: number;\r\n  counterStep?: number;\r\n  counterMin?: number;\r\n  counterMax?: number;\r\n  counterLabel?: string;\r\n  counterDescription?: string;\r\n  counterError?: string;\r\n  counterRequired?: boolean;\r\n  counterDisabled?: boolean;\r\n  counterReadOnly?: boolean;\r\n  counterSize?: \"sm\" | \"md\" | \"lg\";\r\n  counterAllowInput?: boolean;\r\n  counterClassName?: string;\r\n  counterOnChange?: (value: number, item: AvakioPropertyItem) => void;\r\n  daterangeDefaultValue?: AvakioDateRange;\r\n  daterangePresets?: PresetRange[];\r\n  daterangeAllowSingleDay?: boolean;\r\n  daterangeShowTime?: boolean;\r\n  daterangeClassName?: string;\r\n  daterangeOnChange?: (range: AvakioDateRange, item: AvakioPropertyItem) => void;\r\n  gridsuggestData?: AvakioGridSuggestOption[];\r\n  gridsuggestOnChange?: (value: string | number, option: AvakioGridSuggestOption | undefined, item: AvakioPropertyItem) => void;\r\n  gridsuggestOnInputChange?: (inputValue: string, item: AvakioPropertyItem) => void;\r\n  gridsuggestPlaceholder?: string;\r\n  gridsuggestLabel?: string;\r\n  gridsuggestLabelAlign?: \"left\" | \"right\";\r\n  gridsuggestLabelWidth?: number;\r\n  gridsuggestDisabled?: boolean;\r\n  gridsuggestReadOnly?: boolean;\r\n  gridsuggestTextValue?: string;\r\n  gridsuggestTemplate?: (item: AvakioGridSuggestOption) => React.ReactNode;\r\n  gridsuggestWidth?: number | string;\r\n  gridsuggestBody?: AvakioGridSuggestBodyConfig;\r\n  gridsuggestRequired?: boolean;\r\n  gridsuggestError?: string;\r\n  gridsuggestClassName?: string;\r\n  gridsuggestEditable?: boolean;\r\n  gridsuggestFilterMode?: \"startsWith\" | \"contains\";\r\n  multicomboOptions?: AvakioMultiComboOption[];\r\n  multicomboValue?: string[];\r\n  multicomboOnChange?: (values: string[], item: AvakioPropertyItem) => void;\r\n  multicomboPlaceholder?: string;\r\n  multicomboClassName?: string;\r\n  multicomboShowCount?: boolean;\r\n  multicomboMaxDisplayItems?: number;\r\n  multicomboDisabled?: boolean;\r\n  sliderDefaultValue?: number;\r\n  sliderMin?: number;\r\n  sliderMax?: number;\r\n  sliderStep?: number;\r\n  sliderDisabled?: boolean;\r\n  sliderLabel?: string;\r\n  sliderDescription?: string;\r\n  sliderRequired?: boolean;\r\n  sliderError?: string;\r\n  sliderShowValue?: boolean;\r\n  sliderFormatValue?: (value: number) => string;\r\n  sliderMarks?: number[];\r\n  sliderSize?: \"sm\" | \"md\" | \"lg\";\r\n  sliderOnChange?: (value: number, item: AvakioPropertyItem) => void;\r\n  dateShowTime?: boolean;\r\n  dateClassName?: string;\r\n  dateOnChange?: (value: string, item: AvakioPropertyItem) => void;\r\n  colorDefaultValue?: string;\r\n  colorLabel?: string;\r\n  colorDescription?: string;\r\n  colorError?: string;\r\n  colorDisabled?: boolean;\r\n  colorReadOnly?: boolean;\r\n  colorRequired?: boolean;\r\n  colorPresets?: AvakioColorPickerPreset[];\r\n  colorAllowCustomInput?: boolean;\r\n  colorShowPreview?: boolean;\r\n  colorClassName?: string;\r\n  colorOnChange?: (color: string, item: AvakioPropertyItem) => void;\r\n}\r\n\r\nexport interface AvakioPropertyProps {\r\n  items: AvakioPropertyItem[];\r\n  onChange?: (items: AvakioPropertyItem[], changed: AvakioPropertyItem) => void;\r\n  theme?: string;\r\n  className?: string;\r\n  style?: React.CSSProperties;\r\n  dense?: boolean;\r\n  showBorders?: boolean;\r\n  /** ID of the component */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n}\r\n\r\nexport function AvakioProperty({\r\n  items,\r\n  onChange,\r\n  theme,\r\n  className,\r\n  style,\r\n  dense,\r\n  showBorders,\r\n  id,\r\n  testId,\r\n}: AvakioPropertyProps) {\r\n  const [rows, setRows] = useState<AvakioPropertyItem[]>(items);\r\n  const [lastChanged, setLastChanged] = useState<AvakioPropertyItem | null>(null);\r\n  const [openDateId, setOpenDateId] = useState<string | null>(null);\r\n  const [openDatePlacement, setOpenDatePlacement] = useState<\"bottom\" | \"top\">(\"bottom\");\r\n  const rootRef = useRef<HTMLDivElement | null>(null);\r\n  const dateBtnRefs = useRef<Record<string, HTMLButtonElement | null>>({});\r\n\r\n  useEffect(() => {\r\n    setRows(items);\r\n  }, [items]);\r\n\r\n  useEffect(() => {\r\n    if (lastChanged) {\r\n      onChange?.(rows, lastChanged);\r\n      setLastChanged(null);\r\n    }\r\n  }, [lastChanged, onChange, rows]);\r\n\r\n  useEffect(() => {\r\n    if (!openDateId) return;\r\n    const handleClickOutside = (evt: MouseEvent) => {\r\n      if (!rootRef.current) return;\r\n      if (!rootRef.current.contains(evt.target as Node)) {\r\n        setOpenDateId(null);\r\n      }\r\n    };\r\n    document.addEventListener(\"mousedown\", handleClickOutside);\r\n    return () => document.removeEventListener(\"mousedown\", handleClickOutside);\r\n  }, [openDateId]);\r\n\r\n  const computeDatePlacement = (id: string) => {\r\n    const btn = dateBtnRefs.current[id];\r\n    if (!btn) return \"bottom\" as const;\r\n    const rect = btn.getBoundingClientRect();\r\n    const viewportHeight = window.innerHeight;\r\n    const estimatedHeight = 360;\r\n    const spaceBelow = viewportHeight - rect.bottom;\r\n    const spaceAbove = rect.top;\r\n    return spaceBelow < estimatedHeight && spaceAbove > spaceBelow ? \"top\" : \"bottom\";\r\n  };\r\n\r\n  const coerceDate = (val: unknown) => {\r\n    if (val === undefined || val === null || val === \"\") return null;\r\n    const raw = String(val);\r\n    const normalized = raw.includes(\"T\") ? raw : `${raw}T00:00:00`;\r\n    const d = new Date(normalized);\r\n    return Number.isNaN(d.getTime()) ? null : d;\r\n  };\r\n\r\n  const formatDisplayValue = (item: AvakioPropertyItem) => {\r\n    if (item.value === undefined || item.value === null || item.value === \"\") {\r\n      return item.placeholder || (item.type === \"datetime\" ? \"Select date & time\" : \"Select date\");\r\n    }\r\n\r\n    if (item.type === \"date\" && typeof item.value === \"string\") {\r\n      const date = coerceDate(item.value);\r\n      return date ? date.toLocaleDateString(undefined, { dateStyle: \"medium\" }) : \"Invalid date\";\r\n    }\r\n\r\n    if (item.type === \"datetime\" && typeof item.value === \"string\") {\r\n      const date = coerceDate(item.value);\r\n      return date ? date.toLocaleString(undefined, { dateStyle: \"medium\", timeStyle: \"short\" }) : \"Invalid date\";\r\n    }\r\n\r\n    return String(item.value);\r\n  };\r\n\r\n  const groupedRows = useMemo(() => {\r\n    const groups: Record<string, AvakioPropertyItem[]> = {};\r\n    rows.forEach((row) => {\r\n      const key = row.group || \"__ungrouped\";\r\n      if (!groups[key]) groups[key] = [];\r\n      groups[key].push(row);\r\n    });\r\n    return groups;\r\n  }, [rows]);\r\n\r\n  const handleChange = (id: string, value: string | number | boolean | string[] | AvakioDateRange | null) => {\r\n    setRows((prev) => {\r\n      const next = prev.map((r) => (r.id === id ? { ...r, value } : r));\r\n      const changed = next.find((r) => r.id === id)!;\r\n      setLastChanged(changed);\r\n      return next;\r\n    });\r\n  };\r\n\r\n  const renderControl = (item: AvakioPropertyItem) => {\r\n    const common = {\r\n      id: item.id,\r\n      name: item.id,\r\n      disabled: item.disabled,\r\n      required: item.required,\r\n      placeholder: item.placeholder,\r\n    } as const;\r\n\r\n    switch (item.type) {\r\n      case \"number\":\r\n        return (\r\n          <input\r\n            type=\"number\"\r\n            className=\"av-prop-input\"\r\n            {...common}\r\n            value={\r\n              item.value === undefined || item.value === null\r\n                ? \"\"\r\n                : (item.value as number | string)\r\n            }\r\n            onChange={(e) => handleChange(item.id, e.target.value === \"\" ? \"\" : Number(e.target.value))}\r\n          />\r\n        );\r\n      case \"select\":\r\n        {\r\n          const richOptions = (item.selectOptions ?? item.options ?? []).map((opt): string | AvakioRichSelectOption => {\r\n            if (typeof opt === \"string\") return opt;\r\n            if ((opt as AvakioRichSelectOption).id !== undefined) return opt as AvakioRichSelectOption;\r\n            const propOpt = opt as AvakioPropertyOption;\r\n            const normalizedId = typeof propOpt.value === \"boolean\" ? String(propOpt.value) : propOpt.value;\r\n            return { id: normalizedId, value: propOpt.label } as AvakioRichSelectOption;\r\n          }) as AvakioRichSelectOption[] | string[];\r\n\r\n          return (\r\n            <AvakioRichSelect\r\n              id={item.id}\r\n              value={typeof item.value === \"string\" || typeof item.value === \"number\" ? item.value : undefined}\r\n              options={richOptions}\r\n              onChange={(val, opt) => {\r\n                item.selectOnChange?.(val, opt, item);\r\n                handleChange(item.id, (val as string | number) ?? \"\");\r\n              }}\r\n              placeholder={item.selectPlaceholder ?? item.placeholder}\r\n              disabled={item.selectDisabled ?? item.disabled}\r\n              readonly={item.selectReadOnly}\r\n              template={item.selectTemplate}\r\n              width={item.selectWidth}\r\n              maxHeight={item.selectMaxHeight}\r\n              yCount={item.selectYCount}\r\n              required={item.selectRequired ?? item.required}\r\n              error={item.selectError}\r\n              className={item.selectClassName}\r\n              clearable={item.selectClearable}\r\n            />\r\n          );\r\n        }\r\n      case \"checkbox\":\r\n        {\r\n          const checked = item.value === undefined ? false : Boolean(item.value);\r\n        return (\r\n          <AvakioCheckbox\r\n            id={item.id}\r\n            name={item.id}\r\n              checked={checked}\r\n              onChange={(next) => {\r\n                item.checkboxOnChange?.(next, item);\r\n                handleChange(item.id, next);\r\n              }}\r\n              label={item.checkboxLabel ?? item.placeholder ?? item.label}\r\n              description={item.checkboxDescription ?? item.description}\r\n            disabled={item.disabled}\r\n            required={item.required}\r\n          />\r\n        );\r\n        }\r\n      case \"combo\":\r\n        return (\r\n          <AvakioCombo\r\n            id={item.id}\r\n            value={typeof item.value === \"string\" || typeof item.value === \"number\" ? item.value : undefined}\r\n            options={(item.comboOptions ?? item.options ?? []) as AvakioComboOption[] | string[]}\r\n            onChange={(val, opt) => {\r\n              item.comboOnChange?.(val, opt, item);\r\n              handleChange(item.id, (val as string | number) ?? \"\");\r\n            }}\r\n            onInputChange={(inputVal) => item.comboOnInputChange?.(inputVal, item)}\r\n            placeholder={item.comboPlaceholder ?? item.placeholder}\r\n            label={item.comboLabel}\r\n            labelAlign={item.comboLabelAlign}\r\n            labelWidth={item.comboLabelWidth}\r\n            disabled={item.comboDisabled ?? item.disabled}\r\n            readonly={item.comboReadOnly}\r\n            filterMode={item.comboFilterMode}\r\n            customFilter={item.comboCustomFilter}\r\n            template={item.comboTemplate}\r\n            width={item.comboWidth}\r\n            maxHeight={item.comboMaxHeight}\r\n            required={item.comboRequired ?? item.required}\r\n            error={item.comboError}\r\n            className={item.comboClassName}\r\n          />\r\n        );\r\n      case \"colorpicker\":\r\n        return (\r\n          <AvakioColorPicker\r\n            id={item.id}\r\n            value={typeof item.value === \"string\" ? item.value : undefined}\r\n            defaultValue={item.colorDefaultValue}\r\n            label={item.colorLabel}\r\n            description={item.colorDescription}\r\n            error={item.colorError}\r\n            disabled={item.colorDisabled ?? item.disabled}\r\n            readOnly={item.colorReadOnly}\r\n            required={item.colorRequired ?? item.required}\r\n            presets={item.colorPresets}\r\n            allowCustomInput={item.colorAllowCustomInput}\r\n            showPreview={item.colorShowPreview}\r\n            className={item.colorClassName}\r\n            onChange={(color) => {\r\n              item.colorOnChange?.(color, item);\r\n              handleChange(item.id, color);\r\n            }}\r\n          />\r\n        );\r\n      case \"counter\":\r\n        return (\r\n          <AvakioCounter\r\n            id={item.id}\r\n            value={typeof item.value === \"number\" ? item.value : undefined}\r\n            defaultValue={item.counterDefaultValue}\r\n            step={item.counterStep}\r\n            min={item.counterMin}\r\n            max={item.counterMax}\r\n            label={item.counterLabel ?? item.label}\r\n            description={item.counterDescription ?? item.description}\r\n            error={item.counterError}\r\n            required={item.counterRequired ?? item.required}\r\n            disabled={item.counterDisabled ?? item.disabled}\r\n            readOnly={item.counterReadOnly}\r\n            size={item.counterSize}\r\n            allowInput={item.counterAllowInput}\r\n            className={item.counterClassName}\r\n            onChange={(val) => {\r\n              item.counterOnChange?.(val, item);\r\n              handleChange(item.id, val);\r\n            }}\r\n          />\r\n        );\r\n      case \"slider\":\r\n        return (\r\n          <AvakioSlider\r\n            value={typeof item.value === \"number\" ? item.value : undefined}\r\n            defaultValue={item.sliderDefaultValue}\r\n            min={item.sliderMin}\r\n            max={item.sliderMax}\r\n            step={item.sliderStep}\r\n            disabled={item.sliderDisabled ?? item.disabled}\r\n            label={item.sliderLabel ?? item.label}\r\n            description={item.sliderDescription ?? item.description}\r\n            required={item.sliderRequired ?? item.required}\r\n            error={item.sliderError}\r\n            showValue={item.sliderShowValue}\r\n            formatValue={item.sliderFormatValue}\r\n            marks={item.sliderMarks}\r\n            size={item.sliderSize}\r\n            onChange={(val) => {\r\n              const numericVal = typeof val === \"number\" ? val : val[0];\r\n              item.sliderOnChange?.(numericVal, item);\r\n              handleChange(item.id, numericVal);\r\n            }}\r\n          />\r\n        );\r\n      case \"date\":\r\n        return (\r\n          <div className=\"av-prop-datewrap\">\r\n            <button\r\n              type=\"button\"\r\n              className=\"av-prop-datebtn\"\r\n              ref={(el) => {\r\n                dateBtnRefs.current[item.id] = el;\r\n              }}\r\n              onClick={() => {\r\n                if (openDateId === item.id) {\r\n                  setOpenDateId(null);\r\n                  return;\r\n                }\r\n                const placement = computeDatePlacement(item.id);\r\n                setOpenDatePlacement(placement);\r\n                setOpenDateId(item.id);\r\n              }}\r\n            >\r\n              {formatDisplayValue(item)}\r\n            </button>\r\n            {openDateId === item.id && (\r\n              <div className={`av-prop-datepop ${openDatePlacement === \"top\" ? \"is-top\" : \"\"}`}>\r\n                <AvakioDatePicker\r\n                  value={(item.value as string | undefined) ?? \"\"}\r\n                  onChange={(val) => {\r\n                    item.dateOnChange?.(val, item);\r\n                    handleChange(item.id, val);\r\n                    setOpenDateId(null);\r\n                  }}\r\n                  showTime={item.dateShowTime ?? false}\r\n                  className={item.dateClassName ?? \"av-prop-datepicker\"}\r\n                />\r\n              </div>\r\n            )}\r\n          </div>\r\n        );\r\n      case \"daterangepicker\":\r\n        return (\r\n          <AvakioDateRangePicker\r\n            value={item.value && typeof item.value === \"object\" ? (item.value as AvakioDateRange) : undefined}\r\n            defaultValue={item.daterangeDefaultValue}\r\n            presets={item.daterangePresets}\r\n            allowSingleDay={item.daterangeAllowSingleDay}\r\n            showTime={item.daterangeShowTime}\r\n            className={item.daterangeClassName}\r\n            onChange={(range) => {\r\n              item.daterangeOnChange?.(range, item);\r\n              handleChange(item.id, range);\r\n            }}\r\n          />\r\n        );\r\n      case \"gridsuggest\":\r\n        return (\r\n          <AvakioGridSuggest\r\n            id={item.id}\r\n            value={typeof item.value === \"string\" || typeof item.value === \"number\" ? item.value : undefined}\r\n            data={item.gridsuggestData ?? (item.options as unknown as AvakioGridSuggestOption[] | undefined) ?? []}\r\n            onChange={(val, opt) => {\r\n              item.gridsuggestOnChange?.(val, opt, item);\r\n              handleChange(item.id, (val as string | number) ?? \"\");\r\n            }}\r\n            onInputChange={(text) => item.gridsuggestOnInputChange?.(text, item)}\r\n            placeholder={item.gridsuggestPlaceholder ?? item.placeholder}\r\n            label={item.gridsuggestLabel}\r\n            labelAlign={item.gridsuggestLabelAlign}\r\n            labelWidth={item.gridsuggestLabelWidth}\r\n            disabled={item.gridsuggestDisabled ?? item.disabled}\r\n            readonly={item.gridsuggestReadOnly}\r\n            textValue={item.gridsuggestTextValue}\r\n            template={item.gridsuggestTemplate}\r\n            width={item.gridsuggestWidth}\r\n            body={item.gridsuggestBody}\r\n            required={item.gridsuggestRequired ?? item.required}\r\n            error={item.gridsuggestError}\r\n            className={item.gridsuggestClassName}\r\n            editable={item.gridsuggestEditable}\r\n            filterMode={item.gridsuggestFilterMode}\r\n          />\r\n        );\r\n      case \"multicombo\":\r\n        return (\r\n          <AvakioMultiCombo\r\n            options={item.multicomboOptions ?? []}\r\n            value={Array.isArray(item.multicomboValue ?? item.value) ? (item.multicomboValue ?? (item.value as string[])) : []}\r\n            onChange={(vals) => {\r\n              item.multicomboOnChange?.(vals, item);\r\n              handleChange(item.id, vals);\r\n            }}\r\n            placeholder={item.multicomboPlaceholder ?? item.placeholder}\r\n            className={item.multicomboClassName}\r\n            showCount={item.multicomboShowCount}\r\n            maxDisplayItems={item.multicomboMaxDisplayItems}\r\n            disabled={item.multicomboDisabled ?? item.disabled}\r\n          />\r\n        );\r\n      case \"datetime\":\r\n        return (\r\n          <div className=\"av-prop-datewrap\">\r\n            <button\r\n              type=\"button\"\r\n              className=\"av-prop-datebtn\"\r\n              ref={(el) => {\r\n                dateBtnRefs.current[item.id] = el;\r\n              }}\r\n              onClick={() => {\r\n                if (openDateId === item.id) {\r\n                  setOpenDateId(null);\r\n                  return;\r\n                }\r\n                const placement = computeDatePlacement(item.id);\r\n                setOpenDatePlacement(placement);\r\n                setOpenDateId(item.id);\r\n              }}\r\n            >\r\n              {formatDisplayValue(item)}\r\n            </button>\r\n            {openDateId === item.id && (\r\n              <div className={`av-prop-datepop ${openDatePlacement === \"top\" ? \"is-top\" : \"\"}`}>\r\n                <AvakioDatePicker\r\n                  value={(item.value as string | undefined) ?? \"\"}\r\n                  onChange={(val) => {\r\n                    item.dateOnChange?.(val, item);\r\n                    handleChange(item.id, val);\r\n                    setOpenDateId(null);\r\n                  }}\r\n                  showTime={item.dateShowTime ?? true}\r\n                  className={item.dateClassName ?? \"av-prop-datepicker\"}\r\n                />\r\n              </div>\r\n            )}\r\n          </div>\r\n        );\r\n      case \"button\":\r\n        return (\r\n          <AvakioButton\r\n            label={item.buttonLabel || item.placeholder || \"Action\"}\r\n            onClick={() => {\r\n              if (item.disabled) return;\r\n              item.buttonOnClick?.(item);\r\n              handleChange(item.id, true);\r\n            }}\r\n            disabled={item.disabled}\r\n            variant={item.buttonVariant}\r\n            size={item.buttonSize}\r\n            badge={item.buttonBadge}\r\n            icon={item.buttonIcon}\r\n            iconRight={item.buttonIconRight}\r\n            block={item.buttonBlock}\r\n          />\r\n        );\r\n      case \"textarea\":\r\n        return (\r\n          <textarea\r\n            className=\"av-prop-input av-prop-textarea\"\r\n            {...common}\r\n            value={(item.value as string | undefined) ?? \"\"}\r\n            onChange={(e) => handleChange(item.id, e.target.value)}\r\n          />\r\n        );\r\n      case \"text\":\r\n      default:\r\n        return (\r\n          <input\r\n            type=\"text\"\r\n            className=\"av-prop-input\"\r\n            {...common}\r\n            value={(item.value as string | undefined) ?? \"\"}\r\n            onChange={(e) => handleChange(item.id, e.target.value)}\r\n          />\r\n        );\r\n    }\r\n  };\r\n\r\n  const rootClass = [\r\n    \"avakio-property\",\r\n    dense ? \"is-dense\" : \"\",\r\n    showBorders ? \"has-borders\" : \"\",\r\n    className || \"\",\r\n  ]\r\n    .filter(Boolean)\r\n    .join(\" \");\r\n\r\n  const themeProps = theme ? { \"data-admin-theme\": theme } : undefined;\r\n\r\n  return (\r\n    <div ref={rootRef} id={id} data-testid={testId} className={rootClass} style={style} {...themeProps}>\r\n      <div className=\"av-prop-table\">\r\n        {Object.entries(groupedRows).map(([group, rowsInGroup]) => (\r\n          <React.Fragment key={group}>\r\n            {group !== \"__ungrouped\" && <div className=\"av-prop-group\">{group}</div>}\r\n            {rowsInGroup.map((item) => (\r\n              <div key={item.id} className=\"av-prop-row\">\r\n                <div className=\"av-prop-label\">\r\n                  <label htmlFor={item.id}>{item.label}</label>\r\n                  {item.description && <div className=\"av-prop-desc\">{item.description}</div>}\r\n                </div>\r\n                <div className=\"av-prop-control\">{renderControl(item)}</div>\r\n              </div>\r\n            ))}\r\n          </React.Fragment>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useState, useMemo, useEffect } from 'react';\r\nimport { ChevronLeft, ChevronRight } from 'lucide-react';\r\nimport './avakio-calendar.css';\r\n\r\nexport type AvakioCalendarMode = 'single' | 'multiple' | 'range';\r\n\r\nexport interface AvakioCalendarMarker {\r\n  date: string; // ISO date string\r\n  color?: string;\r\n  text?: string;\r\n}\r\n\r\nexport interface AvakioCalendarProps {\r\n  value?: string | string[]; // ISO date string(s)\r\n  onChange?: (value: string | string[]) => void;\r\n  mode?: AvakioCalendarMode;\r\n  minDate?: string; // ISO date string\r\n  maxDate?: string; // ISO date string\r\n  disabledDates?: string[]; // Array of ISO date strings\r\n  markers?: AvakioCalendarMarker[]; // Event indicators\r\n  showWeekNumbers?: boolean;\r\n  monthsToShow?: number; // Display multiple months (1-3)\r\n  weekStart?: 0 | 1; // 0 = Sunday, 1 = Monday\r\n  className?: string;\r\n  onMonthChange?: (date: Date) => void;\r\n  /** ID of the component */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n}\r\n\r\nfunction isSameDay(date1: Date, date2: Date): boolean {\r\n  return (\r\n    date1.getFullYear() === date2.getFullYear() &&\r\n    date1.getMonth() === date2.getMonth() &&\r\n    date1.getDate() === date2.getDate()\r\n  );\r\n}\r\n\r\nfunction formatDateKey(date: Date): string {\r\n  const year = date.getFullYear();\r\n  const month = String(date.getMonth() + 1).padStart(2, '0');\r\n  const day = String(date.getDate()).padStart(2, '0');\r\n  return `${year}-${month}-${day}`;\r\n}\r\n\r\nfunction parseDate(str: string): Date {\r\n  // Parse as local date to avoid timezone shifts\r\n  const [year, month, day] = str.split('-').map(Number);\r\n  return new Date(year, month - 1, day);\r\n}\r\n\r\nexport function AvakioCalendar({\r\n  value,\r\n  onChange,\r\n  mode = 'single',\r\n  minDate,\r\n  maxDate,\r\n  disabledDates = [],\r\n  markers = [],\r\n  showWeekNumbers = false,\r\n  monthsToShow = 1,\r\n  weekStart = 0,\r\n  className = '',\r\n  onMonthChange,\r\n  id,\r\n  testId,\r\n}: AvakioCalendarProps) {\r\n  // Initialize view to the first selected date's month, or today if no selection\r\n  const getInitialViewDate = () => {\r\n    if (value) {\r\n      const firstDate = Array.isArray(value) ? value[0] : value;\r\n      if (firstDate && firstDate.trim()) {\r\n        return parseDate(firstDate);\r\n      }\r\n    }\r\n    return new Date();\r\n  };\r\n\r\n  const [viewDate, setViewDate] = useState(getInitialViewDate);\r\n  \r\n  // Clamp monthsToShow between 1 and 3\r\n  const safeMonthsToShow = Math.max(1, Math.min(3, monthsToShow));\r\n\r\n  // Update viewDate when value prop changes to a different month\r\n  useEffect(() => {\r\n    if (value) {\r\n      const firstDate = Array.isArray(value) ? value[0] : value;\r\n      if (firstDate && firstDate.trim()) {\r\n        const selectedDate = parseDate(firstDate);\r\n        // Only update if the selected date is in a different month than current view\r\n        if (selectedDate.getFullYear() !== viewDate.getFullYear() ||\r\n            selectedDate.getMonth() !== viewDate.getMonth()) {\r\n          setViewDate(selectedDate);\r\n        }\r\n      }\r\n    }\r\n  }, [value]); // Only depend on value, not viewDate to avoid loops\r\n\r\n  const selectedDates = useMemo(() => {\r\n    if (!value) return [];\r\n    const dates = Array.isArray(value) ? value : [value];\r\n    // Filter out empty strings before parsing\r\n    return dates.filter(d => d && d.trim()).map(parseDate);\r\n  }, [value]);\r\n\r\n  const disabledDatesSet = useMemo(() => {\r\n    return new Set(disabledDates);\r\n  }, [disabledDates]);\r\n\r\n  const markersByDate = useMemo(() => {\r\n    const map = new Map<string, AvakioCalendarMarker[]>();\r\n    markers.forEach(marker => {\r\n      // Ensure we always use YYYY-MM-DD format (remove time if present)\r\n      const key = marker.date.includes('T') ? marker.date.split('T')[0] : marker.date;\r\n      if (!map.has(key)) map.set(key, []);\r\n      map.get(key)!.push(marker);\r\n    });\r\n    return map;\r\n  }, [markers]);\r\n\r\n  const monthNames = [\r\n    'January', 'February', 'March', 'April', 'May', 'June',\r\n    'July', 'August', 'September', 'October', 'November', 'December'\r\n  ];\r\n\r\n  const weekDays = weekStart === 0\r\n    ? ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat']\r\n    : ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];\r\n\r\n  const getMonthGrid = (baseDate: Date) => {\r\n    const year = baseDate.getFullYear();\r\n    const month = baseDate.getMonth();\r\n    \r\n    const firstDay = new Date(year, month, 1);\r\n    const lastDay = new Date(year, month + 1, 0);\r\n    \r\n    let startDay = firstDay.getDay();\r\n    if (weekStart === 1) {\r\n      startDay = startDay === 0 ? 6 : startDay - 1;\r\n    }\r\n    \r\n    const daysInMonth = lastDay.getDate();\r\n    const daysInPrevMonth = new Date(year, month, 0).getDate();\r\n    \r\n    const days: Array<{\r\n      date: Date;\r\n      isCurrentMonth: boolean;\r\n      weekNumber?: number;\r\n    }> = [];\r\n    \r\n    // Previous month days\r\n    for (let i = startDay - 1; i >= 0; i--) {\r\n      days.push({\r\n        date: new Date(year, month - 1, daysInPrevMonth - i),\r\n        isCurrentMonth: false,\r\n      });\r\n    }\r\n    \r\n    // Current month days\r\n    for (let i = 1; i <= daysInMonth; i++) {\r\n      const date = new Date(year, month, i);\r\n      days.push({\r\n        date,\r\n        isCurrentMonth: true,\r\n        weekNumber: showWeekNumbers ? getWeekNumber(date) : undefined,\r\n      });\r\n    }\r\n    \r\n    // Next month days to fill grid\r\n    const remainingDays = 42 - days.length;\r\n    for (let i = 1; i <= remainingDays; i++) {\r\n      days.push({\r\n        date: new Date(year, month + 1, i),\r\n        isCurrentMonth: false,\r\n      });\r\n    }\r\n    \r\n    return days;\r\n  };\r\n\r\n  const getWeekNumber = (date: Date): number => {\r\n    const d = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()));\r\n    const dayNum = d.getUTCDay() || 7;\r\n    d.setUTCDate(d.getUTCDate() + 4 - dayNum);\r\n    const yearStart = new Date(Date.UTC(d.getUTCFullYear(), 0, 1));\r\n    return Math.ceil((((d.getTime() - yearStart.getTime()) / 86400000) + 1) / 7);\r\n  };\r\n\r\n  const isDateDisabled = (date: Date): boolean => {\r\n    const key = formatDateKey(date);\r\n    if (disabledDatesSet.has(key)) return true;\r\n    \r\n    // Compare dates only (ignore time)\r\n    if (minDate) {\r\n      const min = parseDate(minDate);\r\n      if (date.getFullYear() < min.getFullYear() ||\r\n          (date.getFullYear() === min.getFullYear() && date.getMonth() < min.getMonth()) ||\r\n          (date.getFullYear() === min.getFullYear() && date.getMonth() === min.getMonth() && date.getDate() < min.getDate())) {\r\n        return true;\r\n      }\r\n    }\r\n    \r\n    if (maxDate) {\r\n      const max = parseDate(maxDate);\r\n      if (date.getFullYear() > max.getFullYear() ||\r\n          (date.getFullYear() === max.getFullYear() && date.getMonth() > max.getMonth()) ||\r\n          (date.getFullYear() === max.getFullYear() && date.getMonth() === max.getMonth() && date.getDate() > max.getDate())) {\r\n        return true;\r\n      }\r\n    }\r\n    \r\n    return false;\r\n  };\r\n\r\n  const isDateSelected = (date: Date): boolean => {\r\n    return selectedDates.some(selected => isSameDay(selected, date));\r\n  };\r\n\r\n  const isDateInRange = (date: Date): boolean => {\r\n    if (mode !== 'range' || selectedDates.length !== 2) return false;\r\n    const [start, end] = selectedDates.sort((a, b) => a.getTime() - b.getTime());\r\n    return date > start && date < end;\r\n  };\r\n\r\n  const handleDateClick = (date: Date) => {\r\n    if (isDateDisabled(date)) return;\r\n\r\n    const dateKey = formatDateKey(date);\r\n\r\n    if (mode === 'single') {\r\n      // Allow deselecting by clicking the same date\r\n      const currentValue = typeof value === 'string' ? value : '';\r\n      onChange?.(currentValue === dateKey ? '' : dateKey);\r\n    } else if (mode === 'multiple') {\r\n      const currentDates = Array.isArray(value) ? value : value ? [value] : [];\r\n      const exists = currentDates.includes(dateKey);\r\n      const newDates = exists\r\n        ? currentDates.filter(d => d !== dateKey)\r\n        : [...currentDates, dateKey];\r\n      onChange?.(newDates);\r\n    } else if (mode === 'range') {\r\n      // Normalize current range to an array for safety\r\n      const currentRange = Array.isArray(value) ? value : value ? [value] : [];\r\n\r\n      if (currentRange.length === 0 || currentRange.length === 2) {\r\n        // Start new range\r\n        onChange?.([dateKey]);\r\n      } else if (currentRange.length === 1) {\r\n        // Complete range - if same date clicked, clear selection\r\n        if (currentRange[0] === dateKey) {\r\n          onChange?.([]);\r\n        } else {\r\n          const sorted = [currentRange[0], dateKey].sort();\r\n          onChange?.(sorted);\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  const handlePrevMonth = () => {\r\n    const newDate = new Date(viewDate.getFullYear(), viewDate.getMonth() - 1, 1);\r\n    setViewDate(newDate);\r\n    onMonthChange?.(newDate);\r\n  };\r\n\r\n  const handleNextMonth = () => {\r\n    const newDate = new Date(viewDate.getFullYear(), viewDate.getMonth() + 1, 1);\r\n    setViewDate(newDate);\r\n    onMonthChange?.(newDate);\r\n  };\r\n\r\n  const handleToday = () => {\r\n    const today = new Date();\r\n    setViewDate(today);\r\n    onMonthChange?.(today);\r\n    \r\n    // Also select today's date\r\n    const todayKey = formatDateKey(today);\r\n    if (mode === 'single') {\r\n      onChange?.(todayKey);\r\n    } else if (mode === 'multiple') {\r\n      const currentDates = Array.isArray(value) ? value : value ? [value] : [];\r\n      if (!currentDates.includes(todayKey)) {\r\n        onChange?.([...currentDates, todayKey]);\r\n      }\r\n    } else if (mode === 'range') {\r\n      onChange?.([todayKey]);\r\n    }\r\n  };\r\n\r\n  const renderMonth = (monthOffset: number) => {\r\n    const displayDate = new Date(viewDate.getFullYear(), viewDate.getMonth() + monthOffset, 1);\r\n    const days = getMonthGrid(displayDate);\r\n    const today = new Date();\r\n\r\n    return (\r\n      <div key={monthOffset} className=\"avakio-cal-month\">\r\n        <div className=\"avakio-cal-header\">\r\n          {monthOffset === 0 && safeMonthsToShow === 1 && (\r\n            <button\r\n              type=\"button\"\r\n              className=\"avakio-cal-nav-btn\"\r\n              onClick={handlePrevMonth}\r\n            >\r\n              <ChevronLeft className=\"h-4 w-4\" />\r\n            </button>\r\n          )}\r\n          <div className=\"avakio-cal-title\">\r\n            {monthNames[displayDate.getMonth()]} {displayDate.getFullYear()}\r\n          </div>\r\n          {monthOffset === monthsToShow - 1 && safeMonthsToShow === 1 && (\r\n            <button\r\n              type=\"button\"\r\n              className=\"avakio-cal-nav-btn\"\r\n              onClick={handleNextMonth}\r\n            >\r\n              <ChevronRight className=\"h-4 w-4\" />\r\n            </button>\r\n          )}\r\n        </div>\r\n\r\n        <div className={`avakio-cal-weekdays ${showWeekNumbers ? 'avakio-cal-with-week-nums' : ''}`}>\r\n          {showWeekNumbers && <div className=\"avakio-cal-weekday avakio-cal-week-num-header\">#</div>}\r\n          {weekDays.map(day => (\r\n            <div key={day} className=\"avakio-cal-weekday\">\r\n              {day}\r\n            </div>\r\n          ))}\r\n        </div>\r\n\r\n        <div className={`avakio-cal-grid ${showWeekNumbers ? 'avakio-cal-with-week-nums' : ''}`}>\r\n          {days.map((dayInfo, index) => {\r\n            const isSelected = isDateSelected(dayInfo.date);\r\n            const isToday = isSameDay(dayInfo.date, today);\r\n            const isDisabled = isDateDisabled(dayInfo.date);\r\n            const isInRange = isDateInRange(dayInfo.date);\r\n            const dateKey = formatDateKey(dayInfo.date);\r\n            const dayMarkers = markersByDate.get(dateKey) || [];\r\n            const showWeekNum = showWeekNumbers && index % 7 === 0;\r\n            const uniqueKey = `${dateKey}-${index}`;\r\n            const displayWeekNumber = showWeekNum\r\n              ? (dayInfo.weekNumber ?? getWeekNumber(dayInfo.date))\r\n              : undefined;\r\n\r\n            return (\r\n              <React.Fragment key={uniqueKey}>\r\n                {showWeekNum && (\r\n                  <div className=\"avakio-cal-week-num\">\r\n                    {displayWeekNumber}\r\n                  </div>\r\n                )}\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => handleDateClick(dayInfo.date)}\r\n                  disabled={isDisabled}\r\n                  className={`avakio-cal-day ${\r\n                    !dayInfo.isCurrentMonth ? 'avakio-cal-day-outside' : ''\r\n                  } ${isSelected ? 'avakio-cal-day-selected' : ''} ${\r\n                    isToday ? 'avakio-cal-day-today' : ''\r\n                  } ${isDisabled ? 'avakio-cal-day-disabled' : ''} ${\r\n                    isInRange ? 'avakio-cal-day-in-range' : ''\r\n                  }`}\r\n                >\r\n                  <span className=\"avakio-cal-day-number\">{dayInfo.date.getDate()}</span>\r\n                  {dayMarkers.length > 0 && (\r\n                    <div className=\"avakio-cal-markers\">\r\n                      {dayMarkers.slice(0, 3).map((marker, idx) => (\r\n                        <span\r\n                          key={`marker-${uniqueKey}-${idx}`}\r\n                          className=\"avakio-cal-marker\"\r\n                          style={{ backgroundColor: marker.color || '#3b82f6' }}\r\n                          title={marker.text}\r\n                        />\r\n                      ))}\r\n                    </div>\r\n                  )}\r\n                </button>\r\n              </React.Fragment>\r\n            );\r\n          })}\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div id={id} data-testid={testId} className={`avakio-calendar ${className}`}>\r\n      {safeMonthsToShow > 1 && (\r\n        <div className=\"avakio-cal-multi-nav\">\r\n          <button\r\n            type=\"button\"\r\n            className=\"avakio-cal-nav-btn\"\r\n            onClick={handlePrevMonth}\r\n          >\r\n            <ChevronLeft className=\"h-4 w-4\" />\r\n          </button>\r\n          <button\r\n            type=\"button\"\r\n            className=\"avakio-cal-today-btn\"\r\n            onClick={handleToday}\r\n          >\r\n            Today\r\n          </button>\r\n          <button\r\n            type=\"button\"\r\n            className=\"avakio-cal-nav-btn\"\r\n            onClick={handleNextMonth}\r\n          >\r\n            <ChevronRight className=\"h-4 w-4\" />\r\n          </button>\r\n        </div>\r\n      )}\r\n      \r\n      <div className={`avakio-cal-months avakio-cal-months-${safeMonthsToShow}`}>\r\n        {Array.from({ length: safeMonthsToShow }, (_, i) => renderMonth(i))}\r\n      </div>\r\n\r\n      {safeMonthsToShow === 1 && (\r\n        <div className=\"avakio-cal-footer\">\r\n          <button\r\n            type=\"button\"\r\n            className=\"avakio-cal-today-btn\"\r\n            onClick={handleToday}\r\n          >\r\n            Today\r\n          </button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useEffect, useMemo, useState } from \"react\";\r\nimport \"./avakio-scheduler.css\";\r\nimport { AvakioPopup } from \"../avakio-popup/avakio-popup\";\r\nimport \"../avakio-popup/avakio-popup.css\";\r\nimport { AvakioCalendar, AvakioCalendarMarker } from \"../ui-controls/avakio-calendar/avakio-calendar\";\r\n\r\nfunction startOfWeek(date: Date) {\r\n  const d = new Date(date);\r\n  const day = (d.getDay() + 6) % 7; // Monday as start\r\n  d.setDate(d.getDate() - day);\r\n  d.setHours(0, 0, 0, 0);\r\n  return d;\r\n}\r\n\r\nfunction addDays(date: Date, days: number) {\r\n  const d = new Date(date);\r\n  d.setDate(d.getDate() + days);\r\n  return d;\r\n}\r\n\r\nfunction formatDateKey(date: Date) {\r\n  const year = date.getFullYear();\r\n  const month = String(date.getMonth() + 1).padStart(2, \"0\");\r\n  const day = String(date.getDate()).padStart(2, \"0\");\r\n  return `${year}-${month}-${day}`;\r\n}\r\n\r\nfunction parseDateKey(key: string) {\r\n  const [y, m, d] = key.split(\"-\").map(Number);\r\n  return new Date(y, m - 1, d);\r\n}\r\n\r\nfunction formatTime(date: Date) {\r\n  return date.toLocaleTimeString(undefined, { hour: \"2-digit\", minute: \"2-digit\" });\r\n}\r\n\r\nfunction formatDay(date: Date) {\r\n  return date.toLocaleDateString(undefined, { weekday: \"short\", month: \"short\", day: \"numeric\" });\r\n}\r\n\r\nexport type AvakioEvent = {\r\n  id: string;\r\n  title: string;\r\n  start: string; // ISO string\r\n  end: string;   // ISO string\r\n  color?: string;\r\n};\r\n\r\nexport type AvakioSchedulerView = \"month\" | \"week\" | \"day\";\r\n\r\nexport interface AvakioSchedulerProps {\r\n  events?: AvakioEvent[];\r\n  defaultView?: AvakioSchedulerView;\r\n  defaultDate?: string; // ISO date to anchor the view\r\n  theme?: string; // optional theme token forwarded to popup overlays\r\n  userId?: string; // user ID to fetch calendar events for\r\n  dataUrl?: string; // deprecated alias for eventsUrl\r\n  eventsUrl?: string; // optional remote source for fetching events\r\n  loadRemoteOnNavigate?: boolean; // refetch when view/anchor changes\r\n  fetchOptions?: RequestInit; // custom fetch options\r\n  transformEvent?: (raw: any) => AvakioEvent; // adapter for remote payload\r\n  buildEventsQuery?: (range: { start: Date; end: Date; view: AvakioSchedulerView; userId?: string }) => string; // build query string\r\n  mutationUrl?: string; // fixed endpoint for creating/updating events (POST by default)\r\n  buildMutationUrl?: (event: AvakioEvent, action: \"create\" | \"update\") => string; // override mutation target\r\n  mutationMethod?: \"post\" | \"put\" | \"patch\"; // HTTP verb for create/update\r\n  onNavigate?: (date: string, view: AvakioSchedulerView) => void;\r\n  onViewChange?: (view: AvakioSchedulerView) => void;\r\n  onEventClick?: (event: AvakioEvent) => void;\r\n  onEventCreate?: (event: AvakioEvent) => void;\r\n  className?: string;\r\n  /** ID of the component */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n}\r\nexport function AvakioScheduler({\r\n  events = [],\r\n  defaultView = \"month\",\r\n  defaultDate,\r\n  theme,\r\n  userId,\r\n  dataUrl,\r\n  eventsUrl,\r\n  loadRemoteOnNavigate,\r\n  fetchOptions,\r\n  transformEvent,\r\n  buildEventsQuery,\r\n  mutationUrl,\r\n  buildMutationUrl,\r\n  mutationMethod = \"post\",\r\n  onNavigate,\r\n  onViewChange,\r\n  onEventClick,\r\n  onEventCreate,\r\n  className,\r\n  id,\r\n  testId,\r\n}: AvakioSchedulerProps) {\r\n  const [view, setView] = useState<AvakioSchedulerView>(defaultView);\r\n  const [anchor, setAnchor] = useState<Date>(\r\n    defaultDate ? new Date(defaultDate) : new Date(2020, 9, 1)\r\n  );\r\n  const [selectedDateKey, setSelectedDateKey] = useState<string>(formatDateKey(defaultDate ? new Date(defaultDate) : new Date()));\r\n  const [isMobile, setIsMobile] = useState(false);\r\n  const [remoteEvents, setRemoteEvents] = useState<AvakioEvent[]>([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [hasFetchedOnce, setHasFetchedOnce] = useState(false);\r\n  const [morePopup, setMorePopup] = useState<{ dateKey: string; anchorRect: DOMRect | null } | null>(null);\r\n\r\n  const eventsEndpoint = eventsUrl || dataUrl;\r\n\r\n  const rangeForView = (currentView: AvakioSchedulerView, currentAnchor: Date) => {\r\n    if (currentView === \"month\") {\r\n      const start = startOfWeek(new Date(currentAnchor.getFullYear(), currentAnchor.getMonth(), 1));\r\n      const end = addDays(start, 42);\r\n      return { start, end };\r\n    }\r\n    if (currentView === \"week\") {\r\n      const start = startOfWeek(currentAnchor);\r\n      const end = addDays(start, 7);\r\n      return { start, end };\r\n    }\r\n    const start = new Date(currentAnchor);\r\n    start.setHours(0, 0, 0, 0);\r\n    const end = addDays(start, 1);\r\n    return { start, end };\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (!eventsEndpoint) return;\r\n    if (!loadRemoteOnNavigate && hasFetchedOnce) return;\r\n    let cancelled = false;\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    const { start, end } = rangeForView(view, anchor);\r\n    const query = buildEventsQuery\r\n      ? buildEventsQuery({ start, end, view, userId })\r\n      : `?start=${start.toISOString()}&end=${end.toISOString()}${userId ? `&userId=${userId}` : ''}`;\r\n    const url = eventsEndpoint + query;\r\n\r\n    const mapEvent = (raw: any): AvakioEvent => {\r\n      if (transformEvent) return transformEvent(raw);\r\n      const hasLegacyShape = raw.start_date && raw.end_date;\r\n      const start = hasLegacyShape ? new Date(raw.start_date) : new Date(raw.start || raw.startDate || raw.date);\r\n      const end = hasLegacyShape ? new Date(raw.end_date) : new Date(raw.end || raw.endDate || raw.finish || raw.finishDate || start);\r\n      return {\r\n        id: String(raw.id ?? raw._id ?? `${start?.toISOString() || \"evt\"}-${Math.random()}`),\r\n        title: raw.title || raw.text || \"Event\",\r\n        start: start?.toISOString(),\r\n        end: end?.toISOString(),\r\n        color: raw.color,\r\n      };\r\n    };\r\n\r\n    fetch(url, fetchOptions)\r\n      .then(async (res) => {\r\n        if (!res.ok) throw new Error(`Request failed: ${res.status}`);\r\n        const json = await res.json();\r\n        const payload = Array.isArray(json)\r\n          ? json\r\n          : Array.isArray((json as any).data)\r\n            ? (json as any).data\r\n            : Array.isArray((json as any).events)\r\n              ? (json as any).events\r\n              : [];\r\n        const mapped = payload.map(mapEvent).filter((e: AvakioEvent) => e.start && e.end);\r\n        if (!cancelled) {\r\n          setRemoteEvents(mapped);\r\n          setHasFetchedOnce(true);\r\n        }\r\n      })\r\n      .catch((err: Error) => {\r\n        if (!cancelled) setError(err.message);\r\n      })\r\n      .finally(() => {\r\n        if (!cancelled) setLoading(false);\r\n      });\r\n\r\n    return () => {\r\n      cancelled = true;\r\n    };\r\n  }, [eventsEndpoint, loadRemoteOnNavigate, view, anchor, userId, fetchOptions, transformEvent, buildEventsQuery, hasFetchedOnce]);\r\n\r\n  // Track mobile viewport\r\n  useEffect(() => {\r\n    const detect = () => {\r\n      if (typeof window === \"undefined\") return false;\r\n      return window.innerWidth <= 768;\r\n    };\r\n    setIsMobile(detect());\r\n    const onResize = () => setIsMobile(detect());\r\n    window.addEventListener(\"resize\", onResize);\r\n    return () => window.removeEventListener(\"resize\", onResize);\r\n  }, []);\r\n\r\n  // Keep selected date aligned with anchor changes\r\n  useEffect(() => {\r\n    setSelectedDateKey(formatDateKey(anchor));\r\n  }, [anchor]);\r\n\r\n  const monthGrid = useMemo(() => {\r\n    const first = new Date(anchor.getFullYear(), anchor.getMonth(), 1);\r\n    const start = startOfWeek(first);\r\n    const cells: Date[] = [];\r\n    for (let i = 0; i < 42; i++) cells.push(addDays(start, i));\r\n    return cells;\r\n  }, [anchor]);\r\n\r\n  const weekGrid = useMemo(() => {\r\n    const start = startOfWeek(anchor);\r\n    return Array.from({ length: 7 }, (_, i) => addDays(start, i));\r\n  }, [anchor]);\r\n\r\n  const dayGrid = useMemo(() => [anchor], [anchor]);\r\n\r\n  const filteredEvents = useMemo(() => {\r\n    const merged = [...remoteEvents, ...events];\r\n    return merged.map((e) => ({ ...e, _start: new Date(e.start), _end: new Date(e.end) }));\r\n  }, [events, remoteEvents]);\r\n\r\n  const selectedDate = useMemo(() => parseDateKey(selectedDateKey), [selectedDateKey]);\r\n\r\n  const monthAgenda = useMemo(() => {\r\n    if (view !== \"month\") return [] as typeof filteredEvents;\r\n    return [...filteredEvents]\r\n      .filter((e) => e._start.getMonth() === anchor.getMonth() && e._start.getFullYear() === anchor.getFullYear())\r\n      .sort((a, b) => a._start.getTime() - b._start.getTime());\r\n  }, [view, filteredEvents, anchor]);\r\n\r\n  const visibleEvents = useMemo(() => {\r\n    if (view === \"month\") {\r\n      const start = monthGrid[0];\r\n      const end = addDays(monthGrid[monthGrid.length - 1], 1);\r\n      return filteredEvents.filter((e) => e._start < end && e._end >= start);\r\n    }\r\n    if (view === \"week\") {\r\n      const start = weekGrid[0];\r\n      const end = addDays(weekGrid[weekGrid.length - 1], 1);\r\n      return filteredEvents.filter((e) => e._start < end && e._end >= start);\r\n    }\r\n    return filteredEvents.filter((e) => {\r\n      const d = dayGrid[0];\r\n      return e._start.toDateString() === d.toDateString();\r\n    });\r\n  }, [view, monthGrid, weekGrid, dayGrid, filteredEvents]);\r\n\r\n  const go = (delta: number) => {\r\n    let next = new Date(anchor);\r\n    if (view === \"month\") next = new Date(anchor.getFullYear(), anchor.getMonth() + delta, 1);\r\n    if (view === \"week\") next = addDays(anchor, delta * 7);\r\n    if (view === \"day\") next = addDays(anchor, delta);\r\n    setAnchor(next);\r\n    onNavigate?.(next.toISOString(), view);\r\n  };\r\n\r\n  const changeView = (next: AvakioSchedulerView) => {\r\n    setView(next);\r\n    onViewChange?.(next);\r\n  };\r\n\r\n  const createEvent = () => {\r\n    const start = new Date(anchor);\r\n    const end = addDays(start, 0);\r\n    start.setHours(9, 0, 0, 0);\r\n    end.setHours(10, 0, 0, 0);\r\n    const evt: AvakioEvent = {\r\n      id: `${Date.now()}`,\r\n      title: \"New event\",\r\n      start: start.toISOString(),\r\n      end: end.toISOString(),\r\n    };\r\n\r\n    const maybePersist = async () => {\r\n      if (!mutationUrl) return onEventCreate?.(evt);\r\n      const target = buildMutationUrl ? buildMutationUrl(evt, \"create\") : mutationUrl;\r\n      try {\r\n        setLoading(true);\r\n        setError(null);\r\n        const res = await fetch(target, {\r\n          method: mutationMethod,\r\n          headers: { \"Content-Type\": \"application/json\" },\r\n          body: JSON.stringify(evt),\r\n        });\r\n        if (!res.ok) throw new Error(`Failed to save event: ${res.status}`);\r\n        const saved = await res.json();\r\n        const mapped = transformEvent ? transformEvent(saved) : saved;\r\n        setRemoteEvents((prev) => [...prev, mapped]);\r\n        onEventCreate?.(mapped);\r\n      } catch (err: any) {\r\n        setError(err.message || \"Failed to save event\");\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    void maybePersist();\r\n  };\r\n\r\n  const eventsForDay = (date: Date) => visibleEvents.filter((e) => e._start.toDateString() === date.toDateString());\r\n  const eventsForDayKey = (dateKey: string) => visibleEvents.filter((e) => e._start.toDateString() === dateKey);\r\n  const eventsForDateKey = (dateKey: string) => visibleEvents.filter((e) => formatDateKey(e._start) === dateKey);\r\n\r\n  const mobileMarkers: AvakioCalendarMarker[] = useMemo(\r\n    () =>\r\n      visibleEvents.map((e) => ({\r\n        date: formatDateKey(e._start),\r\n        color: e.color,\r\n        text: e.title,\r\n      })),\r\n    [visibleEvents]\r\n  );\r\n\r\n  const selectedDateEvents = useMemo(() => eventsForDateKey(selectedDateKey), [selectedDateKey, visibleEvents]);\r\n\r\n  const renderEventPill = (e: any) => (\r\n    <div\r\n      key={e.id}\r\n      className=\"avakio-sch-event\"\r\n      style={{ background: e.color || \"var(--sch-primary)\" }}\r\n      onClick={() => onEventClick?.(e)}\r\n    >\r\n      <div className=\"avakio-sch-event-title\">{e.title}</div>\r\n      <div className=\"avakio-sch-event-time\">\r\n        {formatTime(e._start)} â€“ {formatTime(e._end)}\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  const renderEventsForDay = (date: Date) => {\r\n    const events = eventsForDay(date).sort((a, b) => a._start.getTime() - b._start.getTime());\r\n    if (!events.length) return <div className=\"avakio-sch-mobile-empty\">No events</div>;\r\n    return events.map((evt) => renderEventPill(evt));\r\n  };\r\n\r\n  return (\r\n    <div id={id} data-testid={testId} className={[\"avakio-scheduler\", className || \"\"].join(\" \")}>\r\n      <div className=\"avakio-sch-toolbar\">\r\n        <div className=\"avakio-sch-nav\">\r\n          <button onClick={() => go(-1)} className=\"avakio-sch-btn\">Prev</button>\r\n          <button onClick={() => setAnchor(new Date())} className=\"avakio-sch-btn\">Today</button>\r\n          <button onClick={() => go(1)} className=\"avakio-sch-btn\">Next</button>\r\n        </div>\r\n        <div className=\"avakio-sch-title\">\r\n          {anchor.toLocaleString(undefined, { month: \"long\", year: \"numeric\", day: view === \"day\" ? \"numeric\" : undefined })}\r\n        </div>\r\n        <div className=\"avakio-sch-views\">\r\n          <button onClick={() => changeView(\"month\")} className={`avakio-sch-btn ${view === \"month\" ? \"is-active\" : \"\"}`}>Month</button>\r\n          <button onClick={() => changeView(\"week\")} className={`avakio-sch-btn ${view === \"week\" ? \"is-active\" : \"\"}`}>Week</button>\r\n          <button onClick={() => changeView(\"day\")} className={`avakio-sch-btn ${view === \"day\" ? \"is-active\" : \"\"}`}>Day</button>\r\n          <button onClick={createEvent} className=\"avakio-sch-btn\">New</button>\r\n        </div>\r\n        {loading && <div className=\"avakio-sch-status\">Loading remote eventsâ€¦</div>}\r\n        {error && <div className=\"avakio-sch-status is-error\">{error}</div>}\r\n      </div>\r\n\r\n      {view === \"month\" && isMobile && (\r\n        <div className=\"avakio-sch-month-mobile\">\r\n          <AvakioCalendar\r\n            value={selectedDateKey}\r\n            onChange={(val) => {\r\n              const nextKey = Array.isArray(val) ? val[0] : val;\r\n              if (!nextKey) return;\r\n              setSelectedDateKey(nextKey);\r\n              setAnchor(parseDateKey(nextKey));\r\n            }}\r\n            onMonthChange={(date) => setAnchor(date)}\r\n            markers={mobileMarkers}\r\n            weekStart={1}\r\n          />\r\n\r\n          <div className=\"avakio-sch-mobile-events\">\r\n            <div className=\"avakio-sch-mobile-events-header\">\r\n              {formatDay(selectedDate)} â€” {selectedDateEvents.length} event{selectedDateEvents.length === 1 ? \"\" : \"s\"}\r\n            </div>\r\n            <div className=\"avakio-sch-mobile-list\">\r\n              {selectedDateEvents.length === 0 && <div className=\"avakio-sch-mobile-empty\">No events for this date.</div>}\r\n              {selectedDateEvents\r\n                .slice()\r\n                .sort((a, b) => a._start.getTime() - b._start.getTime())\r\n                .map((evt) => (\r\n                  <div\r\n                    key={evt.id}\r\n                    className=\"avakio-sch-mobile-item\"\r\n                    onClick={() => onEventClick?.(evt)}\r\n                  >\r\n                    <span className=\"avakio-sch-dot\" style={{ background: evt.color || \"var(--sch-primary)\" }} />\r\n                    <div className=\"avakio-sch-mobile-meta\">\r\n                      <div className=\"avakio-sch-mobile-title\">{evt.title}</div>\r\n                      <div className=\"avakio-sch-mobile-time\">\r\n                        {formatTime(evt._start)} â€“ {formatTime(evt._end)}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {view === \"month\" && !isMobile && (\r\n        <div className=\"avakio-sch-month\">\r\n          <div className=\"avakio-sch-weekdays\">\r\n            {[\"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\", \"Sun\"].map((d) => (\r\n              <div key={d} className=\"avakio-sch-weekday\">{d}</div>\r\n            ))}\r\n          </div>\r\n          <div className=\"avakio-sch-grid\">\r\n            {monthGrid.map((d) => (\r\n              <div key={d.toISOString()} className={`avakio-sch-cell ${d.getMonth() === anchor.getMonth() ? \"\" : \"is-out\"}`}>\r\n                <div className=\"avakio-sch-cell-date\">\r\n                  <span>{d.getDate()}</span>\r\n                  {eventsForDay(d).length > 1 && (\r\n                    <button\r\n                      className=\"avakio-sch-more-btn\"\r\n                      onClick={(e) =>\r\n                        setMorePopup({\r\n                          dateKey: d.toDateString(),\r\n                          anchorRect: (e.currentTarget as HTMLButtonElement).getBoundingClientRect(),\r\n                        })\r\n                      }\r\n                      title={`${eventsForDay(d).length - 1} more`}\r\n                    >\r\n                      {eventsForDay(d).length - 1} more\r\n                    </button>\r\n                  )}\r\n                </div>\r\n                <div className=\"avakio-sch-cell-events\">\r\n                  {eventsForDay(d)\r\n                    .slice(0, 1)\r\n                    .map((evt) => renderEventPill(evt))}\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {view === \"month\" && !isMobile && monthAgenda.length > 0 && (\r\n        <div className=\"avakio-sch-month-agenda\">\r\n          {monthAgenda.map((evt) => (\r\n            <div\r\n              key={evt.id}\r\n              className=\"avakio-sch-agenda-item\"\r\n              onClick={() => onEventClick?.(evt)}\r\n            >\r\n              <div className=\"avakio-sch-agenda-time\">\r\n                <div>{formatTime(evt._start)}</div>\r\n                <div className=\"avakio-sch-agenda-time-end\">{formatTime(evt._end)}</div>\r\n              </div>\r\n              <span className=\"avakio-sch-dot\" style={{ background: evt.color || \"var(--sch-primary)\" }} />\r\n              <div className=\"avakio-sch-agenda-meta\">\r\n                <div className=\"avakio-sch-agenda-title\">{evt.title}</div>\r\n                <div className=\"avakio-sch-agenda-date\">\r\n                  {evt._start.toLocaleDateString(undefined, { weekday: \"short\", month: \"short\", day: \"numeric\" })}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n\r\n      {morePopup && (\r\n        <AvakioPopup\r\n          open\r\n          anchorRect={morePopup.anchorRect || undefined}\r\n          offset={{ y: 6 }}\r\n          theme={theme}\r\n          closeOnOutside\r\n          closeOnEsc\r\n          onClose={() => setMorePopup(null)}\r\n        >\r\n          <h4>Other events</h4>\r\n          <div className=\"avakio-sch-more-list\">\r\n            {eventsForDayKey(morePopup.dateKey)\r\n              .slice(1)\r\n              .map((evt) => (\r\n                <div\r\n                  key={evt.id}\r\n                  className=\"avakio-sch-more-item\"\r\n                  onClick={() => onEventClick?.(evt)}\r\n                >\r\n                  <span className=\"avakio-sch-dot\" style={{ background: evt.color || \"var(--sch-primary)\" }} />\r\n                  <div className=\"avakio-sch-more-meta\">\r\n                    <div className=\"avakio-sch-more-title\">{evt.title}</div>\r\n                    <div className=\"avakio-sch-more-time\">\r\n                      {formatTime(evt._start)} â€“ {formatTime(evt._end)}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n          </div>\r\n        </AvakioPopup>\r\n      )}\r\n\r\n      {view === \"week\" && (\r\n        <div className=\"avakio-sch-week\">\r\n          <div className=\"avakio-sch-week-row\">\r\n            {weekGrid.map((d) => (\r\n              <div key={d.toISOString()} className=\"avakio-sch-daycol\">\r\n                <div className=\"avakio-sch-day-header\">{formatDay(d)}</div>\r\n                <div className=\"avakio-sch-day-events\">{renderEventsForDay(d)}</div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {view === \"day\" && (\r\n        <div className=\"avakio-sch-day\">\r\n          <div className=\"avakio-sch-day-header\">{formatDay(dayGrid[0])}</div>\r\n          <div className=\"avakio-sch-day-events\">{renderEventsForDay(dayGrid[0])}</div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useState, useCallback, useMemo } from 'react';\r\nimport './avakio-sidebar.css';\r\n\r\nexport interface SidebarItem {\r\n  id: string;\r\n  value: string;\r\n  icon?: React.ReactNode;\r\n  data?: SidebarItem[];\r\n  [key: string]: any;\r\n}\r\n\r\nexport type SidebarPosition = 'left' | 'right';\r\n\r\nexport interface AvakioSidebarProps {\r\n  data: SidebarItem[];\r\n  collapsed?: boolean;\r\n  position?: SidebarPosition;\r\n  collapsedWidth?: number;\r\n  width?: number;\r\n  activeTitle?: boolean;\r\n  titleHeight?: number;\r\n  multipleOpen?: boolean;\r\n  onSelect?: (item: SidebarItem) => void;\r\n  onToggle?: (collapsed: boolean) => void;\r\n  className?: string;\r\n  mobileBreakpoint?: number;\r\n  tabletBreakpoint?: number;\r\n  autoCloseMobile?: boolean;\r\n  showOverlay?: boolean;\r\n  onOverlayClick?: () => void;\r\n  showMobileDongle?: boolean;\r\n  dongleIcon?: React.ReactNode;\r\n  /** ID of the component */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n}\r\n\r\ninterface ItemState {\r\n  [key: string]: boolean;\r\n}\r\n\r\nexport function AvakioSidebar({\r\n  data,\r\n  collapsed = false,\r\n  position = 'left',\r\n  collapsedWidth = 41,\r\n  width = 250,\r\n  activeTitle = true,\r\n  titleHeight = 40,\r\n  multipleOpen = false,\r\n  onSelect,\r\n  onToggle,\r\n  className = '',\r\n  mobileBreakpoint = 768,\r\n  tabletBreakpoint = 1024,\r\n  autoCloseMobile = true,\r\n  showOverlay = true,\r\n  onOverlayClick,\r\n  showMobileDongle = true,\r\n  dongleIcon,\r\n  id,\r\n  testId,\r\n}: AvakioSidebarProps) {\r\n  const [isCollapsed, setIsCollapsed] = useState(collapsed);\r\n  const [openItems, setOpenItems] = useState<ItemState>({});\r\n  const [hoveredItem, setHoveredItem] = useState<string | null>(null);\r\n  const [selectedItem, setSelectedItem] = useState<string | null>(null);\r\n  const [isMobile, setIsMobile] = useState(false);\r\n  const [isTablet, setIsTablet] = useState(false);\r\n\r\n  // Detect screen size: mobile (dongle), tablet (collapsed), desktop (expanded)\r\n  React.useEffect(() => {\r\n    const checkScreenSize = () => {\r\n      const width = window.innerWidth;\r\n      const isMobileScreen = width < mobileBreakpoint;\r\n      const isTabletScreen = width >= mobileBreakpoint && width < tabletBreakpoint;\r\n      \r\n      setIsMobile(isMobileScreen);\r\n      setIsTablet(isTabletScreen);\r\n      \r\n      // Mobile: hide sidebar (show dongle only)\r\n      // Tablet: show collapsed sidebar\r\n      // Desktop: show expanded sidebar\r\n      if (isMobileScreen || isTabletScreen) {\r\n        setIsCollapsed(true);\r\n      } else {\r\n        setIsCollapsed(false);\r\n      }\r\n    };\r\n    \r\n    checkScreenSize();\r\n    window.addEventListener('resize', checkScreenSize);\r\n    return () => window.removeEventListener('resize', checkScreenSize);\r\n  }, [mobileBreakpoint, tabletBreakpoint]);\r\n\r\n  // Sync internal state with external collapsed prop\r\n  React.useEffect(() => {\r\n    setIsCollapsed(collapsed);\r\n  }, [collapsed]);\r\n\r\n  // Prevent body scroll when sidebar is open on mobile\r\n  React.useEffect(() => {\r\n    if (isMobile && !isCollapsed) {\r\n      document.body.style.overflow = 'hidden';\r\n    } else {\r\n      document.body.style.overflow = '';\r\n    }\r\n    return () => {\r\n      document.body.style.overflow = '';\r\n    };\r\n  }, [isMobile, isCollapsed]);\r\n\r\n  const toggleCollapse = useCallback(() => {\r\n    const newCollapsed = !isCollapsed;\r\n    setIsCollapsed(newCollapsed);\r\n    if (onToggle) {\r\n      onToggle(newCollapsed);\r\n    }\r\n  }, [isCollapsed, onToggle]);\r\n\r\n  const toggleItem = useCallback(\r\n    (itemId: string, hasChildren: boolean) => {\r\n      if (!hasChildren || !activeTitle) return;\r\n\r\n      setOpenItems((prev) => {\r\n        if (multipleOpen) {\r\n          return { ...prev, [itemId]: !prev[itemId] };\r\n        } else {\r\n          return { [itemId]: !prev[itemId] };\r\n        }\r\n      });\r\n    },\r\n    [multipleOpen, activeTitle]\r\n  );\r\n\r\n  const handleItemClick = useCallback(\r\n    (item: SidebarItem, hasChildren: boolean, level: number = 0, parentId?: string) => {\r\n      // If collapsed and has children, expand the sidebar instead of toggling children\r\n      if (isCollapsed && hasChildren) {\r\n        setIsCollapsed(false);\r\n        return;\r\n      }\r\n      \r\n      // Always set the selected item and call onSelect\r\n      setSelectedItem(item.id);\r\n      if (onSelect) {\r\n        onSelect(item);\r\n      }\r\n      \r\n      // Auto-close/collapse sidebar on mobile and tablet:\r\n      // - Mobile: Close if it's a child item (level > 0) or parent without children\r\n      // - Tablet: Same behavior - collapse to show icons only, but select parent\r\n      // - Desktop: Don't auto-close, just toggle children\r\n      const shouldCollapseOnMobileOrTablet = (isMobile || isTablet) && autoCloseMobile && (level > 0 || !hasChildren);\r\n      \r\n      if (shouldCollapseOnMobileOrTablet) {\r\n        // On tablet, when collapsing after selecting a child, keep the parent selected\r\n        if (isTablet && level > 0 && parentId) {\r\n          setSelectedItem(parentId);\r\n        }\r\n        setIsCollapsed(true);\r\n      } else {\r\n        // Toggle children expansion when sidebar is not collapsed and not closing\r\n        if (hasChildren && !isCollapsed) {\r\n          toggleItem(item.id, hasChildren);\r\n        }\r\n      }\r\n    },\r\n    [toggleItem, onSelect, isMobile, isTablet, autoCloseMobile, isCollapsed]\r\n  );\r\n\r\n  const handleOverlayClick = useCallback(() => {\r\n    if (onOverlayClick) {\r\n      onOverlayClick();\r\n    } else {\r\n      setIsCollapsed(true);\r\n    }\r\n  }, [onOverlayClick]);\r\n\r\n  const renderIcon = (icon?: React.ReactNode) => {\r\n    if (!icon) return null;\r\n    return <span className=\"avakio-sidebar-icon\">{icon}</span>;\r\n  };\r\n\r\n  const renderArrow = (hasChildren: boolean, isOpen: boolean, level: number) => {\r\n    if (!hasChildren || level === 0) return null;\r\n    return (\r\n      <span className={`avakio-sidebar-arrow ${isOpen ? 'open' : ''}`}>\r\n        <svg width=\"12\" height=\"12\" viewBox=\"0 0 12 12\" fill=\"currentColor\">\r\n          <path d=\"M4 3l4 3-4 3V3z\" />\r\n        </svg>\r\n      </span>\r\n    );\r\n  };\r\n\r\n  const renderItem = (item: SidebarItem, level: number = 0, parentId?: string): React.ReactNode => {\r\n    const hasChildren = !!(item.data && item.data.length > 0);\r\n    const isOpen = openItems[item.id] || false;\r\n    const isSelected = selectedItem === item.id;\r\n    const isHovered = hoveredItem === item.id;\r\n\r\n    return (\r\n      <div key={item.id} className=\"avakio-sidebar-item-wrapper\">\r\n        <div\r\n          className={[\r\n            'avakio-sidebar-item',\r\n            `level-${level}`,\r\n            isSelected ? 'selected' : '',\r\n            hasChildren ? 'has-children' : '',\r\n          ]\r\n            .filter(Boolean)\r\n            .join(' ')}\r\n          onClick={() => handleItemClick(item, hasChildren, level, parentId)}\r\n          onMouseEnter={() => setHoveredItem(item.id)}\r\n          onMouseLeave={() => setHoveredItem(null)}\r\n          style={{\r\n            paddingLeft: level === 0 ? undefined : `${16 + level * 20}px`,\r\n            minHeight: level === 0 ? `${titleHeight}px` : undefined,\r\n          }}\r\n        >\r\n          {renderArrow(hasChildren, isOpen, level)}\r\n          {renderIcon(item.icon)}\r\n          {!isCollapsed && <span className=\"avakio-sidebar-value\">{item.value}</span>}\r\n        </div>\r\n\r\n        {/* Popup for collapsed mode */}\r\n        {isCollapsed && isHovered && level === 0 && (\r\n          <div\r\n            className={`avakio-sidebar-popup ${position === 'right' ? 'popup-left' : 'popup-right'}`}\r\n            style={{ minHeight: `${titleHeight}px` }}\r\n          >\r\n            <div className=\"avakio-sidebar-popup-title\">{item.value}</div>\r\n            {hasChildren && (\r\n              <div className=\"avakio-sidebar-popup-children\">\r\n                {item.data?.map((child) => (\r\n                  <div\r\n                    key={child.id}\r\n                    className={`avakio-sidebar-popup-item ${selectedItem === child.id ? 'selected' : ''}`}\r\n                    onClick={(e) => {\r\n                      e.stopPropagation();\r\n                      handleItemClick(child, false, 1, item.id);\r\n                    }}\r\n                  >\r\n                    {renderIcon(child.icon)}\r\n                    <span className=\"avakio-sidebar-value\">{child.value}</span>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/* Expanded children */}\r\n        {!isCollapsed && hasChildren && isOpen && (\r\n          <div className=\"avakio-sidebar-children\">\r\n            {item.data?.map((child) => renderItem(child, level + 1, level === 0 ? item.id : parentId))}\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {/* Mobile overlay */}\r\n      {isMobile && !isCollapsed && showOverlay && (\r\n        <div\r\n          className=\"avakio-sidebar-overlay\"\r\n          onClick={handleOverlayClick}\r\n          aria-hidden=\"true\"\r\n        />\r\n      )}\r\n\r\n      {/* Mobile dongle/toggle button */}\r\n      {isMobile && isCollapsed && showMobileDongle && (\r\n        <button\r\n          type=\"button\"\r\n          className={`avakio-sidebar-mobile-dongle position-${position}`}\r\n          onClick={() => setIsCollapsed(false)}\r\n          aria-label=\"Open sidebar\"\r\n        >\r\n          {dongleIcon || (\r\n            <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n              <path d=\"M2 4h16v2H2V4zm0 5h16v2H2V9zm0 5h16v2H2v-2z\" />\r\n            </svg>\r\n          )}\r\n        </button>\r\n      )}\r\n\r\n      <div\r\n        id={id}\r\n        data-testid={testId}\r\n        className={[\r\n          'avakio-sidebar',\r\n          isCollapsed ? 'collapsed' : 'expanded',\r\n          `position-${position}`,\r\n          isMobile ? 'mobile' : 'desktop',\r\n          className,\r\n        ]\r\n          .filter(Boolean)\r\n          .join(' ')}\r\n        style={{\r\n          width: isCollapsed ? `${collapsedWidth}px` : `${width}px`,\r\n        }}\r\n      >\r\n        <div className=\"avakio-sidebar-content\">{data.map((item) => renderItem(item))}</div>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n\r\n// Export toggle function component for external use\r\nexport interface AvakioSidebarToggleButtonProps {\r\n  onClick?: () => void;\r\n  className?: string;\r\n  icon?: React.ReactNode;\r\n  isCollapsed?: boolean;\r\n}\r\n\r\nexport function AvakioSidebarToggleButton({\r\n  onClick,\r\n  className = '',\r\n  icon,\r\n  isCollapsed = false,\r\n}: AvakioSidebarToggleButtonProps) {\r\n  return (\r\n    <button\r\n      type=\"button\"\r\n      className={`avakio-sidebar-toggle-button ${isCollapsed ? 'collapsed' : 'expanded'} ${className}`}\r\n      onClick={onClick}\r\n      aria-label={isCollapsed ? \"Expand sidebar\" : \"Collapse sidebar\"}\r\n    >\r\n      {icon || (\r\n        <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n          <path d=\"M2 4h16v2H2V4zm0 5h16v2H2V9zm0 5h16v2H2v-2z\" />\r\n        </svg>\r\n      )}\r\n    </button>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { forwardRef, useImperativeHandle, useRef, useState, useEffect, ReactNode, useMemo, useCallback } from 'react';\r\nimport { MoreVertical, Send, Edit2, Trash2, X, Check } from 'lucide-react';\r\nimport './avakio-comment.css';\r\n\r\nexport type AvakioCommentTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\nexport type UserStatus = 'active' | 'away' | 'busy' | 'none';\r\nexport type CommentMode = 'default' | 'chat';\r\nexport type SendAction = 'enter' | 'shift+enter';\r\n\r\nexport interface CommentUser {\r\n  id: string | number;\r\n  value: string;\r\n  image?: string;\r\n  status?: UserStatus;\r\n}\r\n\r\nexport interface CommentItem {\r\n  id: string | number;\r\n  user_id?: string | number;\r\n  date: Date | string;\r\n  text: string;\r\n}\r\n\r\nexport interface AvakioCommentProps {\r\n  /** Unique identifier */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n  /** Theme variant */\r\n  theme?: AvakioCommentTheme;\r\n  /** Array of comments */\r\n  data?: CommentItem[];\r\n  /** Array of users who can comment */\r\n  users?: CommentUser[];\r\n  /** Current user ID - their comments can be edited/deleted */\r\n  currentUser?: string | number;\r\n  /** Display mode - default shows oldest first, chat shows newest first */\r\n  mode?: CommentMode;\r\n  /** Read-only mode - hides input and disables editing */\r\n  readonly?: boolean;\r\n  /** Key combination to send comment */\r\n  sendAction?: SendAction;\r\n  /** Placeholder text for the input */\r\n  placeholder?: string;\r\n  /** Label for the \"More comments\" button */\r\n  moreButtonLabel?: string;\r\n  /** Show more button if there are more comments */\r\n  hasMore?: boolean;\r\n  /** Enable mentions functionality */\r\n  mentions?: boolean;\r\n  /** Keep send button always visible */\r\n  keepButtonVisible?: boolean;\r\n  /** Border-less mode */\r\n  borderless?: boolean;\r\n  /** Custom CSS styles */\r\n  css?: React.CSSProperties;\r\n  /** Additional CSS class name */\r\n  className?: string;\r\n  /** Width of the component */\r\n  width?: number | string;\r\n  /** Height of the component */\r\n  height?: number | string;\r\n  /** Disabled state */\r\n  disabled?: boolean;\r\n  /** Callback when a comment is added */\r\n  onAdd?: (comment: CommentItem) => void;\r\n  /** Callback when a comment is deleted */\r\n  onDelete?: (commentId: string | number) => void;\r\n  /** Callback when a comment is edited */\r\n  onEdit?: (comment: CommentItem) => void;\r\n  /** Callback when more comments are requested */\r\n  onLoadMore?: () => void;\r\n  /** Callback when a user is mentioned */\r\n  onUserMentioned?: (userId: string | number, comment: CommentItem) => void;\r\n  /** Custom date formatter */\r\n  dateFormatter?: (date: Date | string) => string;\r\n  /** Custom avatar renderer */\r\n  renderAvatar?: (user?: CommentUser) => ReactNode;\r\n}\r\n\r\nexport interface AvakioCommentRef {\r\n  /** Get the component DOM node */\r\n  getNode: () => HTMLDivElement | null;\r\n  /** Get all comments */\r\n  getComments: () => CommentItem[];\r\n  /** Add a new comment */\r\n  add: (comment: Omit<CommentItem, 'id'>) => void;\r\n  /** Remove a comment by ID */\r\n  remove: (commentId: string | number) => void;\r\n  /** Edit a comment */\r\n  edit: (commentId: string | number) => void;\r\n  /** Get users data */\r\n  getUsers: () => CommentUser[];\r\n  /** Set current user */\r\n  setCurrentUser: (userId: string | number) => void;\r\n  /** Focus the input area */\r\n  focus: () => void;\r\n  /** Check if enabled */\r\n  isEnabled: () => boolean;\r\n  /** Enable the component */\r\n  enable: () => void;\r\n  /** Disable the component */\r\n  disable: () => void;\r\n  /** Clear all comments */\r\n  clear: () => void;\r\n}\r\n\r\n// Default date formatter\r\nconst defaultDateFormatter = (date: Date | string): string => {\r\n  const d = typeof date === 'string' ? new Date(date) : date;\r\n  const now = new Date();\r\n  const diff = now.getTime() - d.getTime();\r\n  const minutes = Math.floor(diff / 60000);\r\n  const hours = Math.floor(diff / 3600000);\r\n  const days = Math.floor(diff / 86400000);\r\n\r\n  if (minutes < 1) return 'Just now';\r\n  if (minutes < 60) return `${minutes}m ago`;\r\n  if (hours < 24) return `${hours}h ago`;\r\n  if (days < 7) return `${days}d ago`;\r\n  \r\n  return d.toLocaleDateString(undefined, { \r\n    month: 'short', \r\n    day: 'numeric',\r\n    year: d.getFullYear() !== now.getFullYear() ? 'numeric' : undefined\r\n  });\r\n};\r\n\r\n// Generate unique ID\r\nconst generateId = () => `comment-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\r\n\r\nexport const AvakioComment = forwardRef<AvakioCommentRef, AvakioCommentProps>(\r\n  (\r\n    {\r\n      id,\r\n      testId,\r\n      theme,\r\n      data: initialData = [],\r\n      users = [],\r\n      currentUser,\r\n      mode = 'default',\r\n      readonly = false,\r\n      sendAction = 'enter',\r\n      placeholder = 'Write a comment...',\r\n      moreButtonLabel = 'Load more comments',\r\n      hasMore = false,\r\n      mentions = false,\r\n      keepButtonVisible = false,\r\n      borderless = false,\r\n      css,\r\n      className = '',\r\n      width,\r\n      height,\r\n      disabled: disabledProp = false,\r\n      onAdd,\r\n      onDelete,\r\n      onEdit,\r\n      onLoadMore,\r\n      onUserMentioned,\r\n      dateFormatter = defaultDateFormatter,\r\n      renderAvatar,\r\n    },\r\n    ref\r\n  ) => {\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n    const inputRef = useRef<HTMLTextAreaElement>(null);\r\n    const listRef = useRef<HTMLDivElement>(null);\r\n    \r\n    const [comments, setComments] = useState<CommentItem[]>(initialData);\r\n    const [disabled, setDisabled] = useState(disabledProp);\r\n    const [inputValue, setInputValue] = useState('');\r\n    const [editingId, setEditingId] = useState<string | number | null>(null);\r\n    const [editValue, setEditValue] = useState('');\r\n    const [activeMenuId, setActiveMenuId] = useState<string | number | null>(null);\r\n    const [showMentions, setShowMentions] = useState(false);\r\n    const [mentionSearch, setMentionSearch] = useState('');\r\n    const [currentUserId, setCurrentUserId] = useState<string | number | undefined>(currentUser);\r\n\r\n    // Sync with props\r\n    useEffect(() => {\r\n      setComments(initialData);\r\n    }, [initialData]);\r\n\r\n    useEffect(() => {\r\n      setDisabled(disabledProp);\r\n    }, [disabledProp]);\r\n\r\n    useEffect(() => {\r\n      setCurrentUserId(currentUser);\r\n    }, [currentUser]);\r\n\r\n    // Sort comments based on mode\r\n    const sortedComments = useMemo(() => {\r\n      const sorted = [...comments].sort((a, b) => {\r\n        const dateA = new Date(a.date).getTime();\r\n        const dateB = new Date(b.date).getTime();\r\n        return mode === 'chat' ? dateB - dateA : dateA - dateB;\r\n      });\r\n      return mode === 'chat' ? sorted.reverse() : sorted;\r\n    }, [comments, mode]);\r\n\r\n    // Get user by ID\r\n    const getUserById = useCallback((userId?: string | number): CommentUser | undefined => {\r\n      if (!userId) return undefined;\r\n      return users.find(u => u.id === userId);\r\n    }, [users]);\r\n\r\n    // Filter users for mentions\r\n    const filteredMentionUsers = useMemo(() => {\r\n      if (!mentionSearch) return users;\r\n      const search = mentionSearch.toLowerCase();\r\n      return users.filter(u => u.value.toLowerCase().includes(search));\r\n    }, [users, mentionSearch]);\r\n\r\n    // Handle sending a comment\r\n    const handleSend = useCallback(() => {\r\n      if (!inputValue.trim() || disabled || readonly) return;\r\n\r\n      const newComment: CommentItem = {\r\n        id: generateId(),\r\n        user_id: currentUserId,\r\n        date: new Date(),\r\n        text: inputValue.trim(),\r\n      };\r\n\r\n      setComments(prev => [...prev, newComment]);\r\n      setInputValue('');\r\n      onAdd?.(newComment);\r\n\r\n      // Check for mentions\r\n      if (mentions) {\r\n        const mentionRegex = /@\"([^\"]+)\"/g;\r\n        let match: RegExpExecArray | null;\r\n        while ((match = mentionRegex.exec(newComment.text)) !== null) {\r\n          const mentionedUser = users.find(u => u.value === match![1]);\r\n          if (mentionedUser) {\r\n            onUserMentioned?.(mentionedUser.id, newComment);\r\n          }\r\n        }\r\n      }\r\n\r\n      // Scroll to bottom/top based on mode\r\n      setTimeout(() => {\r\n        if (listRef.current) {\r\n          if (mode === 'chat') {\r\n            listRef.current.scrollTop = listRef.current.scrollHeight;\r\n          } else {\r\n            listRef.current.scrollTop = listRef.current.scrollHeight;\r\n          }\r\n        }\r\n      }, 100);\r\n    }, [inputValue, disabled, readonly, currentUserId, mentions, users, mode, onAdd, onUserMentioned]);\r\n\r\n    // Handle key press in input\r\n    const handleKeyDown = (e: React.KeyboardEvent<HTMLTextAreaElement>) => {\r\n      if (sendAction === 'enter' && e.key === 'Enter' && !e.shiftKey) {\r\n        e.preventDefault();\r\n        handleSend();\r\n      } else if (sendAction === 'shift+enter' && e.key === 'Enter' && e.shiftKey) {\r\n        e.preventDefault();\r\n        handleSend();\r\n      }\r\n\r\n      // Handle mentions\r\n      if (mentions && e.key === '@') {\r\n        setShowMentions(true);\r\n        setMentionSearch('');\r\n      }\r\n    };\r\n\r\n    // Handle input change\r\n    const handleInputChange = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\r\n      const value = e.target.value;\r\n      setInputValue(value);\r\n\r\n      // Handle mention search\r\n      if (mentions && showMentions) {\r\n        const atIndex = value.lastIndexOf('@');\r\n        if (atIndex !== -1) {\r\n          setMentionSearch(value.slice(atIndex + 1));\r\n        }\r\n      }\r\n    };\r\n\r\n    // Insert mention\r\n    const insertMention = (user: CommentUser) => {\r\n      const atIndex = inputValue.lastIndexOf('@');\r\n      if (atIndex !== -1) {\r\n        const newValue = inputValue.slice(0, atIndex) + `@\"${user.value}\" `;\r\n        setInputValue(newValue);\r\n      }\r\n      setShowMentions(false);\r\n      setMentionSearch('');\r\n      inputRef.current?.focus();\r\n    };\r\n\r\n    // Handle delete\r\n    const handleDelete = (commentId: string | number) => {\r\n      setComments(prev => prev.filter(c => c.id !== commentId));\r\n      setActiveMenuId(null);\r\n      onDelete?.(commentId);\r\n    };\r\n\r\n    // Handle edit start\r\n    const handleEditStart = (comment: CommentItem) => {\r\n      setEditingId(comment.id);\r\n      setEditValue(comment.text);\r\n      setActiveMenuId(null);\r\n    };\r\n\r\n    // Handle edit save\r\n    const handleEditSave = (commentId: string | number) => {\r\n      if (!editValue.trim()) return;\r\n      \r\n      setComments(prev => prev.map(c => \r\n        c.id === commentId ? { ...c, text: editValue.trim() } : c\r\n      ));\r\n      \r\n      const updatedComment = comments.find(c => c.id === commentId);\r\n      if (updatedComment) {\r\n        onEdit?.({ ...updatedComment, text: editValue.trim() });\r\n      }\r\n      \r\n      setEditingId(null);\r\n      setEditValue('');\r\n    };\r\n\r\n    // Handle edit cancel\r\n    const handleEditCancel = () => {\r\n      setEditingId(null);\r\n      setEditValue('');\r\n    };\r\n\r\n    // Default avatar renderer\r\n    const defaultRenderAvatar = (user?: CommentUser): ReactNode => {\r\n      if (user?.image) {\r\n        return <img src={user.image} alt={user.value} className=\"avakio-comment-avatar-img\" />;\r\n      }\r\n      \r\n      const initials = user?.value\r\n        ? user.value.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2)\r\n        : '?';\r\n      \r\n      return <span className=\"avakio-comment-avatar-initials\">{initials}</span>;\r\n    };\r\n\r\n    // Render text with mentions highlighted\r\n    const renderText = (text: string): ReactNode => {\r\n      if (!mentions) return text;\r\n      \r\n      const parts = text.split(/(@\"[^\"]+\")/).filter(Boolean);\r\n      return parts.map((part, i) => {\r\n        if (part.startsWith('@\"') && part.endsWith('\"')) {\r\n          const name = part.slice(2, -1);\r\n          return (\r\n            <span key={i} className=\"avakio-comment-mention\">\r\n              @{name}\r\n            </span>\r\n          );\r\n        }\r\n        return part;\r\n      });\r\n    };\r\n\r\n    // Expose imperative methods\r\n    useImperativeHandle(ref, () => ({\r\n      getNode: () => containerRef.current,\r\n      getComments: () => comments,\r\n      add: (comment) => {\r\n        const newComment: CommentItem = {\r\n          ...comment,\r\n          id: generateId(),\r\n        };\r\n        setComments(prev => [...prev, newComment]);\r\n        onAdd?.(newComment);\r\n      },\r\n      remove: (commentId) => {\r\n        setComments(prev => prev.filter(c => c.id !== commentId));\r\n        onDelete?.(commentId);\r\n      },\r\n      edit: (commentId) => {\r\n        const comment = comments.find(c => c.id === commentId);\r\n        if (comment) {\r\n          handleEditStart(comment);\r\n        }\r\n      },\r\n      getUsers: () => users,\r\n      setCurrentUser: (userId) => setCurrentUserId(userId),\r\n      focus: () => inputRef.current?.focus(),\r\n      isEnabled: () => !disabled,\r\n      enable: () => setDisabled(false),\r\n      disable: () => setDisabled(true),\r\n      clear: () => setComments([]),\r\n    }), [comments, users, disabled, onAdd, onDelete]);\r\n\r\n    // Build class names\r\n    const containerClassNames = [\r\n      'avakio-comment',\r\n      theme && `avakio-comment-theme-${theme}`,\r\n      mode === 'chat' && 'avakio-comment-mode-chat',\r\n      borderless && 'avakio-comment-borderless',\r\n      disabled && 'avakio-comment-disabled',\r\n      readonly && 'avakio-comment-readonly',\r\n      className,\r\n    ].filter(Boolean).join(' ');\r\n\r\n    // Build styles\r\n    const containerStyles: React.CSSProperties = {\r\n      ...(css && typeof css === 'object' && !Array.isArray(css) ? css : {}),\r\n      width: typeof width === 'number' ? `${width}px` : width,\r\n      height: typeof height === 'number' ? `${height}px` : height,\r\n    };\r\n\r\n    return (\r\n      <div\r\n        ref={containerRef}\r\n        id={id}\r\n        data-testid={testId}\r\n        data-admin-theme={theme}\r\n        className={containerClassNames}\r\n        style={containerStyles}\r\n      >\r\n        {/* Comment List */}\r\n        <div ref={listRef} className=\"avakio-comment-list\">\r\n          {/* More button at top for chat mode */}\r\n          {mode === 'chat' && hasMore && (\r\n            <button \r\n              className=\"avakio-comment-more-btn\"\r\n              onClick={onLoadMore}\r\n              disabled={disabled}\r\n            >\r\n              {moreButtonLabel}\r\n            </button>\r\n          )}\r\n\r\n          {sortedComments.map((comment) => {\r\n            const user = getUserById(comment.user_id);\r\n            const isOwner = currentUserId !== undefined && comment.user_id === currentUserId;\r\n            const isEditing = editingId === comment.id;\r\n\r\n            return (\r\n              <div key={comment.id} className=\"avakio-comment-item\">\r\n                {/* Avatar */}\r\n                <div className=\"avakio-comment-avatar\">\r\n                  {renderAvatar ? renderAvatar(user) : defaultRenderAvatar(user)}\r\n                  {user?.status && user.status !== 'none' && (\r\n                    <span className={`avakio-comment-status avakio-comment-status-${user.status}`} />\r\n                  )}\r\n                </div>\r\n\r\n                {/* Content */}\r\n                <div className=\"avakio-comment-content\">\r\n                  <div className=\"avakio-comment-header\">\r\n                    <span className=\"avakio-comment-author\">\r\n                      {user?.value || 'Anonymous'}\r\n                    </span>\r\n                    <span className=\"avakio-comment-date\">\r\n                      {dateFormatter(comment.date)}\r\n                    </span>\r\n                    \r\n                    {/* Menu for owner */}\r\n                    {isOwner && !readonly && !isEditing && (\r\n                      <div className=\"avakio-comment-menu-wrapper\">\r\n                        <button\r\n                          className=\"avakio-comment-menu-btn\"\r\n                          onClick={() => setActiveMenuId(activeMenuId === comment.id ? null : comment.id)}\r\n                        >\r\n                          <MoreVertical size={16} />\r\n                        </button>\r\n                        {activeMenuId === comment.id && (\r\n                          <div className=\"avakio-comment-menu\">\r\n                            <button onClick={() => handleEditStart(comment)}>\r\n                              <Edit2 size={14} />\r\n                              Edit\r\n                            </button>\r\n                            <button onClick={() => handleDelete(comment.id)}>\r\n                              <Trash2 size={14} />\r\n                              Delete\r\n                            </button>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n\r\n                  {/* Comment text or edit mode */}\r\n                  {isEditing ? (\r\n                    <div className=\"avakio-comment-edit\">\r\n                      <textarea\r\n                        value={editValue}\r\n                        onChange={(e) => setEditValue(e.target.value)}\r\n                        className=\"avakio-comment-edit-input\"\r\n                        autoFocus\r\n                      />\r\n                      <div className=\"avakio-comment-edit-actions\">\r\n                        <button \r\n                          className=\"avakio-comment-edit-save\"\r\n                          onClick={() => handleEditSave(comment.id)}\r\n                        >\r\n                          <Check size={14} />\r\n                        </button>\r\n                        <button \r\n                          className=\"avakio-comment-edit-cancel\"\r\n                          onClick={handleEditCancel}\r\n                        >\r\n                          <X size={14} />\r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n                  ) : (\r\n                    <div className=\"avakio-comment-text\">\r\n                      {renderText(comment.text)}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            );\r\n          })}\r\n\r\n          {/* More button at bottom for default mode */}\r\n          {mode === 'default' && hasMore && (\r\n            <button \r\n              className=\"avakio-comment-more-btn\"\r\n              onClick={onLoadMore}\r\n              disabled={disabled}\r\n            >\r\n              {moreButtonLabel}\r\n            </button>\r\n          )}\r\n\r\n          {/* Empty state */}\r\n          {sortedComments.length === 0 && (\r\n            <div className=\"avakio-comment-empty\">\r\n              No comments yet. Be the first to comment!\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Input area */}\r\n        {!readonly && (\r\n          <div className=\"avakio-comment-input-area\">\r\n            <div className=\"avakio-comment-input-wrapper\">\r\n              <textarea\r\n                ref={inputRef}\r\n                value={inputValue}\r\n                onChange={handleInputChange}\r\n                onKeyDown={handleKeyDown}\r\n                placeholder={placeholder}\r\n                className=\"avakio-comment-input\"\r\n                disabled={disabled}\r\n                rows={1}\r\n              />\r\n              \r\n              {/* Mentions dropdown */}\r\n              {showMentions && filteredMentionUsers.length > 0 && (\r\n                <div className=\"avakio-comment-mentions\">\r\n                  {filteredMentionUsers.map(user => (\r\n                    <button\r\n                      key={user.id}\r\n                      className=\"avakio-comment-mention-item\"\r\n                      onClick={() => insertMention(user)}\r\n                    >\r\n                      <div className=\"avakio-comment-mention-avatar\">\r\n                        {defaultRenderAvatar(user)}\r\n                      </div>\r\n                      <span>{user.value}</span>\r\n                    </button>\r\n                  ))}\r\n                </div>\r\n              )}\r\n            </div>\r\n            \r\n            {(keepButtonVisible || inputValue.trim()) && (\r\n              <button\r\n                className=\"avakio-comment-send-btn\"\r\n                onClick={handleSend}\r\n                disabled={disabled || !inputValue.trim()}\r\n              >\r\n                <Send size={18} />\r\n              </button>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nAvakioComment.displayName = 'AvakioComment';\r\n\r\nexport default AvakioComment;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useState, useRef, useEffect } from 'react';\r\n\r\ninterface SelectProps {\r\n  value?: string;\r\n  defaultValue?: string;\r\n  onValueChange?: (value: string) => void;\r\n  children: React.ReactNode;\r\n  disabled?: boolean;\r\n}\r\n\r\ninterface SelectContextType {\r\n  value: string;\r\n  onValueChange: (value: string) => void;\r\n  open: boolean;\r\n  setOpen: (open: boolean) => void;\r\n}\r\n\r\nconst SelectContext = React.createContext<SelectContextType | null>(null);\r\n\r\nexport const Select = ({ children, value, defaultValue, onValueChange, disabled }: SelectProps) => {\r\n  const [internalValue, setInternalValue] = useState(defaultValue || '');\r\n  const [open, setOpen] = useState(false);\r\n  \r\n  const currentValue = value !== undefined ? value : internalValue;\r\n  \r\n  const handleValueChange = (newValue: string) => {\r\n    if (value === undefined) {\r\n      setInternalValue(newValue);\r\n    }\r\n    onValueChange?.(newValue);\r\n    setOpen(false);\r\n  };\r\n\r\n  return (\r\n    <SelectContext.Provider value={{ value: currentValue, onValueChange: handleValueChange, open, setOpen }}>\r\n      <div style={{ position: 'relative', display: 'inline-block' }}>\r\n        {children}\r\n      </div>\r\n    </SelectContext.Provider>\r\n  );\r\n};\r\n\r\nexport const SelectTrigger = ({ children, className, ...props }: any) => {\r\n  const context = React.useContext(SelectContext);\r\n  if (!context) throw new Error('SelectTrigger must be used within Select');\r\n  \r\n  return (\r\n    <button\r\n      type=\"button\"\r\n      className={className}\r\n      onClick={() => context.setOpen(!context.open)}\r\n      {...props}\r\n    >\r\n      {children}\r\n    </button>\r\n  );\r\n};\r\n\r\nexport const SelectValue = ({ placeholder, ...props }: any) => {\r\n  const context = React.useContext(SelectContext);\r\n  if (!context) throw new Error('SelectValue must be used within Select');\r\n  \r\n  return <span {...props}>{context.value || placeholder}</span>;\r\n};\r\n\r\nexport const SelectContent = ({ children, className, ...props }: any) => {\r\n  const context = React.useContext(SelectContext);\r\n  const ref = useRef<HTMLDivElement>(null);\r\n  \r\n  if (!context) throw new Error('SelectContent must be used within Select');\r\n\r\n  useEffect(() => {\r\n    const handleClickOutside = (event: MouseEvent) => {\r\n      if (ref.current && !ref.current.contains(event.target as Node)) {\r\n        context.setOpen(false);\r\n      }\r\n    };\r\n    \r\n    if (context.open) {\r\n      document.addEventListener('mousedown', handleClickOutside);\r\n    }\r\n    \r\n    return () => document.removeEventListener('mousedown', handleClickOutside);\r\n  }, [context.open]);\r\n\r\n  if (!context.open) return null;\r\n\r\n  return (\r\n    <div\r\n      ref={ref}\r\n      className={className}\r\n      style={{\r\n        position: 'absolute',\r\n        top: '100%',\r\n        left: 0,\r\n        right: 0,\r\n        zIndex: 50,\r\n        minWidth: '8rem',\r\n        background: 'var(--view-background-color, white)',\r\n        border: '1px solid var(--view-border-color, #e5e7eb)',\r\n        borderRadius: '6px',\r\n        boxShadow: '0 4px 6px -1px rgba(0, 0, 0, 0.1)',\r\n        marginTop: '4px',\r\n        overflow: 'hidden'\r\n      }}\r\n      {...props}\r\n    >\r\n      {children}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport const SelectItem = ({ children, value, className, ...props }: any) => {\r\n  const context = React.useContext(SelectContext);\r\n  if (!context) throw new Error('SelectItem must be used within Select');\r\n  \r\n  const isSelected = context.value === value;\r\n\r\n  return (\r\n    <div\r\n      className={className}\r\n      style={{\r\n        padding: '8px 12px',\r\n        cursor: 'pointer',\r\n        background: isSelected ? 'var(--view-hover-color, #f3f4f6)' : 'transparent',\r\n        fontSize: '14px'\r\n      }}\r\n      onClick={() => context.onValueChange(value)}\r\n      onMouseEnter={(e) => {\r\n        (e.target as HTMLElement).style.background = 'var(--view-hover-color, #f3f4f6)';\r\n      }}\r\n      onMouseLeave={(e) => {\r\n        (e.target as HTMLElement).style.background = isSelected ? 'var(--view-hover-color, #f3f4f6)' : 'transparent';\r\n      }}\r\n      {...props}\r\n    >\r\n      {children}\r\n    </div>\r\n  );\r\n};\r\n","import React, { useState, useMemo, useCallback, useEffect } from 'react';\r\nimport { ChevronUp, ChevronDown, ChevronsUpDown, ChevronLeft, ChevronRight, Search, X } from 'lucide-react';\r\nimport { Input } from '../../../ui/input';\r\n// Button component not available\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '../../../ui/select';\r\nimport './avakio-datatable.css';\r\nimport { Button } from '../../../ui/button';\r\n\r\nexport interface AvakioColumn<T = any> {\r\n  id: string;\r\n  header: string;\r\n  width?: number | string;\r\n  minWidth?: number;\r\n  maxWidth?: number;\r\n  sort?: 'asc' | 'desc' | boolean;\r\n  filterable?: boolean;\r\n  filterComponent?: (value: any, onChange: (value: any) => void) => React.ReactNode;\r\n  filterType?: 'text' | 'date' | 'number' | 'multicombo' | 'combo';\r\n  hidden?: boolean;\r\n  resizable?: boolean;\r\n  template?: (row: T) => React.ReactNode;\r\n  cssClass?: string;\r\n  headerCssClass?: string;\r\n  align?: 'left' | 'center' | 'right';\r\n  format?: (value: any) => string;\r\n}\r\n\r\nexport type AvakioSpan = [\r\n  rowId: string | number,\r\n  columnId: string,\r\n  colspan: number,\r\n  rowspan: number,\r\n  value?: any,\r\n  cssClass?: string\r\n];\r\n\r\nexport interface AvakioDataTableProps<T = any> {\r\n  id?: string;\r\n  data: T[];\r\n  spans?: AvakioSpan[];\r\n  columns: AvakioColumn<T>[];\r\n  height?: number | string;\r\n  width?: number | string;\r\n  select?: boolean | 'row' | 'cell' | 'column';\r\n  multiselect?: boolean;\r\n  rowHeight?: number;\r\n  headerHeight?: number;\r\n  fixedRowNumber?: number;\r\n  hover?: boolean;\r\n  resizable?: boolean;\r\n  sortable?: boolean;\r\n  filterable?: boolean;\r\n  paging?: boolean;\r\n  pageSize?: number;\r\n  autoConfig?: boolean;\r\n  scroll?: boolean | 'x' | 'y' | 'xy';\r\n  css?: string;\r\n  serverSide?: boolean;\r\n  onRowClick?: (row: T, index: number) => void;\r\n  onRowDoubleClick?: (row: T, index: number) => void;\r\n  onSelectChange?: (selected: T[]) => void;\r\n  onSort?: (columnId: string, direction: 'asc' | 'desc') => void;\r\n  onFilter?: (filters: Record<string, string>) => void;\r\n  loading?: boolean;\r\n  emptyText?: string;\r\n  totalCount?: number;\r\n  currentPage?: number;\r\n  onPageChange?: (page: number) => void;\r\n  onPageSizeChange?: (pageSize: number) => void;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n}\r\n\r\nexport function AvakioDataTable<T extends Record<string, any>>({\r\n  id = 'avakio-datatable',\r\n  data,\r\n  spans,\r\n  columns,\r\n  height = 'auto',\r\n  width = '100%',\r\n  select = false,\r\n  multiselect = false,\r\n  rowHeight = 40,\r\n  headerHeight = 44,\r\n  fixedRowNumber = 0,\r\n  hover = true,\r\n  resizable = true,\r\n  sortable = true,\r\n  filterable = true,\r\n  paging = false,\r\n  pageSize = 20,\r\n  autoConfig = false,\r\n  scroll = 'xy',\r\n  css = '',\r\n  serverSide = false,\r\n  onRowClick,\r\n  onRowDoubleClick,\r\n  onSelectChange,\r\n  onSort,\r\n  onFilter,\r\n  loading = false,\r\n  emptyText = 'No data available',\r\n  totalCount,\r\n  currentPage = 1,\r\n  onPageChange,\r\n  onPageSizeChange,\r\n  testId,\r\n}: AvakioDataTableProps<T>) {\r\n  const [selectedRows, setSelectedRows] = useState<Set<number>>(new Set());\r\n  const [sortColumn, setSortColumn] = useState<string | null>(null);\r\n  const [sortDirection, setSortDirection] = useState<'asc' | 'desc'>('asc');\r\n\r\n  // Process spans to create a map of cells to skip\r\n  const spanMap = useMemo(() => {\r\n    const map = new Map<string, { skip: boolean; colspan?: number; rowspan?: number; value?: any; cssClass?: string }>();\r\n    \r\n    if (!spans || spans.length === 0) return map;\r\n    \r\n    spans.forEach(([rowId, columnId, colspan, rowspan, value, cssClass]) => {\r\n      const rowKey = String(rowId);\r\n      const cellKey = `${rowKey}-${columnId}`;\r\n      \r\n      // Mark the origin cell with span properties\r\n      map.set(cellKey, { skip: false, colspan, rowspan, value, cssClass });\r\n      \r\n      // Mark cells to skip due to colspan\r\n      const colIndex = columns.findIndex(col => col.id === columnId);\r\n      if (colIndex !== -1) {\r\n        for (let c = 1; c < colspan; c++) {\r\n          const nextCol = columns[colIndex + c];\r\n          if (nextCol) {\r\n            map.set(`${rowKey}-${nextCol.id}`, { skip: true });\r\n          }\r\n        }\r\n      }\r\n      \r\n      // Mark cells to skip due to rowspan\r\n      // Use row IDs directly from the span configuration to find consecutive rows\r\n      const allRowIds = data.map((row: any) => String(row.id || row.Id));\r\n      const rowIndex = allRowIds.indexOf(rowKey);\r\n      \r\n      if (rowIndex !== -1) {\r\n        for (let r = 1; r < rowspan; r++) {\r\n          const nextRowIndex = rowIndex + r;\r\n          if (nextRowIndex < allRowIds.length) {\r\n            const nextRowKey = allRowIds[nextRowIndex];\r\n            map.set(`${nextRowKey}-${columnId}`, { skip: true });\r\n            \r\n            // Also skip cells affected by both rowspan and colspan\r\n            for (let c = 1; c < colspan; c++) {\r\n              const nextCol = columns[colIndex + c];\r\n              if (nextCol) {\r\n                map.set(`${nextRowKey}-${nextCol.id}`, { skip: true });\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    });\r\n    \r\n    return map;\r\n  }, [spans, columns, data]);\r\n  const [filters, setFilters] = useState<Record<string, string>>({});\r\n  const [columnWidths, setColumnWidths] = useState<Record<string, number>>({});\r\n  const [page, setPage] = useState(currentPage);\r\n  const [localPageSize, setLocalPageSize] = useState(pageSize);\r\n  const [resizingColumn, setResizingColumn] = useState<string | null>(null);\r\n  const [resizeStartX, setResizeStartX] = useState(0);\r\n  const [resizeStartWidth, setResizeStartWidth] = useState(0);\r\n\r\n  useEffect(() => {\r\n    setPage(currentPage);\r\n  }, [currentPage]);\r\n\r\n  // Filter data (skip if server-side)\r\n  const filteredData = useMemo(() => {\r\n    if (serverSide) return data;\r\n    \r\n    let result = [...data];\r\n\r\n    // Apply filters\r\n    Object.entries(filters).forEach(([columnId, filterValue]) => {\r\n      // Skip empty filters\r\n      if (!filterValue) return;\r\n      \r\n      // Handle multicombo filters (array values)\r\n      if (Array.isArray(filterValue) && filterValue.length === 0) return;\r\n      \r\n      const column = columns.find(col => col.id === columnId);\r\n      \r\n      result = result.filter((row) => {\r\n        const value = row[columnId];\r\n        \r\n        // Handle multicombo filtering (array of selected values)\r\n        if (column?.filterType === 'multicombo' && Array.isArray(filterValue) && filterValue.length > 0) {\r\n          const stringValue = String(value || '').toLowerCase();\r\n          return filterValue.some(fv => stringValue.includes(fv.toLowerCase()));\r\n        }\r\n        \r\n        // Handle combo filtering (single selected value)\r\n        if (column?.filterType === 'combo' && filterValue) {\r\n          const stringValue = String(value || '').toLowerCase();\r\n          const filterStringValue = String(filterValue).toLowerCase();\r\n          return stringValue.includes(filterStringValue);\r\n        }\r\n        \r\n        // Handle date filtering\r\n        if (column?.filterType === 'date' && value) {\r\n          const rowDate = String(value).split('T')[0]; // Get YYYY-MM-DD part\r\n          const filterDate = String(filterValue).split('T')[0];\r\n          return rowDate === filterDate;\r\n        }\r\n        \r\n        // Handle text filtering (default)\r\n        if (typeof filterValue === 'string' && filterValue.trim()) {\r\n          const stringValue = String(value || '').toLowerCase();\r\n          return stringValue.includes(filterValue.toLowerCase());\r\n        }\r\n        \r\n        return true;\r\n      });\r\n    });\r\n\r\n    return result;\r\n  }, [data, filters, columns, serverSide]);\r\n\r\n  // Sort data (skip if server-side)\r\n  const sortedData = useMemo(() => {\r\n    if (serverSide) return filteredData;\r\n    if (!sortColumn) return filteredData;\r\n\r\n    return [...filteredData].sort((a, b) => {\r\n      const aVal = a[sortColumn];\r\n      const bVal = b[sortColumn];\r\n\r\n      if (aVal === null || aVal === undefined) return 1;\r\n      if (bVal === null || bVal === undefined) return -1;\r\n\r\n      let comparison = 0;\r\n      if (typeof aVal === 'number' && typeof bVal === 'number') {\r\n        comparison = aVal - bVal;\r\n      } else {\r\n        comparison = String(aVal).localeCompare(String(bVal));\r\n      }\r\n\r\n      return sortDirection === 'asc' ? comparison : -comparison;\r\n    });\r\n  }, [filteredData, sortColumn, sortDirection, serverSide]);\r\n\r\n  // Paginate data (skip if server-side)\r\n  const paginatedData = useMemo(() => {\r\n    if (serverSide) return data; // In server-side mode, data is already paginated\r\n    if (!paging) return sortedData;\r\n    const startIndex = (page - 1) * localPageSize;\r\n    return sortedData.slice(startIndex, startIndex + localPageSize);\r\n  }, [sortedData, paging, page, localPageSize, serverSide, data]);\r\n\r\n  const totalPages = Math.ceil((totalCount || sortedData.length) / localPageSize);\r\n\r\n  // Handle sort\r\n  const handleSort = useCallback((columnId: string) => {\r\n    if (!sortable) return;\r\n\r\n    const newDirection = sortColumn === columnId && sortDirection === 'asc' ? 'desc' : 'asc';\r\n    setSortColumn(columnId);\r\n    setSortDirection(newDirection);\r\n\r\n    if (onSort) {\r\n      onSort(columnId, newDirection);\r\n    }\r\n  }, [sortable, sortColumn, sortDirection, onSort]);\r\n\r\n  // Handle filter\r\n  const handleFilter = useCallback((columnId: string, value: string) => {\r\n    const newFilters = { ...filters, [columnId]: value };\r\n    setFilters(newFilters);\r\n    setPage(1); // Reset to first page on filter\r\n\r\n    if (onFilter) {\r\n      onFilter(newFilters);\r\n    }\r\n  }, [filters, onFilter]);\r\n\r\n  // Handle row selection\r\n  const handleRowClick = useCallback((row: T, index: number, event: React.MouseEvent) => {\r\n    if (select) {\r\n      if (multiselect && (event.ctrlKey || event.metaKey)) {\r\n        setSelectedRows((prev) => {\r\n          const newSet = new Set(prev);\r\n          if (newSet.has(index)) {\r\n            newSet.delete(index);\r\n          } else {\r\n            newSet.add(index);\r\n          }\r\n          return newSet;\r\n        });\r\n      } else {\r\n        setSelectedRows(new Set([index]));\r\n      }\r\n    }\r\n\r\n    if (onRowClick) {\r\n      onRowClick(row, index);\r\n    }\r\n  }, [select, multiselect, onRowClick]);\r\n\r\n  // Handle row double click\r\n  const handleRowDoubleClick = useCallback((row: T, index: number) => {\r\n    if (onRowDoubleClick) {\r\n      onRowDoubleClick(row, index);\r\n    }\r\n  }, [onRowDoubleClick]);\r\n\r\n  // Handle column resize\r\n  const handleResizeStart = useCallback((columnId: string, event: React.MouseEvent) => {\r\n    if (!resizable) return;\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    const column = columns.find(c => c.id === columnId);\r\n    const currentWidth = columnWidths[columnId] || (typeof column?.width === 'number' ? column.width : 150);\r\n\r\n    setResizingColumn(columnId);\r\n    setResizeStartX(event.clientX);\r\n    setResizeStartWidth(currentWidth);\r\n  }, [resizable, columns, columnWidths]);\r\n\r\n  useEffect(() => {\r\n    if (!resizingColumn) return;\r\n\r\n    const handleMouseMove = (event: MouseEvent) => {\r\n      const diff = event.clientX - resizeStartX;\r\n      const newWidth = Math.max(50, resizeStartWidth + diff);\r\n      setColumnWidths(prev => ({ ...prev, [resizingColumn]: newWidth }));\r\n    };\r\n\r\n    const handleMouseUp = () => {\r\n      setResizingColumn(null);\r\n    };\r\n\r\n    document.addEventListener('mousemove', handleMouseMove);\r\n    document.addEventListener('mouseup', handleMouseUp);\r\n\r\n    return () => {\r\n      document.removeEventListener('mousemove', handleMouseMove);\r\n      document.removeEventListener('mouseup', handleMouseUp);\r\n    };\r\n  }, [resizingColumn, resizeStartX, resizeStartWidth]);\r\n\r\n  // Notify selection changes\r\n  useEffect(() => {\r\n    if (onSelectChange) {\r\n      const selected = Array.from(selectedRows).map(index => paginatedData[index]).filter(Boolean);\r\n      onSelectChange(selected);\r\n    }\r\n  }, [selectedRows, paginatedData, onSelectChange]);\r\n\r\n  // Get column width\r\n  const getColumnWidth = (column: AvakioColumn<T>) => {\r\n    const customWidth = columnWidths[column.id];\r\n    if (customWidth) return `${customWidth}px`;\r\n    if (column.width) return typeof column.width === 'number' ? `${column.width}px` : column.width;\r\n    return 'auto';\r\n  };\r\n\r\n  // Render cell content\r\n  const renderCell = (column: AvakioColumn<T>, row: T) => {\r\n    if (column.template) {\r\n      return column.template(row);\r\n    }\r\n    \r\n    const value = row[column.id];\r\n    if (column.format) {\r\n      return column.format(value);\r\n    }\r\n    \r\n    return value !== null && value !== undefined ? String(value) : '';\r\n  };\r\n\r\n  const visibleColumns = columns.filter(col => !col.hidden);\r\n\r\n  return (\r\n    <div\r\n      id={id}\r\n      data-testid={testId}\r\n      className={`avakio-datatable ${css}`}\r\n      style={{\r\n        height: typeof height === 'number' ? `${height}px` : height,\r\n        width: typeof width === 'number' ? `${width}px` : width,\r\n      }}\r\n    >\r\n      {/* Header */}\r\n      <div className=\"avakio-datatable-header\" style={{ minHeight: `${headerHeight}px` }}>\r\n        <div className=\"avakio-datatable-header-row\">\r\n          {visibleColumns.map((column) => (\r\n            <div\r\n              key={column.id}\r\n              className={`avakio-datatable-header-cell ${column.headerCssClass || ''} ${\r\n                sortColumn === column.id ? 'sorted' : ''\r\n              }`}\r\n              style={{\r\n                width: getColumnWidth(column),\r\n                minWidth: column.minWidth ? `${column.minWidth}px` : undefined,\r\n                maxWidth: column.maxWidth ? `${column.maxWidth}px` : undefined,\r\n                textAlign: column.align || 'left',\r\n              }}\r\n            >\r\n              <div\r\n                className=\"avakio-datatable-header-content\"\r\n                onClick={() => sortable && column.sort !== false && handleSort(column.id)}\r\n              >\r\n                <span className=\"avakio-datatable-header-text\">{column.header}</span>\r\n                {sortable && column.sort !== false && (\r\n                  <span className=\"avakio-datatable-sort-icon\">\r\n                    {sortColumn === column.id ? (\r\n                      sortDirection === 'asc' ? (\r\n                        <ChevronUp className=\"h-4 w-4\" />\r\n                      ) : (\r\n                        <ChevronDown className=\"h-4 w-4\" />\r\n                      )\r\n                    ) : (\r\n                      <ChevronsUpDown className=\"h-4 w-4 opacity-40\" />\r\n                    )}\r\n                  </span>\r\n                )}\r\n              </div>\r\n              {resizable && column.resizable !== false && (\r\n                <div\r\n                  className=\"avakio-datatable-resize-handle\"\r\n                  onMouseDown={(e) => handleResizeStart(column.id, e)}\r\n                />\r\n              )}\r\n            </div>\r\n          ))}\r\n        </div>\r\n\r\n        {/* Filter Row */}\r\n        {filterable && (\r\n          <div className=\"avakio-datatable-filter-row\">\r\n            {visibleColumns.map((column) => (\r\n              <div\r\n                key={column.id}\r\n                className=\"avakio-datatable-filter-cell\"\r\n                style={{\r\n                  width: getColumnWidth(column),\r\n                  minWidth: column.minWidth ? `${column.minWidth}px` : undefined,\r\n                  maxWidth: column.maxWidth ? `${column.maxWidth}px` : undefined,\r\n                }}\r\n              >\r\n                {column.filterable !== false && (\r\n                  <>\r\n                    {column.filterComponent ? (\r\n                      column.filterComponent(filters[column.id], (value) => handleFilter(column.id, value))\r\n                    ) : (\r\n                      <div className=\"avakio-datatable-filter-input-wrapper\">\r\n                        <Search className=\"h-3 w-3 text-muted-foreground\" />\r\n                        <input\r\n                          type=\"text\"\r\n                          className=\"avakio-datatable-filter-input\"\r\n                          placeholder=\"Filter...\"\r\n                          value={filters[column.id] || ''}\r\n                          onChange={(e) => handleFilter(column.id, e.target.value)}\r\n                        />\r\n                        {filters[column.id] && (\r\n                          <button\r\n                            className=\"avakio-datatable-filter-clear\"\r\n                            onClick={() => handleFilter(column.id, '')}\r\n                          >\r\n                            <X className=\"h-3 w-3\" />\r\n                          </button>\r\n                        )}\r\n                      </div>\r\n                    )}\r\n                  </>\r\n                )}\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Body */}\r\n      <div\r\n        className={`avakio-datatable-body ${scroll ? `scroll-${scroll}` : ''} scrollbar-visible`}\r\n        style={{\r\n          height: typeof height === 'number' ? `${height - headerHeight - (paging ? 50 : 0)}px` : 'auto',\r\n        }}\r\n      >\r\n        {loading ? (\r\n          <div className=\"avakio-datatable-loading\">\r\n            <div className=\"avakio-datatable-spinner\" />\r\n            <p>Loading data...</p>\r\n          </div>\r\n        ) : paginatedData.length === 0 ? (\r\n          <div className=\"avakio-datatable-empty\">\r\n            <p>{emptyText}</p>\r\n          </div>\r\n        ) : (\r\n          <div className=\"avakio-datatable-rows\">\r\n            {paginatedData.map((row, rowIndex) => {\r\n              // Use a unique identifier from the row if available, otherwise fall back to rowIndex\r\n              const rowKey = row.id !== undefined ? `row-${row.id}` : rowIndex;\r\n              const rowId = String(row.id || row.Id);\r\n              \r\n              return (\r\n              <div\r\n                key={rowKey}\r\n                className={`avakio-datatable-row ${\r\n                  selectedRows.has(rowIndex) ? 'selected' : ''\r\n                } ${hover ? 'hover' : ''}`}\r\n                style={{ height: `${rowHeight}px` }}\r\n                onClick={(e) => handleRowClick(row, rowIndex, e)}\r\n                onDoubleClick={() => handleRowDoubleClick(row, rowIndex)}\r\n              >\r\n                {visibleColumns.map((column) => {\r\n                  const cellKey = `${rowId}-${column.id}`;\r\n                  const spanInfo = spanMap.get(cellKey);\r\n                  \r\n                  // Skip cells that are covered by a span\r\n                  if (spanInfo && spanInfo.skip) {\r\n                    return null;\r\n                  }\r\n                  \r\n                  const cellClasses = [\r\n                    'avakio-datatable-cell',\r\n                    column.cssClass || '',\r\n                    spanInfo?.cssClass || ''\r\n                  ].filter(Boolean).join(' ');\r\n                  \r\n                  return (\r\n                    <div\r\n                      key={column.id}\r\n                      className={cellClasses}\r\n                      style={{\r\n                        width: getColumnWidth(column),\r\n                        minWidth: column.minWidth ? `${column.minWidth}px` : undefined,\r\n                        maxWidth: column.maxWidth ? `${column.maxWidth}px` : undefined,\r\n                        textAlign: column.align || 'left',\r\n                      }}\r\n                      {...(spanInfo?.colspan && spanInfo.colspan > 1 ? { 'data-colspan': spanInfo.colspan } : {})}\r\n                      {...(spanInfo?.rowspan && spanInfo.rowspan > 1 ? { 'data-rowspan': spanInfo.rowspan } : {})}\r\n                    >\r\n                      {spanInfo?.value !== undefined ? spanInfo.value : renderCell(column, row)}\r\n                    </div>\r\n                  );\r\n                })}\r\n              </div>\r\n              );\r\n            })}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Footer with Pagination */}\r\n      {paging && !loading && paginatedData.length > 0 && (\r\n        <div className=\"avakio-datatable-footer\">\r\n          <div className=\"avakio-datatable-footer-info\">\r\n            Showing {(page - 1) * localPageSize + 1} to{' '}\r\n            {Math.min(page * localPageSize, totalCount || sortedData.length)} of{' '}\r\n            {totalCount || sortedData.length} records\r\n          </div>\r\n          <div className=\"avakio-datatable-pagination\">\r\n            <Select\r\n              value={String(localPageSize)}\r\n              onValueChange={(value) => {\r\n                const newPageSize = Number(value);\r\n                setLocalPageSize(newPageSize);\r\n                setPage(1);\r\n                if (serverSide && onPageSizeChange) {\r\n                  onPageSizeChange(newPageSize);\r\n                }\r\n              }}\r\n            >\r\n              <SelectTrigger className=\"avakio-datatable-page-size-select\">\r\n                <SelectValue />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                <SelectItem value=\"10\">10 / page</SelectItem>\r\n                <SelectItem value=\"20\">20 / page</SelectItem>\r\n                <SelectItem value=\"50\">50 / page</SelectItem>\r\n                <SelectItem value=\"100\">100 / page</SelectItem>\r\n              </SelectContent>\r\n            </Select>\r\n\r\n            <div className=\"avakio-datatable-pagination-controls\">\r\n              <Button\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                onClick={() => {\r\n                  const newPage = Math.max(1, page - 1);\r\n                  setPage(newPage);\r\n                  onPageChange?.(newPage);\r\n                }}\r\n                disabled={page === 1}\r\n              >\r\n                <ChevronLeft className=\"h-4 w-4\" />\r\n              </Button>\r\n\r\n              <span className=\"avakio-datatable-page-info\">\r\n                Page {page} of {totalPages}\r\n              </span>\r\n\r\n              <Button\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                onClick={() => {\r\n                  const newPage = Math.min(totalPages, page + 1);\r\n                  setPage(newPage);\r\n                  onPageChange?.(newPage);\r\n                }}\r\n                disabled={page === totalPages}\r\n              >\r\n                <ChevronRight className=\"h-4 w-4\" />\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default AvakioDataTable;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React from \"react\";\r\nimport \"./avakio-timeline.css\";\r\n\r\nexport type AvakioTimelineItem = {\r\n  id: string | number;\r\n  title: string;\r\n  subtitle?: string;\r\n  description?: string;\r\n  meta?: string;\r\n  date?: string;\r\n  time?: string;\r\n  status?: \"success\" | \"warning\" | \"danger\" | \"info\" | \"neutral\" | string;\r\n  color?: string;\r\n};\r\n\r\nexport type AvakioTimelineProps = {\r\n  items: AvakioTimelineItem[];\r\n  theme?: string;\r\n  onItemClick?: (item: AvakioTimelineItem) => void;\r\n  className?: string;\r\n  style?: React.CSSProperties;\r\n  dense?: boolean;\r\n  orientation?: \"vertical\" | \"horizontal\";\r\n  variant?: \"default\" | \"split\" | \"colorband\";\r\n};\r\n\r\nexport function AvakioTimeline({\r\n  items,\r\n  theme,\r\n  onItemClick,\r\n  className,\r\n  style,\r\n  dense,\r\n  orientation = \"vertical\",\r\n  variant = \"default\",\r\n}: AvakioTimelineProps) {\r\n  const rootClasses = [\"avakio-timeline\", dense ? \"is-dense\" : \"\", className || \"\"].filter(Boolean);\r\n  if (orientation === \"horizontal\") rootClasses.push(\"is-horizontal\");\r\n  if (orientation === \"vertical\" && variant === \"split\") rootClasses.push(\"is-vertical-split\");\r\n  if (orientation === \"horizontal\" && variant === \"colorband\") rootClasses.push(\"is-horizontal-colorband\");\r\n\r\n  const vertical = (\r\n    <div\r\n      className={rootClasses.join(\" \").trim()}\r\n      data-admin-theme={theme}\r\n      style={style}\r\n    >\r\n      {items.map((item, idx) => {\r\n        const isLast = idx === items.length - 1;\r\n        const dotClass = item.status ? `av-tl-dot-${item.status}` : \"\";\r\n        const showDateInCard = variant === \"split\";\r\n        const leftLabel = showDateInCard ? undefined : item.date || item.meta || item.time;\r\n        const showConnector = true;\r\n        const clickable = Boolean(onItemClick);\r\n        const handleClick = () => onItemClick?.(item);\r\n        const handleKey = (e: React.KeyboardEvent<HTMLDivElement>) => {\r\n          if (!onItemClick) return;\r\n          if (e.key === \"Enter\" || e.key === \" \") {\r\n            e.preventDefault();\r\n            onItemClick(item);\r\n          }\r\n        };\r\n        return (\r\n          <div\r\n            key={item.id}\r\n            className={[\"av-tl-row\", clickable ? \"is-clickable\" : \"\"].join(\" \").trim()}\r\n            onClick={handleClick}\r\n            role={clickable ? \"button\" : undefined}\r\n            tabIndex={clickable ? 0 : undefined}\r\n            onKeyDown={handleKey}\r\n          >\r\n            <div className=\"av-tl-date\">{leftLabel}</div>\r\n            <div className={[\"av-tl-marker\", isLast ? \"is-last\" : \"\"].join(\" \").trim()}>\r\n              <span\r\n                className={[\"av-tl-dot\", dotClass].join(\" \").trim()}\r\n                style={item.color ? { background: item.color, boxShadow: `0 0 0 3px ${item.color}1a` } : undefined}\r\n              >\r\n                {variant === \"split\" ? item.id : undefined}\r\n              </span>\r\n              {!isLast && showConnector && <span className=\"av-tl-line\" />}\r\n            </div>\r\n            <div className=\"av-tl-card\">\r\n              <div className=\"av-tl-card-head\">\r\n                {showDateInCard && item.date && <div className=\"av-tl-date-inline\">{item.date}</div>}\r\n                <div className=\"av-tl-title\">{item.title}</div>\r\n              </div>\r\n              {item.subtitle && <div className=\"av-tl-subtitle\">{item.subtitle}</div>}\r\n              {item.description && <div className=\"av-tl-desc\">{item.description}</div>}\r\n            </div>\r\n          </div>\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n\r\n  const horizontal = (\r\n    <div\r\n      className={rootClasses.join(\" \").trim()}\r\n      data-admin-theme={theme}\r\n      style={style}\r\n    >\r\n      <div className=\"av-tl-h-track\">\r\n        {items.map((item, idx) => {\r\n          const isFirst = idx === 0;\r\n          const isLast = idx === items.length - 1;\r\n          const dotClass = item.status ? `av-tl-dot-${item.status}` : \"\";\r\n          const isColorBand = variant === \"colorband\";\r\n          const topLabel = isColorBand ? undefined : item.date || item.meta || item.time;\r\n          const clickable = Boolean(onItemClick);\r\n          const handleClick = () => onItemClick?.(item);\r\n          const handleKey = (e: React.KeyboardEvent<HTMLDivElement>) => {\r\n            if (!onItemClick) return;\r\n            if (e.key === \"Enter\" || e.key === \" \") {\r\n              e.preventDefault();\r\n              onItemClick(item);\r\n            }\r\n          };\r\n          const positionClass = isColorBand ? (idx % 2 === 0 ? \"is-top\" : \"is-bottom\") : \"\";\r\n          return (\r\n            <div\r\n              key={item.id}\r\n              className={[\"av-tl-h-item\", isFirst ? \"is-first\" : \"\", isLast ? \"is-last\" : \"\", clickable ? \"is-clickable\" : \"\", positionClass].join(\" \").trim()}\r\n              onClick={handleClick}\r\n              role={clickable ? \"button\" : undefined}\r\n              tabIndex={clickable ? 0 : undefined}\r\n              onKeyDown={handleKey}\r\n            >\r\n              {!isColorBand && <div className=\"av-tl-h-date\">{topLabel}</div>}\r\n              <div className={[\"av-tl-h-dotwrap\", isFirst ? \"is-first\" : \"\", isLast ? \"is-last\" : \"\"].join(\" \").trim()}>\r\n                <span className={[\"av-tl-dot\", dotClass].join(\" \").trim()} style={item.color ? { background: item.color, boxShadow: `0 0 0 3px ${item.color}1a` } : undefined} />\r\n              </div>\r\n              <div className=\"av-tl-h-card\">\r\n                {isColorBand && item.date && <div className=\"av-tl-h-date-inline\">{item.date}</div>}\r\n                <div className=\"av-tl-h-title\">{item.title}</div>\r\n                {item.description && <div className=\"av-tl-h-desc\">{item.description}</div>}\r\n              </div>\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  return orientation === \"horizontal\" ? horizontal : vertical;\r\n}\r\n\r\nexport default AvakioTimeline;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { forwardRef, useImperativeHandle, useState, useRef, useEffect, useCallback, useId } from 'react';\r\nimport './avakio-tree.css';\r\nimport { ChevronRight, ChevronDown, Folder, FolderOpen, File, Check, Minus } from 'lucide-react';\r\n\r\nexport type AvakioTreeTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\n\r\nexport interface AvakioTreeNode {\r\n  /** Unique identifier for the node */\r\n  id: string | number;\r\n  /** Display value/label for the node */\r\n  value: string;\r\n  /** Optional icon for the node */\r\n  icon?: React.ReactNode;\r\n  /** Optional icon when node is open (for branches) */\r\n  openIcon?: React.ReactNode;\r\n  /** Children nodes (makes this a branch) */\r\n  data?: AvakioTreeNode[];\r\n  /** Whether the branch is initially open */\r\n  open?: boolean;\r\n  /** Whether this node is disabled */\r\n  disabled?: boolean;\r\n  /** Whether this node has checkbox checked (for three-state checkbox) */\r\n  checked?: boolean | 'indeterminate';\r\n  /** Custom CSS class for this node */\r\n  css?: string;\r\n  /** Tooltip for this node */\r\n  tooltip?: string;\r\n  /** Any additional custom data */\r\n  [key: string]: any;\r\n}\r\n\r\nexport interface AvakioTreeProps {\r\n  /** Unique identifier */\r\n  id?: string;\r\n  /** Test ID for testing */\r\n  testId?: string;\r\n  /** Tree data */\r\n  data: AvakioTreeNode[];\r\n  /** Enable selection */\r\n  select?: boolean | 'multi';\r\n  /** Enable checkboxes */\r\n  checkbox?: boolean;\r\n  /** Enable three-state checkboxes (parent reflects children state) */\r\n  threeState?: boolean;\r\n  /** Show folder/file icons */\r\n  showIcons?: boolean;\r\n  /** Show branch toggle icons */\r\n  showToggle?: boolean;\r\n  /** Show connecting lines between nodes */\r\n  showLines?: boolean;\r\n  /** Enable keyboard navigation */\r\n  navigation?: boolean;\r\n  /** Enable drag and drop */\r\n  drag?: boolean;\r\n  /** Allow editing node values inline */\r\n  editable?: boolean;\r\n  /** Theme */\r\n  theme?: AvakioTreeTheme;\r\n  /** Filter function */\r\n  filterMode?: {\r\n    showSubItems?: boolean;\r\n    openParents?: boolean;\r\n    level?: number;\r\n  };\r\n  /** Height of each tree item */\r\n  itemHeight?: number;\r\n  /** Width */\r\n  width?: number | string;\r\n  /** Height */\r\n  height?: number | string;\r\n  /** CSS class */\r\n  className?: string;\r\n  /** Inline styles */\r\n  style?: React.CSSProperties;\r\n  /** Callback when node is selected */\r\n  onSelect?: (id: string | number, node: AvakioTreeNode) => void;\r\n  /** Callback when selection changes (for multi-select) */\r\n  onSelectChange?: (ids: (string | number)[]) => void;\r\n  /** Callback when node is clicked */\r\n  onClick?: (id: string | number, node: AvakioTreeNode, e: React.MouseEvent) => void;\r\n  /** Callback when node is double-clicked */\r\n  onDblClick?: (id: string | number, node: AvakioTreeNode, e: React.MouseEvent) => void;\r\n  /** Callback when branch opens */\r\n  onOpen?: (id: string | number, node: AvakioTreeNode) => void;\r\n  /** Callback when branch closes */\r\n  onClose?: (id: string | number, node: AvakioTreeNode) => void;\r\n  /** Callback when checkbox state changes */\r\n  onCheck?: (id: string | number, checked: boolean | 'indeterminate', node: AvakioTreeNode) => void;\r\n  /** Callback when node is edited */\r\n  onEdit?: (id: string | number, newValue: string, node: AvakioTreeNode) => void;\r\n  /** Callback on context menu */\r\n  onContext?: (id: string | number, node: AvakioTreeNode, e: React.MouseEvent) => void;\r\n}\r\n\r\nexport interface AvakioTreeRef {\r\n  /** Get the selected node ID */\r\n  getSelectedId: () => string | number | null;\r\n  /** Get multiple selected IDs */\r\n  getSelectedIds: () => (string | number)[];\r\n  /** Select a node by ID */\r\n  select: (id: string | number) => void;\r\n  /** Unselect a node */\r\n  unselect: (id?: string | number) => void;\r\n  /** Open a branch */\r\n  open: (id: string | number) => void;\r\n  /** Close a branch */\r\n  close: (id: string | number) => void;\r\n  /** Open all branches */\r\n  openAll: () => void;\r\n  /** Close all branches */\r\n  closeAll: () => void;\r\n  /** Check a node */\r\n  checkItem: (id: string | number) => void;\r\n  /** Uncheck a node */\r\n  uncheckItem: (id: string | number) => void;\r\n  /** Check all items */\r\n  checkAll: () => void;\r\n  /** Uncheck all items */\r\n  uncheckAll: () => void;\r\n  /** Get checked item IDs */\r\n  getChecked: () => (string | number)[];\r\n  /** Is node checked */\r\n  isChecked: (id: string | number) => boolean | 'indeterminate';\r\n  /** Is branch open */\r\n  isBranchOpen: (id: string | number) => boolean;\r\n  /** Check if node is a branch */\r\n  isBranch: (id: string | number) => boolean;\r\n  /** Get node by ID */\r\n  getItem: (id: string | number) => AvakioTreeNode | undefined;\r\n  /** Get parent ID */\r\n  getParentId: (id: string | number) => string | number | null;\r\n  /** Filter tree */\r\n  filter: (fn: (node: AvakioTreeNode) => boolean) => void;\r\n  /** Clear filter */\r\n  clearFilter: () => void;\r\n  /** Refresh the tree */\r\n  refresh: () => void;\r\n  /** Focus the tree */\r\n  focus: () => void;\r\n  /** Get the HTML container */\r\n  getNode: () => HTMLDivElement | null;\r\n  /** Scroll to make an item visible */\r\n  showItem: (id: string | number) => void;\r\n}\r\n\r\n// Build a flat lookup map from the tree data\r\nfunction buildNodeMap(\r\n  nodes: AvakioTreeNode[],\r\n  map: Map<string | number, { node: AvakioTreeNode; parentId: string | number | null; depth: number }>,\r\n  parentId: string | number | null = null,\r\n  depth: number = 0\r\n) {\r\n  nodes.forEach((node) => {\r\n    map.set(node.id, { node, parentId, depth });\r\n    if (node.data && node.data.length > 0) {\r\n      buildNodeMap(node.data, map, node.id, depth + 1);\r\n    }\r\n  });\r\n}\r\n\r\n// Get all descendant IDs of a node\r\nfunction getDescendantIds(node: AvakioTreeNode): (string | number)[] {\r\n  const ids: (string | number)[] = [];\r\n  if (node.data) {\r\n    node.data.forEach((child) => {\r\n      ids.push(child.id);\r\n      ids.push(...getDescendantIds(child));\r\n    });\r\n  }\r\n  return ids;\r\n}\r\n\r\n// Get all node IDs\r\nfunction getAllNodeIds(nodes: AvakioTreeNode[]): (string | number)[] {\r\n  const ids: (string | number)[] = [];\r\n  nodes.forEach((node) => {\r\n    ids.push(node.id);\r\n    if (node.data) {\r\n      ids.push(...getAllNodeIds(node.data));\r\n    }\r\n  });\r\n  return ids;\r\n}\r\n\r\nexport const AvakioTree = forwardRef<AvakioTreeRef, AvakioTreeProps>(\r\n  (\r\n    {\r\n      id,\r\n      testId,\r\n      data,\r\n      select = true,\r\n      checkbox = false,\r\n      threeState = false,\r\n      showIcons = true,\r\n      showToggle = true,\r\n      showLines = false,\r\n      navigation = true,\r\n      drag = false,\r\n      editable = false,\r\n      theme,\r\n      filterMode,\r\n      itemHeight = 32,\r\n      width,\r\n      height,\r\n      className = '',\r\n      style,\r\n      onSelect,\r\n      onSelectChange,\r\n      onClick,\r\n      onDblClick,\r\n      onOpen,\r\n      onClose,\r\n      onCheck,\r\n      onEdit,\r\n      onContext,\r\n    },\r\n    ref\r\n  ) => {\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n    const autoId = useId();\r\n    const treeId = id || `avakio-tree-${autoId}`;\r\n\r\n    // State\r\n    const [selectedIds, setSelectedIds] = useState<Set<string | number>>(new Set());\r\n    const [openIds, setOpenIds] = useState<Set<string | number>>(() => {\r\n      // Initialize with initially open nodes\r\n      const initialOpen = new Set<string | number>();\r\n      const collectOpen = (nodes: AvakioTreeNode[]) => {\r\n        nodes.forEach((node) => {\r\n          if (node.open) {\r\n            initialOpen.add(node.id);\r\n          }\r\n          if (node.data) {\r\n            collectOpen(node.data);\r\n          }\r\n        });\r\n      };\r\n      collectOpen(data);\r\n      return initialOpen;\r\n    });\r\n    const [checkedIds, setCheckedIds] = useState<Set<string | number>>(() => {\r\n      // Initialize with initially checked nodes\r\n      const initialChecked = new Set<string | number>();\r\n      const collectChecked = (nodes: AvakioTreeNode[]) => {\r\n        nodes.forEach((node) => {\r\n          if (node.checked === true) {\r\n            initialChecked.add(node.id);\r\n          }\r\n          if (node.data) {\r\n            collectChecked(node.data);\r\n          }\r\n        });\r\n      };\r\n      collectChecked(data);\r\n      return initialChecked;\r\n    });\r\n    const [focusedId, setFocusedId] = useState<string | number | null>(null);\r\n    const [editingId, setEditingId] = useState<string | number | null>(null);\r\n    const [editValue, setEditValue] = useState<string>('');\r\n    const [filterFn, setFilterFn] = useState<((node: AvakioTreeNode) => boolean) | null>(null);\r\n    const [, forceUpdate] = useState({});\r\n\r\n    // Build node lookup map\r\n    const nodeMap = useRef(new Map<string | number, { node: AvakioTreeNode; parentId: string | number | null; depth: number }>());\r\n    useEffect(() => {\r\n      nodeMap.current.clear();\r\n      buildNodeMap(data, nodeMap.current);\r\n    }, [data]);\r\n\r\n    // Compute three-state checkbox status\r\n    const getCheckState = useCallback(\r\n      (nodeId: string | number): boolean | 'indeterminate' => {\r\n        if (!threeState) {\r\n          return checkedIds.has(nodeId);\r\n        }\r\n        \r\n        const entry = nodeMap.current.get(nodeId);\r\n        if (!entry) return false;\r\n        \r\n        const { node } = entry;\r\n        if (!node.data || node.data.length === 0) {\r\n          return checkedIds.has(nodeId);\r\n        }\r\n        \r\n        // Check children recursively\r\n        const descendantIds = getDescendantIds(node);\r\n        const checkedCount = descendantIds.filter((id) => checkedIds.has(id)).length;\r\n        \r\n        if (checkedCount === 0) return false;\r\n        if (checkedCount === descendantIds.length) return true;\r\n        return 'indeterminate';\r\n      },\r\n      [checkedIds, threeState]\r\n    );\r\n\r\n    // Handle checkbox toggle with three-state propagation\r\n    const handleCheckToggle = useCallback(\r\n      (nodeId: string | number) => {\r\n        const entry = nodeMap.current.get(nodeId);\r\n        if (!entry) return;\r\n        \r\n        const currentState = getCheckState(nodeId);\r\n        const newChecked = currentState !== true;\r\n        \r\n        setCheckedIds((prev) => {\r\n          const next = new Set(prev);\r\n          \r\n          if (threeState) {\r\n            // Update this node and all descendants\r\n            const { node } = entry;\r\n            const descendantIds = getDescendantIds(node);\r\n            \r\n            if (newChecked) {\r\n              next.add(nodeId);\r\n              descendantIds.forEach((id) => next.add(id));\r\n            } else {\r\n              next.delete(nodeId);\r\n              descendantIds.forEach((id) => next.delete(id));\r\n            }\r\n            \r\n            // Update ancestors\r\n            let parentId = entry.parentId;\r\n            while (parentId !== null) {\r\n              const parentEntry = nodeMap.current.get(parentId);\r\n              if (!parentEntry) break;\r\n              \r\n              const parentNode = parentEntry.node;\r\n              if (parentNode.data) {\r\n                const childIds = parentNode.data.map((c) => c.id);\r\n                const allChecked = childIds.every((id) => next.has(id));\r\n                const anyChecked = childIds.some((id) => next.has(id));\r\n                \r\n                if (allChecked) {\r\n                  next.add(parentId);\r\n                } else {\r\n                  next.delete(parentId);\r\n                }\r\n              }\r\n              \r\n              parentId = parentEntry.parentId;\r\n            }\r\n          } else {\r\n            if (newChecked) {\r\n              next.add(nodeId);\r\n            } else {\r\n              next.delete(nodeId);\r\n            }\r\n          }\r\n          \r\n          return next;\r\n        });\r\n        \r\n        onCheck?.(nodeId, newChecked, entry.node);\r\n      },\r\n      [threeState, getCheckState, onCheck]\r\n    );\r\n\r\n    // Handle selection\r\n    const handleSelect = useCallback(\r\n      (nodeId: string | number, e?: React.MouseEvent) => {\r\n        const entry = nodeMap.current.get(nodeId);\r\n        if (!entry || entry.node.disabled) return;\r\n        \r\n        if (select === 'multi' && e?.ctrlKey) {\r\n          setSelectedIds((prev) => {\r\n            const next = new Set(prev);\r\n            if (next.has(nodeId)) {\r\n              next.delete(nodeId);\r\n            } else {\r\n              next.add(nodeId);\r\n            }\r\n            onSelectChange?.(Array.from(next));\r\n            return next;\r\n          });\r\n        } else if (select) {\r\n          setSelectedIds(new Set([nodeId]));\r\n          onSelect?.(nodeId, entry.node);\r\n          onSelectChange?.([nodeId]);\r\n        }\r\n        \r\n        setFocusedId(nodeId);\r\n      },\r\n      [select, onSelect, onSelectChange]\r\n    );\r\n\r\n    // Handle toggle branch\r\n    const handleToggle = useCallback(\r\n      (nodeId: string | number, e?: React.MouseEvent) => {\r\n        e?.stopPropagation();\r\n        const entry = nodeMap.current.get(nodeId);\r\n        if (!entry || !entry.node.data) return;\r\n        \r\n        setOpenIds((prev) => {\r\n          const next = new Set(prev);\r\n          if (next.has(nodeId)) {\r\n            next.delete(nodeId);\r\n            onClose?.(nodeId, entry.node);\r\n          } else {\r\n            next.add(nodeId);\r\n            onOpen?.(nodeId, entry.node);\r\n          }\r\n          return next;\r\n        });\r\n      },\r\n      [onOpen, onClose]\r\n    );\r\n\r\n    // Handle node click\r\n    const handleNodeClick = useCallback(\r\n      (nodeId: string | number, e: React.MouseEvent) => {\r\n        const entry = nodeMap.current.get(nodeId);\r\n        if (!entry) return;\r\n        \r\n        handleSelect(nodeId, e);\r\n        onClick?.(nodeId, entry.node, e);\r\n      },\r\n      [handleSelect, onClick]\r\n    );\r\n\r\n    // Handle double click\r\n    const handleNodeDblClick = useCallback(\r\n      (nodeId: string | number, e: React.MouseEvent) => {\r\n        const entry = nodeMap.current.get(nodeId);\r\n        if (!entry) return;\r\n        \r\n        if (editable && !entry.node.disabled) {\r\n          setEditingId(nodeId);\r\n          setEditValue(entry.node.value);\r\n        } else if (entry.node.data) {\r\n          handleToggle(nodeId, e);\r\n        }\r\n        \r\n        onDblClick?.(nodeId, entry.node, e);\r\n      },\r\n      [editable, handleToggle, onDblClick]\r\n    );\r\n\r\n    // Handle edit submit\r\n    const handleEditSubmit = useCallback(\r\n      (nodeId: string | number) => {\r\n        const entry = nodeMap.current.get(nodeId);\r\n        if (entry && editValue !== entry.node.value) {\r\n          onEdit?.(nodeId, editValue, entry.node);\r\n        }\r\n        setEditingId(null);\r\n        setEditValue('');\r\n      },\r\n      [editValue, onEdit]\r\n    );\r\n\r\n    // Handle context menu\r\n    const handleContextMenu = useCallback(\r\n      (nodeId: string | number, e: React.MouseEvent) => {\r\n        const entry = nodeMap.current.get(nodeId);\r\n        if (entry && onContext) {\r\n          e.preventDefault();\r\n          onContext(nodeId, entry.node, e);\r\n        }\r\n      },\r\n      [onContext]\r\n    );\r\n\r\n    // Keyboard navigation\r\n    const handleKeyDown = useCallback(\r\n      (e: React.KeyboardEvent) => {\r\n        if (!navigation || focusedId === null) return;\r\n        \r\n        const allIds = getAllNodeIds(data);\r\n        const visibleIds = allIds.filter((nodeId) => {\r\n          const entry = nodeMap.current.get(nodeId);\r\n          if (!entry) return false;\r\n          \r\n          // Check if all ancestors are open\r\n          let parentId = entry.parentId;\r\n          while (parentId !== null) {\r\n            if (!openIds.has(parentId)) return false;\r\n            const parentEntry = nodeMap.current.get(parentId);\r\n            if (!parentEntry) return false;\r\n            parentId = parentEntry.parentId;\r\n          }\r\n          return true;\r\n        });\r\n        \r\n        const currentIndex = visibleIds.indexOf(focusedId);\r\n        \r\n        switch (e.key) {\r\n          case 'ArrowDown':\r\n            e.preventDefault();\r\n            if (currentIndex < visibleIds.length - 1) {\r\n              setFocusedId(visibleIds[currentIndex + 1]);\r\n            }\r\n            break;\r\n          case 'ArrowUp':\r\n            e.preventDefault();\r\n            if (currentIndex > 0) {\r\n              setFocusedId(visibleIds[currentIndex - 1]);\r\n            }\r\n            break;\r\n          case 'ArrowRight': {\r\n            e.preventDefault();\r\n            const entry = nodeMap.current.get(focusedId);\r\n            if (entry?.node.data) {\r\n              if (!openIds.has(focusedId)) {\r\n                handleToggle(focusedId);\r\n              } else if (entry.node.data.length > 0) {\r\n                setFocusedId(entry.node.data[0].id);\r\n              }\r\n            }\r\n            break;\r\n          }\r\n          case 'ArrowLeft': {\r\n            e.preventDefault();\r\n            const entry = nodeMap.current.get(focusedId);\r\n            if (entry) {\r\n              if (openIds.has(focusedId) && entry.node.data) {\r\n                handleToggle(focusedId);\r\n              } else if (entry.parentId !== null) {\r\n                setFocusedId(entry.parentId);\r\n              }\r\n            }\r\n            break;\r\n          }\r\n          case 'Enter':\r\n          case ' ':\r\n            e.preventDefault();\r\n            if (checkbox) {\r\n              handleCheckToggle(focusedId);\r\n            } else {\r\n              handleSelect(focusedId);\r\n            }\r\n            break;\r\n          case 'Home':\r\n            e.preventDefault();\r\n            if (visibleIds.length > 0) {\r\n              setFocusedId(visibleIds[0]);\r\n            }\r\n            break;\r\n          case 'End':\r\n            e.preventDefault();\r\n            if (visibleIds.length > 0) {\r\n              setFocusedId(visibleIds[visibleIds.length - 1]);\r\n            }\r\n            break;\r\n        }\r\n      },\r\n      [navigation, focusedId, data, openIds, checkbox, handleToggle, handleCheckToggle, handleSelect]\r\n    );\r\n\r\n    // Imperative handle\r\n    useImperativeHandle(ref, () => ({\r\n      getSelectedId: () => (selectedIds.size > 0 ? Array.from(selectedIds)[0] : null),\r\n      getSelectedIds: () => Array.from(selectedIds),\r\n      select: (nodeId) => handleSelect(nodeId),\r\n      unselect: (nodeId) => {\r\n        if (nodeId) {\r\n          setSelectedIds((prev) => {\r\n            const next = new Set(prev);\r\n            next.delete(nodeId);\r\n            return next;\r\n          });\r\n        } else {\r\n          setSelectedIds(new Set());\r\n        }\r\n      },\r\n      open: (nodeId) => {\r\n        setOpenIds((prev) => new Set(prev).add(nodeId));\r\n        const entry = nodeMap.current.get(nodeId);\r\n        if (entry) onOpen?.(nodeId, entry.node);\r\n      },\r\n      close: (nodeId) => {\r\n        setOpenIds((prev) => {\r\n          const next = new Set(prev);\r\n          next.delete(nodeId);\r\n          return next;\r\n        });\r\n        const entry = nodeMap.current.get(nodeId);\r\n        if (entry) onClose?.(nodeId, entry.node);\r\n      },\r\n      openAll: () => {\r\n        const allBranchIds = getAllNodeIds(data).filter((nodeId) => {\r\n          const entry = nodeMap.current.get(nodeId);\r\n          return entry?.node.data && entry.node.data.length > 0;\r\n        });\r\n        setOpenIds(new Set(allBranchIds));\r\n      },\r\n      closeAll: () => setOpenIds(new Set()),\r\n      checkItem: (nodeId) => {\r\n        if (!checkedIds.has(nodeId)) {\r\n          handleCheckToggle(nodeId);\r\n        }\r\n      },\r\n      uncheckItem: (nodeId) => {\r\n        if (checkedIds.has(nodeId)) {\r\n          handleCheckToggle(nodeId);\r\n        }\r\n      },\r\n      checkAll: () => {\r\n        const allIds = getAllNodeIds(data);\r\n        setCheckedIds(new Set(allIds));\r\n      },\r\n      uncheckAll: () => setCheckedIds(new Set()),\r\n      getChecked: () => Array.from(checkedIds),\r\n      isChecked: (nodeId) => getCheckState(nodeId),\r\n      isBranchOpen: (nodeId) => openIds.has(nodeId),\r\n      isBranch: (nodeId) => {\r\n        const entry = nodeMap.current.get(nodeId);\r\n        return entry?.node.data !== undefined && entry.node.data.length > 0;\r\n      },\r\n      getItem: (nodeId) => nodeMap.current.get(nodeId)?.node,\r\n      getParentId: (nodeId) => nodeMap.current.get(nodeId)?.parentId ?? null,\r\n      filter: (fn) => setFilterFn(() => fn),\r\n      clearFilter: () => setFilterFn(null),\r\n      refresh: () => forceUpdate({}),\r\n      focus: () => containerRef.current?.focus(),\r\n      getNode: () => containerRef.current,\r\n      showItem: (nodeId) => {\r\n        // Open all ancestors\r\n        let parentId = nodeMap.current.get(nodeId)?.parentId ?? null;\r\n        const toOpen: (string | number)[] = [];\r\n        while (parentId !== null) {\r\n          toOpen.push(parentId);\r\n          parentId = nodeMap.current.get(parentId)?.parentId ?? null;\r\n        }\r\n        setOpenIds((prev) => {\r\n          const next = new Set(prev);\r\n          toOpen.forEach((id) => next.add(id));\r\n          return next;\r\n        });\r\n        \r\n        // Scroll into view after state update\r\n        setTimeout(() => {\r\n          const element = containerRef.current?.querySelector(`[data-node-id=\"${nodeId}\"]`);\r\n          element?.scrollIntoView({ behavior: 'smooth', block: 'nearest' });\r\n        }, 50);\r\n      },\r\n    }));\r\n\r\n    // Render a tree node recursively\r\n    const renderNode = (node: AvakioTreeNode, depth: number = 0): React.ReactNode => {\r\n      const isBranch = node.data && node.data.length > 0;\r\n      const isOpen = openIds.has(node.id);\r\n      const isSelected = selectedIds.has(node.id);\r\n      const isFocused = focusedId === node.id;\r\n      const isEditing = editingId === node.id;\r\n      const checkState = checkbox ? getCheckState(node.id) : false;\r\n      \r\n      // Apply filter\r\n      if (filterFn && !filterFn(node)) {\r\n        // Check if any descendants match\r\n        if (!node.data?.some((child) => filterFn(child) || getDescendantIds(child).some((id) => {\r\n          const entry = nodeMap.current.get(id);\r\n          return entry && filterFn(entry.node);\r\n        }))) {\r\n          return null;\r\n        }\r\n      }\r\n\r\n      const nodeClasses = [\r\n        'avakio-tree-node',\r\n        isSelected && 'avakio-tree-node--selected',\r\n        isFocused && 'avakio-tree-node--focused',\r\n        node.disabled && 'avakio-tree-node--disabled',\r\n        isBranch && 'avakio-tree-node--branch',\r\n        node.css,\r\n      ].filter(Boolean).join(' ');\r\n\r\n      const indent = depth * 20;\r\n\r\n      return (\r\n        <div key={node.id} className=\"avakio-tree-node-wrapper\">\r\n          <div\r\n            className={nodeClasses}\r\n            data-node-id={node.id}\r\n            style={{ \r\n              paddingLeft: indent + 8,\r\n              height: itemHeight,\r\n            }}\r\n            onClick={(e) => handleNodeClick(node.id, e)}\r\n            onDoubleClick={(e) => handleNodeDblClick(node.id, e)}\r\n            onContextMenu={(e) => handleContextMenu(node.id, e)}\r\n            title={node.tooltip}\r\n            role=\"treeitem\"\r\n            aria-selected={isSelected}\r\n            aria-expanded={isBranch ? isOpen : undefined}\r\n            tabIndex={isFocused ? 0 : -1}\r\n          >\r\n            {/* Toggle icon */}\r\n            {showToggle && (\r\n              <span\r\n                className={`avakio-tree-toggle ${isBranch ? 'avakio-tree-toggle--visible' : ''}`}\r\n                onClick={(e) => isBranch && handleToggle(node.id, e)}\r\n              >\r\n                {isBranch ? (\r\n                  isOpen ? <ChevronDown size={16} /> : <ChevronRight size={16} />\r\n                ) : null}\r\n              </span>\r\n            )}\r\n\r\n            {/* Checkbox */}\r\n            {checkbox && (\r\n              <span\r\n                className={`avakio-tree-checkbox ${checkState === true ? 'avakio-tree-checkbox--checked' : ''} ${checkState === 'indeterminate' ? 'avakio-tree-checkbox--indeterminate' : ''}`}\r\n                onClick={(e) => {\r\n                  e.stopPropagation();\r\n                  if (!node.disabled) handleCheckToggle(node.id);\r\n                }}\r\n              >\r\n                {checkState === true && <Check size={12} />}\r\n                {checkState === 'indeterminate' && <Minus size={12} />}\r\n              </span>\r\n            )}\r\n\r\n            {/* Icon */}\r\n            {showIcons && (\r\n              <span className=\"avakio-tree-icon\">\r\n                {node.icon ? (\r\n                  isOpen && node.openIcon ? node.openIcon : node.icon\r\n                ) : isBranch ? (\r\n                  isOpen ? <FolderOpen size={16} /> : <Folder size={16} />\r\n                ) : (\r\n                  <File size={16} />\r\n                )}\r\n              </span>\r\n            )}\r\n\r\n            {/* Label */}\r\n            {isEditing ? (\r\n              <input\r\n                type=\"text\"\r\n                className=\"avakio-tree-edit-input\"\r\n                value={editValue}\r\n                onChange={(e) => setEditValue(e.target.value)}\r\n                onBlur={() => handleEditSubmit(node.id)}\r\n                onKeyDown={(e) => {\r\n                  if (e.key === 'Enter') handleEditSubmit(node.id);\r\n                  if (e.key === 'Escape') {\r\n                    setEditingId(null);\r\n                    setEditValue('');\r\n                  }\r\n                }}\r\n                autoFocus\r\n                onClick={(e) => e.stopPropagation()}\r\n              />\r\n            ) : (\r\n              <span className=\"avakio-tree-label\">{node.value}</span>\r\n            )}\r\n          </div>\r\n\r\n          {/* Children */}\r\n          {isBranch && isOpen && (\r\n            <div className={`avakio-tree-children ${showLines ? 'avakio-tree-children--lines' : ''}`}>\r\n              {node.data!.map((child) => renderNode(child, depth + 1))}\r\n            </div>\r\n          )}\r\n        </div>\r\n      );\r\n    };\r\n\r\n    // Detect theme from parent if not provided\r\n    const [detectedTheme, setDetectedTheme] = useState<string>(theme || 'material');\r\n    useEffect(() => {\r\n      if (!theme) {\r\n        const globalTheme = document.documentElement.getAttribute('data-admin-theme');\r\n        if (globalTheme) setDetectedTheme(globalTheme);\r\n\r\n        const observer = new MutationObserver(() => {\r\n          const newTheme = document.documentElement.getAttribute('data-admin-theme');\r\n          if (newTheme) setDetectedTheme(newTheme);\r\n        });\r\n        observer.observe(document.documentElement, {\r\n          attributes: true,\r\n          attributeFilter: ['data-admin-theme'],\r\n        });\r\n        return () => observer.disconnect();\r\n      }\r\n    }, [theme]);\r\n\r\n    const effectiveTheme = theme || detectedTheme;\r\n\r\n    const containerClasses = [\r\n      'avakio-tree',\r\n      `avakio-tree--${effectiveTheme}`,\r\n      showLines && 'avakio-tree--lines',\r\n      className,\r\n    ].filter(Boolean).join(' ');\r\n\r\n    return (\r\n      <div\r\n        ref={containerRef}\r\n        id={treeId}\r\n        data-testid={testId}\r\n        className={containerClasses}\r\n        style={{\r\n          width,\r\n          height,\r\n          ...style,\r\n        }}\r\n        role=\"tree\"\r\n        tabIndex={0}\r\n        onKeyDown={handleKeyDown}\r\n        onFocus={() => {\r\n          if (focusedId === null && data.length > 0) {\r\n            setFocusedId(data[0].id);\r\n          }\r\n        }}\r\n      >\r\n        {data.map((node) => renderNode(node, 0))}\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nAvakioTree.displayName = 'AvakioTree';\r\n\r\nexport default AvakioTree;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { forwardRef, useImperativeHandle, useRef, useState, useCallback, useEffect } from 'react';\r\nimport './avakio-absolute-layout.css';\r\n\r\nexport type AvakioAbsoluteLayoutTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\n\r\n/**\r\n * Cell configuration for AbsoluteLayout\r\n * Each cell can be positioned absolutely using top/left/bottom/right\r\n * or relatively using the relative flag\r\n */\r\nexport interface AvakioAbsoluteLayoutCell {\r\n  /** Unique identifier for the cell */\r\n  id?: string;\r\n  /** The content to render in this cell */\r\n  content: React.ReactNode;\r\n  /** Distance from top of container (px or %) */\r\n  top?: number | string;\r\n  /** Distance from left of container (px or %) */\r\n  left?: number | string;\r\n  /** Distance from bottom of container (px or %) */\r\n  bottom?: number | string;\r\n  /** Distance from right of container (px or %) */\r\n  right?: number | string;\r\n  /** Width of the cell (px or %) */\r\n  width?: number | string;\r\n  /** Height of the cell (px or %) */\r\n  height?: number | string;\r\n  /** Minimum width */\r\n  minWidth?: number | string;\r\n  /** Minimum height */\r\n  minHeight?: number | string;\r\n  /** Maximum width */\r\n  maxWidth?: number | string;\r\n  /** Maximum height */\r\n  maxHeight?: number | string;\r\n  /** If true, the cell takes all available space (like position: relative) */\r\n  relative?: boolean;\r\n  /** CSS class for this cell */\r\n  css?: string;\r\n  /** Z-index for stacking order */\r\n  zIndex?: number;\r\n  /** Whether this cell is hidden */\r\n  hidden?: boolean;\r\n  /** Whether this cell is disabled */\r\n  disabled?: boolean;\r\n  /** Batch name for showing/hiding groups of cells */\r\n  batch?: string;\r\n}\r\n\r\nexport interface AvakioAbsoluteLayoutProps {\r\n  /** Unique identifier */\r\n  id?: string;\r\n  /** Test ID for testing */\r\n  testId?: string;\r\n  /** Theme to apply */\r\n  theme?: AvakioAbsoluteLayoutTheme;\r\n  /** Array of cells with absolute positioning configuration */\r\n  cells: AvakioAbsoluteLayoutCell[];\r\n  /** Width of the layout container */\r\n  width?: number | string;\r\n  /** Height of the layout container */\r\n  height?: number | string;\r\n  /** Minimum width */\r\n  minWidth?: number | string;\r\n  /** Minimum height */\r\n  minHeight?: number | string;\r\n  /** Maximum width */\r\n  maxWidth?: number | string;\r\n  /** Maximum height */\r\n  maxHeight?: number | string;\r\n  /** Whether to remove borders */\r\n  borderless?: boolean;\r\n  /** Custom CSS class */\r\n  css?: string;\r\n  /** Whether the layout is initially hidden */\r\n  hidden?: boolean;\r\n  /** Whether the layout is disabled */\r\n  disabled?: boolean;\r\n  /** Initial visible batch */\r\n  visibleBatch?: string;\r\n  /** Background color */\r\n  background?: string;\r\n  /** Padding inside the container */\r\n  padding?: number | string;\r\n  /** Callback when a cell is clicked */\r\n  onCellClick?: (cellId: string | undefined, cell: AvakioAbsoluteLayoutCell) => void;\r\n  /** Callback when the layout is resized */\r\n  onResize?: (width: number, height: number) => void;\r\n}\r\n\r\nexport interface AvakioAbsoluteLayoutRef {\r\n  /** Add a new cell to the layout */\r\n  addView: (cell: AvakioAbsoluteLayoutCell, index?: number) => void;\r\n  /** Remove a cell by id or index */\r\n  removeView: (idOrIndex: string | number) => void;\r\n  /** Get all child cells */\r\n  getChildViews: () => AvakioAbsoluteLayoutCell[];\r\n  /** Get the DOM node */\r\n  getNode: () => HTMLDivElement | null;\r\n  /** Show the layout */\r\n  show: () => void;\r\n  /** Hide the layout */\r\n  hide: () => void;\r\n  /** Check if visible */\r\n  isVisible: () => boolean;\r\n  /** Enable the layout */\r\n  enable: () => void;\r\n  /** Disable the layout */\r\n  disable: () => void;\r\n  /** Check if enabled */\r\n  isEnabled: () => boolean;\r\n  /** Resize the layout */\r\n  resize: () => void;\r\n  /** Show cells by batch name */\r\n  showBatch: (batchName: string) => void;\r\n  /** Get index of a cell by id */\r\n  index: (cellId: string) => number;\r\n  /** Reconstruct the layout with new cells */\r\n  reconstruct: (cells: AvakioAbsoluteLayoutCell[]) => void;\r\n}\r\n\r\n// Helper to convert number/string to CSS value\r\nconst toCssValue = (value: number | string | undefined): string | undefined => {\r\n  if (value === undefined) return undefined;\r\n  if (typeof value === 'number') return `${value}px`;\r\n  return value;\r\n};\r\n\r\nexport const AvakioAbsoluteLayout = forwardRef<AvakioAbsoluteLayoutRef, AvakioAbsoluteLayoutProps>((props, ref) => {\r\n  const {\r\n    id,\r\n    testId,\r\n    theme = 'material',\r\n    cells: initialCells,\r\n    width,\r\n    height,\r\n    minWidth,\r\n    minHeight,\r\n    maxWidth,\r\n    maxHeight,\r\n    borderless = false,\r\n    css,\r\n    hidden: initialHidden = false,\r\n    disabled: initialDisabled = false,\r\n    visibleBatch: initialVisibleBatch,\r\n    background,\r\n    padding,\r\n    onCellClick,\r\n    onResize,\r\n  } = props;\r\n\r\n  // State\r\n  const [cells, setCells] = useState<AvakioAbsoluteLayoutCell[]>(initialCells);\r\n  const [isHidden, setIsHidden] = useState(initialHidden);\r\n  const [isDisabled, setIsDisabled] = useState(initialDisabled);\r\n  const [visibleBatch, setVisibleBatch] = useState<string | undefined>(initialVisibleBatch);\r\n  \r\n  // Refs\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n  const resizeObserverRef = useRef<ResizeObserver | null>(null);\r\n\r\n  // Update cells when props change\r\n  useEffect(() => {\r\n    setCells(initialCells);\r\n  }, [initialCells]);\r\n\r\n  // Setup resize observer\r\n  useEffect(() => {\r\n    if (!containerRef.current || !onResize) return;\r\n\r\n    resizeObserverRef.current = new ResizeObserver((entries) => {\r\n      for (const entry of entries) {\r\n        const { width, height } = entry.contentRect;\r\n        onResize(width, height);\r\n      }\r\n    });\r\n\r\n    resizeObserverRef.current.observe(containerRef.current);\r\n\r\n    return () => {\r\n      resizeObserverRef.current?.disconnect();\r\n    };\r\n  }, [onResize]);\r\n\r\n  // Handle cell click\r\n  const handleCellClick = useCallback((cell: AvakioAbsoluteLayoutCell) => {\r\n    if (isDisabled || cell.disabled) return;\r\n    onCellClick?.(cell.id, cell);\r\n  }, [isDisabled, onCellClick]);\r\n\r\n  // Check if cell should be visible based on batch\r\n  const isCellVisible = useCallback((cell: AvakioAbsoluteLayoutCell): boolean => {\r\n    if (cell.hidden) return false;\r\n    if (!visibleBatch) return true;\r\n    if (!cell.batch) return true;\r\n    return cell.batch === visibleBatch;\r\n  }, [visibleBatch]);\r\n\r\n  // Imperative handle\r\n  useImperativeHandle(ref, () => ({\r\n    addView: (cell: AvakioAbsoluteLayoutCell, index?: number) => {\r\n      setCells(prev => {\r\n        if (index !== undefined && index >= 0 && index <= prev.length) {\r\n          const newCells = [...prev];\r\n          newCells.splice(index, 0, cell);\r\n          return newCells;\r\n        }\r\n        return [...prev, cell];\r\n      });\r\n    },\r\n    removeView: (idOrIndex: string | number) => {\r\n      setCells(prev => {\r\n        if (typeof idOrIndex === 'number') {\r\n          return prev.filter((_, i) => i !== idOrIndex);\r\n        }\r\n        return prev.filter(c => c.id !== idOrIndex);\r\n      });\r\n    },\r\n    getChildViews: () => cells,\r\n    getNode: () => containerRef.current,\r\n    show: () => setIsHidden(false),\r\n    hide: () => setIsHidden(true),\r\n    isVisible: () => !isHidden,\r\n    enable: () => setIsDisabled(false),\r\n    disable: () => setIsDisabled(true),\r\n    isEnabled: () => !isDisabled,\r\n    resize: () => {\r\n      if (containerRef.current && onResize) {\r\n        const { width, height } = containerRef.current.getBoundingClientRect();\r\n        onResize(width, height);\r\n      }\r\n    },\r\n    showBatch: (batchName: string) => setVisibleBatch(batchName),\r\n    index: (cellId: string) => cells.findIndex(c => c.id === cellId),\r\n    reconstruct: (newCells: AvakioAbsoluteLayoutCell[]) => setCells(newCells),\r\n  }), [cells, isHidden, isDisabled, onResize]);\r\n\r\n  // Container styles\r\n  const containerStyle: React.CSSProperties = {\r\n    width: toCssValue(width),\r\n    height: toCssValue(height),\r\n    minWidth: toCssValue(minWidth),\r\n    minHeight: toCssValue(minHeight),\r\n    maxWidth: toCssValue(maxWidth),\r\n    maxHeight: toCssValue(maxHeight),\r\n    background,\r\n    padding: toCssValue(padding),\r\n  };\r\n\r\n  if (isHidden) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div\r\n      ref={containerRef}\r\n      id={id}\r\n      data-testid={testId}\r\n      className={`avakio-absolute-layout avakio-absolute-layout-theme-${theme} ${borderless ? 'borderless' : ''} ${isDisabled ? 'disabled' : ''} ${css || ''}`}\r\n      style={containerStyle}\r\n    >\r\n      {cells.map((cell, index) => {\r\n        if (!isCellVisible(cell)) return null;\r\n\r\n        const cellStyle: React.CSSProperties = cell.relative\r\n          ? {\r\n              position: 'relative',\r\n              width: toCssValue(cell.width) || '100%',\r\n              height: toCssValue(cell.height) || '100%',\r\n              minWidth: toCssValue(cell.minWidth),\r\n              minHeight: toCssValue(cell.minHeight),\r\n              maxWidth: toCssValue(cell.maxWidth),\r\n              maxHeight: toCssValue(cell.maxHeight),\r\n              zIndex: cell.zIndex,\r\n            }\r\n          : {\r\n              position: 'absolute',\r\n              top: toCssValue(cell.top),\r\n              left: toCssValue(cell.left),\r\n              bottom: toCssValue(cell.bottom),\r\n              right: toCssValue(cell.right),\r\n              width: toCssValue(cell.width),\r\n              height: toCssValue(cell.height),\r\n              minWidth: toCssValue(cell.minWidth),\r\n              minHeight: toCssValue(cell.minHeight),\r\n              maxWidth: toCssValue(cell.maxWidth),\r\n              maxHeight: toCssValue(cell.maxHeight),\r\n              zIndex: cell.zIndex,\r\n            };\r\n\r\n        return (\r\n          <div\r\n            key={cell.id || index}\r\n            className={`avakio-absolute-layout-cell ${cell.relative ? 'relative' : 'absolute'} ${cell.disabled ? 'disabled' : ''} ${cell.css || ''}`}\r\n            style={cellStyle}\r\n            onClick={() => handleCellClick(cell)}\r\n            data-cell-id={cell.id}\r\n            data-batch={cell.batch}\r\n          >\r\n            {cell.content}\r\n          </div>\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n});\r\n\r\nAvakioAbsoluteLayout.displayName = 'AvakioAbsoluteLayout';\r\n\r\nexport default AvakioAbsoluteLayout;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { forwardRef, useImperativeHandle, useState, useRef, useEffect, useMemo, useCallback } from 'react';\r\nimport './avakio-grid.css';\r\n\r\nexport type AvakioGridTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\n\r\n/**\r\n * Cell configuration for AvakioGrid\r\n * x, y: Grid position (0-indexed)\r\n * dx, dy: Cell span (width/height in grid units)\r\n */\r\nexport interface AvakioGridCell {\r\n  /** Unique identifier for the cell */\r\n  id: string;\r\n  /** Whether this cell can be dragged when grid dragging is enabled */\r\n  draggable?: boolean;\r\n  /** Content to display in the cell */\r\n  content?: React.ReactNode;\r\n  /** Template string or function */\r\n  template?: string | ((cell: AvakioGridCell) => React.ReactNode);\r\n  /** X position in grid (0-indexed) */\r\n  x: number;\r\n  /** Y position in grid (0-indexed) */\r\n  y: number;\r\n  /** Width in grid units (default: 1) */\r\n  dx?: number;\r\n  /** Height in grid units (default: 1) */\r\n  dy?: number;\r\n  /** Fixed height for this cell in pixels (overrides grid calculation) */\r\n  height?: number;\r\n  /** Custom CSS class for the cell */\r\n  cssClass?: string;\r\n  /** Custom inline styles */\r\n  css?: React.CSSProperties;\r\n  /** Whether the cell is hidden */\r\n  hidden?: boolean;\r\n  /** Whether the cell is disabled */\r\n  disabled?: boolean;\r\n  /** Additional data attached to cell */\r\n  data?: Record<string, any>;\r\n}\r\n\r\nexport interface AvakioGridProps {\r\n  /** Unique identifier */\r\n  id?: string;\r\n  /** Test ID for testing */\r\n  testId?: string;\r\n  /** Number of columns in the grid */\r\n  gridColumns?: number;\r\n  /** Number of rows in the grid */\r\n  gridRows?: number;\r\n  /** Fixed cell width in pixels (auto-calculated if not set) */\r\n  cellWidth?: number;\r\n  /** Fixed cell height in pixels (auto-calculated if not set) */\r\n  cellHeight?: number;\r\n  /** Array of cell configurations */\r\n  cells: AvakioGridCell[];\r\n  /** Theme to apply */\r\n  theme?: AvakioGridTheme;\r\n  /** Margin between cells in pixels */\r\n  cellMargin?: number;\r\n  /** Margin around the grid container in pixels */\r\n  margin?: number;\r\n  /** Padding around the grid - can be a number (all sides) or array [top, right, bottom, left] */\r\n  padding?: number | [number, number, number, number];\r\n  /** Horizontal padding */\r\n  paddingX?: number;\r\n  /** Vertical padding */\r\n  paddingY?: number;\r\n  /** Width of the grid container */\r\n  width?: number | string;\r\n  /** Height of the grid container */\r\n  height?: number | string;\r\n  /** Minimum width */\r\n  minWidth?: number | string;\r\n  /** Minimum height */\r\n  minHeight?: number | string;\r\n  /** Remove container/view borders */\r\n  borderless?: boolean;\r\n  /** Remove cell borders */\r\n  cellBorderless?: boolean;\r\n  /** Custom CSS class */\r\n  className?: string;\r\n  /** Custom inline styles */\r\n  css?: React.CSSProperties;\r\n  /** Whether the grid is hidden */\r\n  hidden?: boolean;\r\n  /** Whether the grid is disabled */\r\n  disabled?: boolean;\r\n  /** Auto-place new views vertically */\r\n  autoplace?: boolean;\r\n  /** Factory function to create cell content */\r\n  factory?: (cell: AvakioGridCell) => React.ReactNode;\r\n  /** Callback when cells change */\r\n  onChange?: (cells: AvakioGridCell[]) => void;\r\n  /** Callback when a cell is clicked */\r\n  onCellClick?: (cell: AvakioGridCell) => void;\r\n  /** Enable drag and drop functionality for cells */\r\n  isDraggable?: boolean;\r\n  /** Callback when drag starts */\r\n  onDragStart?: (cell: AvakioGridCell) => void;\r\n  /** Callback when drag ends */\r\n  onDragEnd?: (cell: AvakioGridCell, newPosition: { x: number; y: number }) => void;\r\n}\r\n\r\nexport interface AvakioGridRef {\r\n  /** Add a new cell to the grid */\r\n  addView: (cell: AvakioGridCell, index?: number) => void;\r\n  /** Remove a cell by ID */\r\n  removeView: (id: string) => void;\r\n  /** Move/resize a cell */\r\n  moveView: (id: string, position: { x?: number; y?: number; dx?: number; dy?: number }) => void;\r\n  /** Clear all cells */\r\n  clearAll: () => void;\r\n  /** Get all cells */\r\n  getCells: () => AvakioGridCell[];\r\n  /** Get a cell by ID */\r\n  getCell: (id: string) => AvakioGridCell | undefined;\r\n  /** Serialize the grid state */\r\n  serialize: () => AvakioGridCell[];\r\n  /** Restore grid state */\r\n  restore: (cells: AvakioGridCell[]) => void;\r\n  /** Rebuild the grid */\r\n  reconstruct: () => void;\r\n  /** Show the grid */\r\n  show: () => void;\r\n  /** Hide the grid */\r\n  hide: () => void;\r\n  /** Get the DOM node */\r\n  getNode: () => HTMLDivElement | null;\r\n}\r\n\r\nexport const AvakioGrid = forwardRef<AvakioGridRef, AvakioGridProps>(\r\n  (\r\n    {\r\n      id,\r\n      testId,\r\n      gridColumns = 2,\r\n      gridRows = 2,\r\n      cellWidth,\r\n      cellHeight,\r\n      cells: initialCells = [],\r\n      theme = 'material',\r\n      cellMargin = 10,\r\n      margin,\r\n      padding = 10,\r\n      paddingX,\r\n      paddingY,\r\n      width,\r\n      height,\r\n      minWidth,\r\n      minHeight,\r\n      borderless = false,\r\n      cellBorderless = false,\r\n      className = '',\r\n      css,\r\n      hidden = false,\r\n      disabled = false,\r\n      autoplace = false,\r\n      factory,\r\n      onChange,\r\n      onCellClick,\r\n      isDraggable = false,\r\n      onDragStart,\r\n      onDragEnd,\r\n    },\r\n    ref\r\n  ) => {\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n    const [cells, setCells] = useState<AvakioGridCell[]>(initialCells);\r\n    const [isHidden, setIsHidden] = useState(hidden);\r\n    const [containerSize, setContainerSize] = useState({ width: 0, height: 0 });\r\n    const cellsRef = useRef(cells);\r\n    \r\n    // Drag state\r\n    const [draggingCell, setDraggingCell] = useState<string | null>(null);\r\n    const [dragOffset, setDragOffset] = useState({ x: 0, y: 0 });\r\n    const [dragPosition, setDragPosition] = useState({ x: 0, y: 0 });\r\n\r\n    // Keep cellsRef in sync\r\n    useEffect(() => {\r\n      cellsRef.current = cells;\r\n    }, [cells]);\r\n\r\n    // Update cells when prop changes\r\n    useEffect(() => {\r\n      setCells(initialCells);\r\n    }, [initialCells]);\r\n\r\n    // Observe container size for responsive cell sizing\r\n    useEffect(() => {\r\n      if (!containerRef.current) return;\r\n\r\n      // Get initial size immediately using clientWidth/clientHeight (content + padding, excludes border)\r\n      const initialWidth = containerRef.current.clientWidth;\r\n      const initialHeight = containerRef.current.clientHeight;\r\n      if (initialWidth > 0 || initialHeight > 0) {\r\n        setContainerSize({ width: initialWidth, height: initialHeight });\r\n      }\r\n\r\n      let rafId: number | null = null;\r\n      let pendingSize: { width: number; height: number } | null = null;\r\n\r\n      const resizeObserver = new ResizeObserver((entries) => {\r\n        for (const entry of entries) {\r\n          const target = entry.target as HTMLElement;\r\n          pendingSize = { width: target.clientWidth, height: target.clientHeight };\r\n          \r\n          // Use requestAnimationFrame to throttle updates for smooth resizing\r\n          if (rafId === null) {\r\n            rafId = requestAnimationFrame(() => {\r\n              if (pendingSize) {\r\n                setContainerSize(pendingSize);\r\n                pendingSize = null;\r\n              }\r\n              rafId = null;\r\n            });\r\n          }\r\n        }\r\n      });\r\n\r\n      resizeObserver.observe(containerRef.current);\r\n      return () => {\r\n        resizeObserver.disconnect();\r\n        if (rafId !== null) {\r\n          cancelAnimationFrame(rafId);\r\n        }\r\n      };\r\n    }, []);\r\n\r\n    // Calculate actual cell dimensions\r\n    const calculatedCellWidth = useMemo(() => {\r\n      if (cellWidth) return cellWidth;\r\n      const basePadding = Array.isArray(padding) ? padding : [padding, padding, padding, padding];\r\n      const px = paddingX !== undefined ? paddingX : basePadding[1];\r\n      const paddingHorizontal = px * 2;\r\n      const totalMargin = cellMargin * (gridColumns - 1);\r\n      const availableWidth = containerSize.width - paddingHorizontal - totalMargin;\r\n      return Math.max(availableWidth / gridColumns, 50);\r\n    }, [cellWidth, containerSize.width, gridColumns, cellMargin, padding, paddingX]);\r\n\r\n    // Calculate heights for cells, accounting for fixed-height cells\r\n    const cellHeights = useMemo(() => {\r\n      // If cellHeight is explicitly set, use it for all cells\r\n      if (cellHeight) {\r\n        return cells.reduce((acc, cell) => {\r\n          acc[cell.id] = cell.height || cellHeight;\r\n          return acc;\r\n        }, {} as Record<string, number>);\r\n      }\r\n\r\n      const basePadding = Array.isArray(padding) ? padding : [padding, padding, padding, padding];\r\n      const py = paddingY !== undefined ? paddingY : basePadding[0];\r\n      const paddingVertical = py * 2;\r\n      const totalMargin = cellMargin * (gridRows - 1);\r\n      const availableHeight = containerSize.height - paddingVertical - totalMargin;\r\n\r\n      // Calculate fixed heights and count flexible cells\r\n      let fixedHeightTotal = 0;\r\n      let flexibleRowCount = 0;\r\n      const rowHeights: Record<number, number | 'flex'> = {};\r\n\r\n      // Group cells by row and determine which rows have fixed heights\r\n      for (let row = 0; row < gridRows; row++) {\r\n        const cellsInRow = cells.filter(c => c.y === row && !c.hidden);\r\n        const fixedHeightCell = cellsInRow.find(c => c.height !== undefined);\r\n        \r\n        if (fixedHeightCell && fixedHeightCell.height) {\r\n          rowHeights[row] = fixedHeightCell.height;\r\n          fixedHeightTotal += fixedHeightCell.height;\r\n        } else {\r\n          rowHeights[row] = 'flex';\r\n          flexibleRowCount++;\r\n        }\r\n      }\r\n\r\n      // Calculate height for flexible rows\r\n      const remainingHeight = availableHeight - fixedHeightTotal;\r\n      const flexRowHeight = flexibleRowCount > 0 \r\n        ? Math.max(remainingHeight / flexibleRowCount, 50) \r\n        : 50;\r\n\r\n      // Build heights map for each cell\r\n      const heights: Record<string, number> = {};\r\n      cells.forEach(cell => {\r\n        if (cell.height) {\r\n          heights[cell.id] = cell.height;\r\n        } else {\r\n          const dy = cell.dy || 1;\r\n          let totalHeight = 0;\r\n          for (let i = 0; i < dy; i++) {\r\n            const rowH = rowHeights[cell.y + i];\r\n            totalHeight += rowH === 'flex' ? flexRowHeight : rowH;\r\n            if (i > 0) totalHeight += cellMargin;\r\n          }\r\n          heights[cell.id] = totalHeight;\r\n        }\r\n      });\r\n\r\n      return heights;\r\n    }, [cells, cellHeight, containerSize.height, gridRows, cellMargin, padding, paddingY]);\r\n\r\n    // Calculate row top positions (accounting for variable heights)\r\n    const rowPositions = useMemo(() => {\r\n      const basePadding = Array.isArray(padding) ? padding : [padding, padding, padding, padding];\r\n      const py = paddingY !== undefined ? paddingY : basePadding[0];\r\n      const paddingVertical = py * 2;\r\n      const availableHeight = containerSize.height - paddingVertical - (cellMargin * (gridRows - 1));\r\n      \r\n      // Calculate fixed heights and flexible row count\r\n      let fixedHeightTotal = 0;\r\n      let flexibleRowCount = 0;\r\n      const rowHeights: (number | 'flex')[] = [];\r\n\r\n      for (let row = 0; row < gridRows; row++) {\r\n        const cellsInRow = cells.filter(c => c.y === row && !c.hidden);\r\n        const fixedHeightCell = cellsInRow.find(c => c.height !== undefined);\r\n        \r\n        if (fixedHeightCell && fixedHeightCell.height) {\r\n          rowHeights[row] = fixedHeightCell.height;\r\n          fixedHeightTotal += fixedHeightCell.height;\r\n        } else if (cellHeight) {\r\n          rowHeights[row] = cellHeight;\r\n        } else {\r\n          rowHeights[row] = 'flex';\r\n          flexibleRowCount++;\r\n        }\r\n      }\r\n\r\n      const remainingHeight = availableHeight - fixedHeightTotal;\r\n      const flexRowHeight = flexibleRowCount > 0 \r\n        ? Math.max(remainingHeight / flexibleRowCount, 50) \r\n        : (cellHeight || 50);\r\n\r\n      // Calculate cumulative positions\r\n      const positions: number[] = [0];\r\n      for (let row = 0; row < gridRows; row++) {\r\n        const h = rowHeights[row] === 'flex' ? flexRowHeight : (rowHeights[row] as number);\r\n        positions[row + 1] = positions[row] + h + cellMargin;\r\n      }\r\n\r\n      return positions;\r\n    }, [cells, cellHeight, containerSize.height, gridRows, cellMargin, padding, paddingY]);\r\n\r\n    // Calculate cell position and size\r\n    const getCellStyle = useCallback((cell: AvakioGridCell): React.CSSProperties => {\r\n      const dx = cell.dx || 1;\r\n      const basePadding = Array.isArray(padding) ? padding : [padding, padding, padding, padding];\r\n      const px = paddingX !== undefined ? paddingX : basePadding[1];\r\n      const py = paddingY !== undefined ? paddingY : basePadding[0];\r\n\r\n      const left = px + cell.x * (calculatedCellWidth + cellMargin);\r\n      const top = py + rowPositions[cell.y];\r\n      const width = dx * calculatedCellWidth + (dx - 1) * cellMargin;\r\n      const height = cellHeights[cell.id] || 50;\r\n\r\n      return {\r\n        position: 'absolute',\r\n        left: `${left}px`,\r\n        top: `${top}px`,\r\n        width: `${width}px`,\r\n        height: `${height}px`,\r\n        ...cell.css,\r\n      };\r\n    }, [calculatedCellWidth, cellHeights, rowPositions, cellMargin, padding, paddingX, paddingY]);\r\n\r\n    // Render cell content\r\n    const renderCellContent = useCallback((cell: AvakioGridCell): React.ReactNode => {\r\n      if (factory) {\r\n        return factory(cell);\r\n      }\r\n      if (cell.content) {\r\n        return cell.content;\r\n      }\r\n      if (typeof cell.template === 'function') {\r\n        return cell.template(cell);\r\n      }\r\n      if (typeof cell.template === 'string') {\r\n        // Simple template replacement\r\n        let result = cell.template;\r\n        if (cell.data) {\r\n          Object.entries(cell.data).forEach(([key, value]) => {\r\n            result = result.replace(new RegExp(`#${key}#`, 'g'), String(value));\r\n          });\r\n        }\r\n        return <div dangerouslySetInnerHTML={{ __html: result }} />;\r\n      }\r\n      return null;\r\n    }, [factory]);\r\n\r\n    // Calculate grid position from pixel coordinates\r\n    const getGridPositionFromPixels = useCallback((pixelX: number, pixelY: number): { x: number; y: number } => {\r\n      const basePadding = Array.isArray(padding) ? padding : [padding, padding, padding, padding];\r\n      const px = paddingX !== undefined ? paddingX : basePadding[1];\r\n      const py = paddingY !== undefined ? paddingY : basePadding[0];\r\n      \r\n      // Calculate x position\r\n      const adjustedX = pixelX - px;\r\n      const colWidth = calculatedCellWidth + cellMargin;\r\n      let gridX = Math.round(adjustedX / colWidth);\r\n      gridX = Math.max(0, Math.min(gridX, gridColumns - 1));\r\n      \r\n      // Calculate y position based on row positions\r\n      const adjustedY = pixelY - py;\r\n      let gridY = 0;\r\n      for (let i = 0; i < rowPositions.length - 1; i++) {\r\n        const rowMid = rowPositions[i] + (rowPositions[i + 1] - rowPositions[i] - cellMargin) / 2;\r\n        if (adjustedY > rowMid) {\r\n          gridY = i + 1;\r\n        }\r\n      }\r\n      gridY = Math.max(0, Math.min(gridY, gridRows - 1));\r\n      \r\n      return { x: gridX, y: gridY };\r\n    }, [calculatedCellWidth, cellMargin, gridColumns, gridRows, padding, paddingX, paddingY, rowPositions]);\r\n\r\n    // Check if a position is occupied by another cell\r\n    const isPositionOccupied = useCallback((gridX: number, gridY: number, excludeCellId?: string): boolean => {\r\n      return cellsRef.current.some(cell => {\r\n        if (cell.id === excludeCellId) return false;\r\n        const dx = cell.dx || 1;\r\n        const dy = cell.dy || 1;\r\n        return gridX >= cell.x && gridX < cell.x + dx && gridY >= cell.y && gridY < cell.y + dy;\r\n      });\r\n    }, []);\r\n\r\n    // Handle drag start\r\n    const handleDragStart = useCallback((e: React.MouseEvent | React.TouchEvent, cell: AvakioGridCell) => {\r\n      if (!isDraggable || disabled || cell.disabled || cell.draggable === false) return;\r\n      \r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n      \r\n      const clientX = 'touches' in e ? e.touches[0].clientX : e.clientX;\r\n      const clientY = 'touches' in e ? e.touches[0].clientY : e.clientY;\r\n      \r\n      const rect = containerRef.current?.getBoundingClientRect();\r\n      if (!rect) return;\r\n      \r\n      const cellStyle = getCellStyle(cell);\r\n      const cellLeft = parseFloat(String(cellStyle.left));\r\n      const cellTop = parseFloat(String(cellStyle.top));\r\n      \r\n      setDragOffset({\r\n        x: clientX - rect.left - cellLeft,\r\n        y: clientY - rect.top - cellTop,\r\n      });\r\n      setDragPosition({\r\n        x: clientX - rect.left - (clientX - rect.left - cellLeft),\r\n        y: clientY - rect.top - (clientY - rect.top - cellTop),\r\n      });\r\n      setDraggingCell(cell.id);\r\n      onDragStart?.(cell);\r\n    }, [isDraggable, disabled, getCellStyle, onDragStart]);\r\n\r\n    // Handle drag move\r\n    const handleDragMove = useCallback((e: MouseEvent | TouchEvent) => {\r\n      if (!draggingCell || !containerRef.current) return;\r\n      \r\n      const clientX = 'touches' in e ? e.touches[0].clientX : e.clientX;\r\n      const clientY = 'touches' in e ? e.touches[0].clientY : e.clientY;\r\n      \r\n      const rect = containerRef.current.getBoundingClientRect();\r\n      \r\n      setDragPosition({\r\n        x: clientX - rect.left - dragOffset.x,\r\n        y: clientY - rect.top - dragOffset.y,\r\n      });\r\n    }, [draggingCell, dragOffset]);\r\n\r\n    // Handle drag end\r\n    const handleDragEnd = useCallback(() => {\r\n      if (!draggingCell) return;\r\n      \r\n      const cell = cellsRef.current.find(c => c.id === draggingCell);\r\n      if (!cell) {\r\n        setDraggingCell(null);\r\n        return;\r\n      }\r\n      \r\n      // Calculate new grid position\r\n      const newGridPos = getGridPositionFromPixels(dragPosition.x, dragPosition.y);\r\n      \r\n      // Check if the position is within bounds\r\n      const dx = cell.dx || 1;\r\n      const dy = cell.dy || 1;\r\n      \r\n      let canPlace = true;\r\n      for (let i = 0; i < dx && canPlace; i++) {\r\n        for (let j = 0; j < dy && canPlace; j++) {\r\n          const checkX = newGridPos.x + i;\r\n          const checkY = newGridPos.y + j;\r\n          if (checkX >= gridColumns || checkY >= gridRows) {\r\n            canPlace = false;\r\n          }\r\n        }\r\n      }\r\n      \r\n      // Check if position actually changed\r\n      const positionChanged = newGridPos.x !== cell.x || newGridPos.y !== cell.y;\r\n      \r\n      if (canPlace && positionChanged) {\r\n        // For single-column grids with 1x1 cells, use shift reordering\r\n        const isSingleColumn = gridColumns === 1;\r\n        const allCellsSimple = cellsRef.current.every(c => (c.dx || 1) === 1 && (c.dy || 1) === 1);\r\n        \r\n        if (isSingleColumn && allCellsSimple) {\r\n          // Shift-based reordering for single-column lists\r\n          const oldY = cell.y;\r\n          const newY = newGridPos.y;\r\n          \r\n          setCells(prev => {\r\n            const updated = prev.map(c => {\r\n              if (c.id === draggingCell) {\r\n                return { ...c, y: newY };\r\n              }\r\n              \r\n              if (oldY < newY) {\r\n                if (c.y > oldY && c.y <= newY) {\r\n                  return { ...c, y: c.y - 1 };\r\n                }\r\n              } else {\r\n                if (c.y >= newY && c.y < oldY) {\r\n                  return { ...c, y: c.y + 1 };\r\n                }\r\n              }\r\n              return c;\r\n            });\r\n            onChange?.(updated);\r\n            return updated;\r\n          });\r\n        } else {\r\n          // Swap-based approach for multi-column grids or complex cells\r\n          // Find if there's a cell at the target position\r\n          const targetCell = cellsRef.current.find(c => {\r\n            if (c.id === draggingCell) return false;\r\n            const cDx = c.dx || 1;\r\n            const cDy = c.dy || 1;\r\n            // Check if new position overlaps with this cell\r\n            return newGridPos.x >= c.x && newGridPos.x < c.x + cDx &&\r\n                   newGridPos.y >= c.y && newGridPos.y < c.y + cDy;\r\n          });\r\n          \r\n          setCells(prev => {\r\n            const updated = prev.map(c => {\r\n              if (c.id === draggingCell) {\r\n                // Move dragged cell to new position\r\n                return { ...c, x: newGridPos.x, y: newGridPos.y };\r\n              }\r\n              if (targetCell && c.id === targetCell.id) {\r\n                // Swap: move target cell to dragged cell's old position\r\n                return { ...c, x: cell.x, y: cell.y };\r\n              }\r\n              return c;\r\n            });\r\n            onChange?.(updated);\r\n            return updated;\r\n          });\r\n        }\r\n        onDragEnd?.(cell, newGridPos);\r\n      }\r\n      \r\n      setDraggingCell(null);\r\n    }, [draggingCell, dragPosition, getGridPositionFromPixels, gridColumns, gridRows, onChange, onDragEnd]);\r\n\r\n    // Add global mouse/touch event listeners for drag\r\n    useEffect(() => {\r\n      if (!isDraggable || !draggingCell) return;\r\n      \r\n      const handleMove = (e: MouseEvent | TouchEvent) => handleDragMove(e);\r\n      const handleUp = () => handleDragEnd();\r\n      \r\n      document.addEventListener('mousemove', handleMove);\r\n      document.addEventListener('mouseup', handleUp);\r\n      document.addEventListener('touchmove', handleMove, { passive: false });\r\n      document.addEventListener('touchend', handleUp);\r\n      \r\n      return () => {\r\n        document.removeEventListener('mousemove', handleMove);\r\n        document.removeEventListener('mouseup', handleUp);\r\n        document.removeEventListener('touchmove', handleMove);\r\n        document.removeEventListener('touchend', handleUp);\r\n      };\r\n    }, [isDraggable, draggingCell, handleDragMove, handleDragEnd]);\r\n\r\n    // Find next available position for autoplace\r\n    const findNextPosition = useCallback((): { x: number; y: number } => {\r\n      const occupied = new Set<string>();\r\n      cellsRef.current.forEach(cell => {\r\n        const dx = cell.dx || 1;\r\n        const dy = cell.dy || 1;\r\n        for (let i = 0; i < dx; i++) {\r\n          for (let j = 0; j < dy; j++) {\r\n            occupied.add(`${cell.x + i},${cell.y + j}`);\r\n          }\r\n        }\r\n      });\r\n\r\n      for (let y = 0; y < gridRows; y++) {\r\n        for (let x = 0; x < gridColumns; x++) {\r\n          if (!occupied.has(`${x},${y}`)) {\r\n            return { x, y };\r\n          }\r\n        }\r\n      }\r\n      return { x: 0, y: gridRows }; // Add below existing rows\r\n    }, [gridColumns, gridRows]);\r\n\r\n    // Imperative methods\r\n    useImperativeHandle(ref, () => ({\r\n      addView: (cell: AvakioGridCell, index?: number) => {\r\n        const newCell = autoplace && (cell.x === undefined || cell.y === undefined)\r\n          ? { ...cell, ...findNextPosition() }\r\n          : cell;\r\n        \r\n        setCells(prev => {\r\n          const updated = index !== undefined\r\n            ? [...prev.slice(0, index), newCell, ...prev.slice(index)]\r\n            : [...prev, newCell];\r\n          onChange?.(updated);\r\n          return updated;\r\n        });\r\n      },\r\n\r\n      removeView: (cellId: string) => {\r\n        setCells(prev => {\r\n          const updated = prev.filter(c => c.id !== cellId);\r\n          onChange?.(updated);\r\n          return updated;\r\n        });\r\n      },\r\n\r\n      moveView: (cellId: string, position: { x?: number; y?: number; dx?: number; dy?: number }) => {\r\n        setCells(prev => {\r\n          const updated = prev.map(c => {\r\n            if (c.id === cellId) {\r\n              return {\r\n                ...c,\r\n                x: position.x ?? c.x,\r\n                y: position.y ?? c.y,\r\n                dx: position.dx ?? c.dx,\r\n                dy: position.dy ?? c.dy,\r\n              };\r\n            }\r\n            return c;\r\n          });\r\n          onChange?.(updated);\r\n          return updated;\r\n        });\r\n      },\r\n\r\n      clearAll: () => {\r\n        setCells([]);\r\n        onChange?.([]);\r\n      },\r\n\r\n      getCells: () => cellsRef.current,\r\n\r\n      getCell: (cellId: string) => cellsRef.current.find(c => c.id === cellId),\r\n\r\n      serialize: () => cellsRef.current.map(({ id, x, y, dx, dy, data }) => ({ \r\n        id, x, y, dx: dx || 1, dy: dy || 1, data \r\n      })),\r\n\r\n      restore: (newCells: AvakioGridCell[]) => {\r\n        setCells(newCells);\r\n        onChange?.(newCells);\r\n      },\r\n\r\n      reconstruct: () => {\r\n        setCells([...cellsRef.current]);\r\n      },\r\n\r\n      show: () => setIsHidden(false),\r\n\r\n      hide: () => setIsHidden(true),\r\n\r\n      getNode: () => containerRef.current,\r\n    }));\r\n\r\n    // Build class names\r\n    const containerClasses = [\r\n      'avakio-grid',\r\n      `avakio-grid-theme-${theme}`,\r\n      borderless ? 'avakio-grid-borderless' : '',\r\n      cellBorderless ? 'avakio-grid-cell-borderless' : '',\r\n      isHidden ? 'avakio-grid-hidden' : '',\r\n      disabled ? 'avakio-grid-disabled' : '',\r\n      isDraggable ? 'avakio-grid-draggable' : '',\r\n      draggingCell ? 'avakio-grid-dragging' : '',\r\n      className,\r\n    ].filter(Boolean).join(' ');\r\n\r\n    // Calculate width accounting for margin\r\n    const calculateWidth = () => {\r\n      if (width === undefined) return undefined;\r\n      if (typeof width === 'number') return `${width}px`;\r\n      // If width is '100%' and margin is set, use calc to subtract margin\r\n      if (width === '100%' && margin !== undefined) {\r\n        const marginValue = typeof margin === 'number' ? margin * 2 : 0;\r\n        return marginValue > 0 ? `calc(100% - ${marginValue}px)` : '100%';\r\n      }\r\n      return width;\r\n    };\r\n\r\n    // Build container styles\r\n    const containerStyles: React.CSSProperties = {\r\n      position: 'relative',\r\n      width: calculateWidth(),\r\n      height: typeof height === 'number' ? `${height}px` : height,\r\n      minWidth: typeof minWidth === 'number' ? `${minWidth}px` : minWidth,\r\n      minHeight: typeof minHeight === 'number' ? `${minHeight}px` : minHeight,\r\n      margin: margin !== undefined ? (typeof margin === 'number' ? `${margin}px` : margin) : undefined,\r\n      ...(css && typeof css === 'object' && !Array.isArray(css) ? css : {}),\r\n    };\r\n\r\n    return (\r\n      <div\r\n        ref={containerRef}\r\n        id={id}\r\n        data-testid={testId}\r\n        className={containerClasses}\r\n        style={containerStyles}\r\n      >\r\n        {cells.map(cell => {\r\n          if (cell.hidden) return null;\r\n\r\n          const isDragging = draggingCell === cell.id;\r\n          const cellClasses = [\r\n            'avakio-grid-cell',\r\n            cell.cssClass || '',\r\n            cell.disabled ? 'avakio-grid-cell-disabled' : '',\r\n            isDraggable && !cell.disabled && cell.draggable !== false ? 'avakio-grid-cell-draggable' : '',\r\n            isDragging ? 'avakio-grid-cell-dragging' : '',\r\n          ].filter(Boolean).join(' ');\r\n\r\n          // Use drag position if this cell is being dragged\r\n          const cellStyle = isDragging\r\n            ? { ...getCellStyle(cell), left: `${dragPosition.x}px`, top: `${dragPosition.y}px`, zIndex: 1000 }\r\n            : getCellStyle(cell);\r\n\r\n          return (\r\n            <div\r\n              key={cell.id}\r\n              id={cell.id}\r\n              className={cellClasses}\r\n              style={cellStyle}\r\n              onClick={() => !isDragging && onCellClick?.(cell)}\r\n              onMouseDown={(e) => handleDragStart(e, cell)}\r\n              onTouchStart={(e) => handleDragStart(e, cell)}\r\n              data-cell-id={cell.id}\r\n            >\r\n              <div className=\"avakio-grid-cell-content\">\r\n                {renderCellContent(cell)}\r\n              </div>\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nAvakioGrid.displayName = 'AvakioGrid';\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useRef, useEffect, useState, useCallback } from 'react';\r\nimport './avakio-layout.css';\r\n\r\nexport type AvakioLayoutType = 'space' | 'wide' | 'clean' | 'line' | 'head' | 'material';\r\n\r\nexport interface AvakioLayoutProps {\r\n  /** Array of child views arranged vertically */\r\n  rows?: React.ReactNode[];\r\n  \r\n  /** Array of child views arranged horizontally */\r\n  cols?: React.ReactNode[];\r\n  \r\n  /** Direct children (alternative to rows/cols) */\r\n  children?: React.ReactNode;\r\n  \r\n  /** Theme to apply */\r\n  theme?: 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\n  \r\n  /** Custom CSS class name */\r\n  className?: string;\r\n  \r\n  /** Custom CSS styles object */\r\n  css?: React.CSSProperties;\r\n  \r\n  /** Width of the layout */\r\n  width?: number | string;\r\n  \r\n  /** Height of the layout */\r\n  height?: number | string;\r\n  \r\n  /** Minimum width */\r\n  minWidth?: number | string;\r\n  \r\n  /** Minimum height */\r\n  minHeight?: number | string;\r\n  \r\n  /** Maximum width */\r\n  maxWidth?: number | string;\r\n  \r\n  /** Maximum height */\r\n  maxHeight?: number | string;\r\n  \r\n  /** Whether to remove borders */\r\n  borderless?: boolean;\r\n  \r\n  /** Layout type (defines border style) */\r\n  type?: AvakioLayoutType;\r\n  \r\n  /** Padding around content - can be a number (all sides), string, or array [top, right, bottom, left] */\r\n  padding?: number | string | [number, number, number, number];\r\n  \r\n  /** Padding on X axis (left and right) */\r\n  paddingX?: number | string;\r\n  \r\n  /** Padding on Y axis (top and bottom) */\r\n  paddingY?: number | string;\r\n  \r\n  /** Margin around layout */\r\n  margin?: number | string;\r\n  \r\n  /** Layout gravity for flexible sizing */\r\n  gravity?: number;\r\n  \r\n  /** Whether the layout is initially hidden */\r\n  hidden?: boolean;\r\n  \r\n  /** Whether the layout is disabled */\r\n  disabled?: boolean;\r\n  \r\n  /** Enable responsive behavior */\r\n  responsive?: boolean | string;\r\n  \r\n  /** ID of the layout */\r\n  id?: string;\r\n  \r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n  \r\n  /** Gap between items (CSS gap property) */\r\n  gap?: number | string;\r\n  \r\n  /** Alignment of items */\r\n  align?: 'start' | 'center' | 'end' | 'stretch';\r\n  \r\n  /** Justify content */\r\n  justify?: 'start' | 'center' | 'end' | 'space-between' | 'space-around' | 'space-evenly';\r\n  \r\n  /** Callback when window is resized (for responsive layouts) */\r\n  onResize?: () => void;\r\n  \r\n  /** Enable auto-resize observer */\r\n  autoResize?: boolean;\r\n}\r\n\r\nexport function AvakioLayout({\r\n  rows,\r\n  cols,\r\n  children,\r\n  theme = 'material',\r\n  className = '',\r\n  css,\r\n  width,\r\n  height,\r\n  minWidth,\r\n  minHeight,\r\n  maxWidth,\r\n  maxHeight,\r\n  borderless = false,\r\n  type = 'space',\r\n  padding,\r\n  paddingX,\r\n  paddingY,\r\n  margin,\r\n  gravity,\r\n  hidden = false,\r\n  disabled = false,\r\n  responsive = false,\r\n  id,\r\n  testId,\r\n  gap,\r\n  align = 'stretch',\r\n  justify = 'start',\r\n  onResize,\r\n  autoResize = false,\r\n}: AvakioLayoutProps) {\r\n  const layoutRef = useRef<HTMLDivElement>(null);\r\n  const [responsiveMode, setResponsiveMode] = useState(false);\r\n  \r\n  const isRows = !!rows || (!cols && !rows);\r\n  const items = rows || cols || [];\r\n\r\n  // Handle responsive behavior\r\n  const checkResponsive = useCallback(() => {\r\n    if (!responsive || !layoutRef.current) return;\r\n    \r\n    const container = layoutRef.current;\r\n    const containerWidth = container.offsetWidth;\r\n    \r\n    // Switch to vertical layout if width is less than 768px\r\n    if (containerWidth < 768 && !isRows) {\r\n      setResponsiveMode(true);\r\n    } else {\r\n      setResponsiveMode(false);\r\n    }\r\n    \r\n    if (onResize) {\r\n      onResize();\r\n    }\r\n  }, [responsive, isRows, onResize]);\r\n\r\n  // Window resize observer\r\n  useEffect(() => {\r\n    if (!responsive && !autoResize) return;\r\n\r\n    checkResponsive();\r\n    \r\n    const handleResize = () => {\r\n      checkResponsive();\r\n    };\r\n\r\n    window.addEventListener('resize', handleResize);\r\n    \r\n    return () => {\r\n      window.removeEventListener('resize', handleResize);\r\n    };\r\n  }, [responsive, autoResize, checkResponsive]);\r\n\r\n  // ResizeObserver for container size changes\r\n  useEffect(() => {\r\n    if (!autoResize || !layoutRef.current) return;\r\n\r\n    const resizeObserver = new ResizeObserver(() => {\r\n      checkResponsive();\r\n    });\r\n\r\n    resizeObserver.observe(layoutRef.current);\r\n\r\n    return () => {\r\n      resizeObserver.disconnect();\r\n    };\r\n  }, [autoResize, checkResponsive]);\r\n  \r\n  const layoutClasses = [\r\n    'avakio-layout',\r\n    `avakio-layout-theme-${theme}`,\r\n    `avakio-layout-type-${type}`,\r\n    (isRows || responsiveMode) ? 'avakio-layout-rows' : 'avakio-layout-cols',\r\n    borderless ? 'avakio-layout-borderless' : '',\r\n    disabled ? 'avakio-layout-disabled' : '',\r\n    hidden ? 'avakio-layout-hidden' : '',\r\n    responsive ? 'avakio-layout-responsive' : '',\r\n    responsiveMode ? 'avakio-layout-responsive-active' : '',\r\n    className,\r\n  ].filter(Boolean).join(' ');\r\n\r\n  const layoutStyles: React.CSSProperties = {\r\n    width: typeof width === 'number' ? `${width}px` : width,\r\n    height: typeof height === 'number' ? `${height}px` : height,\r\n    minWidth: typeof minWidth === 'number' ? `${minWidth}px` : minWidth,\r\n    minHeight: typeof minHeight === 'number' ? `${minHeight}px` : minHeight,\r\n    maxWidth: typeof maxWidth === 'number' ? `${maxWidth}px` : maxWidth,\r\n    maxHeight: typeof maxHeight === 'number' ? `${maxHeight}px` : maxHeight,\r\n    margin: typeof margin === 'number' ? `${margin}px` : margin,\r\n    gap: typeof gap === 'number' ? `${gap}px` : gap,\r\n    alignItems: align,\r\n    justifyContent: justify,\r\n    flex: gravity,\r\n    ...(css && typeof css === 'object' && !Array.isArray(css) ? css : {}),\r\n  };\r\n\r\n  // Handle padding\r\n  if (padding !== undefined) {\r\n    layoutStyles.padding = Array.isArray(padding) \r\n      ? `${padding[0]}px ${padding[1]}px ${padding[2]}px ${padding[3]}px`\r\n      : typeof padding === 'number' ? `${padding}px` : padding;\r\n  } else {\r\n    if (paddingX !== undefined) {\r\n      layoutStyles.paddingLeft = typeof paddingX === 'number' ? `${paddingX}px` : paddingX;\r\n      layoutStyles.paddingRight = typeof paddingX === 'number' ? `${paddingX}px` : paddingX;\r\n    }\r\n    if (paddingY !== undefined) {\r\n      layoutStyles.paddingTop = typeof paddingY === 'number' ? `${paddingY}px` : paddingY;\r\n      layoutStyles.paddingBottom = typeof paddingY === 'number' ? `${paddingY}px` : paddingY;\r\n    }\r\n  }\r\n\r\n  // Helper to check if a child element should flex\r\n  const shouldItemFlex = (item: React.ReactNode): boolean => {\r\n    if (!React.isValidElement(item)) return false;\r\n    const props = item.props as Record<string, unknown>;\r\n    // Check for flex in css prop or gravity prop\r\n    if (props.gravity) return true;\r\n    if (props.css && typeof props.css === 'object') {\r\n      const css = props.css as Record<string, unknown>;\r\n      if (css.flex === 1 || css.flex === '1') return true;\r\n    }\r\n    return false;\r\n  };\r\n\r\n  return (\r\n    <div\r\n      ref={layoutRef}\r\n      id={id}\r\n      data-testid={testId}\r\n      className={layoutClasses}\r\n      style={layoutStyles}\r\n    >\r\n      {items.length > 0\r\n        ? items.map((item, index) => {\r\n            const itemClasses = ['avakio-layout-item'];\r\n            if (shouldItemFlex(item)) {\r\n              itemClasses.push('avakio-layout-item-flex');\r\n            }\r\n            return (\r\n              <div key={index} className={itemClasses.join(' ')}>\r\n                {item}\r\n              </div>\r\n            );\r\n          })\r\n        : children}\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useRef, useState, useEffect } from 'react';\r\nimport './avakio-resizer.css';\r\n\r\nexport interface AvakioResizerProps {\r\n  /** Direction of the resizer: horizontal for row separation, vertical for column separation */\r\n  direction: 'horizontal' | 'vertical';\r\n  /** Theme to apply */\r\n  theme?: 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\n  /** Callback when resize starts */\r\n  onResizeStart?: () => void;\r\n  /** Callback during resize with delta value */\r\n  onResize?: (delta: number) => void;\r\n  /** Callback when resize ends */\r\n  onResizeEnd?: () => void;\r\n  /** Additional CSS classes */\r\n  className?: string;\r\n  /** Inline styles */\r\n  css?: React.CSSProperties;\r\n  /** ID of the component */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n}\r\n\r\n/**\r\n * AvakioResizer - A draggable resizer component for adjusting panel sizes\r\n * \r\n * Place between layout items to create resizable panels:\r\n * - Use direction=\"vertical\" between columns (horizontal drag)\r\n * - Use direction=\"horizontal\" between rows (vertical drag)\r\n * \r\n * @example\r\n * ```tsx\r\n * <AvakioLayout cols={[\r\n *   <div style={{ width: `${width}px` }}>Panel 1</div>,\r\n *   <AvakioResizer \r\n *     direction=\"vertical\" \r\n *     onResize={(delta) => setWidth(prev => prev + delta)} \r\n *   />,\r\n *   <div style={{ flex: 1 }}>Panel 2</div>\r\n * ]} />\r\n * ```\r\n */\r\nexport function AvakioResizer({\r\n  direction,\r\n  theme = 'material',\r\n  onResizeStart,\r\n  onResize,\r\n  onResizeEnd,\r\n  className = '',\r\n  css,\r\n  id,\r\n  testId,\r\n}: AvakioResizerProps) {\r\n  const resizerRef = useRef<HTMLDivElement>(null);\r\n  const startPosRef = useRef<number>(0);\r\n  const [isDragging, setIsDragging] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (!isDragging) return;\r\n\r\n    const handleMouseMove = (e: MouseEvent) => {\r\n      e.preventDefault();\r\n      \r\n      // Calculate delta based on direction\r\n      const currentPos = direction === 'horizontal' ? e.clientY : e.clientX;\r\n      const delta = currentPos - startPosRef.current;\r\n      \r\n      if (onResize) {\r\n        onResize(delta);\r\n      }\r\n      \r\n      // Update start position for next delta calculation\r\n      startPosRef.current = currentPos;\r\n    };\r\n\r\n    const handleMouseUp = () => {\r\n      setIsDragging(false);\r\n      document.body.style.cursor = '';\r\n      document.body.style.userSelect = '';\r\n      \r\n      if (onResizeEnd) {\r\n        onResizeEnd();\r\n      }\r\n    };\r\n\r\n    document.addEventListener('mousemove', handleMouseMove);\r\n    document.addEventListener('mouseup', handleMouseUp);\r\n\r\n    return () => {\r\n      document.removeEventListener('mousemove', handleMouseMove);\r\n      document.removeEventListener('mouseup', handleMouseUp);\r\n    };\r\n  }, [isDragging, direction, onResize, onResizeEnd]);\r\n\r\n  const handleMouseDown = (e: React.MouseEvent) => {\r\n    e.preventDefault();\r\n    \r\n    // Set initial position\r\n    startPosRef.current = direction === 'horizontal' ? e.clientY : e.clientX;\r\n    setIsDragging(true);\r\n    \r\n    // Set cursor for the entire document\r\n    document.body.style.cursor = direction === 'horizontal' ? 'row-resize' : 'col-resize';\r\n    document.body.style.userSelect = 'none';\r\n    \r\n    if (onResizeStart) {\r\n      onResizeStart();\r\n    }\r\n  };\r\n\r\n  const classes = [\r\n    'avakio-resizer',\r\n    `avakio-resizer-${direction}`,\r\n    `avakio-resizer-theme-${theme}`,\r\n    isDragging ? 'avakio-resizer-dragging' : '',\r\n    className,\r\n  ]\r\n    .filter(Boolean)\r\n    .join(' ');\r\n\r\n  return (\r\n    <div\r\n      ref={resizerRef}\r\n      id={id}\r\n      data-testid={testId}\r\n      className={classes}\r\n      data-admin-theme={theme}\r\n      onMouseDown={handleMouseDown}\r\n      style={css}\r\n      role=\"separator\"\r\n      aria-orientation={direction === 'horizontal' ? 'horizontal' : 'vertical'}\r\n      aria-label=\"Resizer\"\r\n    >\r\n      <div className=\"avakio-resizer-handle\" />\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useState, useRef, useCallback, useMemo } from 'react';\r\nimport { ChevronRight, ChevronLeft, ChevronsRight, ChevronsLeft, Search, GripVertical } from 'lucide-react';\r\nimport { cn } from '@/lib/utils';\r\nimport './avakio-doublelist.css';\r\n\r\nexport interface AvakioDoubleListItem {\r\n  id: string;\r\n  value: string;\r\n  disabled?: boolean;\r\n}\r\n\r\nexport interface AvakioDoubleListProps {\r\n  /** Array of all available items */\r\n  data: AvakioDoubleListItem[];\r\n  /** Array of selected item IDs (items in the right list) */\r\n  value: string[];\r\n  /** Callback when selection changes */\r\n  onChange: (selectedIds: string[]) => void;\r\n  /** Label for the left list */\r\n  labelLeft?: string;\r\n  /** Label for the right list */\r\n  labelRight?: string;\r\n  /** Label at the bottom of the left list */\r\n  labelBottomLeft?: string;\r\n  /** Label at the bottom of the right list */\r\n  labelBottomRight?: string;\r\n  /** Whether to show the control buttons between lists */\r\n  showButtons?: boolean;\r\n  /** Whether to enable search/filter in lists */\r\n  searchable?: boolean;\r\n  /** Whether to enable drag and drop */\r\n  draggable?: boolean;\r\n  /** Whether the component is disabled */\r\n  disabled?: boolean;\r\n  /** Custom height for the lists */\r\n  listHeight?: number | string;\r\n  /** Unique ID for the component */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n  /** Custom class name */\r\n  className?: string;\r\n}\r\n\r\nexport function AvakioDoubleList({\r\n  data,\r\n  value = [],\r\n  onChange,\r\n  labelLeft = \"Available\",\r\n  labelRight = \"Selected\",\r\n  labelBottomLeft,\r\n  labelBottomRight,\r\n  showButtons = true,\r\n  searchable = true,\r\n  draggable = true,\r\n  disabled = false,\r\n  listHeight = 300,\r\n  id,\r\n  testId,\r\n  className,\r\n}: AvakioDoubleListProps) {\r\n  const [leftSearch, setLeftSearch] = useState('');\r\n  const [rightSearch, setRightSearch] = useState('');\r\n  const [leftSelection, setLeftSelection] = useState<string[]>([]);\r\n  const [rightSelection, setRightSelection] = useState<string[]>([]);\r\n  const [draggedItem, setDraggedItem] = useState<string | null>(null);\r\n  const [dragOverSide, setDragOverSide] = useState<'left' | 'right' | null>(null);\r\n\r\n  const leftListRef = useRef<HTMLDivElement>(null);\r\n  const rightListRef = useRef<HTMLDivElement>(null);\r\n\r\n  // Compute left and right lists\r\n  const selectedSet = useMemo(() => new Set(value), [value]);\r\n  \r\n  const leftItems = useMemo(() => \r\n    data.filter(item => !selectedSet.has(item.id)),\r\n    [data, selectedSet]\r\n  );\r\n  \r\n  const rightItems = useMemo(() => \r\n    data.filter(item => selectedSet.has(item.id)),\r\n    [data, selectedSet]\r\n  );\r\n\r\n  // Filter items based on search\r\n  const filteredLeftItems = useMemo(() => {\r\n    if (!leftSearch.trim()) return leftItems;\r\n    const search = leftSearch.toLowerCase();\r\n    return leftItems.filter(item => item.value.toLowerCase().includes(search));\r\n  }, [leftItems, leftSearch]);\r\n\r\n  const filteredRightItems = useMemo(() => {\r\n    if (!rightSearch.trim()) return rightItems;\r\n    const search = rightSearch.toLowerCase();\r\n    return rightItems.filter(item => item.value.toLowerCase().includes(search));\r\n  }, [rightItems, rightSearch]);\r\n\r\n  // Move items to right (select)\r\n  const moveToRight = useCallback((ids: string[]) => {\r\n    const validIds = ids.filter(id => {\r\n      const item = data.find(d => d.id === id);\r\n      return item && !item.disabled && !selectedSet.has(id);\r\n    });\r\n    if (validIds.length > 0) {\r\n      onChange([...value, ...validIds]);\r\n      setLeftSelection([]);\r\n    }\r\n  }, [data, selectedSet, value, onChange]);\r\n\r\n  // Move items to left (deselect)\r\n  const moveToLeft = useCallback((ids: string[]) => {\r\n    const idsToRemove = new Set(ids.filter(id => {\r\n      const item = data.find(d => d.id === id);\r\n      return item && !item.disabled;\r\n    }));\r\n    if (idsToRemove.size > 0) {\r\n      onChange(value.filter(id => !idsToRemove.has(id)));\r\n      setRightSelection([]);\r\n    }\r\n  }, [data, value, onChange]);\r\n\r\n  // Move all to right\r\n  const moveAllToRight = useCallback(() => {\r\n    const newIds = leftItems\r\n      .filter(item => !item.disabled)\r\n      .map(item => item.id);\r\n    onChange([...value, ...newIds]);\r\n    setLeftSelection([]);\r\n  }, [leftItems, value, onChange]);\r\n\r\n  // Move all to left\r\n  const moveAllToLeft = useCallback(() => {\r\n    const disabledIds = rightItems\r\n      .filter(item => item.disabled)\r\n      .map(item => item.id);\r\n    onChange(disabledIds);\r\n    setRightSelection([]);\r\n  }, [rightItems, onChange]);\r\n\r\n  // Handle item click with multi-select support\r\n  const handleItemClick = useCallback((\r\n    itemId: string,\r\n    side: 'left' | 'right',\r\n    event: React.MouseEvent\r\n  ) => {\r\n    const item = data.find(d => d.id === itemId);\r\n    if (!item || item.disabled || disabled) return;\r\n\r\n    const setSelection = side === 'left' ? setLeftSelection : setRightSelection;\r\n    const selection = side === 'left' ? leftSelection : rightSelection;\r\n\r\n    if (event.ctrlKey || event.metaKey) {\r\n      // Toggle single item\r\n      setSelection(prev =>\r\n        prev.includes(itemId)\r\n          ? prev.filter(id => id !== itemId)\r\n          : [...prev, itemId]\r\n      );\r\n    } else if (event.shiftKey && selection.length > 0) {\r\n      // Range selection\r\n      const items = side === 'left' ? filteredLeftItems : filteredRightItems;\r\n      const lastSelected = selection[selection.length - 1];\r\n      const lastIndex = items.findIndex(i => i.id === lastSelected);\r\n      const currentIndex = items.findIndex(i => i.id === itemId);\r\n      \r\n      if (lastIndex !== -1 && currentIndex !== -1) {\r\n        const start = Math.min(lastIndex, currentIndex);\r\n        const end = Math.max(lastIndex, currentIndex);\r\n        const rangeIds = items\r\n          .slice(start, end + 1)\r\n          .filter(i => !i.disabled)\r\n          .map(i => i.id);\r\n        setSelection(rangeIds);\r\n      }\r\n    } else {\r\n      // Single selection\r\n      setSelection([itemId]);\r\n    }\r\n  }, [data, disabled, leftSelection, rightSelection, filteredLeftItems, filteredRightItems]);\r\n\r\n  // Handle double-click to move item\r\n  const handleItemDoubleClick = useCallback((itemId: string, side: 'left' | 'right') => {\r\n    if (disabled) return;\r\n    if (side === 'left') {\r\n      moveToRight([itemId]);\r\n    } else {\r\n      moveToLeft([itemId]);\r\n    }\r\n  }, [disabled, moveToRight, moveToLeft]);\r\n\r\n  // Drag and drop handlers\r\n  const handleDragStart = useCallback((e: React.DragEvent, itemId: string) => {\r\n    if (!draggable || disabled) return;\r\n    e.dataTransfer.setData('text/plain', itemId);\r\n    e.dataTransfer.effectAllowed = 'move';\r\n    setDraggedItem(itemId);\r\n  }, [draggable, disabled]);\r\n\r\n  const handleDragEnd = useCallback(() => {\r\n    setDraggedItem(null);\r\n    setDragOverSide(null);\r\n  }, []);\r\n\r\n  const handleDragOver = useCallback((e: React.DragEvent, side: 'left' | 'right') => {\r\n    if (!draggable || disabled) return;\r\n    e.preventDefault();\r\n    e.dataTransfer.dropEffect = 'move';\r\n    setDragOverSide(side);\r\n  }, [draggable, disabled]);\r\n\r\n  const handleDragLeave = useCallback(() => {\r\n    setDragOverSide(null);\r\n  }, []);\r\n\r\n  const handleDrop = useCallback((e: React.DragEvent, side: 'left' | 'right') => {\r\n    if (!draggable || disabled) return;\r\n    e.preventDefault();\r\n    const itemId = e.dataTransfer.getData('text/plain');\r\n    \r\n    if (itemId) {\r\n      const isCurrentlySelected = selectedSet.has(itemId);\r\n      \r\n      if (side === 'right' && !isCurrentlySelected) {\r\n        moveToRight([itemId]);\r\n      } else if (side === 'left' && isCurrentlySelected) {\r\n        moveToLeft([itemId]);\r\n      }\r\n    }\r\n    \r\n    setDraggedItem(null);\r\n    setDragOverSide(null);\r\n  }, [draggable, disabled, selectedSet, moveToRight, moveToLeft]);\r\n\r\n  // Render list item\r\n  const renderItem = (item: AvakioDoubleListItem, side: 'left' | 'right') => {\r\n    const selection = side === 'left' ? leftSelection : rightSelection;\r\n    const isSelected = selection.includes(item.id);\r\n    const isDragging = draggedItem === item.id;\r\n\r\n    return (\r\n      <div\r\n        key={item.id}\r\n        className={cn(\r\n          'avakio-doublelist-item',\r\n          isSelected && 'avakio-doublelist-item-selected',\r\n          item.disabled && 'avakio-doublelist-item-disabled',\r\n          isDragging && 'avakio-doublelist-item-dragging'\r\n        )}\r\n        onClick={(e) => handleItemClick(item.id, side, e)}\r\n        onDoubleClick={() => handleItemDoubleClick(item.id, side)}\r\n        draggable={draggable && !item.disabled && !disabled}\r\n        onDragStart={(e) => handleDragStart(e, item.id)}\r\n        onDragEnd={handleDragEnd}\r\n        data-item-id={item.id}\r\n      >\r\n        {draggable && !item.disabled && !disabled && (\r\n          <GripVertical size={14} className=\"avakio-doublelist-drag-handle\" />\r\n        )}\r\n        <span className=\"avakio-doublelist-item-text\">{item.value}</span>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const listStyle = { height: typeof listHeight === 'number' ? `${listHeight}px` : listHeight };\r\n\r\n  return (\r\n    <div\r\n      id={id}\r\n      data-testid={testId}\r\n      className={cn(\r\n        'avakio-doublelist',\r\n        disabled && 'avakio-doublelist-disabled',\r\n        className\r\n      )}\r\n    >\r\n      {/* Left Panel */}\r\n      <div className=\"avakio-doublelist-panel\">\r\n        {labelLeft && (\r\n          <div className=\"avakio-doublelist-label avakio-doublelist-label-top\">\r\n            {labelLeft}\r\n            <span className=\"avakio-doublelist-count\">({filteredLeftItems.length})</span>\r\n          </div>\r\n        )}\r\n        \r\n        {searchable && (\r\n          <div className=\"avakio-doublelist-search\">\r\n            <Search size={14} className=\"avakio-doublelist-search-icon\" />\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Search...\"\r\n              value={leftSearch}\r\n              onChange={(e) => setLeftSearch(e.target.value)}\r\n              disabled={disabled}\r\n              className=\"avakio-doublelist-search-input\"\r\n            />\r\n          </div>\r\n        )}\r\n        \r\n        <div\r\n          ref={leftListRef}\r\n          className={cn(\r\n            'avakio-doublelist-list',\r\n            dragOverSide === 'left' && 'avakio-doublelist-list-dragover'\r\n          )}\r\n          style={listStyle}\r\n          onDragOver={(e) => handleDragOver(e, 'left')}\r\n          onDragLeave={handleDragLeave}\r\n          onDrop={(e) => handleDrop(e, 'left')}\r\n        >\r\n          {filteredLeftItems.length === 0 ? (\r\n            <div className=\"avakio-doublelist-empty\">\r\n              {leftSearch ? 'No matches found' : 'No items available'}\r\n            </div>\r\n          ) : (\r\n            filteredLeftItems.map(item => renderItem(item, 'left'))\r\n          )}\r\n        </div>\r\n        \r\n        {labelBottomLeft && (\r\n          <div className=\"avakio-doublelist-label avakio-doublelist-label-bottom\">\r\n            {labelBottomLeft}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Buttons */}\r\n      {showButtons && (\r\n        <div className=\"avakio-doublelist-buttons\">\r\n          <button\r\n            type=\"button\"\r\n            className=\"avakio-doublelist-btn\"\r\n            onClick={() => moveToRight(leftSelection)}\r\n            disabled={disabled || leftSelection.length === 0}\r\n            title=\"Move selected to right\"\r\n          >\r\n            <ChevronRight size={18} />\r\n          </button>\r\n          <button\r\n            type=\"button\"\r\n            className=\"avakio-doublelist-btn\"\r\n            onClick={moveAllToRight}\r\n            disabled={disabled || leftItems.filter(i => !i.disabled).length === 0}\r\n            title=\"Move all to right\"\r\n          >\r\n            <ChevronsRight size={18} />\r\n          </button>\r\n          <button\r\n            type=\"button\"\r\n            className=\"avakio-doublelist-btn\"\r\n            onClick={() => moveToLeft(rightSelection)}\r\n            disabled={disabled || rightSelection.length === 0}\r\n            title=\"Move selected to left\"\r\n          >\r\n            <ChevronLeft size={18} />\r\n          </button>\r\n          <button\r\n            type=\"button\"\r\n            className=\"avakio-doublelist-btn\"\r\n            onClick={moveAllToLeft}\r\n            disabled={disabled || rightItems.filter(i => !i.disabled).length === 0}\r\n            title=\"Move all to left\"\r\n          >\r\n            <ChevronsLeft size={18} />\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {/* Right Panel */}\r\n      <div className=\"avakio-doublelist-panel\">\r\n        {labelRight && (\r\n          <div className=\"avakio-doublelist-label avakio-doublelist-label-top\">\r\n            {labelRight}\r\n            <span className=\"avakio-doublelist-count\">({filteredRightItems.length})</span>\r\n          </div>\r\n        )}\r\n        \r\n        {searchable && (\r\n          <div className=\"avakio-doublelist-search\">\r\n            <Search size={14} className=\"avakio-doublelist-search-icon\" />\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Search...\"\r\n              value={rightSearch}\r\n              onChange={(e) => setRightSearch(e.target.value)}\r\n              disabled={disabled}\r\n              className=\"avakio-doublelist-search-input\"\r\n            />\r\n          </div>\r\n        )}\r\n        \r\n        <div\r\n          ref={rightListRef}\r\n          className={cn(\r\n            'avakio-doublelist-list',\r\n            dragOverSide === 'right' && 'avakio-doublelist-list-dragover'\r\n          )}\r\n          style={listStyle}\r\n          onDragOver={(e) => handleDragOver(e, 'right')}\r\n          onDragLeave={handleDragLeave}\r\n          onDrop={(e) => handleDrop(e, 'right')}\r\n        >\r\n          {filteredRightItems.length === 0 ? (\r\n            <div className=\"avakio-doublelist-empty\">\r\n              {rightSearch ? 'No matches found' : 'No items selected'}\r\n            </div>\r\n          ) : (\r\n            filteredRightItems.map(item => renderItem(item, 'right'))\r\n          )}\r\n        </div>\r\n        \r\n        {labelBottomRight && (\r\n          <div className=\"avakio-doublelist-label avakio-doublelist-label-bottom\">\r\n            {labelBottomRight}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default AvakioDoubleList;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { forwardRef, useImperativeHandle, useRef, useState, useEffect, ReactNode } from 'react';\r\nimport './avakio-fieldset.css';\r\n\r\nexport type AvakioFieldsetTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\n\r\nexport interface AvakioFieldsetProps {\r\n  /** Unique identifier */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n  /** Legend/label text for the fieldset */\r\n  label?: string;\r\n  /** Body content of the fieldset */\r\n  children?: ReactNode;\r\n  /** Whether to hide borders */\r\n  borderless?: boolean;\r\n  /** Theme variant */\r\n  theme?: AvakioFieldsetTheme;\r\n  /** Disabled state - dims the fieldset */\r\n  disabled?: boolean;\r\n  /** Width of the fieldset */\r\n  width?: number | string;\r\n  /** Height of the fieldset */\r\n  height?: number | string;\r\n  /** Horizontal padding (left and right) */\r\n  paddingX?: number;\r\n  /** Vertical padding (top and bottom) */\r\n  paddingY?: number;\r\n  /** Custom CSS styles */\r\n  css?: React.CSSProperties;\r\n  /** Additional CSS class name */\r\n  className?: string;\r\n  /** Whether the fieldset is collapsible */\r\n  collapsible?: boolean;\r\n  /** Default collapsed state (only if collapsible) */\r\n  defaultCollapsed?: boolean;\r\n  /** Controlled collapsed state */\r\n  collapsed?: boolean;\r\n  /** Callback when collapsed state changes */\r\n  onCollapse?: (collapsed: boolean) => void;\r\n  /** Icon to display before the label */\r\n  icon?: ReactNode;\r\n}\r\n\r\nexport interface AvakioFieldsetRef {\r\n  /** Get the fieldset DOM node */\r\n  getNode: () => HTMLFieldSetElement | null;\r\n  /** Get the body container */\r\n  getBody: () => HTMLDivElement | null;\r\n  /** Check if fieldset is enabled */\r\n  isEnabled: () => boolean;\r\n  /** Enable the fieldset */\r\n  enable: () => void;\r\n  /** Disable the fieldset */\r\n  disable: () => void;\r\n  /** Collapse the fieldset (if collapsible) */\r\n  collapse: () => void;\r\n  /** Expand the fieldset (if collapsible) */\r\n  expand: () => void;\r\n  /** Check if collapsed */\r\n  isCollapsed: () => boolean;\r\n  /** Toggle collapsed state */\r\n  toggle: () => void;\r\n}\r\n\r\nexport const AvakioFieldset = forwardRef<AvakioFieldsetRef, AvakioFieldsetProps>(\r\n  (\r\n    {\r\n      id,\r\n      testId,\r\n      label,\r\n      children,\r\n      borderless = false,\r\n      theme,\r\n      disabled: disabledProp = false,\r\n      width,\r\n      height,\r\n      paddingX = 18,\r\n      paddingY = 16,\r\n      css,\r\n      className = '',\r\n      collapsible = false,\r\n      defaultCollapsed = false,\r\n      collapsed: collapsedProp,\r\n      onCollapse,\r\n      icon,\r\n    },\r\n    ref\r\n  ) => {\r\n    const fieldsetRef = useRef<HTMLFieldSetElement>(null);\r\n    const bodyRef = useRef<HTMLDivElement>(null);\r\n    \r\n    const [disabled, setDisabled] = useState(disabledProp);\r\n    const isControlledCollapse = collapsedProp !== undefined;\r\n    const [internalCollapsed, setInternalCollapsed] = useState(defaultCollapsed);\r\n    \r\n    const isCollapsed = isControlledCollapse ? collapsedProp : internalCollapsed;\r\n\r\n    // Sync disabled prop\r\n    useEffect(() => {\r\n      setDisabled(disabledProp);\r\n    }, [disabledProp]);\r\n\r\n    // Handle collapse toggle\r\n    const handleCollapseToggle = () => {\r\n      if (!collapsible) return;\r\n      \r\n      const newCollapsed = !isCollapsed;\r\n      if (!isControlledCollapse) {\r\n        setInternalCollapsed(newCollapsed);\r\n      }\r\n      onCollapse?.(newCollapsed);\r\n    };\r\n\r\n    // Expose imperative methods\r\n    useImperativeHandle(ref, () => ({\r\n      getNode: () => fieldsetRef.current,\r\n      getBody: () => bodyRef.current,\r\n      isEnabled: () => !disabled,\r\n      enable: () => setDisabled(false),\r\n      disable: () => setDisabled(true),\r\n      collapse: () => {\r\n        if (!collapsible) return;\r\n        if (!isControlledCollapse) {\r\n          setInternalCollapsed(true);\r\n        }\r\n        onCollapse?.(true);\r\n      },\r\n      expand: () => {\r\n        if (!collapsible) return;\r\n        if (!isControlledCollapse) {\r\n          setInternalCollapsed(false);\r\n        }\r\n        onCollapse?.(false);\r\n      },\r\n      isCollapsed: () => isCollapsed,\r\n      toggle: () => handleCollapseToggle(),\r\n    }), [disabled, isCollapsed, isControlledCollapse, collapsible, onCollapse]);\r\n\r\n    // Build class names\r\n    const containerClassNames = [\r\n      'avakio-fieldset',\r\n      theme && `avakio-fieldset-theme-${theme}`,\r\n      borderless && 'avakio-fieldset-borderless',\r\n      disabled && 'avakio-fieldset-disabled',\r\n      collapsible && 'avakio-fieldset-collapsible',\r\n      isCollapsed && 'avakio-fieldset-collapsed',\r\n      className,\r\n    ]\r\n      .filter(Boolean)\r\n      .join(' ');\r\n\r\n    // Build styles\r\n    const containerStyles: React.CSSProperties = {\r\n      ...(css && typeof css === 'object' && !Array.isArray(css) ? css : {}),\r\n      width: typeof width === 'number' ? `${width}px` : width,\r\n      height: typeof height === 'number' ? `${height}px` : height,\r\n    };\r\n\r\n    const bodyStyles: React.CSSProperties = {\r\n      paddingLeft: `${paddingX}px`,\r\n      paddingRight: `${paddingX}px`,\r\n      paddingTop: `${paddingY}px`,\r\n      paddingBottom: `${paddingY}px`,\r\n    };\r\n\r\n    return (\r\n      <fieldset\r\n        ref={fieldsetRef}\r\n        id={id}\r\n        data-testid={testId}\r\n        data-admin-theme={theme}\r\n        className={containerClassNames}\r\n        style={containerStyles}\r\n        disabled={disabled}\r\n      >\r\n        {label && (\r\n          <legend \r\n            className={`avakio-fieldset-legend ${collapsible ? 'avakio-fieldset-legend-clickable' : ''}`}\r\n            onClick={collapsible ? handleCollapseToggle : undefined}\r\n          >\r\n            {collapsible && (\r\n              <span className=\"avakio-fieldset-collapse-icon\">\r\n                <svg \r\n                  width=\"12\" \r\n                  height=\"12\" \r\n                  viewBox=\"0 0 12 12\" \r\n                  fill=\"none\" \r\n                  xmlns=\"http://www.w3.org/2000/svg\"\r\n                  className={`avakio-fieldset-chevron ${isCollapsed ? 'avakio-fieldset-chevron-collapsed' : ''}`}\r\n                >\r\n                  <path \r\n                    d=\"M3 4.5L6 7.5L9 4.5\" \r\n                    stroke=\"currentColor\" \r\n                    strokeWidth=\"1.5\" \r\n                    strokeLinecap=\"round\" \r\n                    strokeLinejoin=\"round\"\r\n                  />\r\n                </svg>\r\n              </span>\r\n            )}\r\n            {icon && <span className=\"avakio-fieldset-icon\">{icon}</span>}\r\n            <span className=\"avakio-fieldset-label-text\">{label}</span>\r\n          </legend>\r\n        )}\r\n        <div \r\n          ref={bodyRef}\r\n          className=\"avakio-fieldset-body\"\r\n          style={bodyStyles}\r\n        >\r\n          {children}\r\n        </div>\r\n      </fieldset>\r\n    );\r\n  }\r\n);\r\n\r\nAvakioFieldset.displayName = 'AvakioFieldset';\r\n\r\nexport default AvakioFieldset;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { forwardRef, useImperativeHandle, useRef, CSSProperties } from 'react';\r\nimport './avakio-label.css';\r\n\r\nexport interface AvakioLabelProps {\r\n  /** Unique identifier for the label */\r\n  id?: string;\r\n  /** Test identifier for testing */\r\n  testId?: string;\r\n  /** The text content of the label */\r\n  label?: string;\r\n  /** Custom HTML content (overrides label if provided) */\r\n  html?: string;\r\n  /** Alignment of the label (left, center, right) */\r\n  align?: 'left' | 'center' | 'right';\r\n  /** Width of the label */\r\n  width?: number | string;\r\n  /** Height of the label */\r\n  height?: number | string;\r\n  /** Theme variant */\r\n  theme?: 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\n  /** CSS class name */\r\n  className?: string;\r\n  /** Custom CSS styles */\r\n  css?: CSSProperties;\r\n  /** Tooltip text */\r\n  tooltip?: string;\r\n  /** Disabled state */\r\n  disabled?: boolean;\r\n  /** Hidden state */\r\n  hidden?: boolean;\r\n  /** Click handler */\r\n  onClick?: (e: React.MouseEvent<HTMLDivElement>) => void;\r\n  /** Whether to auto-adjust width based on content */\r\n  autowidth?: boolean;\r\n  /** Font size */\r\n  fontSize?: number | string;\r\n  /** Font weight */\r\n  fontWeight?: 'normal' | 'bold' | '100' | '200' | '300' | '400' | '500' | '600' | '700' | '800' | '900';\r\n  /** Text color */\r\n  color?: string;\r\n  /** Background color */\r\n  backgroundColor?: string;\r\n  /** Padding - can be a number (all sides), string, or array [top, right, bottom, left] */\r\n  padding?: string | number | [number, number, number, number];\r\n  /** Margin - can be a number (all sides), string, or array [top, right, bottom, left] */\r\n  margin?: string | number | [number, number, number, number];\r\n  /** Border */\r\n  border?: string;\r\n  /** Border radius */\r\n  borderRadius?: string | number;\r\n}\r\n\r\nexport interface AvakioLabelRef {\r\n  /** Get the label text content */\r\n  getValue: () => string;\r\n  /** Set the label text content */\r\n  setValue: (value: string) => void;\r\n  /** Set HTML content */\r\n  setHTML: (html: string) => void;\r\n  /** Get the DOM element */\r\n  getNode: () => HTMLDivElement | null;\r\n  /** Hide the label */\r\n  hide: () => void;\r\n  /** Show the label */\r\n  show: () => void;\r\n  /** Check if label is visible */\r\n  isVisible: () => boolean;\r\n  /** Disable the label */\r\n  disable: () => void;\r\n  /** Enable the label */\r\n  enable: () => void;\r\n  /** Check if label is enabled */\r\n  isEnabled: () => boolean;\r\n}\r\n\r\nexport const AvakioLabel = forwardRef<AvakioLabelRef, AvakioLabelProps>(\r\n  (\r\n    {\r\n      id,\r\n      testId,\r\n      label = '',\r\n      html,\r\n      align = 'left',\r\n      width,\r\n      height,\r\n      theme = 'material',\r\n      className = '',\r\n      css = {},\r\n      tooltip,\r\n      disabled = false,\r\n      hidden = false,\r\n      onClick,\r\n      autowidth = false,\r\n      fontSize,\r\n      fontWeight,\r\n      color,\r\n      backgroundColor,\r\n      padding,\r\n      margin,\r\n      border,\r\n      borderRadius,\r\n    },\r\n    ref\r\n  ) => {\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n    const [currentLabel, setCurrentLabel] = React.useState(label);\r\n    const [currentHtml, setCurrentHtml] = React.useState(html);\r\n    const [isVisible, setIsVisible] = React.useState(!hidden);\r\n    const [isDisabled, setIsDisabled] = React.useState(disabled);\r\n\r\n    // Expose ref methods\r\n    useImperativeHandle(ref, () => ({\r\n      getValue: () => currentLabel,\r\n      setValue: (value: string) => {\r\n        setCurrentLabel(value);\r\n        setCurrentHtml(undefined);\r\n      },\r\n      setHTML: (htmlContent: string) => {\r\n        setCurrentHtml(htmlContent);\r\n      },\r\n      getNode: () => containerRef.current,\r\n      hide: () => setIsVisible(false),\r\n      show: () => setIsVisible(true),\r\n      isVisible: () => isVisible,\r\n      disable: () => setIsDisabled(true),\r\n      enable: () => setIsDisabled(false),\r\n      isEnabled: () => !isDisabled,\r\n    }));\r\n\r\n    // Build CSS classes\r\n    const classes = [\r\n      'avakio-label',\r\n      `avakio-label-theme-${theme}`,\r\n      `avakio-label-align-${align}`,\r\n      isDisabled && 'avakio-label-disabled',\r\n      autowidth && 'avakio-label-autowidth',\r\n      className,\r\n    ]\r\n      .filter(Boolean)\r\n      .join(' ');\r\n\r\n    // Build inline styles\r\n    const inlineStyles: CSSProperties = {\r\n      ...(css && typeof css === 'object' && !Array.isArray(css) ? css : {}),\r\n      width: autowidth ? 'auto' : width,\r\n      height,\r\n      fontSize,\r\n      fontWeight,\r\n      color,\r\n      backgroundColor,\r\n      padding: Array.isArray(padding) \r\n        ? `${padding[0]}px ${padding[1]}px ${padding[2]}px ${padding[3]}px`\r\n        : typeof padding === 'number' ? `${padding}px` : padding,\r\n      margin: Array.isArray(margin) \r\n        ? `${margin[0]}px ${margin[1]}px ${margin[2]}px ${margin[3]}px`\r\n        : typeof margin === 'number' ? `${margin}px` : margin,\r\n      border,\r\n      borderRadius,\r\n      display: isVisible ? undefined : 'none',\r\n    };\r\n\r\n    // Handle click\r\n    const handleClick = (e: React.MouseEvent<HTMLDivElement>) => {\r\n      if (!isDisabled && onClick) {\r\n        onClick(e);\r\n      }\r\n    };\r\n\r\n    return (\r\n      <div\r\n        ref={containerRef}\r\n        id={id}\r\n        data-testid={testId}\r\n        className={classes}\r\n        style={inlineStyles}\r\n        title={tooltip}\r\n        onClick={handleClick}\r\n      >\r\n        {currentHtml ? (\r\n          <div dangerouslySetInnerHTML={{ __html: currentHtml }} />\r\n        ) : (\r\n          <span>{currentLabel}</span>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nAvakioLabel.displayName = 'AvakioLabel';\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { forwardRef, useImperativeHandle, useState, useRef, useEffect, useCallback } from 'react';\r\nimport { Plus, X } from 'lucide-react';\r\nimport './avakio-multitext.css';\r\n\r\nexport type AvakioMultitextTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\nexport type AvakioMultitextLabelPosition = 'left' | 'top';\r\n\r\nexport interface AvakioMultitextField {\r\n  /** Unique identifier for the field */\r\n  id: string;\r\n  /** Current value of the field */\r\n  value: string;\r\n  /** Whether this is the primary (non-removable) field */\r\n  isPrimary?: boolean;\r\n  /** Whether this field is disabled */\r\n  disabled?: boolean;\r\n}\r\n\r\nexport interface AvakioMultitextSubConfig {\r\n  /** Placeholder for additional fields */\r\n  placeholder?: string;\r\n  /** Max length for additional fields */\r\n  maxLength?: number;\r\n  /** Pattern for additional fields */\r\n  pattern?: string;\r\n  /** Disabled state for additional fields */\r\n  disabled?: boolean;\r\n}\r\n\r\nexport interface AvakioMultitextProps {\r\n  /** Unique identifier */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n  /** Name for form submission */\r\n  name?: string;\r\n  /** Current value (comma-separated string or array) */\r\n  value?: string | string[];\r\n  /** Default value */\r\n  defaultValue?: string | string[];\r\n  /** Label text */\r\n  label?: string;\r\n  /** Label width */\r\n  labelWidth?: number;\r\n  /** Label alignment */\r\n  labelAlign?: 'left' | 'right';\r\n  /** Label position */\r\n  labelPosition?: AvakioMultitextLabelPosition;\r\n  /** Placeholder for the primary field */\r\n  placeholder?: string;\r\n  /** Mark as required */\r\n  required?: boolean;\r\n  /** Error message */\r\n  error?: string;\r\n  /** Invalid message (shown on validation) */\r\n  invalidMessage?: string;\r\n  /** Bottom label text */\r\n  bottomLabel?: string;\r\n  /** Theme variant */\r\n  theme?: AvakioMultitextTheme;\r\n  /** Disabled state */\r\n  disabled?: boolean;\r\n  /** Readonly state */\r\n  readonly?: boolean;\r\n  /** CSS class name */\r\n  className?: string;\r\n  /** Inline styles */\r\n  css?: React.CSSProperties;\r\n  /** Width */\r\n  width?: number | string;\r\n  /** Height */\r\n  height?: number | string;\r\n  /** Minimum width */\r\n  minWidth?: number | string;\r\n  /** Maximum width */\r\n  maxWidth?: number | string;\r\n  /** Input alignment */\r\n  inputAlign?: 'left' | 'center' | 'right';\r\n  /** Input width */\r\n  inputWidth?: number;\r\n  /** Icon for add button */\r\n  icon?: React.ReactNode;\r\n  /** Icon width */\r\n  iconWidth?: number;\r\n  /** Maximum number of fields allowed */\r\n  maxFields?: number;\r\n  /** Separator for combined value string */\r\n  separator?: string;\r\n  /** Configuration for additional fields */\r\n  subConfig?: AvakioMultitextSubConfig;\r\n  /** Show line numbers */\r\n  showNumbers?: boolean;\r\n  /** Custom add button label */\r\n  addButtonLabel?: string;\r\n  /** Custom add button tooltip */\r\n  addButtonTooltip?: string;\r\n  /** Validate function */\r\n  validate?: (value: string[]) => boolean | string;\r\n  /** Validate event */\r\n  validateEvent?: 'change' | 'blur';\r\n  /** Max length per field */\r\n  maxLength?: number;\r\n  /** Pattern for HTML5 validation */\r\n  pattern?: string;\r\n  /** Autocomplete attribute */\r\n  autoComplete?: string;\r\n  /** Callback when value changes */\r\n  onChange?: (value: string[], combinedValue: string) => void;\r\n  /** Callback when a section is added */\r\n  onSectionAdd?: (fieldId: string, index: number) => void;\r\n  /** Callback when a section is removed */\r\n  onSectionRemove?: (fieldId: string, value: string) => void;\r\n  /** Callback when a field gains focus */\r\n  onFocus?: (fieldId: string, event: React.FocusEvent) => void;\r\n  /** Callback when a field loses focus */\r\n  onBlur?: (fieldId: string, event: React.FocusEvent) => void;\r\n  /** Callback on Enter key */\r\n  onEnter?: (fieldId: string, value: string) => void;\r\n}\r\n\r\nexport interface AvakioMultitextRef {\r\n  /** Get the combined value string */\r\n  getValue: () => string;\r\n  /** Get all values as an array */\r\n  getValues: () => string[];\r\n  /** Set the combined value string */\r\n  setValue: (value: string | string[]) => void;\r\n  /** Get the value of the primary (first) field only */\r\n  getValueHere: () => string;\r\n  /** Set the value of the primary (first) field only */\r\n  setValueHere: (value: string) => void;\r\n  /** Add a new empty field */\r\n  addSection: (value?: string) => string;\r\n  /** Remove a field by ID (cannot remove primary) */\r\n  removeSection: (fieldId?: string) => void;\r\n  /** Get all field IDs */\r\n  getFieldIds: () => string[];\r\n  /** Get a specific field by ID */\r\n  getField: (fieldId: string) => AvakioMultitextField | undefined;\r\n  /** Get the number of fields */\r\n  getFieldCount: () => number;\r\n  /** Clear all additional fields (keep primary) */\r\n  clearAdditional: () => void;\r\n  /** Clear all fields including primary value */\r\n  clear: () => void;\r\n  /** Focus the primary field */\r\n  focus: () => void;\r\n  /** Focus a specific field */\r\n  focusField: (fieldId: string) => void;\r\n  /** Blur all fields */\r\n  blur: () => void;\r\n  /** Refresh the component */\r\n  refresh: () => void;\r\n  /** Enable the component */\r\n  enable: () => void;\r\n  /** Disable the component */\r\n  disable: () => void;\r\n  /** Check if enabled */\r\n  isEnabled: () => boolean;\r\n  /** Hide the component */\r\n  hide: () => void;\r\n  /** Show the component */\r\n  show: () => void;\r\n  /** Check if visible */\r\n  isVisible: () => boolean;\r\n  /** Validate the control */\r\n  validate: () => boolean;\r\n  /** Get the HTML element */\r\n  getNode: () => HTMLDivElement | null;\r\n}\r\n\r\n// Generate unique ID for fields\r\nlet fieldIdCounter = 0;\r\nconst generateFieldId = () => `multitext-field-${++fieldIdCounter}`;\r\n\r\nexport const AvakioMultitext = forwardRef<AvakioMultitextRef, AvakioMultitextProps>(\r\n  (\r\n    {\r\n      id,\r\n      testId,\r\n      name,\r\n      value,\r\n      defaultValue,\r\n      label,\r\n      labelWidth = 100,\r\n      labelAlign = 'left',\r\n      labelPosition = 'left',\r\n      placeholder,\r\n      required = false,\r\n      error,\r\n      invalidMessage,\r\n      bottomLabel,\r\n      theme = 'material',\r\n      disabled = false,\r\n      readonly = false,\r\n      className = '',\r\n      css,\r\n      width,\r\n      height,\r\n      minWidth,\r\n      maxWidth,\r\n      inputAlign = 'left',\r\n      inputWidth,\r\n      icon,\r\n      iconWidth = 28,\r\n      maxFields,\r\n      separator = ', ',\r\n      subConfig,\r\n      showNumbers = false,\r\n      addButtonLabel,\r\n      addButtonTooltip = 'Add field',\r\n      validate,\r\n      validateEvent = 'blur',\r\n      maxLength,\r\n      pattern,\r\n      autoComplete,\r\n      onChange,\r\n      onSectionAdd,\r\n      onSectionRemove,\r\n      onFocus,\r\n      onBlur,\r\n      onEnter,\r\n    },\r\n    ref\r\n  ) => {\r\n    // Parse initial value\r\n    const parseValue = useCallback((val: string | string[] | undefined): AvakioMultitextField[] => {\r\n      if (!val) {\r\n        return [{ id: generateFieldId(), value: '', isPrimary: true }];\r\n      }\r\n      \r\n      const values = Array.isArray(val) \r\n        ? val \r\n        : val.split(separator).map(v => v.trim()).filter(v => v);\r\n      \r\n      if (values.length === 0) {\r\n        return [{ id: generateFieldId(), value: '', isPrimary: true }];\r\n      }\r\n      \r\n      return values.map((v, index) => ({\r\n        id: generateFieldId(),\r\n        value: v,\r\n        isPrimary: index === 0,\r\n      }));\r\n    }, [separator]);\r\n\r\n    const [fields, setFields] = useState<AvakioMultitextField[]>(() => \r\n      parseValue(value ?? defaultValue)\r\n    );\r\n    const [isDisabled, setIsDisabled] = useState(disabled);\r\n    const [isVisible, setIsVisible] = useState(true);\r\n    const [isInvalid, setIsInvalid] = useState(false);\r\n    const [validationMessage, setValidationMessage] = useState(error || invalidMessage || '');\r\n    const [refreshKey, setRefreshKey] = useState(0);\r\n\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n    const inputRefs = useRef<Map<string, HTMLInputElement>>(new Map());\r\n\r\n    // Sync with external value changes\r\n    useEffect(() => {\r\n      if (value !== undefined) {\r\n        setFields(parseValue(value));\r\n      }\r\n    }, [value, parseValue]);\r\n\r\n    // Sync disabled state\r\n    useEffect(() => {\r\n      setIsDisabled(disabled);\r\n    }, [disabled]);\r\n\r\n    // Sync error state\r\n    useEffect(() => {\r\n      if (error) {\r\n        setIsInvalid(true);\r\n        setValidationMessage(error);\r\n      } else if (invalidMessage) {\r\n        setValidationMessage(invalidMessage);\r\n      }\r\n    }, [error, invalidMessage]);\r\n\r\n    // Get combined value string\r\n    const getCombinedValue = useCallback(() => {\r\n      return fields.map(f => f.value).filter(v => v).join(separator);\r\n    }, [fields, separator]);\r\n\r\n    // Get values array\r\n    const getValuesArray = useCallback(() => {\r\n      return fields.map(f => f.value);\r\n    }, [fields]);\r\n\r\n    // Validate fields\r\n    const validateFields = useCallback(() => {\r\n      if (required && fields.every(f => !f.value.trim())) {\r\n        setIsInvalid(true);\r\n        setValidationMessage(invalidMessage || 'This field is required');\r\n        return false;\r\n      }\r\n\r\n      if (validate) {\r\n        const values = fields.map(f => f.value);\r\n        const result = validate(values);\r\n        if (typeof result === 'string') {\r\n          setIsInvalid(true);\r\n          setValidationMessage(result);\r\n          return false;\r\n        } else if (result === false) {\r\n          setIsInvalid(true);\r\n          setValidationMessage(invalidMessage || 'Invalid value');\r\n          return false;\r\n        }\r\n      }\r\n\r\n      setIsInvalid(false);\r\n      setValidationMessage('');\r\n      return true;\r\n    }, [fields, required, validate, invalidMessage]);\r\n\r\n    // Handle field value change\r\n    const handleFieldChange = useCallback((fieldId: string, newValue: string) => {\r\n      setFields(prev => {\r\n        const updated = prev.map(f => \r\n          f.id === fieldId ? { ...f, value: newValue } : f\r\n        );\r\n        \r\n        // Trigger onChange callback\r\n        setTimeout(() => {\r\n          const values = updated.map(f => f.value);\r\n          const combined = values.filter(v => v).join(separator);\r\n          onChange?.(values, combined);\r\n          \r\n          if (validateEvent === 'change') {\r\n            validateFields();\r\n          }\r\n        }, 0);\r\n        \r\n        return updated;\r\n      });\r\n    }, [separator, onChange, validateEvent, validateFields]);\r\n\r\n    // Handle add section\r\n    const handleAddSection = useCallback((initialValue: string = '') => {\r\n      if (maxFields && fields.length >= maxFields) {\r\n        return '';\r\n      }\r\n\r\n      const newFieldId = generateFieldId();\r\n      const newField: AvakioMultitextField = {\r\n        id: newFieldId,\r\n        value: initialValue,\r\n        isPrimary: false,\r\n      };\r\n\r\n      setFields(prev => [...prev, newField]);\r\n      \r\n      // Focus the new field after render\r\n      setTimeout(() => {\r\n        inputRefs.current.get(newFieldId)?.focus();\r\n      }, 50);\r\n\r\n      onSectionAdd?.(newFieldId, fields.length);\r\n      \r\n      // Trigger onChange\r\n      setTimeout(() => {\r\n        const values = [...fields.map(f => f.value), initialValue];\r\n        const combined = values.filter(v => v).join(separator);\r\n        onChange?.(values, combined);\r\n      }, 0);\r\n\r\n      return newFieldId;\r\n    }, [fields, maxFields, separator, onChange, onSectionAdd]);\r\n\r\n    // Handle remove section\r\n    const handleRemoveSection = useCallback((fieldId?: string) => {\r\n      setFields(prev => {\r\n        // If no fieldId, remove the last non-primary field\r\n        const targetId = fieldId || prev.filter(f => !f.isPrimary).pop()?.id;\r\n        if (!targetId) return prev;\r\n\r\n        const fieldToRemove = prev.find(f => f.id === targetId);\r\n        if (!fieldToRemove || fieldToRemove.isPrimary) return prev;\r\n\r\n        const updated = prev.filter(f => f.id !== targetId);\r\n        \r\n        onSectionRemove?.(targetId, fieldToRemove.value);\r\n        \r\n        // Trigger onChange\r\n        setTimeout(() => {\r\n          const values = updated.map(f => f.value);\r\n          const combined = values.filter(v => v).join(separator);\r\n          onChange?.(values, combined);\r\n        }, 0);\r\n\r\n        return updated;\r\n      });\r\n    }, [separator, onChange, onSectionRemove]);\r\n\r\n    // Handle key press\r\n    const handleKeyPress = useCallback((fieldId: string, e: React.KeyboardEvent<HTMLInputElement>) => {\r\n      if (e.key === 'Enter') {\r\n        const field = fields.find(f => f.id === fieldId);\r\n        if (field) {\r\n          onEnter?.(fieldId, field.value);\r\n        }\r\n      }\r\n    }, [fields, onEnter]);\r\n\r\n    // Handle focus\r\n    const handleFocus = useCallback((fieldId: string, e: React.FocusEvent<HTMLInputElement>) => {\r\n      onFocus?.(fieldId, e);\r\n    }, [onFocus]);\r\n\r\n    // Handle blur\r\n    const handleBlur = useCallback((fieldId: string, e: React.FocusEvent<HTMLInputElement>) => {\r\n      onBlur?.(fieldId, e);\r\n      \r\n      if (validateEvent === 'blur') {\r\n        validateFields();\r\n      }\r\n    }, [onBlur, validateEvent, validateFields]);\r\n\r\n    // Expose imperative methods\r\n    useImperativeHandle(ref, () => ({\r\n      getValue: () => getCombinedValue(),\r\n      getValues: () => getValuesArray(),\r\n      setValue: (val: string | string[]) => {\r\n        setFields(parseValue(val));\r\n      },\r\n      getValueHere: () => fields[0]?.value || '',\r\n      setValueHere: (val: string) => {\r\n        setFields(prev => {\r\n          const updated = [...prev];\r\n          if (updated[0]) {\r\n            updated[0] = { ...updated[0], value: val };\r\n          }\r\n          return updated;\r\n        });\r\n      },\r\n      addSection: (val?: string) => handleAddSection(val || ''),\r\n      removeSection: (fieldId?: string) => handleRemoveSection(fieldId),\r\n      getFieldIds: () => fields.map(f => f.id),\r\n      getField: (fieldId: string) => fields.find(f => f.id === fieldId),\r\n      getFieldCount: () => fields.length,\r\n      clearAdditional: () => {\r\n        setFields(prev => {\r\n          const primary = prev.find(f => f.isPrimary);\r\n          return primary ? [primary] : [{ id: generateFieldId(), value: '', isPrimary: true }];\r\n        });\r\n      },\r\n      clear: () => {\r\n        setFields([{ id: generateFieldId(), value: '', isPrimary: true }]);\r\n      },\r\n      focus: () => {\r\n        const primaryField = fields.find(f => f.isPrimary);\r\n        if (primaryField) {\r\n          inputRefs.current.get(primaryField.id)?.focus();\r\n        }\r\n      },\r\n      focusField: (fieldId: string) => {\r\n        inputRefs.current.get(fieldId)?.focus();\r\n      },\r\n      blur: () => {\r\n        inputRefs.current.forEach(input => input.blur());\r\n      },\r\n      refresh: () => setRefreshKey(k => k + 1),\r\n      enable: () => setIsDisabled(false),\r\n      disable: () => setIsDisabled(true),\r\n      isEnabled: () => !isDisabled,\r\n      hide: () => setIsVisible(false),\r\n      show: () => setIsVisible(true),\r\n      isVisible: () => isVisible,\r\n      validate: () => validateFields(),\r\n      getNode: () => containerRef.current,\r\n    }), [fields, getCombinedValue, getValuesArray, parseValue, handleAddSection, handleRemoveSection, isDisabled, isVisible, validateFields]);\r\n\r\n    // Build class names\r\n    const containerClasses = [\r\n      'avakio-multitext',\r\n      `avakio-multitext--${theme}`,\r\n      `avakio-multitext--label-${labelPosition}`,\r\n      isDisabled && 'avakio-multitext--disabled',\r\n      readonly && 'avakio-multitext--readonly',\r\n      isInvalid && 'avakio-multitext--invalid',\r\n      !isVisible && 'avakio-multitext--hidden',\r\n      className,\r\n    ].filter(Boolean).join(' ');\r\n\r\n    // Build container styles\r\n    const containerStyles: React.CSSProperties = {\r\n      ...(css && typeof css === 'object' && !Array.isArray(css) ? css : {}),\r\n      width: width ? (typeof width === 'number' ? `${width}px` : width) : undefined,\r\n      height: height ? (typeof height === 'number' ? `${height}px` : height) : undefined,\r\n      minWidth: minWidth ? (typeof minWidth === 'number' ? `${minWidth}px` : minWidth) : undefined,\r\n      maxWidth: maxWidth ? (typeof maxWidth === 'number' ? `${maxWidth}px` : maxWidth) : undefined,\r\n    };\r\n\r\n    const canAddMore = !maxFields || fields.length < maxFields;\r\n\r\n    if (!isVisible) {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <div\r\n        ref={containerRef}\r\n        id={id}\r\n        data-testid={testId}\r\n        className={containerClasses}\r\n        style={containerStyles}\r\n        data-admin-theme={theme}\r\n        key={refreshKey}\r\n      >\r\n        {/* Label */}\r\n        {label && (\r\n          <label \r\n            className=\"avakio-multitext__label\"\r\n            style={{ \r\n              width: labelPosition === 'left' ? `${labelWidth}px` : undefined,\r\n              textAlign: labelAlign,\r\n            }}\r\n          >\r\n            {label}\r\n            {required && <span className=\"avakio-multitext__required\">*</span>}\r\n          </label>\r\n        )}\r\n\r\n        {/* Fields container */}\r\n        <div className=\"avakio-multitext__fields\">\r\n          {fields.map((field, index) => (\r\n            <div key={field.id} className=\"avakio-multitext__field-row\">\r\n              {/* Line number */}\r\n              {showNumbers && (\r\n                <span className=\"avakio-multitext__field-number\">{index + 1}.</span>\r\n              )}\r\n\r\n              {/* Input */}\r\n              <div className=\"avakio-multitext__input-wrapper\">\r\n                <input\r\n                  ref={(el) => {\r\n                    if (el) {\r\n                      inputRefs.current.set(field.id, el);\r\n                    } else {\r\n                      inputRefs.current.delete(field.id);\r\n                    }\r\n                  }}\r\n                  type=\"text\"\r\n                  name={name ? `${name}[${index}]` : undefined}\r\n                  value={field.value}\r\n                  placeholder={field.isPrimary ? placeholder : (subConfig?.placeholder || placeholder)}\r\n                  disabled={isDisabled || field.disabled || (field.isPrimary ? false : subConfig?.disabled)}\r\n                  readOnly={readonly}\r\n                  maxLength={field.isPrimary ? maxLength : (subConfig?.maxLength || maxLength)}\r\n                  pattern={field.isPrimary ? pattern : (subConfig?.pattern || pattern)}\r\n                  autoComplete={autoComplete}\r\n                  className=\"avakio-multitext__input\"\r\n                  style={{ \r\n                    textAlign: inputAlign,\r\n                    width: inputWidth ? `${inputWidth}px` : undefined,\r\n                  }}\r\n                  onChange={(e) => handleFieldChange(field.id, e.target.value)}\r\n                  onKeyPress={(e) => handleKeyPress(field.id, e)}\r\n                  onFocus={(e) => handleFocus(field.id, e)}\r\n                  onBlur={(e) => handleBlur(field.id, e)}\r\n                  aria-invalid={isInvalid}\r\n                  aria-describedby={isInvalid ? `${id}-error` : undefined}\r\n                />\r\n\r\n                {/* Add button (only on primary) */}\r\n                {field.isPrimary && !readonly && canAddMore && (\r\n                  <button\r\n                    type=\"button\"\r\n                    className=\"avakio-multitext__add-btn\"\r\n                    onClick={() => handleAddSection()}\r\n                    disabled={isDisabled}\r\n                    title={addButtonTooltip}\r\n                    style={{ width: iconWidth ? `${iconWidth}px` : undefined }}\r\n                    aria-label={addButtonLabel || 'Add field'}\r\n                  >\r\n                    {icon || <Plus size={16} />}\r\n                    {addButtonLabel && (\r\n                      <span className=\"avakio-multitext__add-btn-label\">{addButtonLabel}</span>\r\n                    )}\r\n                  </button>\r\n                )}\r\n\r\n                {/* Remove button (only on non-primary) */}\r\n                {!field.isPrimary && !readonly && (\r\n                  <button\r\n                    type=\"button\"\r\n                    className=\"avakio-multitext__remove-btn\"\r\n                    onClick={() => handleRemoveSection(field.id)}\r\n                    disabled={isDisabled}\r\n                    title=\"Remove field\"\r\n                    aria-label=\"Remove field\"\r\n                  >\r\n                    <X size={16} />\r\n                  </button>\r\n                )}\r\n              </div>\r\n            </div>\r\n          ))}\r\n\r\n          {/* Bottom label */}\r\n          {bottomLabel && (\r\n            <div className=\"avakio-multitext__bottom-label\">{bottomLabel}</div>\r\n          )}\r\n\r\n          {/* Error message */}\r\n          {isInvalid && validationMessage && (\r\n            <div id={`${id}-error`} className=\"avakio-multitext__error\" role=\"alert\">\r\n              {validationMessage}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nAvakioMultitext.displayName = 'AvakioMultitext';\r\n\r\nexport default AvakioMultitext;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { forwardRef, useImperativeHandle, useState, useRef, useEffect, useId } from 'react';\r\nimport './avakio-radio.css';\r\n\r\nexport type AvakioRadioTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\nexport type AvakioRadioSize = 'sm' | 'md' | 'lg';\r\n\r\nexport interface AvakioRadioOption {\r\n  /** Unique identifier for the option */\r\n  id: string | number;\r\n  /** Display label for the option */\r\n  value: string;\r\n  /** Optional icon */\r\n  icon?: React.ReactNode;\r\n  /** Whether this option is disabled */\r\n  disabled?: boolean;\r\n  /** Whether this option is hidden */\r\n  hidden?: boolean;\r\n  /** Custom CSS class for this option */\r\n  css?: string;\r\n  /** Tooltip for this option */\r\n  tooltip?: string;\r\n}\r\n\r\nexport interface AvakioRadioProps {\r\n  /** Unique identifier */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n  /** Name for form submission */\r\n  name?: string;\r\n  /** Current selected value (controlled) */\r\n  value?: string | number | null;\r\n  /** Default selected value (uncontrolled) */\r\n  defaultValue?: string | number | null;\r\n  /** Array of radio options */\r\n  options: AvakioRadioOption[] | string[];\r\n  /** Label text (displayed to the left or top) */\r\n  label?: string;\r\n  /** Width of the label in pixels */\r\n  labelWidth?: number;\r\n  /** Label alignment ('left' | 'right') */\r\n  labelAlign?: 'left' | 'right';\r\n  /** Label position ('left' | 'top') */\r\n  labelPosition?: 'left' | 'top';\r\n  /** Vertical layout for radio options */\r\n  vertical?: boolean;\r\n  /** Radio button size */\r\n  size?: AvakioRadioSize;\r\n  /** Theme variant */\r\n  theme?: AvakioRadioTheme;\r\n  /** Disabled state for all options */\r\n  disabled?: boolean;\r\n  /** Required field */\r\n  required?: boolean;\r\n  /** Invalid state */\r\n  invalid?: boolean;\r\n  /** Invalid message */\r\n  invalidMessage?: string;\r\n  /** Bottom label text */\r\n  bottomLabel?: string;\r\n  /** Custom radio rendering (false = use native HTML radio) */\r\n  customRadio?: boolean;\r\n  /** Height of each radio option */\r\n  optionHeight?: number;\r\n  /** CSS class name */\r\n  className?: string;\r\n  /** Inline styles */\r\n  css?: React.CSSProperties;\r\n  /** Width */\r\n  width?: number | string;\r\n  /** Height */\r\n  height?: number | string;\r\n  /** Callback when value changes */\r\n  onChange?: (value: string | number) => void;\r\n  /** Callback when an option is clicked */\r\n  onClick?: (e: React.MouseEvent, option: AvakioRadioOption) => void;\r\n  /** Callback when focused */\r\n  onFocus?: (e: React.FocusEvent) => void;\r\n  /** Callback when blurred */\r\n  onBlur?: (e: React.FocusEvent) => void;\r\n}\r\n\r\nexport interface AvakioRadioRef {\r\n  /** Get the current selected value */\r\n  getValue: () => string | number | null;\r\n  /** Set the selected value */\r\n  setValue: (value: string | number | null) => void;\r\n  /** Focus the first non-disabled option */\r\n  focus: () => void;\r\n  /** Blur the control */\r\n  blur: () => void;\r\n  /** Enable the control */\r\n  enable: () => void;\r\n  /** Disable the control */\r\n  disable: () => void;\r\n  /** Enable a specific option */\r\n  enableOption: (id: string | number) => void;\r\n  /** Disable a specific option */\r\n  disableOption: (id: string | number) => void;\r\n  /** Show a hidden option */\r\n  showOption: (id: string | number) => void;\r\n  /** Hide an option */\r\n  hideOption: (id: string | number) => void;\r\n  /** Check if enabled */\r\n  isEnabled: () => boolean;\r\n  /** Get the HTML container element */\r\n  getNode: () => HTMLDivElement | null;\r\n  /** Get the option configuration by id */\r\n  getOption: (id: string | number) => AvakioRadioOption | undefined;\r\n  /** Refresh/repaint the component */\r\n  refresh: () => void;\r\n}\r\n\r\n// Normalize options to consistent format\r\nfunction normalizeOptions(options: AvakioRadioOption[] | string[]): AvakioRadioOption[] {\r\n  return options.map((opt, index) => {\r\n    if (typeof opt === 'string') {\r\n      return { id: opt, value: opt };\r\n    }\r\n    return opt;\r\n  });\r\n}\r\n\r\nexport const AvakioRadio = forwardRef<AvakioRadioRef, AvakioRadioProps>(\r\n  (\r\n    {\r\n      id,\r\n      testId,\r\n      name,\r\n      value,\r\n      defaultValue = null,\r\n      options: optionsProp,\r\n      label,\r\n      labelWidth = 80,\r\n      labelAlign = 'left',\r\n      labelPosition = 'left',\r\n      vertical = false,\r\n      size = 'md',\r\n      theme,\r\n      disabled: disabledProp = false,\r\n      required = false,\r\n      invalid = false,\r\n      invalidMessage,\r\n      bottomLabel,\r\n      customRadio = true,\r\n      optionHeight,\r\n      className = '',\r\n      css,\r\n      width,\r\n      height,\r\n      onChange,\r\n      onClick,\r\n      onFocus,\r\n      onBlur,\r\n    },\r\n    ref\r\n  ) => {\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n    const inputRefs = useRef<Map<string | number, HTMLInputElement>>(new Map());\r\n    const autoId = useId();\r\n    const radioName = name || `avakio-radio-${autoId}`;\r\n    \r\n    const isControlled = value !== undefined;\r\n    const [internalValue, setInternalValue] = useState<string | number | null>(defaultValue);\r\n    const [disabled, setDisabled] = useState<boolean>(disabledProp);\r\n    const [optionStates, setOptionStates] = useState<Map<string | number, { disabled?: boolean; hidden?: boolean }>>(new Map());\r\n    const [, forceUpdate] = useState({});\r\n\r\n    const currentValue = isControlled ? value : internalValue;\r\n    const options = normalizeOptions(optionsProp);\r\n\r\n    // Sync disabled prop\r\n    useEffect(() => {\r\n      setDisabled(disabledProp);\r\n    }, [disabledProp]);\r\n\r\n    // Get effective option state (merged with local overrides)\r\n    const getOptionState = (opt: AvakioRadioOption) => {\r\n      const override = optionStates.get(opt.id);\r\n      return {\r\n        disabled: override?.disabled ?? opt.disabled ?? false,\r\n        hidden: override?.hidden ?? opt.hidden ?? false,\r\n      };\r\n    };\r\n\r\n    // Expose imperative methods\r\n    useImperativeHandle(ref, () => ({\r\n      getValue: () => (isControlled ? value : internalValue) ?? null,\r\n      setValue: (newValue: string | number | null) => {\r\n        if (!isControlled) {\r\n          setInternalValue(newValue);\r\n        }\r\n        if (newValue !== null) {\r\n          onChange?.(newValue);\r\n        }\r\n      },\r\n      focus: () => {\r\n        const firstEnabled = options.find(opt => !getOptionState(opt).disabled && !getOptionState(opt).hidden);\r\n        if (firstEnabled) {\r\n          inputRefs.current.get(firstEnabled.id)?.focus();\r\n        }\r\n      },\r\n      blur: () => {\r\n        if (document.activeElement instanceof HTMLElement) {\r\n          document.activeElement.blur();\r\n        }\r\n      },\r\n      enable: () => setDisabled(false),\r\n      disable: () => setDisabled(true),\r\n      enableOption: (optId: string | number) => {\r\n        setOptionStates(prev => {\r\n          const next = new Map(prev);\r\n          const current = next.get(optId) || {};\r\n          next.set(optId, { ...current, disabled: false });\r\n          return next;\r\n        });\r\n      },\r\n      disableOption: (optId: string | number) => {\r\n        setOptionStates(prev => {\r\n          const next = new Map(prev);\r\n          const current = next.get(optId) || {};\r\n          next.set(optId, { ...current, disabled: true });\r\n          return next;\r\n        });\r\n      },\r\n      showOption: (optId: string | number) => {\r\n        setOptionStates(prev => {\r\n          const next = new Map(prev);\r\n          const current = next.get(optId) || {};\r\n          next.set(optId, { ...current, hidden: false });\r\n          return next;\r\n        });\r\n      },\r\n      hideOption: (optId: string | number) => {\r\n        setOptionStates(prev => {\r\n          const next = new Map(prev);\r\n          const current = next.get(optId) || {};\r\n          next.set(optId, { ...current, hidden: true });\r\n          return next;\r\n        });\r\n      },\r\n      isEnabled: () => !disabled,\r\n      getNode: () => containerRef.current,\r\n      getOption: (optId: string | number) => options.find(opt => opt.id === optId),\r\n      refresh: () => forceUpdate({}),\r\n    }));\r\n\r\n    const handleChange = (optionId: string | number) => {\r\n      if (!isControlled) {\r\n        setInternalValue(optionId);\r\n      }\r\n      onChange?.(optionId);\r\n    };\r\n\r\n    const handleKeyDown = (e: React.KeyboardEvent, currentIndex: number) => {\r\n      const visibleOptions = options.filter(opt => !getOptionState(opt).hidden);\r\n      const currentVisibleIndex = visibleOptions.findIndex(opt => opt.id === options[currentIndex].id);\r\n      \r\n      let nextIndex = -1;\r\n      \r\n      if (e.key === 'ArrowDown' || e.key === 'ArrowRight') {\r\n        e.preventDefault();\r\n        for (let i = 1; i <= visibleOptions.length; i++) {\r\n          const idx = (currentVisibleIndex + i) % visibleOptions.length;\r\n          if (!getOptionState(visibleOptions[idx]).disabled) {\r\n            nextIndex = idx;\r\n            break;\r\n          }\r\n        }\r\n      } else if (e.key === 'ArrowUp' || e.key === 'ArrowLeft') {\r\n        e.preventDefault();\r\n        for (let i = 1; i <= visibleOptions.length; i++) {\r\n          const idx = (currentVisibleIndex - i + visibleOptions.length) % visibleOptions.length;\r\n          if (!getOptionState(visibleOptions[idx]).disabled) {\r\n            nextIndex = idx;\r\n            break;\r\n          }\r\n        }\r\n      }\r\n\r\n      if (nextIndex >= 0) {\r\n        const nextOption = visibleOptions[nextIndex];\r\n        inputRefs.current.get(nextOption.id)?.focus();\r\n        handleChange(nextOption.id);\r\n      }\r\n    };\r\n\r\n    const containerClasses = [\r\n      'avakio-radio-container',\r\n      `avakio-radio-container-${size}`,\r\n      vertical ? 'avakio-radio-vertical' : 'avakio-radio-horizontal',\r\n      labelPosition === 'top' ? 'avakio-radio-label-top' : '',\r\n      disabled ? 'avakio-radio-container-disabled' : '',\r\n      invalid ? 'avakio-radio-container-invalid' : '',\r\n      className,\r\n    ].filter(Boolean).join(' ');\r\n\r\n    const containerStyle: React.CSSProperties = {\r\n      ...(css && typeof css === 'object' && !Array.isArray(css) ? css : {}),\r\n      ...(width ? { width: typeof width === 'number' ? `${width}px` : width } : {}),\r\n      ...(height ? { height: typeof height === 'number' ? `${height}px` : height } : {}),\r\n    };\r\n\r\n    return (\r\n      <div\r\n        ref={containerRef}\r\n        id={id}\r\n        data-testid={testId}\r\n        className={containerClasses}\r\n        style={containerStyle}\r\n        data-admin-theme={theme}\r\n        role=\"radiogroup\"\r\n        aria-labelledby={label ? `${radioName}-label` : undefined}\r\n        aria-required={required}\r\n        aria-invalid={invalid}\r\n      >\r\n        {/* Label */}\r\n        {label && (\r\n          <label\r\n            id={`${radioName}-label`}\r\n            className={`avakio-radio-label avakio-radio-label-${labelAlign}`}\r\n            style={{ width: labelPosition === 'left' ? labelWidth : undefined }}\r\n          >\r\n            {label}\r\n            {required && <span className=\"avakio-radio-required\">*</span>}\r\n          </label>\r\n        )}\r\n\r\n        {/* Options Container */}\r\n        <div className=\"avakio-radio-options\">\r\n          {options.map((option, index) => {\r\n            const optState = getOptionState(option);\r\n            if (optState.hidden) return null;\r\n\r\n            const isChecked = currentValue === option.id;\r\n            const isDisabled = disabled || optState.disabled;\r\n\r\n            const optionClasses = [\r\n              'avakio-radio-option',\r\n              isChecked ? 'avakio-radio-option-checked' : '',\r\n              isDisabled ? 'avakio-radio-option-disabled' : '',\r\n              customRadio ? 'avakio-radio-custom' : 'avakio-radio-native',\r\n              option.css || '',\r\n            ].filter(Boolean).join(' ');\r\n\r\n            const optionStyle: React.CSSProperties = optionHeight\r\n              ? { height: optionHeight }\r\n              : {};\r\n\r\n            return (\r\n              <label\r\n                key={option.id}\r\n                className={optionClasses}\r\n                style={optionStyle}\r\n                title={option.tooltip}\r\n                onClick={(e) => {\r\n                  if (!isDisabled) {\r\n                    onClick?.(e, option);\r\n                  }\r\n                }}\r\n              >\r\n                <input\r\n                  ref={(el) => {\r\n                    if (el) {\r\n                      inputRefs.current.set(option.id, el);\r\n                    } else {\r\n                      inputRefs.current.delete(option.id);\r\n                    }\r\n                  }}\r\n                  type=\"radio\"\r\n                  name={radioName}\r\n                  value={String(option.id)}\r\n                  checked={isChecked}\r\n                  disabled={isDisabled}\r\n                  onChange={() => handleChange(option.id)}\r\n                  onKeyDown={(e) => handleKeyDown(e, index)}\r\n                  onFocus={onFocus}\r\n                  onBlur={onBlur}\r\n                  className=\"avakio-radio-input\"\r\n                  aria-checked={isChecked}\r\n                />\r\n                {customRadio && (\r\n                  <span className=\"avakio-radio-indicator\">\r\n                    <span className=\"avakio-radio-dot\" />\r\n                  </span>\r\n                )}\r\n                {option.icon && (\r\n                  <span className=\"avakio-radio-icon\">{option.icon}</span>\r\n                )}\r\n                <span className=\"avakio-radio-text\">{option.value}</span>\r\n              </label>\r\n            );\r\n          })}\r\n        </div>\r\n\r\n        {/* Bottom Section */}\r\n        {(bottomLabel || (invalid && invalidMessage)) && (\r\n          <div className=\"avakio-radio-bottom\" style={{ paddingLeft: labelPosition === 'left' ? labelWidth + 8 : 0 }}>\r\n            {invalid && invalidMessage ? (\r\n              <span className=\"avakio-radio-invalid-message\">{invalidMessage}</span>\r\n            ) : bottomLabel ? (\r\n              <span className=\"avakio-radio-bottom-label\">{bottomLabel}</span>\r\n            ) : null}\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nAvakioRadio.displayName = 'AvakioRadio';\r\n\r\nexport default AvakioRadio;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { forwardRef, useImperativeHandle, useState, useRef, useEffect, useCallback } from 'react';\r\nimport './avakio-segmented-button.css';\r\n\r\nexport type AvakioSegmentedButtonTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\nexport type AvakioSegmentedButtonSize = 'sm' | 'md' | 'lg';\r\nexport type AvakioSegmentedButtonAlign = 'left' | 'center' | 'right';\r\n\r\nexport interface AvakioSegmentedOption {\r\n  /** Unique identifier for the option */\r\n  id: string | number;\r\n  /** Display label for the segment */\r\n  value: string;\r\n  /** Optional icon to display */\r\n  icon?: React.ReactNode;\r\n  /** Badge content (string or number) */\r\n  badge?: string | number;\r\n  /** Whether this option is disabled */\r\n  disabled?: boolean;\r\n  /** Whether this option is hidden */\r\n  hidden?: boolean;\r\n  /** Tooltip text for this option */\r\n  tooltip?: string;\r\n  /** ARIA controls ID */\r\n  ariaControls?: string;\r\n}\r\n\r\nexport interface AvakioSegmentedButtonProps {\r\n  /** Unique identifier */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n  /** Name for form submission */\r\n  name?: string;\r\n  /** Current selected value (controlled) */\r\n  value?: string | number | null;\r\n  /** Default selected value (uncontrolled) */\r\n  defaultValue?: string | number;\r\n  /** Array of options or simple string array */\r\n  options?: AvakioSegmentedOption[] | string[];\r\n  /** Label text */\r\n  label?: string;\r\n  /** Label width */\r\n  labelWidth?: number;\r\n  /** Label alignment */\r\n  labelAlign?: 'left' | 'right';\r\n  /** Label position */\r\n  labelPosition?: 'left' | 'top';\r\n  /** Mark as required */\r\n  required?: boolean;\r\n  /** Error message */\r\n  error?: string;\r\n  /** Invalid message (shown on validation) */\r\n  invalidMessage?: string;\r\n  /** Bottom label text */\r\n  bottomLabel?: string;\r\n  /** Button size */\r\n  size?: AvakioSegmentedButtonSize;\r\n  /** Content alignment */\r\n  align?: AvakioSegmentedButtonAlign;\r\n  /** Theme variant */\r\n  theme?: AvakioSegmentedButtonTheme;\r\n  /** Whether to fill available width */\r\n  fill?: boolean;\r\n  /** Fixed option width */\r\n  optionWidth?: number;\r\n  /** Disabled state */\r\n  disabled?: boolean;\r\n  /** Borderless style */\r\n  borderless?: boolean;\r\n  /** CSS class name */\r\n  className?: string;\r\n  /** Inline styles */\r\n  css?: React.CSSProperties;\r\n  /** Width */\r\n  width?: number | string;\r\n  /** Height */\r\n  height?: number | string;\r\n  /** Minimum width */\r\n  minWidth?: number | string;\r\n  /** Maximum width */\r\n  maxWidth?: number | string;\r\n  /** Connect to multiview (for switching views) */\r\n  multiview?: boolean;\r\n  /** Tooltip text */\r\n  tooltip?: string;\r\n  /** Input alignment */\r\n  inputAlign?: 'left' | 'center' | 'right';\r\n  /** Input width */\r\n  inputWidth?: number;\r\n  /** Input height */\r\n  inputHeight?: number;\r\n  /** Callback when value changes */\r\n  onChange?: (value: string | number | null, option?: AvakioSegmentedOption | null) => void;\r\n  /** Callback before segment is clicked (return false to cancel) */\r\n  onBeforeTabClick?: (id: string | number) => boolean | void;\r\n  /** Callback after segment is clicked */\r\n  onAfterTabClick?: (id: string | number) => void;\r\n  /** Callback when an option is added */\r\n  onOptionAdd?: (option: AvakioSegmentedOption) => void;\r\n  /** Callback when an option is removed */\r\n  onOptionRemove?: (id: string | number) => void;\r\n}\r\n\r\nexport interface AvakioSegmentedButtonRef {\r\n  /** Get the current selected value */\r\n  getValue: () => string | number | null;\r\n  /** Set the selected value */\r\n  setValue: (value: string | number | null) => void;\r\n  /** Get a specific option by ID */\r\n  getOption: (id: string | number) => AvakioSegmentedOption | undefined;\r\n  /** Get all options */\r\n  getOptions: () => AvakioSegmentedOption[];\r\n  /** Add a new option */\r\n  addOption: (option: AvakioSegmentedOption, index?: number) => void;\r\n  /** Remove an option by ID */\r\n  removeOption: (id: string | number) => void;\r\n  /** Hide an option */\r\n  hideOption: (id: string | number) => void;\r\n  /** Show a hidden option */\r\n  showOption: (id: string | number) => void;\r\n  /** Disable a specific option */\r\n  disableOption: (id: string | number) => void;\r\n  /** Enable a specific option */\r\n  enableOption: (id: string | number) => void;\r\n  /** Get the index of an option */\r\n  optionIndex: (id: string | number) => number;\r\n  /** Refresh the component */\r\n  refresh: () => void;\r\n  /** Focus the component */\r\n  focus: () => void;\r\n  /** Blur the component */\r\n  blur: () => void;\r\n  /** Enable the component */\r\n  enable: () => void;\r\n  /** Disable the component */\r\n  disable: () => void;\r\n  /** Check if enabled */\r\n  isEnabled: () => boolean;\r\n  /** Hide the component */\r\n  hide: () => void;\r\n  /** Show the component */\r\n  show: () => void;\r\n  /** Check if visible */\r\n  isVisible: () => boolean;\r\n  /** Validate the control */\r\n  validate: () => boolean;\r\n  /** Get the HTML element */\r\n  getNode: () => HTMLDivElement | null;\r\n}\r\n\r\n// Normalize options to AvakioSegmentedOption[]\r\nconst normalizeOptions = (options: AvakioSegmentedOption[] | string[]): AvakioSegmentedOption[] => {\r\n  return options.map((opt, index) => {\r\n    if (typeof opt === 'string') {\r\n      return { id: opt, value: opt };\r\n    }\r\n    return opt;\r\n  });\r\n};\r\n\r\nexport const AvakioSegmentedButton = forwardRef<AvakioSegmentedButtonRef, AvakioSegmentedButtonProps>(\r\n  (\r\n    {\r\n      id,\r\n      testId,\r\n      name,\r\n      value,\r\n      defaultValue,\r\n      options: optionsProp = [],\r\n      label,\r\n      labelWidth = 120,\r\n      labelAlign = 'left',\r\n      labelPosition = 'left',\r\n      required = false,\r\n      error,\r\n      invalidMessage,\r\n      bottomLabel,\r\n      size = 'md',\r\n      align = 'left',\r\n      theme,\r\n      fill = false,\r\n      optionWidth,\r\n      disabled: disabledProp = false,\r\n      borderless = false,\r\n      className = '',\r\n      css,\r\n      width,\r\n      height,\r\n      minWidth,\r\n      maxWidth,\r\n      multiview = false,\r\n      tooltip,\r\n      inputAlign,\r\n      inputWidth,\r\n      inputHeight,\r\n      onChange,\r\n      onBeforeTabClick,\r\n      onAfterTabClick,\r\n      onOptionAdd,\r\n      onOptionRemove,\r\n    },\r\n    ref\r\n  ) => {\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n    const segmentRefs = useRef<(HTMLButtonElement | null)[]>([]);\r\n    \r\n    // State\r\n    const [internalOptions, setInternalOptions] = useState<AvakioSegmentedOption[]>(() => \r\n      normalizeOptions(optionsProp)\r\n    );\r\n    const isControlled = value !== undefined;\r\n    const [internalValue, setInternalValue] = useState<string | number | null>(() => {\r\n      if (defaultValue !== undefined) return defaultValue;\r\n      const normalized = normalizeOptions(optionsProp);\r\n      const firstEnabled = normalized.find(opt => !opt.disabled && !opt.hidden);\r\n      return firstEnabled?.id ?? null;\r\n    });\r\n    const [disabled, setDisabled] = useState<boolean>(disabledProp);\r\n    const [visible, setVisible] = useState<boolean>(true);\r\n    const [hiddenOptions, setHiddenOptions] = useState<Set<string | number>>(new Set());\r\n    const [disabledOptions, setDisabledOptions] = useState<Set<string | number>>(new Set());\r\n    const [refreshKey, setRefreshKey] = useState(0);\r\n\r\n    const currentValue = isControlled ? value : internalValue;\r\n\r\n    // Sync options when prop changes\r\n    useEffect(() => {\r\n      setInternalOptions(normalizeOptions(optionsProp));\r\n    }, [optionsProp]);\r\n\r\n    // Sync disabled prop\r\n    useEffect(() => {\r\n      setDisabled(disabledProp);\r\n    }, [disabledProp]);\r\n\r\n    // Ensure value points to valid option\r\n    useEffect(() => {\r\n      if (isControlled) return;\r\n      \r\n      const visibleOptions = internalOptions.filter(\r\n        opt => !opt.hidden && !hiddenOptions.has(opt.id)\r\n      );\r\n      const exists = visibleOptions.some(\r\n        opt => opt.id === internalValue && !opt.disabled && !disabledOptions.has(opt.id)\r\n      );\r\n      \r\n      if (!exists && visibleOptions.length > 0) {\r\n        const fallback = visibleOptions.find(\r\n          opt => !opt.disabled && !disabledOptions.has(opt.id)\r\n        )?.id ?? null;\r\n        setInternalValue(fallback);\r\n      }\r\n    }, [internalOptions, internalValue, isControlled, hiddenOptions, disabledOptions]);\r\n\r\n    // Get visible options\r\n    const visibleOptions = internalOptions.filter(\r\n      opt => !opt.hidden && !hiddenOptions.has(opt.id)\r\n    );\r\n\r\n    // Handle segment click\r\n    const handleSegmentClick = useCallback((optionId: string | number) => {\r\n      if (disabled) return;\r\n      \r\n      const option = internalOptions.find(opt => opt.id === optionId);\r\n      if (!option) return;\r\n      if (option.disabled || disabledOptions.has(optionId)) return;\r\n\r\n      // Check before click callback\r\n      if (onBeforeTabClick) {\r\n        const result = onBeforeTabClick(optionId);\r\n        if (result === false) return;\r\n      }\r\n\r\n      if (!isControlled) {\r\n        setInternalValue(optionId);\r\n      }\r\n\r\n      onChange?.(optionId, option);\r\n      onAfterTabClick?.(optionId);\r\n    }, [disabled, internalOptions, disabledOptions, isControlled, onChange, onBeforeTabClick, onAfterTabClick]);\r\n\r\n    // Handle keyboard navigation\r\n    const handleKeyDown = useCallback((e: React.KeyboardEvent, index: number) => {\r\n      if (disabled) return;\r\n\r\n      let targetIndex = -1;\r\n\r\n      switch (e.key) {\r\n        case 'ArrowLeft':\r\n        case 'ArrowUp':\r\n          e.preventDefault();\r\n          targetIndex = index - 1;\r\n          while (targetIndex >= 0) {\r\n            const opt = visibleOptions[targetIndex];\r\n            if (!opt.disabled && !disabledOptions.has(opt.id)) break;\r\n            targetIndex--;\r\n          }\r\n          break;\r\n        case 'ArrowRight':\r\n        case 'ArrowDown':\r\n          e.preventDefault();\r\n          targetIndex = index + 1;\r\n          while (targetIndex < visibleOptions.length) {\r\n            const opt = visibleOptions[targetIndex];\r\n            if (!opt.disabled && !disabledOptions.has(opt.id)) break;\r\n            targetIndex++;\r\n          }\r\n          break;\r\n        case 'Home':\r\n          e.preventDefault();\r\n          targetIndex = 0;\r\n          while (targetIndex < visibleOptions.length) {\r\n            const opt = visibleOptions[targetIndex];\r\n            if (!opt.disabled && !disabledOptions.has(opt.id)) break;\r\n            targetIndex++;\r\n          }\r\n          break;\r\n        case 'End':\r\n          e.preventDefault();\r\n          targetIndex = visibleOptions.length - 1;\r\n          while (targetIndex >= 0) {\r\n            const opt = visibleOptions[targetIndex];\r\n            if (!opt.disabled && !disabledOptions.has(opt.id)) break;\r\n            targetIndex--;\r\n          }\r\n          break;\r\n        case 'Enter':\r\n        case ' ':\r\n          e.preventDefault();\r\n          handleSegmentClick(visibleOptions[index].id);\r\n          return;\r\n      }\r\n\r\n      if (targetIndex >= 0 && targetIndex < visibleOptions.length) {\r\n        segmentRefs.current[targetIndex]?.focus();\r\n      }\r\n    }, [disabled, visibleOptions, disabledOptions, handleSegmentClick]);\r\n\r\n    // Expose imperative methods\r\n    useImperativeHandle(ref, () => ({\r\n      getValue: () => currentValue,\r\n      setValue: (val: string | number | null) => {\r\n        if (!isControlled) {\r\n          setInternalValue(val);\r\n        }\r\n        const option = internalOptions.find(opt => opt.id === val);\r\n        onChange?.(val, option);\r\n      },\r\n      getOption: (optId: string | number) => internalOptions.find(opt => opt.id === optId),\r\n      getOptions: () => internalOptions,\r\n      addOption: (option: AvakioSegmentedOption, index?: number) => {\r\n        setInternalOptions(prev => {\r\n          const newOptions = [...prev];\r\n          if (index !== undefined && index >= 0 && index <= prev.length) {\r\n            newOptions.splice(index, 0, option);\r\n          } else {\r\n            newOptions.push(option);\r\n          }\r\n          return newOptions;\r\n        });\r\n        onOptionAdd?.(option);\r\n      },\r\n      removeOption: (optId: string | number) => {\r\n        setInternalOptions(prev => prev.filter(opt => opt.id !== optId));\r\n        onOptionRemove?.(optId);\r\n        // If removed option was selected, select first available\r\n        if (currentValue === optId && !isControlled) {\r\n          const remaining = internalOptions.filter(\r\n            opt => opt.id !== optId && !opt.hidden && !hiddenOptions.has(opt.id)\r\n          );\r\n          const fallback = remaining.find(\r\n            opt => !opt.disabled && !disabledOptions.has(opt.id)\r\n          )?.id ?? null;\r\n          setInternalValue(fallback);\r\n        }\r\n      },\r\n      hideOption: (optId: string | number) => {\r\n        setHiddenOptions(prev => {\r\n          const next = new Set(Array.from(prev));\r\n          next.add(optId);\r\n          return next;\r\n        });\r\n      },\r\n      showOption: (optId: string | number) => {\r\n        setHiddenOptions(prev => {\r\n          const next = new Set(prev);\r\n          next.delete(optId);\r\n          return next;\r\n        });\r\n      },\r\n      disableOption: (optId: string | number) => {\r\n        setDisabledOptions(prev => {\r\n          const next = new Set(Array.from(prev));\r\n          next.add(optId);\r\n          return next;\r\n        });\r\n      },\r\n      enableOption: (optId: string | number) => {\r\n        setDisabledOptions(prev => {\r\n          const next = new Set(prev);\r\n          next.delete(optId);\r\n          return next;\r\n        });\r\n      },\r\n      optionIndex: (optId: string | number) => internalOptions.findIndex(opt => opt.id === optId),\r\n      refresh: () => setRefreshKey(k => k + 1),\r\n      focus: () => {\r\n        const currentIndex = visibleOptions.findIndex(opt => opt.id === currentValue);\r\n        const focusIndex = currentIndex >= 0 ? currentIndex : 0;\r\n        segmentRefs.current[focusIndex]?.focus();\r\n      },\r\n      blur: () => {\r\n        segmentRefs.current.forEach(el => el?.blur());\r\n      },\r\n      enable: () => setDisabled(false),\r\n      disable: () => setDisabled(true),\r\n      isEnabled: () => !disabled,\r\n      hide: () => setVisible(false),\r\n      show: () => setVisible(true),\r\n      isVisible: () => visible,\r\n      validate: () => {\r\n        if (required && currentValue === null) {\r\n          return false;\r\n        }\r\n        return true;\r\n      },\r\n      getNode: () => containerRef.current,\r\n    }), [\r\n      currentValue, isControlled, internalOptions, visibleOptions, \r\n      hiddenOptions, disabledOptions, disabled, visible, required, \r\n      onChange, onOptionAdd, onOptionRemove\r\n    ]);\r\n\r\n    // Build container styles\r\n    const containerStyles: React.CSSProperties = {\r\n      ...(css && typeof css === 'object' && !Array.isArray(css) ? css : {}),\r\n      ...(width !== undefined && { width: typeof width === 'number' ? `${width}px` : width }),\r\n      ...(height !== undefined && { height: typeof height === 'number' ? `${height}px` : height }),\r\n      ...(minWidth !== undefined && { minWidth: typeof minWidth === 'number' ? `${minWidth}px` : minWidth }),\r\n      ...(maxWidth !== undefined && { maxWidth: typeof maxWidth === 'number' ? `${maxWidth}px` : maxWidth }),\r\n      ...(visible === false && { display: 'none' }),\r\n    };\r\n\r\n    // Build input container styles\r\n    const inputContainerStyles: React.CSSProperties = {\r\n      ...(inputWidth !== undefined && { width: typeof inputWidth === 'number' ? `${inputWidth}px` : inputWidth }),\r\n      ...(inputHeight !== undefined && { height: typeof inputHeight === 'number' ? `${inputHeight}px` : inputHeight }),\r\n      ...(inputAlign !== undefined && { justifyContent: inputAlign === 'left' ? 'flex-start' : inputAlign === 'right' ? 'flex-end' : 'center' }),\r\n    };\r\n\r\n    const hasError = !!error || !!invalidMessage;\r\n\r\n    return (\r\n      <div\r\n        ref={containerRef}\r\n        id={id}\r\n        data-testid={testId}\r\n        data-admin-theme={theme}\r\n        className={[\r\n          'avakio-segmented',\r\n          `avakio-segmented-size-${size}`,\r\n          `avakio-segmented-align-${align}`,\r\n          fill ? 'avakio-segmented-fill' : '',\r\n          borderless ? 'avakio-segmented-borderless' : '',\r\n          disabled ? 'avakio-segmented-disabled' : '',\r\n          hasError ? 'avakio-segmented-error' : '',\r\n          labelPosition === 'top' ? 'avakio-segmented-label-top' : '',\r\n          className,\r\n        ].filter(Boolean).join(' ')}\r\n        style={containerStyles}\r\n        title={tooltip}\r\n        key={refreshKey}\r\n      >\r\n        {label && (\r\n          <label\r\n            className=\"avakio-segmented-label\"\r\n            style={{\r\n              width: labelPosition === 'left' ? labelWidth : 'auto',\r\n              textAlign: labelAlign,\r\n            }}\r\n          >\r\n            {label}\r\n            {required && <span className=\"avakio-segmented-required\">*</span>}\r\n          </label>\r\n        )}\r\n\r\n        <div className=\"avakio-segmented-wrapper\" style={inputContainerStyles}>\r\n          <div \r\n            className=\"avakio-segmented-track\"\r\n            role=\"tablist\"\r\n            aria-label={label || 'Segmented control'}\r\n          >\r\n            {visibleOptions.map((option, index) => {\r\n              const isActive = option.id === currentValue;\r\n              const isDisabled = disabled || option.disabled || disabledOptions.has(option.id);\r\n\r\n              return (\r\n                <button\r\n                  key={option.id}\r\n                  ref={(el) => { segmentRefs.current[index] = el; }}\r\n                  type=\"button\"\r\n                  role=\"tab\"\r\n                  aria-selected={isActive}\r\n                  aria-disabled={isDisabled}\r\n                  aria-controls={option.ariaControls}\r\n                  tabIndex={isActive ? 0 : -1}\r\n                  className={[\r\n                    'avakio-segmented-segment',\r\n                    isActive ? 'avakio-segmented-segment-active' : '',\r\n                    isDisabled ? 'avakio-segmented-segment-disabled' : '',\r\n                  ].filter(Boolean).join(' ')}\r\n                  style={optionWidth ? { width: optionWidth } : undefined}\r\n                  title={option.tooltip}\r\n                  disabled={isDisabled}\r\n                  onClick={() => handleSegmentClick(option.id)}\r\n                  onKeyDown={(e) => handleKeyDown(e, index)}\r\n                >\r\n                  {option.icon && (\r\n                    <span className=\"avakio-segmented-icon\">{option.icon}</span>\r\n                  )}\r\n                  <span className=\"avakio-segmented-text\">{option.value}</span>\r\n                  {option.badge !== undefined && (\r\n                    <span className=\"avakio-segmented-badge\">{option.badge}</span>\r\n                  )}\r\n                </button>\r\n              );\r\n            })}\r\n          </div>\r\n\r\n          {name && (\r\n            <input\r\n              type=\"hidden\"\r\n              name={name}\r\n              value={currentValue?.toString() ?? ''}\r\n            />\r\n          )}\r\n        </div>\r\n\r\n        {(error || invalidMessage) && (\r\n          <div className=\"avakio-segmented-error-text\">{error || invalidMessage}</div>\r\n        )}\r\n\r\n        {bottomLabel && !hasError && (\r\n          <div className=\"avakio-segmented-bottom-label\">{bottomLabel}</div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nAvakioSegmentedButton.displayName = 'AvakioSegmentedButton';\r\n\r\nexport default AvakioSegmentedButton;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { forwardRef, useImperativeHandle, useState, useRef, useEffect } from 'react';\r\nimport './avakio-switch-button.css';\r\n\r\nexport type AvakioSwitchButtonTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\nexport type AvakioSwitchButtonSize = 'sm' | 'md' | 'lg';\r\n\r\nexport interface AvakioSwitchButtonProps {\r\n  /** Unique identifier */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n  /** Name for form submission */\r\n  name?: string;\r\n  /** Current on/off state (controlled) - 1 for on, 0 for off */\r\n  value?: boolean | number;\r\n  /** Default on/off state (uncontrolled) */\r\n  defaultValue?: boolean | number;\r\n  /** Label text (displayed to the left) */\r\n  label?: string;\r\n  /** Width of the label in pixels */\r\n  labelWidth?: number;\r\n  /** Right-hand label text */\r\n  labelRight?: string;\r\n  /** Text label on the switch when in the \"on\" state */\r\n  onLabel?: string;\r\n  /** Text label on the switch when in the \"off\" state */\r\n  offLabel?: string;\r\n  /** Button size */\r\n  size?: AvakioSwitchButtonSize;\r\n  /** Theme variant */\r\n  theme?: AvakioSwitchButtonTheme;\r\n  /** Disabled state */\r\n  disabled?: boolean;\r\n  /** Required field */\r\n  required?: boolean;\r\n  /** Invalid state */\r\n  invalid?: boolean;\r\n  /** Invalid message */\r\n  invalidMessage?: string;\r\n  /** Bottom label text */\r\n  bottomLabel?: string;\r\n  /** Tooltip text */\r\n  tooltip?: string;\r\n  /** CSS class name */\r\n  className?: string;\r\n  /** Inline styles */\r\n  css?: React.CSSProperties;\r\n  /** Width */\r\n  width?: number | string;\r\n  /** Height */\r\n  height?: number | string;\r\n  /** Callback when value changes */\r\n  onChange?: (value: boolean) => void;\r\n  /** Callback when clicked */\r\n  onClick?: (e: React.MouseEvent<HTMLButtonElement>) => void;\r\n  /** Callback when focused */\r\n  onFocus?: (e: React.FocusEvent<HTMLButtonElement>) => void;\r\n  /** Callback when blurred */\r\n  onBlur?: (e: React.FocusEvent<HTMLButtonElement>) => void;\r\n}\r\n\r\nexport interface AvakioSwitchButtonRef {\r\n  /** Get the current on/off state */\r\n  getValue: () => boolean;\r\n  /** Set the on/off state */\r\n  setValue: (value: boolean) => void;\r\n  /** Toggle the state */\r\n  toggle: () => void;\r\n  /** Focus the switch */\r\n  focus: () => void;\r\n  /** Blur the switch */\r\n  blur: () => void;\r\n  /** Enable the switch */\r\n  enable: () => void;\r\n  /** Disable the switch */\r\n  disable: () => void;\r\n  /** Check if enabled */\r\n  isEnabled: () => boolean;\r\n  /** Get the HTML element */\r\n  getNode: () => HTMLButtonElement | null;\r\n  /** Refresh/repaint the component */\r\n  refresh: () => void;\r\n}\r\n\r\nexport const AvakioSwitchButton = forwardRef<AvakioSwitchButtonRef, AvakioSwitchButtonProps>(\r\n  (\r\n    {\r\n      id,\r\n      testId,\r\n      name,\r\n      value,\r\n      defaultValue = false,\r\n      label,\r\n      labelWidth = 80,\r\n      labelRight,\r\n      onLabel,\r\n      offLabel,\r\n      size = 'md',\r\n      theme,\r\n      disabled: disabledProp = false,\r\n      required = false,\r\n      invalid = false,\r\n      invalidMessage,\r\n      bottomLabel,\r\n      tooltip,\r\n      className = '',\r\n      css,\r\n      width,\r\n      height,\r\n      onChange,\r\n      onClick,\r\n      onFocus,\r\n      onBlur,\r\n    },\r\n    ref\r\n  ) => {\r\n    const switchRef = useRef<HTMLButtonElement>(null);\r\n    const isControlled = value !== undefined;\r\n    const normalizeValue = (val: boolean | number | undefined): boolean => {\r\n      if (val === undefined) return false;\r\n      return val === true || val === 1;\r\n    };\r\n    const [internalValue, setInternalValue] = useState<boolean>(normalizeValue(defaultValue));\r\n    const [disabled, setDisabled] = useState<boolean>(disabledProp);\r\n    const [, forceUpdate] = useState({});\r\n\r\n    const isOn = isControlled ? normalizeValue(value) : internalValue;\r\n\r\n    // Sync disabled prop\r\n    useEffect(() => {\r\n      setDisabled(disabledProp);\r\n    }, [disabledProp]);\r\n\r\n    // Expose imperative methods\r\n    useImperativeHandle(ref, () => ({\r\n      getValue: () => (isControlled ? normalizeValue(value) : internalValue),\r\n      setValue: (newValue: boolean) => {\r\n        if (!isControlled) {\r\n          setInternalValue(newValue);\r\n        }\r\n        onChange?.(newValue);\r\n      },\r\n      toggle: () => {\r\n        const currentValue = isControlled ? normalizeValue(value) : internalValue;\r\n        const newValue = !currentValue;\r\n        if (!isControlled) {\r\n          setInternalValue(newValue);\r\n        }\r\n        onChange?.(newValue);\r\n      },\r\n      focus: () => switchRef.current?.focus(),\r\n      blur: () => switchRef.current?.blur(),\r\n      enable: () => setDisabled(false),\r\n      disable: () => setDisabled(true),\r\n      isEnabled: () => !disabled,\r\n      getNode: () => switchRef.current,\r\n      refresh: () => forceUpdate({}),\r\n    }), [isControlled, value, internalValue, disabled, onChange]);\r\n\r\n    const handleClick = (e: React.MouseEvent<HTMLButtonElement>) => {\r\n      if (disabled) return;\r\n      \r\n      const newValue = !isOn;\r\n      if (!isControlled) {\r\n        setInternalValue(newValue);\r\n      }\r\n      onChange?.(newValue);\r\n      onClick?.(e);\r\n    };\r\n\r\n    // Build class names\r\n    const containerClassNames = [\r\n      'avakio-switch-container',\r\n      `avakio-switch-container-${size}`,\r\n      theme && `avakio-switch-theme-${theme}`,\r\n      disabled && 'avakio-switch-container-disabled',\r\n      invalid && 'avakio-switch-container-invalid',\r\n      className,\r\n    ]\r\n      .filter(Boolean)\r\n      .join(' ');\r\n\r\n    const switchClassNames = [\r\n      'avakio-switch-button',\r\n      `avakio-switch-button-${size}`,\r\n      isOn && 'avakio-switch-button-on',\r\n      disabled && 'avakio-switch-button-disabled',\r\n      (onLabel || offLabel) && 'avakio-switch-button-with-labels',\r\n    ]\r\n      .filter(Boolean)\r\n      .join(' ');\r\n\r\n    // Build styles\r\n    const containerStyles: React.CSSProperties = {\r\n      ...(css && typeof css === 'object' && !Array.isArray(css) ? css : {}),\r\n      width: typeof width === 'number' ? `${width}px` : width,\r\n      height: typeof height === 'number' ? `${height}px` : height,\r\n    };\r\n\r\n    const labelStyles: React.CSSProperties = {\r\n      width: labelWidth > 0 ? `${labelWidth}px` : undefined,\r\n      minWidth: labelWidth > 0 ? `${labelWidth}px` : undefined,\r\n    };\r\n\r\n    // Determine switch inner text\r\n    const switchInnerText = isOn ? onLabel : offLabel;\r\n    const hasInnerLabels = onLabel || offLabel;\r\n\r\n    return (\r\n      <div\r\n        className={containerClassNames}\r\n        style={containerStyles}\r\n        data-admin-theme={theme}\r\n      >\r\n        {/* Left Label */}\r\n        {label && (\r\n          <label \r\n            className=\"avakio-switch-label avakio-switch-label-left\"\r\n            style={labelStyles}\r\n          >\r\n            {label}\r\n            {required && <span className=\"avakio-switch-required\">*</span>}\r\n          </label>\r\n        )}\r\n\r\n        {/* Switch Track */}\r\n        <button\r\n          ref={switchRef}\r\n          id={id}\r\n          data-testid={testId}\r\n          name={name}\r\n          type=\"button\"\r\n          role=\"switch\"\r\n          aria-checked={isOn}\r\n          aria-disabled={disabled}\r\n          aria-label={label || labelRight || 'Switch'}\r\n          className={switchClassNames}\r\n          disabled={disabled}\r\n          title={tooltip}\r\n          onClick={handleClick}\r\n          onFocus={onFocus}\r\n          onBlur={onBlur}\r\n        >\r\n          {/* Track with inner labels */}\r\n          <span className=\"avakio-switch-track\">\r\n            {hasInnerLabels && (\r\n              <>\r\n                <span className=\"avakio-switch-track-on-label\">{onLabel}</span>\r\n                <span className=\"avakio-switch-track-off-label\">{offLabel}</span>\r\n              </>\r\n            )}\r\n            <span className=\"avakio-switch-thumb\" />\r\n          </span>\r\n        </button>\r\n\r\n        {/* Right Label */}\r\n        {labelRight && (\r\n          <label className=\"avakio-switch-label avakio-switch-label-right\">\r\n            {labelRight}\r\n            {required && !label && <span className=\"avakio-switch-required\">*</span>}\r\n          </label>\r\n        )}\r\n\r\n        {/* Bottom Label / Invalid Message */}\r\n        {(bottomLabel || (invalid && invalidMessage)) && (\r\n          <div className=\"avakio-switch-bottom\">\r\n            {invalid && invalidMessage ? (\r\n              <span className=\"avakio-switch-invalid-message\">{invalidMessage}</span>\r\n            ) : (\r\n              <span className=\"avakio-switch-bottom-label\">{bottomLabel}</span>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nAvakioSwitchButton.displayName = 'AvakioSwitchButton';\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\r\nimport { ChevronLeft, ChevronRight, X } from 'lucide-react';\r\nimport './avakio-tabbar.css';\r\n\r\nexport interface AvakioTabBarOption {\r\n  id: string | number;\r\n  label: string;\r\n  icon?: React.ReactNode;\r\n  badge?: string | number;\r\n  close?: boolean;\r\n  disabled?: boolean;\r\n  hidden?: boolean;\r\n  ariaControls?: string;\r\n}\r\n\r\nexport type AvakioTabBarAlign = 'left' | 'center' | 'justify';\r\nexport type AvakioTabBarType = 'top' | 'bottom';\r\nexport type AvakioTabBarSize = 'md' | 'sm';\r\n\r\nexport interface AvakioTabBarProps {\r\n  id?: string;\r\n  value?: string | number | null;\r\n  options?: AvakioTabBarOption[];\r\n  onChange?: (value: string | number | null, option?: AvakioTabBarOption | null) => void;\r\n  onClose?: (value: string | number, option?: AvakioTabBarOption) => void;\r\n  renderTab?: (option: AvakioTabBarOption, isActive: boolean, closeButton: React.ReactNode) => React.ReactNode;\r\n  align?: AvakioTabBarAlign;\r\n  type?: AvakioTabBarType;\r\n  closable?: boolean;\r\n  fill?: boolean;\r\n  size?: AvakioTabBarSize;\r\n  scrollable?: boolean;\r\n  label?: string;\r\n  labelWidth?: number;\r\n  labelAlign?: 'left' | 'right';\r\n  required?: boolean;\r\n  error?: string;\r\n  disabled?: boolean;\r\n  className?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n}\r\n\r\nexport function AvakioTabBar({\r\n  id,\r\n  value,\r\n  options = [],\r\n  onChange,\r\n  onClose,\r\n  renderTab,\r\n  align = 'left',\r\n  type = 'top',\r\n  closable = false,\r\n  fill = false,\r\n  size = 'md',\r\n  scrollable = true,\r\n  label,\r\n  labelWidth = 120,\r\n  labelAlign = 'left',\r\n  required = false,\r\n  error,\r\n  disabled = false,\r\n  className = '',\r\n  testId,\r\n}: AvakioTabBarProps) {\r\n  const [internalValue, setInternalValue] = useState<string | number | null>(value ?? null);\r\n  const [closedIds, setClosedIds] = useState<Set<string | number>>(new Set());\r\n  const [canScrollLeft, setCanScrollLeft] = useState(false);\r\n  const [canScrollRight, setCanScrollRight] = useState(false);\r\n  const tabRefs = useRef<(HTMLButtonElement | null)[]>([]);\r\n  const trackRef = useRef<HTMLDivElement>(null);\r\n\r\n  // Normalize options and filter hidden/closed ones\r\n  const visibleOptions = useMemo(() => {\r\n    return options\r\n      .filter((opt) => !opt.hidden)\r\n      .filter((opt) => !closedIds.has(opt.id));\r\n  }, [options, closedIds]);\r\n\r\n  // Resolve controlled vs uncontrolled value\r\n  const currentValue = value !== undefined ? value : internalValue;\r\n\r\n  // Ensure we always point to an existing tab\r\n  useEffect(() => {\r\n    if (value !== undefined) return;\r\n    const exists = visibleOptions.some((opt) => opt.id === internalValue && !opt.disabled);\r\n    if (!exists) {\r\n      const fallback = visibleOptions.find((opt) => !opt.disabled)?.id ?? null;\r\n      setInternalValue(fallback);\r\n    }\r\n  }, [visibleOptions, internalValue, value]);\r\n\r\n  // Mirror controlled value into internal state for focus management\r\n  useEffect(() => {\r\n    if (value !== undefined) {\r\n      setInternalValue(value ?? null);\r\n    }\r\n  }, [value]);\r\n\r\n  // Check if scroll arrows should be visible\r\n  const checkScrollButtons = useCallback(() => {\r\n    const track = trackRef.current;\r\n    if (!track || !scrollable) {\r\n      setCanScrollLeft(false);\r\n      setCanScrollRight(false);\r\n      return;\r\n    }\r\n    \r\n    const { scrollLeft, scrollWidth, clientWidth } = track;\r\n    setCanScrollLeft(scrollLeft > 0);\r\n    setCanScrollRight(scrollLeft + clientWidth < scrollWidth - 1);\r\n  }, [scrollable]);\r\n\r\n  // Update scroll buttons on mount, resize, and when options change\r\n  useEffect(() => {\r\n    checkScrollButtons();\r\n    \r\n    const track = trackRef.current;\r\n    if (track) {\r\n      track.addEventListener('scroll', checkScrollButtons);\r\n      \r\n      // Use ResizeObserver to detect size changes\r\n      const resizeObserver = new ResizeObserver(checkScrollButtons);\r\n      resizeObserver.observe(track);\r\n      \r\n      return () => {\r\n        track.removeEventListener('scroll', checkScrollButtons);\r\n        resizeObserver.disconnect();\r\n      };\r\n    }\r\n  }, [checkScrollButtons, visibleOptions]);\r\n\r\n  // Scroll handlers\r\n  const scrollLeft = () => {\r\n    const track = trackRef.current;\r\n    if (track) {\r\n      track.scrollBy({ left: -150, behavior: 'smooth' });\r\n    }\r\n  };\r\n\r\n  const scrollRight = () => {\r\n    const track = trackRef.current;\r\n    if (track) {\r\n      track.scrollBy({ left: 150, behavior: 'smooth' });\r\n    }\r\n  };\r\n\r\n  const setTabRef = (index: number, el: HTMLButtonElement | null) => {\r\n    tabRefs.current[index] = el;\r\n  };\r\n\r\n  const focusTabById = (id: string | number | null) => {\r\n    if (id === null || id === undefined) return;\r\n    const idx = visibleOptions.findIndex((opt) => opt.id === id);\r\n    if (idx >= 0) {\r\n      tabRefs.current[idx]?.focus();\r\n    }\r\n  };\r\n\r\n  const selectTab = (option: AvakioTabBarOption | undefined | null) => {\r\n    if (!option || option.disabled || disabled) return;\r\n    if (value === undefined) {\r\n      setInternalValue(option.id);\r\n    }\r\n    onChange?.(option.id, option);\r\n  };\r\n\r\n  const handleClose = (option: AvakioTabBarOption, event?: React.MouseEvent) => {\r\n    if (event) {\r\n      event.stopPropagation();\r\n      event.preventDefault();\r\n    }\r\n    if (option.disabled || disabled) return;\r\n\r\n    setClosedIds((prev) => {\r\n      const next = new Set(prev);\r\n      next.add(option.id);\r\n      return next;\r\n    });\r\n\r\n    onClose?.(option.id, option);\r\n\r\n    // Move selection if we closed the active tab in uncontrolled mode\r\n    if (value === undefined && currentValue === option.id) {\r\n      const remaining = visibleOptions.filter((opt) => opt.id !== option.id && !opt.disabled);\r\n      const nextActive = remaining[0]?.id ?? null;\r\n      setInternalValue(nextActive);\r\n      requestAnimationFrame(() => focusTabById(nextActive));\r\n    }\r\n  };\r\n\r\n  const moveFocus = (direction: 'next' | 'prev' | 'first' | 'last') => {\r\n    if (!visibleOptions.length) return;\r\n    const enabled = visibleOptions.filter((opt) => !opt.disabled);\r\n    if (!enabled.length) return;\r\n\r\n    const currentIdx = enabled.findIndex((opt) => opt.id === currentValue);\r\n    const safeIdx = currentIdx === -1 ? 0 : currentIdx;\r\n\r\n    let target: AvakioTabBarOption;\r\n    switch (direction) {\r\n      case 'next':\r\n        target = enabled[(safeIdx + 1) % enabled.length];\r\n        break;\r\n      case 'prev':\r\n        target = enabled[(safeIdx - 1 + enabled.length) % enabled.length];\r\n        break;\r\n      case 'first':\r\n        target = enabled[0];\r\n        break;\r\n      case 'last':\r\n        target = enabled[enabled.length - 1];\r\n        break;\r\n    }\r\n\r\n    selectTab(target);\r\n    focusTabById(target.id);\r\n  };\r\n\r\n  const handleKeyDown = (e: React.KeyboardEvent<HTMLDivElement>) => {\r\n    switch (e.key) {\r\n      case 'ArrowRight':\r\n      case 'ArrowDown':\r\n        e.preventDefault();\r\n        moveFocus('next');\r\n        break;\r\n      case 'ArrowLeft':\r\n      case 'ArrowUp':\r\n        e.preventDefault();\r\n        moveFocus('prev');\r\n        break;\r\n      case 'Home':\r\n        e.preventDefault();\r\n        moveFocus('first');\r\n        break;\r\n      case 'End':\r\n        e.preventDefault();\r\n        moveFocus('last');\r\n        break;\r\n      case 'Delete':\r\n      case 'Backspace':\r\n        if (closable) {\r\n          const active = visibleOptions.find((opt) => opt.id === currentValue);\r\n          if (active) {\r\n            e.preventDefault();\r\n            handleClose(active);\r\n          }\r\n        }\r\n        break;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div\r\n      id={id}\r\n      data-testid={testId}\r\n      className={`avakio-tabbar ${className}`.trim()}\r\n      data-type={type}\r\n      data-align={align}\r\n      data-size={size}\r\n      data-fill={fill}\r\n      data-disabled={disabled}\r\n      data-error={!!error}\r\n    >\r\n      {label && (\r\n        <div\r\n          className=\"avakio-tabbar-label\"\r\n          style={{ width: labelWidth, textAlign: labelAlign }}\r\n        >\r\n          <span>{label}</span>\r\n          {required && <span className=\"avakio-tabbar-required\">*</span>}\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"avakio-tabbar-wrapper\">\r\n        {/* Left scroll arrow */}\r\n        {scrollable && canScrollLeft && (\r\n          <button\r\n            type=\"button\"\r\n            className=\"avakio-tabbar-scroll-btn avakio-tabbar-scroll-left\"\r\n            onClick={scrollLeft}\r\n            aria-label=\"Scroll tabs left\"\r\n          >\r\n            <ChevronLeft size={16} strokeWidth={2.5} />\r\n          </button>\r\n        )}\r\n\r\n        <div\r\n          ref={trackRef}\r\n          className=\"avakio-tabbar-track\"\r\n          role=\"tablist\"\r\n          aria-label={label || 'Tab Bar'}\r\n          data-scrollable={scrollable}\r\n          data-has-scroll-left={canScrollLeft}\r\n          data-has-scroll-right={canScrollRight}\r\n          onKeyDown={handleKeyDown}\r\n        >\r\n          {visibleOptions.map((option, index) => {\r\n            const isActive = option.id === currentValue;\r\n            const isDisabled = disabled || option.disabled;\r\n            const showClose = (option.close || closable) && !isDisabled;\r\n\r\n            const closeButton = showClose ? (\r\n              <button\r\n                type=\"button\"\r\n                className=\"avakio-tabbar-close\"\r\n                aria-label={`Close ${option.label}`}\r\n                onClick={(e) => handleClose(option, e)}\r\n              >\r\n                <X size={14} strokeWidth={2.5} />\r\n              </button>\r\n            ) : null;\r\n\r\n            const defaultContent = (\r\n              <>\r\n                <span className=\"avakio-tabbar-inner\">\r\n                  {option.icon && <span className=\"avakio-tabbar-icon\">{option.icon}</span>}\r\n                  <span className=\"avakio-tabbar-text\">{option.label}</span>\r\n                  {option.badge !== undefined && (\r\n                    <span className=\"avakio-tabbar-badge\">{option.badge}</span>\r\n                  )}\r\n                </span>\r\n                {closeButton}\r\n              </>\r\n            );\r\n\r\n            const tabContent = renderTab\r\n              ? renderTab(option, isActive, closeButton)\r\n              : defaultContent;\r\n\r\n            return (\r\n              <div\r\n                key={option.id}\r\n                ref={(el) => setTabRef(index, el as unknown as HTMLButtonElement)}\r\n                className={`avakio-tabbar-tab${isActive ? ' active' : ''}`}\r\n                role=\"tab\"\r\n                aria-selected={isActive}\r\n                aria-controls={option.ariaControls}\r\n                tabIndex={isActive && !isDisabled ? 0 : -1}\r\n                onClick={() => selectTab(option)}\r\n                onKeyDown={(e) => {\r\n                  if (e.key === 'Enter' || e.key === ' ') {\r\n                    e.preventDefault();\r\n                    selectTab(option);\r\n                  }\r\n                }}\r\n                aria-disabled={isDisabled}\r\n                data-active={isActive}\r\n                data-disabled={isDisabled}\r\n              >\r\n                {tabContent}\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n\r\n        {/* Right scroll arrow */}\r\n        {scrollable && canScrollRight && (\r\n          <button\r\n            type=\"button\"\r\n            className=\"avakio-tabbar-scroll-btn avakio-tabbar-scroll-right\"\r\n            onClick={scrollRight}\r\n            aria-label=\"Scroll tabs right\"\r\n          >\r\n            <ChevronRight size={16} strokeWidth={2.5} />\r\n          </button>\r\n        )}\r\n\r\n        {error && <div className=\"avakio-tabbar-error\">{error}</div>}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { forwardRef, useState, useEffect, useRef, useImperativeHandle, ChangeEvent, KeyboardEvent, FocusEvent } from 'react';\r\nimport { X, Eye, EyeOff, Copy } from 'lucide-react';\r\nimport './avakio-text.css';\r\n\r\nexport interface AvakioTextProps {\r\n  /** The value of the text input */\r\n  value?: string;\r\n  /** The label text */\r\n  label?: string;\r\n  /** The placeholder text */\r\n  placeholder?: string;\r\n  /** The name attribute */\r\n  name?: string;\r\n  /** The type of input (text, password, email, url, number, tel) */\r\n  type?: 'text' | 'password' | 'email' | 'url' | 'number' | 'tel' | 'search';\r\n  /** Whether the input is disabled */\r\n  disabled?: boolean;\r\n  /** Whether the input is readonly */\r\n  readonly?: boolean;\r\n  /** Whether the input is required */\r\n  required?: boolean;\r\n  /** The theme (material, flat, compact, dark, ocean, sunset) */\r\n  theme?: string;\r\n  /** Custom CSS class */\r\n  className?: string;\r\n  /** Width of the component */\r\n  width?: string | number;\r\n  /** Height of the component */\r\n  height?: string | number;\r\n  /** Label width */\r\n  labelWidth?: number;\r\n  /** Label position (left or top) */\r\n  labelPosition?: 'left' | 'top';\r\n  /** Label alignment (left or right) */\r\n  labelAlign?: 'left' | 'right';\r\n  /** Input alignment (left, center, right) */\r\n  inputAlign?: 'left' | 'center' | 'right';\r\n  /** Bottom label text */\r\n  bottomLabel?: string;\r\n  /** Shows clear button when input has value */\r\n  clear?: boolean;\r\n  /** Enables copy button to copy the input value to clipboard */\r\n  enableValueCopyButton?: boolean;\r\n  /** Enables copy button to copy the placeholder text to clipboard */\r\n  enablePlaceHolderCopyButton?: boolean;\r\n  /** Icon to show in the input */\r\n  icon?: React.ReactNode;\r\n  /** Icon position (left or right) */\r\n  iconPosition?: 'left' | 'right';\r\n  /** Validation rules */\r\n  validate?: (value: string) => boolean | string;\r\n  /** Validation event (change, blur, submit) */\r\n  validateEvent?: 'change' | 'blur' | 'submit';\r\n  /** Invalid state */\r\n  invalid?: boolean;\r\n  /** Invalid message */\r\n  invalidMessage?: string;\r\n  /** Maximum length */\r\n  maxLength?: number;\r\n  /** Pattern for HTML5 validation */\r\n  pattern?: string;\r\n  /** Minimum value (for number type) */\r\n  min?: number;\r\n  /** Maximum value (for number type) */\r\n  max?: number;\r\n  /** Step value (for number type) */\r\n  step?: number;\r\n  /** Autocomplete attribute */\r\n  autoComplete?: string;\r\n  /** Enable multiline mode (renders textarea instead of input) */\r\n  multiline?: boolean;\r\n  /** Number of visible rows (only for multiline) */\r\n  rows?: number;\r\n  /** onChange callback */\r\n  onChange?: (value: string, event: ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => void;\r\n  /** onBlur callback */\r\n  onBlur?: (event: FocusEvent<HTMLInputElement | HTMLTextAreaElement>) => void;\r\n  /** onFocus callback */\r\n  onFocus?: (event: FocusEvent<HTMLInputElement | HTMLTextAreaElement>) => void;\r\n  /** onEnter callback */\r\n  onEnter?: (value: string) => void;\r\n  /** onKeyPress callback */\r\n  onKeyPress?: (event: KeyboardEvent<HTMLInputElement | HTMLTextAreaElement>) => void;\r\n  /** onClick callback for the entire component */\r\n  onClick?: () => void;\r\n  /** Padding (number for all sides, string for CSS, or [top, right, bottom, left]) */\r\n  padding?: string | number | [number, number, number, number];\r\n  /** Margin (number for all sides, string for CSS, or [top, right, bottom, left]) */\r\n  margin?: string | number | [number, number, number, number];\r\n  /** Width of the text input/textarea (e.g., '100%', '200px') */\r\n  textWidth?: string | number;\r\n}\r\n\r\nexport interface AvakioTextRef {\r\n  /** Get the current value */\r\n  getValue: () => string;\r\n  /** Set a new value */\r\n  setValue: (value: string) => void;\r\n  /** Focus the input */\r\n  focus: () => void;\r\n  /** Blur the input */\r\n  blur: () => void;\r\n  /** Validate the input */\r\n  validate: () => boolean;\r\n  /** Get the input element */\r\n  getInputNode: () => HTMLInputElement | HTMLTextAreaElement | null;\r\n  /** Clear the input */\r\n  clear: () => void;\r\n  /** Check if input is enabled */\r\n  isEnabled: () => boolean;\r\n  /** Disable the input */\r\n  disable: () => void;\r\n  /** Enable the input */\r\n  enable: () => void;\r\n}\r\n\r\nexport const AvakioText = forwardRef<AvakioTextRef, AvakioTextProps>(\r\n  (\r\n    {\r\n      value = '',\r\n      label,\r\n      placeholder,\r\n      name,\r\n      type = 'text',\r\n      disabled = false,\r\n      readonly = false,\r\n      required = false,\r\n      theme = 'material',\r\n      className = '',\r\n      width,\r\n      height,\r\n      labelWidth = 100,\r\n      labelPosition = 'left',\r\n      labelAlign = 'left',\r\n      inputAlign = 'left',\r\n      bottomLabel,\r\n      clear = false,\r\n      enableValueCopyButton = false,\r\n      enablePlaceHolderCopyButton = false,\r\n      icon,\r\n      iconPosition = 'left',\r\n      validate,\r\n      validateEvent = 'blur',\r\n      invalid = false,\r\n      invalidMessage,\r\n      maxLength,\r\n      pattern,\r\n      min,\r\n      max,\r\n      step,\r\n      autoComplete,\r\n      multiline = false,\r\n      rows = 4,\r\n      onChange,\r\n      onBlur,\r\n      onFocus,\r\n      onEnter,\r\n      onKeyPress,\r\n      onClick,\r\n      padding,\r\n      margin,\r\n      textWidth,\r\n    },\r\n    ref\r\n  ) => {\r\n    const [currentValue, setCurrentValue] = useState<string>(value);\r\n    const [isInvalid, setIsInvalid] = useState(invalid);\r\n    const [validationMessage, setValidationMessage] = useState(invalidMessage || '');\r\n    const [isFocused, setIsFocused] = useState(false);\r\n    const [isDisabled, setIsDisabled] = useState(disabled);\r\n    const [showPassword, setShowPassword] = useState(false);\r\n    const inputRef = useRef<HTMLInputElement | HTMLTextAreaElement>(null);\r\n\r\n    useEffect(() => {\r\n      setCurrentValue(value);\r\n    }, [value]);\r\n\r\n    useEffect(() => {\r\n      setIsInvalid(invalid);\r\n    }, [invalid]);\r\n\r\n    useEffect(() => {\r\n      setIsDisabled(disabled);\r\n    }, [disabled]);\r\n\r\n    const validateInput = (val: string): boolean => {\r\n      if (validate) {\r\n        const result = validate(val);\r\n        if (typeof result === 'string') {\r\n          setIsInvalid(true);\r\n          setValidationMessage(result);\r\n          return false;\r\n        } else if (result === false) {\r\n          setIsInvalid(true);\r\n          setValidationMessage(invalidMessage || 'Invalid value');\r\n          return false;\r\n        }\r\n      }\r\n\r\n      // HTML5 validation\r\n      if (required && !val.trim()) {\r\n        setIsInvalid(true);\r\n        setValidationMessage('This field is required');\r\n        return false;\r\n      }\r\n\r\n      if (type === 'email' && val && !/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(val)) {\r\n        setIsInvalid(true);\r\n        setValidationMessage('Please enter a valid email address');\r\n        return false;\r\n      }\r\n\r\n      if (type === 'url' && val && !/^https?:\\/\\/.+/.test(val)) {\r\n        setIsInvalid(true);\r\n        setValidationMessage('Please enter a valid URL');\r\n        return false;\r\n      }\r\n\r\n      if (type === 'number' && val) {\r\n        const num = parseFloat(val);\r\n        if (isNaN(num)) {\r\n          setIsInvalid(true);\r\n          setValidationMessage('Please enter a valid number');\r\n          return false;\r\n        }\r\n        if (min !== undefined && num < min) {\r\n          setIsInvalid(true);\r\n          setValidationMessage(`Value must be at least ${min}`);\r\n          return false;\r\n        }\r\n        if (max !== undefined && num > max) {\r\n          setIsInvalid(true);\r\n          setValidationMessage(`Value must be at most ${max}`);\r\n          return false;\r\n        }\r\n      }\r\n\r\n      if (pattern && val && !new RegExp(pattern).test(val)) {\r\n        setIsInvalid(true);\r\n        setValidationMessage(invalidMessage || 'Invalid format');\r\n        return false;\r\n      }\r\n\r\n      if (maxLength && val.length > maxLength) {\r\n        setIsInvalid(true);\r\n        setValidationMessage(`Maximum length is ${maxLength} characters`);\r\n        return false;\r\n      }\r\n\r\n      setIsInvalid(false);\r\n      setValidationMessage('');\r\n      return true;\r\n    };\r\n\r\n    const handleChange = (e: ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\r\n      const newValue = e.target.value;\r\n      setCurrentValue(newValue);\r\n\r\n      if (validateEvent === 'change') {\r\n        validateInput(newValue);\r\n      }\r\n\r\n      if (onChange) {\r\n        onChange(newValue, e);\r\n      }\r\n    };\r\n\r\n    const handleBlur = (e: FocusEvent<HTMLInputElement | HTMLTextAreaElement>) => {\r\n      setIsFocused(false);\r\n\r\n      if (validateEvent === 'blur') {\r\n        validateInput(currentValue);\r\n      }\r\n\r\n      if (onBlur) {\r\n        onBlur(e);\r\n      }\r\n    };\r\n\r\n    const handleFocus = (e: FocusEvent<HTMLInputElement | HTMLTextAreaElement>) => {\r\n      setIsFocused(true);\r\n\r\n      if (onFocus) {\r\n        onFocus(e);\r\n      }\r\n    };\r\n\r\n    const handleKeyPress = (e: KeyboardEvent<HTMLInputElement | HTMLTextAreaElement>) => {\r\n      if (e.key === 'Enter' && !multiline && onEnter) {\r\n        onEnter(currentValue);\r\n      }\r\n\r\n      if (onKeyPress) {\r\n        onKeyPress(e);\r\n      }\r\n    };\r\n\r\n    const handleClear = () => {\r\n      setCurrentValue('');\r\n      setIsInvalid(false);\r\n      setValidationMessage('');\r\n      if (onChange) {\r\n        onChange('', {} as ChangeEvent<HTMLInputElement | HTMLTextAreaElement>);\r\n      }\r\n      inputRef.current?.focus();\r\n    };\r\n\r\n    const togglePasswordVisibility = () => {\r\n      setShowPassword(!showPassword);\r\n    };\r\n\r\n    const handleCopyToClipboard = () => {\r\n      if (currentValue) {\r\n        navigator.clipboard.writeText(currentValue).then(() => {\r\n          // Optional: You could add a toast notification here\r\n        }).catch((err) => {\r\n          console.error('Failed to copy text: ', err);\r\n        });\r\n      }\r\n    };\r\n\r\n    const handleCopyPlaceholder = () => {\r\n      if (placeholder) {\r\n        navigator.clipboard.writeText(placeholder).then(() => {\r\n          // Optional: You could add a toast notification here\r\n        }).catch((err) => {\r\n          console.error('Failed to copy placeholder: ', err);\r\n        });\r\n      }\r\n    };\r\n\r\n    useImperativeHandle(ref, () => ({\r\n      getValue: () => currentValue,\r\n      setValue: (val: string) => {\r\n        setCurrentValue(val);\r\n        if (validateEvent === 'change') {\r\n          validateInput(val);\r\n        }\r\n      },\r\n      focus: () => inputRef.current?.focus(),\r\n      blur: () => inputRef.current?.blur(),\r\n      validate: () => validateInput(currentValue),\r\n      getInputNode: () => inputRef.current,\r\n      clear: handleClear,\r\n      isEnabled: () => !isDisabled,\r\n      disable: () => setIsDisabled(true),\r\n      enable: () => setIsDisabled(false),\r\n    }));\r\n\r\n    const labelStyle: React.CSSProperties = {\r\n      width: labelPosition === 'left' ? labelWidth : undefined,\r\n      textAlign: labelAlign,\r\n    };\r\n\r\n    const inputType = type === 'password' && showPassword ? 'text' : type;\r\n\r\n    // Handle padding\r\n    const paddingStyle = padding\r\n      ? typeof padding === 'number'\r\n        ? `${padding}px`\r\n        : Array.isArray(padding)\r\n        ? `${padding[0]}px ${padding[1]}px ${padding[2]}px ${padding[3]}px`\r\n        : padding\r\n      : undefined;\r\n\r\n    // Handle margin\r\n    const marginStyle = margin\r\n      ? typeof margin === 'number'\r\n        ? `${margin}px`\r\n        : Array.isArray(margin)\r\n        ? `${margin[0]}px ${margin[1]}px ${margin[2]}px ${margin[3]}px`\r\n        : margin\r\n      : undefined;\r\n\r\n    const containerStyle: React.CSSProperties = {\r\n      width: typeof width === 'number' ? `${width}px` : width,\r\n      height: typeof height === 'number' ? `${height}px` : height,\r\n      ...(paddingStyle && { padding: paddingStyle }),\r\n      ...(marginStyle && { margin: marginStyle }),\r\n    };\r\n\r\n    const containerClasses = [\r\n      'avakio-text',\r\n      `avakio-text-theme-${theme}`,\r\n      labelPosition === 'top' ? 'avakio-text-label-top' : 'avakio-text-label-left',\r\n      isInvalid ? 'avakio-text-invalid' : '',\r\n      isDisabled ? 'avakio-text-disabled' : '',\r\n      isFocused ? 'avakio-text-focused' : '',\r\n      readonly ? 'avakio-text-readonly' : '',\r\n      className,\r\n    ]\r\n      .filter(Boolean)\r\n      .join(' ');\r\n\r\n    const hasActionButton = (clear && currentValue) || type === 'password' || (enableValueCopyButton && currentValue) || (enablePlaceHolderCopyButton && placeholder);\r\n    \r\n    const inputClasses = [\r\n      'avakio-text-input',\r\n      `avakio-text-input-align-${inputAlign}`,\r\n      icon && iconPosition === 'left' ? 'avakio-text-input-with-icon-left' : '',\r\n      icon && iconPosition === 'right' && !hasActionButton ? 'avakio-text-input-with-icon-right' : '',\r\n      hasActionButton ? 'avakio-text-input-with-action' : '',\r\n    ]\r\n      .filter(Boolean)\r\n      .join(' ');\r\n\r\n    const wrapperStyle: React.CSSProperties = textWidth\r\n      ? { width: typeof textWidth === 'number' ? `${textWidth}px` : textWidth }\r\n      : {};\r\n\r\n    return (\r\n      <div className={containerClasses} style={containerStyle} onClick={onClick}>\r\n        {label && (\r\n          <label className=\"avakio-text-label\" style={labelStyle}>\r\n            {label}\r\n            {required && <span className=\"avakio-text-required\">*</span>}\r\n          </label>\r\n        )}\r\n        <div className=\"avakio-text-content\">\r\n          <div className=\"avakio-text-input-wrapper\" style={wrapperStyle}>\r\n            {icon && iconPosition === 'left' && (\r\n              <span className=\"avakio-text-icon avakio-text-icon-left\">{icon}</span>\r\n            )}\r\n            {multiline ? (\r\n              <textarea\r\n                ref={inputRef as React.RefObject<HTMLTextAreaElement>}\r\n                className={inputClasses}\r\n                value={currentValue}\r\n                placeholder={placeholder}\r\n                name={name}\r\n                disabled={isDisabled}\r\n                readOnly={readonly}\r\n                required={required}\r\n                maxLength={maxLength}\r\n                rows={rows}\r\n                onChange={handleChange as any}\r\n                onBlur={handleBlur as any}\r\n                onFocus={handleFocus as any}\r\n                onKeyPress={handleKeyPress as any}\r\n              />\r\n            ) : (\r\n              <input\r\n                ref={inputRef as React.RefObject<HTMLInputElement>}\r\n                type={inputType}\r\n                className={inputClasses}\r\n                value={currentValue}\r\n                placeholder={placeholder}\r\n                name={name}\r\n                disabled={isDisabled}\r\n                readOnly={readonly}\r\n                required={required}\r\n                maxLength={maxLength}\r\n                pattern={pattern}\r\n                min={min}\r\n                max={max}\r\n                step={step}\r\n                autoComplete={autoComplete}\r\n                onChange={handleChange as any}\r\n                onBlur={handleBlur as any}\r\n                onFocus={handleFocus as any}\r\n                onKeyPress={handleKeyPress as any}\r\n              />\r\n            )}\r\n            {icon && iconPosition === 'right' && !hasActionButton && (\r\n              <span className=\"avakio-text-icon avakio-text-icon-right\">{icon}</span>\r\n            )}\r\n            {type === 'password' && (\r\n              <button\r\n                type=\"button\"\r\n                className=\"avakio-text-action\"\r\n                onClick={togglePasswordVisibility}\r\n                disabled={isDisabled}\r\n                tabIndex={-1}\r\n              >\r\n                {showPassword ? <EyeOff size={16} /> : <Eye size={16} />}\r\n              </button>\r\n            )}\r\n            {clear && currentValue && type !== 'password' && (\r\n              <button\r\n                type=\"button\"\r\n                className=\"avakio-text-action avakio-text-clear\"\r\n                onClick={handleClear}\r\n                disabled={isDisabled || readonly}\r\n                tabIndex={-1}\r\n              >\r\n                <X size={16} />\r\n              </button>\r\n            )}\r\n            {enableValueCopyButton && currentValue && type !== 'password' && (\r\n              <button\r\n                type=\"button\"\r\n                className=\"avakio-text-action avakio-text-copy\"\r\n                onClick={handleCopyToClipboard}\r\n                disabled={isDisabled}\r\n                tabIndex={-1}\r\n                title=\"Copy value to clipboard\"\r\n              >\r\n                <Copy size={16} />\r\n              </button>\r\n            )}\r\n            {enablePlaceHolderCopyButton && placeholder && type !== 'password' && !enableValueCopyButton && (\r\n              <button\r\n                type=\"button\"\r\n                className=\"avakio-text-action avakio-text-copy\"\r\n                onClick={handleCopyPlaceholder}\r\n                disabled={isDisabled}\r\n                tabIndex={-1}\r\n                title=\"Copy placeholder to clipboard\"\r\n              >\r\n                <Copy size={16} />\r\n              </button>\r\n            )}\r\n          </div>\r\n          {bottomLabel && <div className=\"avakio-text-bottom-label\">{bottomLabel}</div>}\r\n          {isInvalid && validationMessage && (\r\n            <div className=\"avakio-text-error-message\">{validationMessage}</div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nAvakioText.displayName = 'AvakioText';\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { forwardRef, useImperativeHandle, useState, useRef, useEffect, useCallback } from 'react';\r\nimport './avakio-toggle-button.css';\r\n\r\nexport type AvakioToggleButtonTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\nexport type AvakioToggleButtonSize = 'sm' | 'md' | 'lg';\r\nexport type AvakioToggleButtonType = 'default' | 'icon' | 'iconTop' | 'image' | 'imageTop';\r\n\r\nexport interface AvakioToggleButtonProps {\r\n  /** Unique identifier */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n  /** Name for form submission */\r\n  name?: string;\r\n  /** Current pressed state (controlled) */\r\n  value?: boolean;\r\n  /** Default pressed state (uncontrolled) */\r\n  defaultValue?: boolean;\r\n  /** Label text (same for both states) */\r\n  label?: string;\r\n  /** Label when pressed/on */\r\n  onLabel?: string;\r\n  /** Label when unpressed/off */\r\n  offLabel?: string;\r\n  /** Icon (same for both states) */\r\n  icon?: React.ReactNode;\r\n  /** Icon when pressed/on */\r\n  onIcon?: React.ReactNode;\r\n  /** Icon when unpressed/off */\r\n  offIcon?: React.ReactNode;\r\n  /** Image URL (same for both states) */\r\n  image?: string;\r\n  /** Image URL when pressed/on */\r\n  onImage?: string;\r\n  /** Image URL when unpressed/off */\r\n  offImage?: string;\r\n  /** Button type/layout */\r\n  type?: AvakioToggleButtonType;\r\n  /** Button size */\r\n  size?: AvakioToggleButtonSize;\r\n  /** Theme variant */\r\n  theme?: AvakioToggleButtonTheme;\r\n  /** Disabled state */\r\n  disabled?: boolean;\r\n  /** Auto-adjust width to content */\r\n  autowidth?: boolean;\r\n  /** Full width button */\r\n  block?: boolean;\r\n  /** Tooltip text */\r\n  tooltip?: string;\r\n  /** Keyboard hotkey (e.g., 'ctrl+t') */\r\n  hotkey?: string;\r\n  /** CSS class name */\r\n  className?: string;\r\n  /** Inline styles */\r\n  css?: React.CSSProperties;\r\n  /** Width */\r\n  width?: number | string;\r\n  /** Height */\r\n  height?: number | string;\r\n  /** Padding (number for all sides, string for CSS, or [top, right, bottom, left]) */\r\n  padding?: string | number | [number, number, number, number];\r\n  /** Margin (number for all sides, string for CSS, or [top, right, bottom, left]) */\r\n  margin?: string | number | [number, number, number, number];\r\n  /** Callback when value changes */\r\n  onChange?: (value: boolean) => void;\r\n  /** Callback when clicked */\r\n  onClick?: (e: React.MouseEvent<HTMLButtonElement>) => void;\r\n  /** Callback when focused */\r\n  onFocus?: (e: React.FocusEvent<HTMLButtonElement>) => void;\r\n  /** Callback when blurred */\r\n  onBlur?: (e: React.FocusEvent<HTMLButtonElement>) => void;\r\n}\r\n\r\nexport interface AvakioToggleButtonRef {\r\n  /** Get the current pressed state */\r\n  getValue: () => boolean;\r\n  /** Set the pressed state */\r\n  setValue: (value: boolean) => void;\r\n  /** Toggle the state */\r\n  toggle: () => void;\r\n  /** Focus the button */\r\n  focus: () => void;\r\n  /** Blur the button */\r\n  blur: () => void;\r\n  /** Enable the button */\r\n  enable: () => void;\r\n  /** Disable the button */\r\n  disable: () => void;\r\n  /** Check if enabled */\r\n  isEnabled: () => boolean;\r\n  /** Get the HTML element */\r\n  getNode: () => HTMLButtonElement | null;\r\n}\r\n\r\nexport const AvakioToggleButton = forwardRef<AvakioToggleButtonRef, AvakioToggleButtonProps>(\r\n  (\r\n    {\r\n      id,\r\n      testId,\r\n      name,\r\n      value,\r\n      defaultValue = false,\r\n      label,\r\n      onLabel,\r\n      offLabel,\r\n      icon,\r\n      onIcon,\r\n      offIcon,\r\n      image,\r\n      onImage,\r\n      offImage,\r\n      type = 'default',\r\n      size = 'md',\r\n      theme,\r\n      disabled: disabledProp = false,\r\n      autowidth = false,\r\n      block = false,\r\n      tooltip,\r\n      hotkey,\r\n      className = '',\r\n      css,\r\n      width,\r\n      height,\r\n      padding,\r\n      margin,\r\n      onChange,\r\n      onClick,\r\n      onFocus,\r\n      onBlur,\r\n    },\r\n    ref\r\n  ) => {\r\n    const buttonRef = useRef<HTMLButtonElement>(null);\r\n    const isControlled = value !== undefined;\r\n    const [internalValue, setInternalValue] = useState<boolean>(defaultValue);\r\n    const [disabled, setDisabled] = useState<boolean>(disabledProp);\r\n\r\n    const isPressed = isControlled ? value : internalValue;\r\n\r\n    // Sync disabled prop\r\n    useEffect(() => {\r\n      setDisabled(disabledProp);\r\n    }, [disabledProp]);\r\n\r\n    // Handle hotkey\r\n    useEffect(() => {\r\n      if (!hotkey || disabled) return;\r\n\r\n      const handleKeyDown = (e: KeyboardEvent) => {\r\n        const keys = hotkey.toLowerCase().split('+');\r\n        const ctrl = keys.includes('ctrl') || keys.includes('control');\r\n        const shift = keys.includes('shift');\r\n        const alt = keys.includes('alt');\r\n        const key = keys[keys.length - 1];\r\n\r\n        if (\r\n          (ctrl === (e.ctrlKey || e.metaKey)) &&\r\n          shift === e.shiftKey &&\r\n          alt === e.altKey &&\r\n          e.key.toLowerCase() === key\r\n        ) {\r\n          e.preventDefault();\r\n          handleToggle();\r\n        }\r\n      };\r\n\r\n      document.addEventListener('keydown', handleKeyDown);\r\n      return () => document.removeEventListener('keydown', handleKeyDown);\r\n    }, [hotkey, disabled]);\r\n\r\n    const handleToggle = useCallback(() => {\r\n      if (disabled) return;\r\n\r\n      const newValue = !isPressed;\r\n      \r\n      if (!isControlled) {\r\n        setInternalValue(newValue);\r\n      }\r\n      \r\n      onChange?.(newValue);\r\n    }, [disabled, isPressed, isControlled, onChange]);\r\n\r\n    const handleClick = (e: React.MouseEvent<HTMLButtonElement>) => {\r\n      handleToggle();\r\n      onClick?.(e);\r\n    };\r\n\r\n    // Expose imperative methods\r\n    useImperativeHandle(ref, () => ({\r\n      getValue: () => isPressed,\r\n      setValue: (val: boolean) => {\r\n        if (!isControlled) {\r\n          setInternalValue(val);\r\n        }\r\n        onChange?.(val);\r\n      },\r\n      toggle: handleToggle,\r\n      focus: () => buttonRef.current?.focus(),\r\n      blur: () => buttonRef.current?.blur(),\r\n      enable: () => setDisabled(false),\r\n      disable: () => setDisabled(true),\r\n      isEnabled: () => !disabled,\r\n      getNode: () => buttonRef.current,\r\n    }), [isPressed, isControlled, disabled, onChange, handleToggle]);\r\n\r\n    // Determine current label\r\n    const currentLabel = isPressed\r\n      ? (onLabel ?? label)\r\n      : (offLabel ?? label);\r\n\r\n    // Determine current icon\r\n    const currentIcon = isPressed\r\n      ? (onIcon ?? icon)\r\n      : (offIcon ?? icon);\r\n\r\n    // Determine current image\r\n    const currentImage = isPressed\r\n      ? (onImage ?? image)\r\n      : (offImage ?? image);\r\n\r\n    // Build style object\r\n    const paddingStyle = padding\r\n      ? typeof padding === 'number'\r\n        ? `${padding}px`\r\n        : Array.isArray(padding)\r\n        ? `${padding[0]}px ${padding[1]}px ${padding[2]}px ${padding[3]}px`\r\n        : padding\r\n      : undefined;\r\n\r\n    const marginStyle = margin\r\n      ? typeof margin === 'number'\r\n        ? `${margin}px`\r\n        : Array.isArray(margin)\r\n        ? `${margin[0]}px ${margin[1]}px ${margin[2]}px ${margin[3]}px`\r\n        : margin\r\n      : undefined;\r\n\r\n    const style: React.CSSProperties = {\r\n      ...(css && typeof css === 'object' && !Array.isArray(css) ? css : {}),\r\n      width: typeof width === 'number' ? `${width}px` : width,\r\n      height: typeof height === 'number' ? `${height}px` : height,\r\n      padding: paddingStyle,\r\n      margin: marginStyle,\r\n    };\r\n\r\n    // Build class names\r\n    const buttonTypeClass = type === 'icon' ? 'icon' : type === 'iconTop' ? 'icon-top' : type === 'image' ? 'image' : type === 'imageTop' ? 'image-top' : 'default';\r\n\r\n    const classes = [\r\n      'avakio-toggle-button',\r\n      `avakio-toggle-button-${size}`,\r\n      `avakio-toggle-button-type-${buttonTypeClass}`,\r\n      isPressed && 'avakio-toggle-button-pressed',\r\n      disabled && 'avakio-toggle-button-disabled',\r\n      block && 'avakio-toggle-button-block',\r\n      autowidth && 'avakio-toggle-button-autowidth',\r\n      className,\r\n    ]\r\n      .filter(Boolean)\r\n      .join(' ');\r\n\r\n    return (\r\n      <button\r\n        ref={buttonRef}\r\n        id={id}\r\n        data-testid={testId}\r\n        data-admin-theme={theme}\r\n        name={name}\r\n        type=\"button\"\r\n        className={classes}\r\n        style={style}\r\n        disabled={disabled}\r\n        title={tooltip}\r\n        aria-pressed={isPressed}\r\n        onClick={handleClick}\r\n        onFocus={onFocus}\r\n        onBlur={onBlur}\r\n      >\r\n        <span className=\"avakio-toggle-button-inner\">\r\n          {currentImage && (\r\n            <img\r\n              src={currentImage}\r\n              alt=\"\"\r\n              className=\"avakio-toggle-button-image\"\r\n            />\r\n          )}\r\n          {currentIcon && (\r\n            <span className=\"avakio-toggle-button-icon\">{currentIcon}</span>\r\n          )}\r\n          {currentLabel && (\r\n            <span className=\"avakio-toggle-button-label\">{currentLabel}</span>\r\n          )}\r\n          {hotkey && (\r\n            <span className=\"avakio-toggle-button-hotkey\">{hotkey}</span>\r\n          )}\r\n        </span>\r\n      </button>\r\n    );\r\n  }\r\n);\r\n\r\nAvakioToggleButton.displayName = 'AvakioToggleButton';\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { forwardRef, useImperativeHandle, useState, useRef, useEffect, useCallback, useId } from 'react';\r\nimport './avakio-accordion.css';\r\nimport { ChevronRight, ChevronDown } from 'lucide-react';\r\n\r\nexport type AvakioAccordionTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\n\r\nexport type AvakioAccordionMultiMode = boolean | 'mixed';\r\n\r\nexport interface AvakioAccordionItem {\r\n  /** Unique identifier for the item */\r\n  id: string | number;\r\n  /** Header text or element */\r\n  header: React.ReactNode;\r\n  /** Body content */\r\n  body: React.ReactNode;\r\n  /** Whether this item is initially collapsed */\r\n  collapsed?: boolean;\r\n  /** Whether this item is disabled */\r\n  disabled?: boolean;\r\n  /** Custom icon for the header */\r\n  icon?: React.ReactNode;\r\n  /** CSS class for this item */\r\n  css?: string;\r\n  /** Whether this item header is visible */\r\n  headerVisible?: boolean;\r\n}\r\n\r\nexport interface AvakioAccordionProps {\r\n  /** Unique identifier */\r\n  id?: string;\r\n  /** Test ID for testing */\r\n  testId?: string;\r\n  /** Accordion items */\r\n  items: AvakioAccordionItem[];\r\n  /** \r\n   * Multi-expand mode:\r\n   * - true: all panels can be expanded/collapsed at a time\r\n   * - false: only one panel can be visible at a time (default)\r\n   * - 'mixed': all panels can be expanded at a time, but one must remain visible\r\n   */\r\n  multi?: AvakioAccordionMultiMode;\r\n  /** Layout type (horizontal or vertical) */\r\n  type?: 'rows' | 'cols';\r\n  /** Theme */\r\n  theme?: AvakioAccordionTheme;\r\n  /** Show icons on headers */\r\n  showIcons?: boolean;\r\n  /** Custom toggle icon for collapsed state */\r\n  collapseIcon?: React.ReactNode;\r\n  /** Custom toggle icon for expanded state */\r\n  expandIcon?: React.ReactNode;\r\n  /** Enable animation */\r\n  animate?: boolean;\r\n  /** Width */\r\n  width?: number | string;\r\n  /** Height */\r\n  height?: number | string;\r\n  /** CSS class */\r\n  className?: string;\r\n  /** Inline styles */\r\n  style?: React.CSSProperties;\r\n  /** Callback when an item is expanded */\r\n  onExpand?: (id: string | number) => void;\r\n  /** Callback when an item is collapsed */\r\n  onCollapse?: (id: string | number) => void;\r\n  /** Callback when state changes */\r\n  onChange?: (expandedIds: (string | number)[]) => void;\r\n}\r\n\r\nexport interface AvakioAccordionRef {\r\n  /** Get IDs of expanded items */\r\n  getExpandedIds: () => (string | number)[];\r\n  /** Expand an item by ID */\r\n  expand: (id: string | number) => void;\r\n  /** Collapse an item by ID */\r\n  collapse: (id: string | number) => void;\r\n  /** Toggle an item by ID */\r\n  toggle: (id: string | number) => void;\r\n  /** Expand all items */\r\n  expandAll: () => void;\r\n  /** Collapse all items */\r\n  collapseAll: () => void;\r\n  /** Check if an item is expanded */\r\n  isExpanded: (id: string | number) => boolean;\r\n  /** Check if an item is disabled */\r\n  isDisabled: (id: string | number) => boolean;\r\n  /** Enable an item */\r\n  enable: (id: string | number) => void;\r\n  /** Disable an item */\r\n  disable: (id: string | number) => void;\r\n}\r\n\r\nexport const AvakioAccordion = forwardRef<AvakioAccordionRef, AvakioAccordionProps>(\r\n  (props, ref) => {\r\n    const {\r\n      id,\r\n      testId,\r\n      items,\r\n      multi = false,\r\n      type = 'rows',\r\n      theme = 'material',\r\n      showIcons = true,\r\n      collapseIcon,\r\n      expandIcon,\r\n      animate = true,\r\n      width,\r\n      height,\r\n      className = '',\r\n      style,\r\n      onExpand,\r\n      onCollapse,\r\n      onChange,\r\n    } = props;\r\n\r\n    const generatedId = useId();\r\n    const accordionId = id || generatedId;\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n    const contentRefs = useRef<Map<string | number, HTMLDivElement>>(new Map());\r\n\r\n    // Initialize expanded state based on items' collapsed property\r\n    const getInitialExpandedIds = useCallback(() => {\r\n      const expanded: (string | number)[] = [];\r\n      items.forEach((item) => {\r\n        if (!item.collapsed && item.headerVisible !== false) {\r\n          expanded.push(item.id);\r\n        }\r\n      });\r\n      // If multi is false and no items are expanded, expand the first non-disabled item\r\n      if (expanded.length === 0 && multi === false) {\r\n        const firstEnabled = items.find((item) => !item.disabled && item.headerVisible !== false);\r\n        if (firstEnabled) {\r\n          expanded.push(firstEnabled.id);\r\n        }\r\n      }\r\n      return expanded;\r\n    }, [items, multi]);\r\n\r\n    const [expandedIds, setExpandedIds] = useState<(string | number)[]>(getInitialExpandedIds);\r\n    const [disabledIds, setDisabledIds] = useState<Set<string | number>>(() => {\r\n      return new Set(items.filter((item) => item.disabled).map((item) => item.id));\r\n    });\r\n\r\n    // Update state when items change\r\n    useEffect(() => {\r\n      setExpandedIds(getInitialExpandedIds());\r\n      setDisabledIds(new Set(items.filter((item) => item.disabled).map((item) => item.id)));\r\n    }, [items, getInitialExpandedIds]);\r\n\r\n    // Handle item toggle\r\n    const handleToggle = useCallback(\r\n      (itemId: string | number) => {\r\n        if (disabledIds.has(itemId)) return;\r\n\r\n        setExpandedIds((prev) => {\r\n          const isCurrentlyExpanded = prev.includes(itemId);\r\n          let newExpandedIds: (string | number)[];\r\n\r\n          if (isCurrentlyExpanded) {\r\n            // Collapsing\r\n            if (multi === false) {\r\n              // In single mode, always keep one item open\r\n              // Find another non-disabled item to expand\r\n              const otherItem = items.find(\r\n                (item) => item.id !== itemId && !disabledIds.has(item.id) && item.headerVisible !== false\r\n              );\r\n              newExpandedIds = otherItem ? [otherItem.id] : prev;\r\n            } else if (multi === 'mixed') {\r\n              // In mixed mode, prevent closing the last item\r\n              if (prev.length <= 1) {\r\n                return prev;\r\n              }\r\n              newExpandedIds = prev.filter((id) => id !== itemId);\r\n            } else {\r\n              // In multi mode, allow collapsing\r\n              newExpandedIds = prev.filter((id) => id !== itemId);\r\n            }\r\n            if (newExpandedIds !== prev) {\r\n              onCollapse?.(itemId);\r\n            }\r\n          } else {\r\n            // Expanding\r\n            if (multi === false) {\r\n              // In single mode, collapse others\r\n              prev.forEach((id) => {\r\n                if (id !== itemId) {\r\n                  onCollapse?.(id);\r\n                }\r\n              });\r\n              newExpandedIds = [itemId];\r\n            } else {\r\n              // In multi or mixed mode, add to expanded\r\n              newExpandedIds = [...prev, itemId];\r\n            }\r\n            onExpand?.(itemId);\r\n          }\r\n\r\n          if (newExpandedIds !== prev) {\r\n            onChange?.(newExpandedIds);\r\n          }\r\n          return newExpandedIds;\r\n        });\r\n      },\r\n      [multi, items, disabledIds, onExpand, onCollapse, onChange]\r\n    );\r\n\r\n    // Handle keyboard navigation\r\n    const handleKeyDown = useCallback(\r\n      (e: React.KeyboardEvent, itemId: string | number, index: number) => {\r\n        const enabledItems = items.filter(\r\n          (item) => !disabledIds.has(item.id) && item.headerVisible !== false\r\n        );\r\n        const currentIndex = enabledItems.findIndex((item) => item.id === itemId);\r\n\r\n        switch (e.key) {\r\n          case 'Enter':\r\n          case ' ':\r\n            e.preventDefault();\r\n            handleToggle(itemId);\r\n            break;\r\n          case 'ArrowDown':\r\n          case 'ArrowRight':\r\n            e.preventDefault();\r\n            if (currentIndex < enabledItems.length - 1) {\r\n              const nextItem = enabledItems[currentIndex + 1];\r\n              const nextHeader = containerRef.current?.querySelector(\r\n                `[data-item-id=\"${nextItem.id}\"] .avakio-accordion-header`\r\n              ) as HTMLElement;\r\n              nextHeader?.focus();\r\n            }\r\n            break;\r\n          case 'ArrowUp':\r\n          case 'ArrowLeft':\r\n            e.preventDefault();\r\n            if (currentIndex > 0) {\r\n              const prevItem = enabledItems[currentIndex - 1];\r\n              const prevHeader = containerRef.current?.querySelector(\r\n                `[data-item-id=\"${prevItem.id}\"] .avakio-accordion-header`\r\n              ) as HTMLElement;\r\n              prevHeader?.focus();\r\n            }\r\n            break;\r\n          case 'Home':\r\n            e.preventDefault();\r\n            if (enabledItems.length > 0) {\r\n              const firstItem = enabledItems[0];\r\n              const firstHeader = containerRef.current?.querySelector(\r\n                `[data-item-id=\"${firstItem.id}\"] .avakio-accordion-header`\r\n              ) as HTMLElement;\r\n              firstHeader?.focus();\r\n            }\r\n            break;\r\n          case 'End':\r\n            e.preventDefault();\r\n            if (enabledItems.length > 0) {\r\n              const lastItem = enabledItems[enabledItems.length - 1];\r\n              const lastHeader = containerRef.current?.querySelector(\r\n                `[data-item-id=\"${lastItem.id}\"] .avakio-accordion-header`\r\n              ) as HTMLElement;\r\n              lastHeader?.focus();\r\n            }\r\n            break;\r\n        }\r\n      },\r\n      [items, disabledIds, handleToggle]\r\n    );\r\n\r\n    // Imperative handle\r\n    useImperativeHandle(ref, () => ({\r\n      getExpandedIds: () => expandedIds,\r\n      expand: (itemId: string | number) => {\r\n        if (!expandedIds.includes(itemId) && !disabledIds.has(itemId)) {\r\n          handleToggle(itemId);\r\n        }\r\n      },\r\n      collapse: (itemId: string | number) => {\r\n        if (expandedIds.includes(itemId)) {\r\n          handleToggle(itemId);\r\n        }\r\n      },\r\n      toggle: (itemId: string | number) => {\r\n        if (!disabledIds.has(itemId)) {\r\n          handleToggle(itemId);\r\n        }\r\n      },\r\n      expandAll: () => {\r\n        if (multi === true) {\r\n          const allIds = items\r\n            .filter((item) => !disabledIds.has(item.id) && item.headerVisible !== false)\r\n            .map((item) => item.id);\r\n          setExpandedIds(allIds);\r\n          allIds.forEach((id) => {\r\n            if (!expandedIds.includes(id)) {\r\n              onExpand?.(id);\r\n            }\r\n          });\r\n          onChange?.(allIds);\r\n        }\r\n      },\r\n      collapseAll: () => {\r\n        if (multi === true) {\r\n          expandedIds.forEach((id) => onCollapse?.(id));\r\n          setExpandedIds([]);\r\n          onChange?.([]);\r\n        } else if (multi === 'mixed') {\r\n          // Keep only the first expanded item\r\n          const firstExpanded = expandedIds[0];\r\n          if (firstExpanded) {\r\n            expandedIds.slice(1).forEach((id) => onCollapse?.(id));\r\n            setExpandedIds([firstExpanded]);\r\n            onChange?.([firstExpanded]);\r\n          }\r\n        }\r\n      },\r\n      isExpanded: (itemId: string | number) => expandedIds.includes(itemId),\r\n      isDisabled: (itemId: string | number) => disabledIds.has(itemId),\r\n      enable: (itemId: string | number) => {\r\n        setDisabledIds((prev) => {\r\n          const newSet = new Set(prev);\r\n          newSet.delete(itemId);\r\n          return newSet;\r\n        });\r\n      },\r\n      disable: (itemId: string | number) => {\r\n        setDisabledIds((prev) => new Set(prev).add(itemId));\r\n      },\r\n    }), [expandedIds, disabledIds, items, multi, handleToggle, onExpand, onCollapse, onChange]);\r\n\r\n    // Render toggle icon\r\n    const renderToggleIcon = (isExpanded: boolean) => {\r\n      if (!showIcons) return null;\r\n\r\n      if (isExpanded) {\r\n        return expandIcon || <ChevronDown size={18} />;\r\n      }\r\n      return collapseIcon || <ChevronRight size={18} />;\r\n    };\r\n\r\n    // Build class names\r\n    const containerClasses = [\r\n      'avakio-accordion',\r\n      `avakio-accordion--${theme}`,\r\n      `avakio-accordion--${type}`,\r\n      animate && 'avakio-accordion--animated',\r\n      className,\r\n    ]\r\n      .filter(Boolean)\r\n      .join(' ');\r\n\r\n    // Build style\r\n    const containerStyle: React.CSSProperties = {\r\n      width: typeof width === 'number' ? `${width}px` : width,\r\n      height: typeof height === 'number' ? `${height}px` : height,\r\n      ...style,\r\n    };\r\n\r\n    return (\r\n      <div\r\n        ref={containerRef}\r\n        id={accordionId}\r\n        data-testid={testId}\r\n        className={containerClasses}\r\n        style={containerStyle}\r\n        role=\"presentation\"\r\n      >\r\n        {items.map((item, index) => {\r\n          const isExpanded = expandedIds.includes(item.id);\r\n          const isDisabled = disabledIds.has(item.id);\r\n          const headerVisible = item.headerVisible !== false;\r\n\r\n          const itemClasses = [\r\n            'avakio-accordion-item',\r\n            isExpanded && 'avakio-accordion-item--expanded',\r\n            isDisabled && 'avakio-accordion-item--disabled',\r\n            !headerVisible && 'avakio-accordion-item--no-header',\r\n            item.css,\r\n          ]\r\n            .filter(Boolean)\r\n            .join(' ');\r\n\r\n          const headerId = `${accordionId}-header-${item.id}`;\r\n          const panelId = `${accordionId}-panel-${item.id}`;\r\n\r\n          return (\r\n            <div\r\n              key={item.id}\r\n              className={itemClasses}\r\n              data-item-id={item.id}\r\n            >\r\n              {headerVisible && (\r\n                <div\r\n                  id={headerId}\r\n                  className=\"avakio-accordion-header\"\r\n                  role=\"button\"\r\n                  tabIndex={isDisabled ? -1 : 0}\r\n                  aria-expanded={isExpanded}\r\n                  aria-controls={panelId}\r\n                  aria-disabled={isDisabled}\r\n                  onClick={() => handleToggle(item.id)}\r\n                  onKeyDown={(e) => handleKeyDown(e, item.id, index)}\r\n                >\r\n                  <span className=\"avakio-accordion-toggle\">\r\n                    {renderToggleIcon(isExpanded)}\r\n                  </span>\r\n                  {item.icon && (\r\n                    <span className=\"avakio-accordion-icon\">{item.icon}</span>\r\n                  )}\r\n                  <span className=\"avakio-accordion-header-text\">{item.header}</span>\r\n                </div>\r\n              )}\r\n              <div\r\n                id={panelId}\r\n                ref={(el) => {\r\n                  if (el) {\r\n                    contentRefs.current.set(item.id, el);\r\n                  } else {\r\n                    contentRefs.current.delete(item.id);\r\n                  }\r\n                }}\r\n                className=\"avakio-accordion-content\"\r\n                role=\"region\"\r\n                aria-labelledby={headerId}\r\n                aria-hidden={!isExpanded}\r\n                style={{\r\n                  maxHeight: isExpanded ? undefined : 0,\r\n                  overflow: isExpanded ? 'visible' : 'hidden',\r\n                }}\r\n              >\r\n                <div className=\"avakio-accordion-body\">{item.body}</div>\r\n              </div>\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nAvakioAccordion.displayName = 'AvakioAccordion';\r\n\r\nexport default AvakioAccordion;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useMemo, useEffect, useState, useRef } from 'react';\r\nimport { cn } from '@/lib/utils';\r\nimport './avakio-bullet-graph.css';\r\n\r\nexport interface AvakioBulletGraphBand {\r\n  /** The end value of this band (bands are rendered from highest to lowest) */\r\n  value: number;\r\n  /** The color of this band */\r\n  color: string;\r\n}\r\n\r\nexport interface AvakioBulletGraphScale {\r\n  /** Step interval for scale ticks */\r\n  step?: number;\r\n  /** Template for scale labels. Use #value# as placeholder */\r\n  template?: string | ((value: number) => string);\r\n}\r\n\r\nexport interface AvakioBulletGraphProps {\r\n  /** Current value to display */\r\n  value: number;\r\n  /** Minimum range value */\r\n  minRange?: number;\r\n  /** Maximum range value */\r\n  maxRange?: number;\r\n  /** Target marker position (vertical line). Set to false to hide */\r\n  marker?: number | false;\r\n  /** Color of the marker */\r\n  markerColor?: string;\r\n  /** Color of the value bar. Can be a string or function that receives value */\r\n  color?: string | ((value: number) => string);\r\n  /** Performance bands (qualitative ranges) */\r\n  bands?: AvakioBulletGraphBand[];\r\n  /** Label text */\r\n  label?: string;\r\n  /** Additional description. Use #value# as placeholder for current value */\r\n  placeholder?: string;\r\n  /** Width of the value bar in pixels */\r\n  stroke?: number;\r\n  /** Scale configuration */\r\n  scale?: AvakioBulletGraphScale;\r\n  /** Length of scale ticks in pixels */\r\n  tickSize?: number;\r\n  /** Animation duration in milliseconds */\r\n  flowTime?: number;\r\n  /** Enable smooth animation */\r\n  smoothFlow?: boolean;\r\n  /** Layout orientation */\r\n  layout?: 'horizontal' | 'vertical';\r\n  /** Width of the label area (horizontal layout) */\r\n  labelWidth?: number;\r\n  /** Height of the label area (vertical layout) */\r\n  labelHeight?: number;\r\n  /** Show/hide the label */\r\n  showLabel?: boolean;\r\n  /** Show/hide the scale */\r\n  showScale?: boolean;\r\n  /** Whether the component is disabled */\r\n  disabled?: boolean;\r\n  /** Unique ID */\r\n  id?: string;\r\n  /** Test ID for testing */\r\n  testId?: string;\r\n  /** Additional CSS class */\r\n  className?: string;\r\n}\r\n\r\nconst DEFAULT_BANDS: AvakioBulletGraphBand[] = [\r\n  { value: 100, color: '#5be5d6' },\r\n  { value: 80, color: '#fff07e' },\r\n  { value: 60, color: '#fd8b8c' },\r\n];\r\n\r\nexport function AvakioBulletGraph({\r\n  value,\r\n  minRange = 0,\r\n  maxRange = 100,\r\n  marker = false,\r\n  markerColor,\r\n  color = 'var(--bg-primary)',\r\n  bands = DEFAULT_BANDS,\r\n  label,\r\n  placeholder,\r\n  stroke = 8,\r\n  scale,\r\n  tickSize = 10,\r\n  flowTime = 500,\r\n  smoothFlow = true,\r\n  layout = 'horizontal',\r\n  labelWidth = 120,\r\n  labelHeight = 40,\r\n  showLabel = true,\r\n  showScale = true,\r\n  disabled = false,\r\n  id,\r\n  testId,\r\n  className,\r\n}: AvakioBulletGraphProps) {\r\n  const [animatedValue, setAnimatedValue] = useState(minRange);\r\n  const animationRef = useRef<number | null>(null);\r\n  const prevValueRef = useRef(minRange);\r\n\r\n  // Clamp value to range\r\n  const clampedValue = useMemo(() => {\r\n    return Math.max(minRange, Math.min(maxRange, value));\r\n  }, [value, minRange, maxRange]);\r\n\r\n  // Animate value changes\r\n  useEffect(() => {\r\n    if (!smoothFlow || flowTime === 0) {\r\n      setAnimatedValue(clampedValue);\r\n      return;\r\n    }\r\n\r\n    const startValue = prevValueRef.current;\r\n    const endValue = clampedValue;\r\n    const startTime = performance.now();\r\n\r\n    const animate = (currentTime: number) => {\r\n      const elapsed = currentTime - startTime;\r\n      const progress = Math.min(elapsed / flowTime, 1);\r\n      \r\n      // Ease out cubic\r\n      const easeProgress = 1 - Math.pow(1 - progress, 3);\r\n      const currentValue = startValue + (endValue - startValue) * easeProgress;\r\n      \r\n      setAnimatedValue(currentValue);\r\n\r\n      if (progress < 1) {\r\n        animationRef.current = requestAnimationFrame(animate);\r\n      } else {\r\n        prevValueRef.current = endValue;\r\n      }\r\n    };\r\n\r\n    if (animationRef.current) {\r\n      cancelAnimationFrame(animationRef.current);\r\n    }\r\n    animationRef.current = requestAnimationFrame(animate);\r\n\r\n    return () => {\r\n      if (animationRef.current) {\r\n        cancelAnimationFrame(animationRef.current);\r\n      }\r\n    };\r\n  }, [clampedValue, flowTime, smoothFlow]);\r\n\r\n  // Calculate percentage position\r\n  const getPercentage = (val: number) => {\r\n    const range = maxRange - minRange;\r\n    if (range === 0) return 0;\r\n    return ((val - minRange) / range) * 100;\r\n  };\r\n\r\n  // Get bar color\r\n  const barColor = useMemo(() => {\r\n    if (typeof color === 'function') {\r\n      return color(clampedValue);\r\n    }\r\n    return color;\r\n  }, [color, clampedValue]);\r\n\r\n  // Generate scale ticks\r\n  const scaleTicks = useMemo(() => {\r\n    if (!showScale || !scale) return [];\r\n    \r\n    const step = scale.step || 10;\r\n    const ticks: { value: number; label: string; position: number }[] = [];\r\n    \r\n    for (let v = minRange; v <= maxRange; v += step) {\r\n      let label = String(v);\r\n      if (scale.template) {\r\n        if (typeof scale.template === 'function') {\r\n          label = scale.template(v);\r\n        } else {\r\n          label = scale.template.replace('#value#', String(v));\r\n        }\r\n      }\r\n      ticks.push({\r\n        value: v,\r\n        label,\r\n        position: getPercentage(v),\r\n      });\r\n    }\r\n    \r\n    return ticks;\r\n  }, [showScale, scale, minRange, maxRange]);\r\n\r\n  // Sort bands by value descending (render highest first as background)\r\n  const sortedBands = useMemo(() => {\r\n    return [...bands].sort((a, b) => b.value - a.value);\r\n  }, [bands]);\r\n\r\n  // Format placeholder text\r\n  const formattedPlaceholder = useMemo(() => {\r\n    if (!placeholder) return null;\r\n    return placeholder.replace('#value#', String(Math.round(clampedValue)));\r\n  }, [placeholder, clampedValue]);\r\n\r\n  const isVertical = layout === 'vertical';\r\n\r\n  return (\r\n    <div\r\n      id={id}\r\n      data-testid={testId}\r\n      className={cn(\r\n        'avakio-bullet-graph',\r\n        isVertical && 'avakio-bullet-graph-vertical',\r\n        disabled && 'avakio-bullet-graph-disabled',\r\n        className\r\n      )}\r\n      style={{\r\n        '--bg-label-width': `${labelWidth}px`,\r\n        '--bg-label-height': `${labelHeight}px`,\r\n      } as React.CSSProperties}\r\n    >\r\n      {/* Label Section */}\r\n      {showLabel && label && (\r\n        <div className=\"avakio-bullet-graph-label\">\r\n          <span className=\"avakio-bullet-graph-label-text\">{label}</span>\r\n          {formattedPlaceholder && (\r\n            <span className=\"avakio-bullet-graph-placeholder\">{formattedPlaceholder}</span>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {/* Graph Section */}\r\n      <div className=\"avakio-bullet-graph-container\">\r\n        <div className=\"avakio-bullet-graph-track\">\r\n          {/* Performance Bands */}\r\n          {sortedBands.map((band, index) => (\r\n            <div\r\n              key={index}\r\n              className=\"avakio-bullet-graph-band\"\r\n              style={{\r\n                [isVertical ? 'height' : 'width']: `${getPercentage(band.value)}%`,\r\n                backgroundColor: band.color,\r\n              }}\r\n            />\r\n          ))}\r\n\r\n          {/* Value Bar */}\r\n          <div\r\n            className=\"avakio-bullet-graph-bar\"\r\n            style={{\r\n              [isVertical ? 'height' : 'width']: `${getPercentage(animatedValue)}%`,\r\n              [isVertical ? 'width' : 'height']: `${stroke}px`,\r\n              backgroundColor: barColor,\r\n              transition: smoothFlow ? `all ${flowTime}ms ease-out` : 'none',\r\n            }}\r\n          />\r\n\r\n          {/* Target Marker */}\r\n          {marker !== false && (\r\n            <div\r\n              className=\"avakio-bullet-graph-marker\"\r\n              style={{\r\n                [isVertical ? 'bottom' : 'left']: `${getPercentage(marker)}%`,\r\n                backgroundColor: markerColor || 'var(--bg-marker)',\r\n              }}\r\n            />\r\n          )}\r\n        </div>\r\n\r\n        {/* Scale */}\r\n        {showScale && scaleTicks.length > 0 && (\r\n          <div className=\"avakio-bullet-graph-scale\">\r\n            {scaleTicks.map((tick, index) => (\r\n              <div\r\n                key={index}\r\n                className=\"avakio-bullet-graph-tick\"\r\n                style={{\r\n                  [isVertical ? 'bottom' : 'left']: `${tick.position}%`,\r\n                }}\r\n              >\r\n                <div\r\n                  className=\"avakio-bullet-graph-tick-line\"\r\n                  style={{\r\n                    [isVertical ? 'width' : 'height']: `${tickSize}px`,\r\n                  }}\r\n                />\r\n                <span className=\"avakio-bullet-graph-tick-label\">{tick.label}</span>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default AvakioBulletGraph;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { forwardRef, useEffect, useImperativeHandle, useRef, useState, useCallback, ReactNode } from 'react';\r\nimport { ChevronLeft, ChevronRight } from 'lucide-react';\r\nimport './avakio-carousel.css';\r\n\r\nexport type AvakioCarouselTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\nexport type NavigationType = 'side' | 'bottom';\r\nexport type NavigationPosition = 'left' | 'right' | 'center';\r\n\r\nexport interface AvakioCarouselSlide {\r\n  id: string;\r\n  content: ReactNode;\r\n}\r\n\r\nexport interface AvakioCarouselNavigation {\r\n  type?: NavigationType;\r\n  items?: boolean;\r\n  buttons?: boolean;\r\n  position?: NavigationPosition;\r\n}\r\n\r\nexport interface AvakioCarouselProps {\r\n  id?: string;\r\n  testId?: string;\r\n  slides: AvakioCarouselSlide[];\r\n  theme?: AvakioCarouselTheme;\r\n  navigation?: AvakioCarouselNavigation;\r\n  autoplay?: boolean;\r\n  autoplayDelay?: number;\r\n  scrollSpeed?: number;\r\n  loop?: boolean;\r\n  activeIndex?: number;\r\n  width?: number | string;\r\n  height?: number | string;\r\n  css?: React.CSSProperties;\r\n  onShow?: (id: string, index: number) => void;\r\n  onSlideChange?: (id: string, index: number) => void;\r\n}\r\n\r\nexport interface AvakioCarouselRef {\r\n  showNext: () => void;\r\n  showPrev: () => void;\r\n  setActive: (id: string) => void;\r\n  setActiveIndex: (index: number) => void;\r\n  getActiveId: () => string;\r\n  getActiveIndex: () => number;\r\n  addView: (slide: AvakioCarouselSlide, position?: number) => void;\r\n  removeView: (id: string) => void;\r\n}\r\n\r\nexport const AvakioCarousel = forwardRef<AvakioCarouselRef, AvakioCarouselProps>(\r\n  (\r\n    {\r\n      id,\r\n      testId,\r\n      slides,\r\n      theme = 'material',\r\n      navigation = { type: 'bottom', items: true, buttons: true, position: 'center' },\r\n      autoplay = false,\r\n      autoplayDelay = 3000,\r\n      scrollSpeed = 300,\r\n      loop = true,\r\n      activeIndex = 0,\r\n      width,\r\n      height = 400,\r\n      css,\r\n      onShow,\r\n      onSlideChange,\r\n    },\r\n    ref\r\n  ) => {\r\n    const [currentIndex, setCurrentIndex] = useState(activeIndex);\r\n    const [slidesList, setSlidesList] = useState<AvakioCarouselSlide[]>(slides);\r\n    const [isTransitioning, setIsTransitioning] = useState(false);\r\n    const [touchStart, setTouchStart] = useState<number | null>(null);\r\n    const [touchEnd, setTouchEnd] = useState<number | null>(null);\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n    const autoplayTimerRef = useRef<NodeJS.Timeout | null>(null);\r\n\r\n    // Min swipe distance (in px)\r\n    const minSwipeDistance = 50;\r\n\r\n    useEffect(() => {\r\n      setSlidesList(slides);\r\n    }, [slides]);\r\n\r\n    const goToSlide = useCallback(\r\n      (index: number, skipTransition = false) => {\r\n        if (isTransitioning && !skipTransition) return;\r\n        \r\n        const targetIndex = Math.max(0, Math.min(index, slidesList.length - 1));\r\n        \r\n        if (!skipTransition) {\r\n          setIsTransitioning(true);\r\n          setTimeout(() => setIsTransitioning(false), scrollSpeed);\r\n        }\r\n        \r\n        setCurrentIndex(targetIndex);\r\n        \r\n        const slide = slidesList[targetIndex];\r\n        if (slide) {\r\n          onShow?.(slide.id, targetIndex);\r\n          onSlideChange?.(slide.id, targetIndex);\r\n        }\r\n      },\r\n      [isTransitioning, slidesList, scrollSpeed, onShow, onSlideChange]\r\n    );\r\n\r\n    const showNext = useCallback(() => {\r\n      if (currentIndex < slidesList.length - 1) {\r\n        goToSlide(currentIndex + 1);\r\n      } else if (loop) {\r\n        goToSlide(0);\r\n      }\r\n    }, [currentIndex, slidesList.length, loop, goToSlide]);\r\n\r\n    const showPrev = useCallback(() => {\r\n      if (currentIndex > 0) {\r\n        goToSlide(currentIndex - 1);\r\n      } else if (loop) {\r\n        goToSlide(slidesList.length - 1);\r\n      }\r\n    }, [currentIndex, slidesList.length, loop, goToSlide]);\r\n\r\n    const setActive = useCallback(\r\n      (slideId: string) => {\r\n        const index = slidesList.findIndex(s => s.id === slideId);\r\n        if (index !== -1) {\r\n          goToSlide(index);\r\n        }\r\n      },\r\n      [slidesList, goToSlide]\r\n    );\r\n\r\n    const setActiveIndex = useCallback(\r\n      (index: number) => {\r\n        goToSlide(index);\r\n      },\r\n      [goToSlide]\r\n    );\r\n\r\n    const getActiveId = useCallback(() => {\r\n      return slidesList[currentIndex]?.id || '';\r\n    }, [slidesList, currentIndex]);\r\n\r\n    const getActiveIndex = useCallback(() => {\r\n      return currentIndex;\r\n    }, [currentIndex]);\r\n\r\n    const addView = useCallback((slide: AvakioCarouselSlide, position?: number) => {\r\n      setSlidesList(prev => {\r\n        if (position !== undefined && position >= 0 && position <= prev.length) {\r\n          return [...prev.slice(0, position), slide, ...prev.slice(position)];\r\n        }\r\n        return [...prev, slide];\r\n      });\r\n    }, []);\r\n\r\n    const removeView = useCallback((slideId: string) => {\r\n      setSlidesList(prev => {\r\n        const newSlides = prev.filter(s => s.id !== slideId);\r\n        if (currentIndex >= newSlides.length && newSlides.length > 0) {\r\n          setCurrentIndex(newSlides.length - 1);\r\n        }\r\n        return newSlides;\r\n      });\r\n    }, [currentIndex]);\r\n\r\n    useImperativeHandle(ref, () => ({\r\n      showNext,\r\n      showPrev,\r\n      setActive,\r\n      setActiveIndex,\r\n      getActiveId,\r\n      getActiveIndex,\r\n      addView,\r\n      removeView,\r\n    }));\r\n\r\n    // Autoplay effect\r\n    useEffect(() => {\r\n      if (autoplay && slidesList.length > 1) {\r\n        autoplayTimerRef.current = setInterval(() => {\r\n          showNext();\r\n        }, autoplayDelay);\r\n\r\n        return () => {\r\n          if (autoplayTimerRef.current) {\r\n            clearInterval(autoplayTimerRef.current);\r\n          }\r\n        };\r\n      }\r\n    }, [autoplay, autoplayDelay, showNext, slidesList.length]);\r\n\r\n    // Touch handlers\r\n    const onTouchStart = (e: React.TouchEvent) => {\r\n      setTouchEnd(null);\r\n      setTouchStart(e.targetTouches[0].clientX);\r\n    };\r\n\r\n    const onTouchMove = (e: React.TouchEvent) => {\r\n      setTouchEnd(e.targetTouches[0].clientX);\r\n    };\r\n\r\n    const onTouchEnd = () => {\r\n      if (!touchStart || !touchEnd) return;\r\n      \r\n      const distance = touchStart - touchEnd;\r\n      const isLeftSwipe = distance > minSwipeDistance;\r\n      const isRightSwipe = distance < -minSwipeDistance;\r\n\r\n      if (isLeftSwipe) {\r\n        showNext();\r\n      }\r\n      if (isRightSwipe) {\r\n        showPrev();\r\n      }\r\n    };\r\n\r\n    // Keyboard navigation\r\n    useEffect(() => {\r\n      const handleKeyDown = (e: KeyboardEvent) => {\r\n        if (e.key === 'ArrowLeft') {\r\n          showPrev();\r\n        } else if (e.key === 'ArrowRight') {\r\n          showNext();\r\n        }\r\n      };\r\n\r\n      window.addEventListener('keydown', handleKeyDown);\r\n      return () => window.removeEventListener('keydown', handleKeyDown);\r\n    }, [showNext, showPrev]);\r\n\r\n    const containerStyle: React.CSSProperties = {\r\n      width: typeof width === 'number' ? `${width}px` : width,\r\n      height: typeof height === 'number' ? `${height}px` : height,\r\n      ...(css && typeof css === 'object' && !Array.isArray(css) ? css : {}),\r\n    };\r\n\r\n    const isSideNavigation = navigation.type === 'side';\r\n    const showButtons = navigation.buttons !== false;\r\n    const showItems = navigation.items !== false;\r\n\r\n    return (\r\n      <div\r\n        ref={containerRef}\r\n        id={id}\r\n        data-testid={testId}\r\n        className={`avakio-carousel avakio-carousel-theme-${theme}`}\r\n        style={containerStyle}\r\n        onTouchStart={onTouchStart}\r\n        onTouchMove={onTouchMove}\r\n        onTouchEnd={onTouchEnd}\r\n      >\r\n        {/* Left Navigation Button (Side Type) */}\r\n        {isSideNavigation && showButtons && (\r\n          <button\r\n            className=\"avakio-carousel-nav-button avakio-carousel-nav-prev\"\r\n            onClick={showPrev}\r\n            disabled={!loop && currentIndex === 0}\r\n            aria-label=\"Previous slide\"\r\n          >\r\n            <ChevronLeft size={24} />\r\n          </button>\r\n        )}\r\n\r\n        {/* Slides Container */}\r\n        <div className=\"avakio-carousel-viewport\">\r\n          <div\r\n            className=\"avakio-carousel-track\"\r\n            style={{\r\n              transform: `translateX(-${currentIndex * 100}%)`,\r\n              transition: isTransitioning ? `transform ${scrollSpeed}ms ease-in-out` : 'none',\r\n            }}\r\n          >\r\n            {slidesList.map((slide) => (\r\n              <div key={slide.id} className=\"avakio-carousel-slide\">\r\n                {slide.content}\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Right Navigation Button (Side Type) */}\r\n        {isSideNavigation && showButtons && (\r\n          <button\r\n            className=\"avakio-carousel-nav-button avakio-carousel-nav-next\"\r\n            onClick={showNext}\r\n            disabled={!loop && currentIndex === slidesList.length - 1}\r\n            aria-label=\"Next slide\"\r\n          >\r\n            <ChevronRight size={24} />\r\n          </button>\r\n        )}\r\n\r\n        {/* Bottom Navigation */}\r\n        {!isSideNavigation && (showButtons || showItems) && (\r\n          <div className={`avakio-carousel-nav-bottom avakio-carousel-nav-${navigation.position || 'center'}`}>\r\n            {/* Navigation Buttons */}\r\n            {showButtons && (\r\n              <div className=\"avakio-carousel-nav-buttons\">\r\n                <button\r\n                  className=\"avakio-carousel-nav-button\"\r\n                  onClick={showPrev}\r\n                  disabled={!loop && currentIndex === 0}\r\n                  aria-label=\"Previous slide\"\r\n                >\r\n                  <ChevronLeft size={20} />\r\n                </button>\r\n                <button\r\n                  className=\"avakio-carousel-nav-button\"\r\n                  onClick={showNext}\r\n                  disabled={!loop && currentIndex === slidesList.length - 1}\r\n                  aria-label=\"Next slide\"\r\n                >\r\n                  <ChevronRight size={20} />\r\n                </button>\r\n              </div>\r\n            )}\r\n\r\n            {/* Navigation Indicators */}\r\n            {showItems && (\r\n              <div className=\"avakio-carousel-indicators\">\r\n                {slidesList.map((slide, index) => (\r\n                  <button\r\n                    key={slide.id}\r\n                    className={`avakio-carousel-indicator ${\r\n                      index === currentIndex ? 'avakio-carousel-indicator-active' : ''\r\n                    }`}\r\n                    onClick={() => goToSlide(index)}\r\n                    aria-label={`Go to slide ${index + 1}`}\r\n                  />\r\n                ))}\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nAvakioCarousel.displayName = 'AvakioCarousel';\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { forwardRef, useImperativeHandle, useState, useRef, useEffect, useCallback, useMemo } from 'react';\r\nimport './avakio-chart.css';\r\n\r\nexport type AvakioChartTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\n\r\nexport type AvakioChartType = \r\n  | 'line' \r\n  | 'spline' \r\n  | 'area' \r\n  | 'splineArea'\r\n  | 'bar' \r\n  | 'barH'\r\n  | 'stackedBar'\r\n  | 'stackedBarH'\r\n  | 'pie' \r\n  | 'pie3D'\r\n  | 'donut' \r\n  | 'scatter' \r\n  | 'radar';\r\n\r\nexport interface AvakioChartDataPoint {\r\n  /** X-axis value or label */\r\n  x?: string | number;\r\n  /** Y-axis value */\r\n  y: number;\r\n  /** Label for pie/donut charts */\r\n  label?: string;\r\n  /** Color override for this data point */\r\n  color?: string;\r\n  /** Tooltip text */\r\n  tooltip?: string;\r\n  /** Any additional custom data */\r\n  [key: string]: any;\r\n}\r\n\r\nexport interface AvakioChartSeries {\r\n  /** Unique identifier for the series */\r\n  id?: string;\r\n  /** Series name (shown in legend) */\r\n  name: string;\r\n  /** Data points */\r\n  data: AvakioChartDataPoint[];\r\n  /** Series color */\r\n  color?: string;\r\n  /** Series type override */\r\n  type?: AvakioChartType;\r\n  /** Line width (for line/spline/area) */\r\n  lineWidth?: number;\r\n  /** Fill opacity (for area charts) */\r\n  fillOpacity?: number;\r\n  /** Show data labels */\r\n  showLabels?: boolean;\r\n  /** Show data points/markers */\r\n  showMarkers?: boolean;\r\n  /** Marker size */\r\n  markerSize?: number;\r\n  /** Hidden initially */\r\n  hidden?: boolean;\r\n}\r\n\r\nexport interface AvakioChartAxis {\r\n  /** Axis title */\r\n  title?: string;\r\n  /** Minimum value */\r\n  min?: number;\r\n  /** Maximum value */\r\n  max?: number;\r\n  /** Step between ticks */\r\n  step?: number;\r\n  /** Format function for labels */\r\n  format?: (value: number | string) => string;\r\n  /** Show grid lines */\r\n  showGrid?: boolean;\r\n  /** Show axis line */\r\n  showLine?: boolean;\r\n  /** Show tick marks */\r\n  showTicks?: boolean;\r\n  /** Rotation angle for labels */\r\n  labelRotation?: number;\r\n}\r\n\r\nexport interface AvakioChartLegend {\r\n  /** Show legend */\r\n  show?: boolean;\r\n  /** Legend position */\r\n  position?: 'top' | 'bottom' | 'left' | 'right';\r\n  /** Legend alignment */\r\n  align?: 'start' | 'center' | 'end';\r\n  /** Allow clicking to toggle series */\r\n  toggle?: boolean;\r\n}\r\n\r\nexport interface AvakioChartTooltip {\r\n  /** Show tooltip */\r\n  show?: boolean;\r\n  /** Tooltip format function */\r\n  format?: (point: AvakioChartDataPoint, series: AvakioChartSeries) => string;\r\n  /** Share tooltip across series */\r\n  shared?: boolean;\r\n}\r\n\r\nexport interface AvakioChartPadding {\r\n  top?: number;\r\n  right?: number;\r\n  bottom?: number;\r\n  left?: number;\r\n}\r\n\r\nexport interface AvakioChartProps {\r\n  /** Unique identifier */\r\n  id?: string;\r\n  /** Test ID for testing */\r\n  testId?: string;\r\n  /** Chart type */\r\n  type?: AvakioChartType;\r\n  /** Chart data series */\r\n  series: AvakioChartSeries[];\r\n  /** X-axis configuration */\r\n  xAxis?: AvakioChartAxis;\r\n  /** Y-axis configuration */\r\n  yAxis?: AvakioChartAxis;\r\n  /** Legend configuration */\r\n  legend?: AvakioChartLegend;\r\n  /** Tooltip configuration */\r\n  tooltip?: AvakioChartTooltip;\r\n  /** Chart title */\r\n  title?: string;\r\n  /** Chart subtitle */\r\n  subtitle?: string;\r\n  /** Color palette */\r\n  colors?: string[];\r\n  /** Theme */\r\n  theme?: AvakioChartTheme;\r\n  /** Width */\r\n  width?: number | string;\r\n  /** Height */\r\n  height?: number | string;\r\n  /** Padding */\r\n  padding?: AvakioChartPadding;\r\n  /** Enable animation */\r\n  animate?: boolean;\r\n  /** Animation duration in ms */\r\n  animateDuration?: number;\r\n  /** Show gradient fills */\r\n  gradient?: boolean | 'horizontal' | 'vertical' | 'falling' | 'rising';\r\n  /** Bar width (for bar charts) */\r\n  barWidth?: number;\r\n  /** Bar offset between groups */\r\n  barOffset?: number;\r\n  /** Border radius for bars */\r\n  borderRadius?: number;\r\n  /** Inner radius for donut chart (0-1) */\r\n  donutInnerRadius?: number;\r\n  /** Start angle for pie/donut (degrees) */\r\n  pieStartAngle?: number;\r\n  /** Show pie labels */\r\n  pieLabels?: boolean;\r\n  /** Inner text for donut */\r\n  donutInnerText?: string;\r\n  /** Stacked mode */\r\n  stacked?: boolean;\r\n  /** CSS class */\r\n  className?: string;\r\n  /** Inline styles */\r\n  style?: React.CSSProperties;\r\n  /** Callback when data point is clicked */\r\n  onClick?: (point: AvakioChartDataPoint, series: AvakioChartSeries, index: number) => void;\r\n  /** Callback when data point is hovered */\r\n  onHover?: (point: AvakioChartDataPoint | null, series: AvakioChartSeries | null, index: number | null) => void;\r\n  /** Callback when legend item is clicked */\r\n  onLegendClick?: (series: AvakioChartSeries, visible: boolean) => void;\r\n}\r\n\r\nexport interface AvakioChartRef {\r\n  /** Get chart container */\r\n  getNode: () => HTMLDivElement | null;\r\n  /** Show a series */\r\n  showSeries: (id: string) => void;\r\n  /** Hide a series */\r\n  hideSeries: (id: string) => void;\r\n  /** Toggle series visibility */\r\n  toggleSeries: (id: string) => void;\r\n  /** Get visible series IDs */\r\n  getVisibleSeries: () => string[];\r\n  /** Export chart as base64 image */\r\n  exportImage: (format?: 'png' | 'jpeg') => Promise<string>;\r\n  /** Refresh chart */\r\n  refresh: () => void;\r\n}\r\n\r\n// Default colors palette\r\nconst DEFAULT_COLORS = [\r\n  '#4285F4', // Blue\r\n  '#EA4335', // Red\r\n  '#FBBC05', // Yellow\r\n  '#34A853', // Green\r\n  '#8E24AA', // Purple\r\n  '#00ACC1', // Cyan\r\n  '#FF7043', // Orange\r\n  '#5C6BC0', // Indigo\r\n  '#26A69A', // Teal\r\n  '#D81B60', // Pink\r\n];\r\n\r\n// Helper to calculate nice axis bounds\r\nfunction calculateAxisBounds(data: number[], step?: number): { min: number; max: number; step: number; ticks: number[] } {\r\n  const dataMin = Math.min(...data);\r\n  const dataMax = Math.max(...data);\r\n  const range = dataMax - dataMin || 1;\r\n  \r\n  // Calculate a nice step\r\n  const magnitude = Math.pow(10, Math.floor(Math.log10(range)));\r\n  const residual = range / magnitude;\r\n  \r\n  let niceStep: number;\r\n  if (residual <= 1.5) niceStep = magnitude * 0.2;\r\n  else if (residual <= 3) niceStep = magnitude * 0.5;\r\n  else if (residual <= 7) niceStep = magnitude;\r\n  else niceStep = magnitude * 2;\r\n  \r\n  if (step) niceStep = step;\r\n  \r\n  const min = Math.floor(dataMin / niceStep) * niceStep;\r\n  const max = Math.ceil(dataMax / niceStep) * niceStep;\r\n  \r\n  const ticks: number[] = [];\r\n  for (let tick = min; tick <= max; tick += niceStep) {\r\n    ticks.push(Math.round(tick * 1000) / 1000);\r\n  }\r\n  \r\n  return { min, max, step: niceStep, ticks };\r\n}\r\n\r\n// Generate spline path using Catmull-Rom\r\nfunction createSplinePath(points: { x: number; y: number }[]): string {\r\n  if (points.length < 2) return '';\r\n  if (points.length === 2) {\r\n    return `M ${points[0].x} ${points[0].y} L ${points[1].x} ${points[1].y}`;\r\n  }\r\n  \r\n  const tension = 0.3;\r\n  let path = `M ${points[0].x} ${points[0].y}`;\r\n  \r\n  for (let i = 0; i < points.length - 1; i++) {\r\n    const p0 = points[Math.max(0, i - 1)];\r\n    const p1 = points[i];\r\n    const p2 = points[i + 1];\r\n    const p3 = points[Math.min(points.length - 1, i + 2)];\r\n    \r\n    const cp1x = p1.x + (p2.x - p0.x) * tension;\r\n    const cp1y = p1.y + (p2.y - p0.y) * tension;\r\n    const cp2x = p2.x - (p3.x - p1.x) * tension;\r\n    const cp2y = p2.y - (p3.y - p1.y) * tension;\r\n    \r\n    path += ` C ${cp1x} ${cp1y}, ${cp2x} ${cp2y}, ${p2.x} ${p2.y}`;\r\n  }\r\n  \r\n  return path;\r\n}\r\n\r\n// Create pie/donut arc path\r\nfunction describeArc(cx: number, cy: number, r: number, startAngle: number, endAngle: number): string {\r\n  const start = {\r\n    x: cx + r * Math.cos((startAngle - 90) * Math.PI / 180),\r\n    y: cy + r * Math.sin((startAngle - 90) * Math.PI / 180),\r\n  };\r\n  const end = {\r\n    x: cx + r * Math.cos((endAngle - 90) * Math.PI / 180),\r\n    y: cy + r * Math.sin((endAngle - 90) * Math.PI / 180),\r\n  };\r\n  const largeArcFlag = endAngle - startAngle <= 180 ? 0 : 1;\r\n  \r\n  return `M ${start.x} ${start.y} A ${r} ${r} 0 ${largeArcFlag} 1 ${end.x} ${end.y}`;\r\n}\r\n\r\nfunction describePieSlice(cx: number, cy: number, r: number, innerR: number, startAngle: number, endAngle: number): string {\r\n  const startOuter = {\r\n    x: cx + r * Math.cos((startAngle - 90) * Math.PI / 180),\r\n    y: cy + r * Math.sin((startAngle - 90) * Math.PI / 180),\r\n  };\r\n  const endOuter = {\r\n    x: cx + r * Math.cos((endAngle - 90) * Math.PI / 180),\r\n    y: cy + r * Math.sin((endAngle - 90) * Math.PI / 180),\r\n  };\r\n  const startInner = {\r\n    x: cx + innerR * Math.cos((endAngle - 90) * Math.PI / 180),\r\n    y: cy + innerR * Math.sin((endAngle - 90) * Math.PI / 180),\r\n  };\r\n  const endInner = {\r\n    x: cx + innerR * Math.cos((startAngle - 90) * Math.PI / 180),\r\n    y: cy + innerR * Math.sin((startAngle - 90) * Math.PI / 180),\r\n  };\r\n  \r\n  const largeArcFlag = endAngle - startAngle <= 180 ? 0 : 1;\r\n  \r\n  if (innerR === 0) {\r\n    return `M ${cx} ${cy} L ${startOuter.x} ${startOuter.y} A ${r} ${r} 0 ${largeArcFlag} 1 ${endOuter.x} ${endOuter.y} Z`;\r\n  }\r\n  \r\n  return `M ${startOuter.x} ${startOuter.y} A ${r} ${r} 0 ${largeArcFlag} 1 ${endOuter.x} ${endOuter.y} L ${startInner.x} ${startInner.y} A ${innerR} ${innerR} 0 ${largeArcFlag} 0 ${endInner.x} ${endInner.y} Z`;\r\n}\r\n\r\nexport const AvakioChart = forwardRef<AvakioChartRef, AvakioChartProps>((props, ref) => {\r\n  const {\r\n    id,\r\n    testId,\r\n    type = 'line',\r\n    series,\r\n    xAxis = {},\r\n    yAxis = {},\r\n    legend = { show: true, position: 'bottom', toggle: true },\r\n    tooltip = { show: true },\r\n    title,\r\n    subtitle,\r\n    colors = DEFAULT_COLORS,\r\n    theme = 'material',\r\n    width = '100%',\r\n    height = 400,\r\n    padding = { top: 40, right: 40, bottom: 60, left: 60 },\r\n    animate = true,\r\n    animateDuration = 500,\r\n    gradient = false,\r\n    barWidth = 24,\r\n    barOffset = 8,\r\n    borderRadius = 4,\r\n    donutInnerRadius = 0.5,\r\n    pieStartAngle = 0,\r\n    pieLabels = true,\r\n    donutInnerText,\r\n    stacked = false,\r\n    className,\r\n    style,\r\n    onClick,\r\n    onHover,\r\n    onLegendClick,\r\n  } = props;\r\n\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n  const svgRef = useRef<SVGSVGElement>(null);\r\n  const [dimensions, setDimensions] = useState({ width: 0, height: 0 });\r\n  const [hiddenSeries, setHiddenSeries] = useState<Set<string>>(new Set());\r\n  const [hoveredPoint, setHoveredPoint] = useState<{ seriesId: string; index: number } | null>(null);\r\n  const [tooltipData, setTooltipData] = useState<{ x: number; y: number; content: string } | null>(null);\r\n  const [animationProgress, setAnimationProgress] = useState(animate ? 0 : 1);\r\n\r\n  // Measure container\r\n  useEffect(() => {\r\n    const container = containerRef.current;\r\n    if (!container) return;\r\n\r\n    const observer = new ResizeObserver((entries) => {\r\n      const entry = entries[0];\r\n      if (entry) {\r\n        setDimensions({\r\n          width: Math.max(0, entry.contentRect.width),\r\n          height: Math.max(0, typeof height === 'number' ? height : entry.contentRect.height),\r\n        });\r\n      }\r\n    });\r\n\r\n    observer.observe(container);\r\n    return () => observer.disconnect();\r\n  }, [height]);\r\n\r\n  // Animation\r\n  useEffect(() => {\r\n    if (!animate) {\r\n      setAnimationProgress(1);\r\n      return;\r\n    }\r\n\r\n    setAnimationProgress(0);\r\n    const startTime = performance.now();\r\n    \r\n    const animateFrame = (currentTime: number) => {\r\n      const elapsed = currentTime - startTime;\r\n      const progress = Math.min(elapsed / animateDuration, 1);\r\n      setAnimationProgress(easeOutCubic(progress));\r\n      \r\n      if (progress < 1) {\r\n        requestAnimationFrame(animateFrame);\r\n      }\r\n    };\r\n\r\n    requestAnimationFrame(animateFrame);\r\n  }, [animate, animateDuration, series]);\r\n\r\n  const easeOutCubic = (t: number): number => 1 - Math.pow(1 - t, 3);\r\n\r\n  // Calculate chart area\r\n  const chartArea = useMemo(() => {\r\n    const pad = {\r\n      top: padding.top ?? 40,\r\n      right: padding.right ?? 40,\r\n      bottom: padding.bottom ?? 60,\r\n      left: padding.left ?? 60,\r\n    };\r\n\r\n    // Adjust for legend\r\n    if (legend.show) {\r\n      switch (legend.position) {\r\n        case 'top':\r\n          pad.top += 30;\r\n          break;\r\n        case 'bottom':\r\n          pad.bottom += 30;\r\n          break;\r\n        case 'left':\r\n          pad.left += 100;\r\n          break;\r\n        case 'right':\r\n          pad.right += 100;\r\n          break;\r\n      }\r\n    }\r\n\r\n    // Adjust for title\r\n    if (title) {\r\n      pad.top += 24;\r\n      if (subtitle) pad.top += 16;\r\n    }\r\n\r\n    return {\r\n      x: pad.left,\r\n      y: pad.top,\r\n      width: Math.max(0, dimensions.width - pad.left - pad.right),\r\n      height: Math.max(0, dimensions.height - pad.top - pad.bottom),\r\n    };\r\n  }, [dimensions, padding, legend, title, subtitle]);\r\n\r\n  // Get visible series\r\n  const visibleSeries = useMemo(() => {\r\n    return series.filter((s) => {\r\n      const seriesId = s.id || s.name;\r\n      return !hiddenSeries.has(seriesId);\r\n    });\r\n  }, [series, hiddenSeries]);\r\n\r\n  // Calculate scales\r\n  const scales = useMemo(() => {\r\n    const isPie = type === 'pie' || type === 'pie3D' || type === 'donut';\r\n    const isRadar = type === 'radar';\r\n    const isHorizontalBar = type === 'barH' || type === 'stackedBarH';\r\n\r\n    if (isPie || isRadar) {\r\n      return { xScale: null, yScale: null };\r\n    }\r\n\r\n    // Collect all data points\r\n    const allXValues: (string | number)[] = [];\r\n    const allYValues: number[] = [];\r\n\r\n    visibleSeries.forEach((s) => {\r\n      s.data.forEach((d) => {\r\n        if (d.x !== undefined) allXValues.push(d.x);\r\n        allYValues.push(d.y);\r\n      });\r\n    });\r\n\r\n    // Get unique x values (for categorical)\r\n    const uniqueXValues = Array.from(new Set(allXValues));\r\n    const isXNumeric = uniqueXValues.every((v) => typeof v === 'number');\r\n\r\n    // Y-axis bounds\r\n    const yBounds = calculateAxisBounds(\r\n      stacked ? calculateStackedMaxValues(visibleSeries) : allYValues,\r\n      yAxis.step\r\n    );\r\n\r\n    if (yAxis.min !== undefined) yBounds.min = yAxis.min;\r\n    if (yAxis.max !== undefined) yBounds.max = yAxis.max;\r\n\r\n    return {\r\n      xValues: uniqueXValues,\r\n      isXNumeric,\r\n      yBounds,\r\n      xScale: (value: string | number): number => {\r\n        if (isXNumeric) {\r\n          const numValue = value as number;\r\n          const min = Math.min(...(uniqueXValues as number[]));\r\n          const max = Math.max(...(uniqueXValues as number[]));\r\n          return chartArea.x + ((numValue - min) / (max - min || 1)) * chartArea.width;\r\n        }\r\n        const index = uniqueXValues.indexOf(value);\r\n        return chartArea.x + (index + 0.5) * (chartArea.width / uniqueXValues.length);\r\n      },\r\n      yScale: (value: number): number => {\r\n        const range = yBounds.max - yBounds.min || 1;\r\n        return chartArea.y + chartArea.height - ((value - yBounds.min) / range) * chartArea.height;\r\n      },\r\n    };\r\n  }, [visibleSeries, chartArea, type, xAxis, yAxis, stacked]);\r\n\r\n  // Helper for stacked values\r\n  function calculateStackedMaxValues(series: AvakioChartSeries[]): number[] {\r\n    const maxValues: number[] = [];\r\n    if (series.length === 0) return [0];\r\n    \r\n    const numPoints = series[0].data.length;\r\n    for (let i = 0; i < numPoints; i++) {\r\n      let sum = 0;\r\n      series.forEach((s) => {\r\n        if (s.data[i]) sum += s.data[i].y;\r\n      });\r\n      maxValues.push(sum);\r\n    }\r\n    return maxValues;\r\n  }\r\n\r\n  // Handle legend click\r\n  const handleLegendClick = (seriesItem: AvakioChartSeries) => {\r\n    if (!legend.toggle) return;\r\n    \r\n    const seriesId = seriesItem.id || seriesItem.name;\r\n    const newHidden = new Set(hiddenSeries);\r\n    \r\n    if (newHidden.has(seriesId)) {\r\n      newHidden.delete(seriesId);\r\n    } else {\r\n      newHidden.add(seriesId);\r\n    }\r\n    \r\n    setHiddenSeries(newHidden);\r\n    onLegendClick?.(seriesItem, !newHidden.has(seriesId));\r\n  };\r\n\r\n  // Handle point hover\r\n  const handlePointHover = (seriesItem: AvakioChartSeries | null, point: AvakioChartDataPoint | null, index: number | null, event: React.MouseEvent) => {\r\n    if (point && seriesItem && index !== null) {\r\n      const seriesId = seriesItem.id || seriesItem.name;\r\n      setHoveredPoint({ seriesId, index });\r\n      \r\n      if (tooltip.show) {\r\n        const content = tooltip.format \r\n          ? tooltip.format(point, seriesItem)\r\n          : `${seriesItem.name}: ${point.y}`;\r\n        \r\n        const rect = containerRef.current?.getBoundingClientRect();\r\n        if (rect) {\r\n          setTooltipData({\r\n            x: event.clientX - rect.left,\r\n            y: event.clientY - rect.top,\r\n            content,\r\n          });\r\n        }\r\n      }\r\n      \r\n      onHover?.(point, seriesItem, index);\r\n    } else {\r\n      setHoveredPoint(null);\r\n      setTooltipData(null);\r\n      onHover?.(null, null, null);\r\n    }\r\n  };\r\n\r\n  // Handle point click\r\n  const handlePointClick = (seriesItem: AvakioChartSeries, point: AvakioChartDataPoint, index: number) => {\r\n    onClick?.(point, seriesItem, index);\r\n  };\r\n\r\n  // Imperative handle\r\n  useImperativeHandle(ref, () => ({\r\n    getNode: () => containerRef.current,\r\n    showSeries: (seriesId: string) => {\r\n      setHiddenSeries((prev) => {\r\n        const next = new Set(prev);\r\n        next.delete(seriesId);\r\n        return next;\r\n      });\r\n    },\r\n    hideSeries: (seriesId: string) => {\r\n      setHiddenSeries((prev) => new Set(prev).add(seriesId));\r\n    },\r\n    toggleSeries: (seriesId: string) => {\r\n      setHiddenSeries((prev) => {\r\n        const next = new Set(prev);\r\n        if (next.has(seriesId)) {\r\n          next.delete(seriesId);\r\n        } else {\r\n          next.add(seriesId);\r\n        }\r\n        return next;\r\n      });\r\n    },\r\n    getVisibleSeries: () => {\r\n      return series\r\n        .filter((s) => !hiddenSeries.has(s.id || s.name))\r\n        .map((s) => s.id || s.name);\r\n    },\r\n    exportImage: async (format = 'png') => {\r\n      if (!svgRef.current) return '';\r\n      \r\n      const svgData = new XMLSerializer().serializeToString(svgRef.current);\r\n      const canvas = document.createElement('canvas');\r\n      canvas.width = dimensions.width;\r\n      canvas.height = dimensions.height;\r\n      const ctx = canvas.getContext('2d');\r\n      \r\n      return new Promise((resolve) => {\r\n        const img = new Image();\r\n        img.onload = () => {\r\n          ctx?.drawImage(img, 0, 0);\r\n          resolve(canvas.toDataURL(`image/${format}`));\r\n        };\r\n        img.src = 'data:image/svg+xml;base64,' + btoa(unescape(encodeURIComponent(svgData)));\r\n      });\r\n    },\r\n    refresh: () => {\r\n      setAnimationProgress(0);\r\n      setTimeout(() => setAnimationProgress(1), 10);\r\n    },\r\n  }), [series, hiddenSeries, dimensions]);\r\n\r\n  // Render functions\r\n  const renderTitle = () => {\r\n    if (!title) return null;\r\n    \r\n    return (\r\n      <g className=\"avakio-chart__title\">\r\n        <text\r\n          x={dimensions.width / 2}\r\n          y={24}\r\n          textAnchor=\"middle\"\r\n          className=\"avakio-chart__title-text\"\r\n        >\r\n          {title}\r\n        </text>\r\n        {subtitle && (\r\n          <text\r\n            x={dimensions.width / 2}\r\n            y={44}\r\n            textAnchor=\"middle\"\r\n            className=\"avakio-chart__subtitle-text\"\r\n          >\r\n            {subtitle}\r\n          </text>\r\n        )}\r\n      </g>\r\n    );\r\n  };\r\n\r\n  const renderAxis = () => {\r\n    if (type === 'pie' || type === 'pie3D' || type === 'donut' || type === 'radar') {\r\n      return null;\r\n    }\r\n\r\n    if (!scales.xValues || !scales.yBounds) return null;\r\n\r\n    const xAxisY = chartArea.y + chartArea.height;\r\n    const yAxisX = chartArea.x;\r\n\r\n    return (\r\n      <g className=\"avakio-chart__axes\">\r\n        {/* X Axis */}\r\n        {(xAxis.showLine !== false) && (\r\n          <line\r\n            x1={chartArea.x}\r\n            y1={xAxisY}\r\n            x2={chartArea.x + chartArea.width}\r\n            y2={xAxisY}\r\n            className=\"avakio-chart__axis-line\"\r\n          />\r\n        )}\r\n        \r\n        {/* X Axis Labels */}\r\n        {scales.xValues.map((value, i) => {\r\n          const x = scales.xScale!(value);\r\n          return (\r\n            <g key={`x-${i}`}>\r\n              {(xAxis.showTicks !== false) && (\r\n                <line\r\n                  x1={x}\r\n                  y1={xAxisY}\r\n                  x2={x}\r\n                  y2={xAxisY + 6}\r\n                  className=\"avakio-chart__tick\"\r\n                />\r\n              )}\r\n              <text\r\n                x={x}\r\n                y={xAxisY + 20}\r\n                textAnchor=\"middle\"\r\n                className=\"avakio-chart__axis-label\"\r\n                transform={xAxis.labelRotation ? `rotate(${xAxis.labelRotation}, ${x}, ${xAxisY + 20})` : undefined}\r\n              >\r\n                {xAxis.format ? xAxis.format(value) : String(value)}\r\n              </text>\r\n            </g>\r\n          );\r\n        })}\r\n        \r\n        {/* X Axis Title */}\r\n        {xAxis.title && (\r\n          <text\r\n            x={chartArea.x + chartArea.width / 2}\r\n            y={xAxisY + 45}\r\n            textAnchor=\"middle\"\r\n            className=\"avakio-chart__axis-title\"\r\n          >\r\n            {xAxis.title}\r\n          </text>\r\n        )}\r\n\r\n        {/* Y Axis */}\r\n        {(yAxis.showLine !== false) && (\r\n          <line\r\n            x1={yAxisX}\r\n            y1={chartArea.y}\r\n            x2={yAxisX}\r\n            y2={chartArea.y + chartArea.height}\r\n            className=\"avakio-chart__axis-line\"\r\n          />\r\n        )}\r\n        \r\n        {/* Y Axis Labels and Grid */}\r\n        {scales.yBounds.ticks.map((value, i) => {\r\n          const y = scales.yScale!(value);\r\n          return (\r\n            <g key={`y-${i}`}>\r\n              {(yAxis.showGrid !== false) && (\r\n                <line\r\n                  x1={chartArea.x}\r\n                  y1={y}\r\n                  x2={chartArea.x + chartArea.width}\r\n                  y2={y}\r\n                  className=\"avakio-chart__grid-line\"\r\n                />\r\n              )}\r\n              {(yAxis.showTicks !== false) && (\r\n                <line\r\n                  x1={yAxisX - 6}\r\n                  y1={y}\r\n                  x2={yAxisX}\r\n                  y2={y}\r\n                  className=\"avakio-chart__tick\"\r\n                />\r\n              )}\r\n              <text\r\n                x={yAxisX - 12}\r\n                y={y + 4}\r\n                textAnchor=\"end\"\r\n                className=\"avakio-chart__axis-label\"\r\n              >\r\n                {yAxis.format ? yAxis.format(value) : String(value)}\r\n              </text>\r\n            </g>\r\n          );\r\n        })}\r\n        \r\n        {/* Y Axis Title */}\r\n        {yAxis.title && (\r\n          <text\r\n            x={20}\r\n            y={chartArea.y + chartArea.height / 2}\r\n            textAnchor=\"middle\"\r\n            className=\"avakio-chart__axis-title\"\r\n            transform={`rotate(-90, 20, ${chartArea.y + chartArea.height / 2})`}\r\n          >\r\n            {yAxis.title}\r\n          </text>\r\n        )}\r\n      </g>\r\n    );\r\n  };\r\n\r\n  const renderLineChart = (isSpline: boolean = false, isArea: boolean = false) => {\r\n    if (!scales.xScale || !scales.yScale) return null;\r\n\r\n    return (\r\n      <g className=\"avakio-chart__series\">\r\n        {visibleSeries.map((s, seriesIdx) => {\r\n          const seriesId = s.id || s.name;\r\n          const color = s.color || colors[seriesIdx % colors.length];\r\n          const points = s.data.map((d) => ({\r\n            x: scales.xScale!(d.x ?? seriesIdx),\r\n            y: scales.yScale!(d.y * animationProgress),\r\n          }));\r\n\r\n          const linePath = isSpline\r\n            ? createSplinePath(points)\r\n            : `M ${points.map((p) => `${p.x} ${p.y}`).join(' L ')}`;\r\n\r\n          const areaPath = isArea\r\n            ? `${linePath} L ${points[points.length - 1]?.x ?? 0} ${chartArea.y + chartArea.height} L ${points[0]?.x ?? 0} ${chartArea.y + chartArea.height} Z`\r\n            : '';\r\n\r\n          return (\r\n            <g key={seriesId} className=\"avakio-chart__series-group\">\r\n              {/* Gradient definition */}\r\n              {gradient && isArea && (\r\n                <defs>\r\n                  <linearGradient id={`gradient-${seriesId}`} x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\">\r\n                    <stop offset=\"0%\" stopColor={color} stopOpacity=\"0.6\" />\r\n                    <stop offset=\"100%\" stopColor={color} stopOpacity=\"0.05\" />\r\n                  </linearGradient>\r\n                </defs>\r\n              )}\r\n              \r\n              {/* Area fill */}\r\n              {isArea && (\r\n                <path\r\n                  d={areaPath}\r\n                  fill={gradient ? `url(#gradient-${seriesId})` : color}\r\n                  fillOpacity={gradient ? 1 : s.fillOpacity ?? 0.2}\r\n                  className=\"avakio-chart__area\"\r\n                />\r\n              )}\r\n              \r\n              {/* Line */}\r\n              <path\r\n                d={linePath}\r\n                stroke={color}\r\n                strokeWidth={s.lineWidth ?? 2}\r\n                fill=\"none\"\r\n                className=\"avakio-chart__line\"\r\n              />\r\n              \r\n              {/* Data points */}\r\n              {(s.showMarkers !== false) && points.map((point, i) => (\r\n                <circle\r\n                  key={i}\r\n                  cx={point.x}\r\n                  cy={point.y}\r\n                  r={hoveredPoint?.seriesId === seriesId && hoveredPoint?.index === i \r\n                    ? (s.markerSize ?? 4) + 2 \r\n                    : s.markerSize ?? 4}\r\n                  fill={color}\r\n                  stroke=\"#fff\"\r\n                  strokeWidth={2}\r\n                  className=\"avakio-chart__marker\"\r\n                  onMouseEnter={(e) => handlePointHover(s, s.data[i], i, e)}\r\n                  onMouseLeave={() => handlePointHover(null, null, null, {} as React.MouseEvent)}\r\n                  onClick={() => handlePointClick(s, s.data[i], i)}\r\n                  style={{ cursor: onClick ? 'pointer' : 'default' }}\r\n                />\r\n              ))}\r\n              \r\n              {/* Labels */}\r\n              {s.showLabels && points.map((point, i) => (\r\n                <text\r\n                  key={`label-${i}`}\r\n                  x={point.x}\r\n                  y={point.y - 10}\r\n                  textAnchor=\"middle\"\r\n                  className=\"avakio-chart__data-label\"\r\n                >\r\n                  {s.data[i].y}\r\n                </text>\r\n              ))}\r\n            </g>\r\n          );\r\n        })}\r\n      </g>\r\n    );\r\n  };\r\n\r\n  const renderBarChart = (horizontal: boolean = false) => {\r\n    if (!scales.xScale || !scales.yScale || !scales.xValues) return null;\r\n\r\n    const numSeries = visibleSeries.length;\r\n    const groupWidth = chartArea.width / Math.max(1, scales.xValues.length);\r\n    const effectiveBarWidth = Math.max(1, Math.min(barWidth, (groupWidth - barOffset * 2) / Math.max(1, numSeries)));\r\n    const totalBarWidth = effectiveBarWidth * numSeries;\r\n    const groupOffset = Math.max(0, (groupWidth - totalBarWidth) / 2);\r\n\r\n    return (\r\n      <g className=\"avakio-chart__series\">\r\n        {scales.xValues.map((xVal, xIdx) => {\r\n          const groupX = chartArea.x + xIdx * groupWidth;\r\n          \r\n          let stackedY = chartArea.y + chartArea.height;\r\n          \r\n          return (\r\n            <g key={`group-${xIdx}`} className=\"avakio-chart__bar-group\">\r\n              {visibleSeries.map((s, seriesIdx) => {\r\n                const seriesId = s.id || s.name;\r\n                const color = s.color || colors[seriesIdx % colors.length];\r\n                const dataPoint = s.data.find((d) => d.x === xVal) || s.data[xIdx];\r\n                \r\n                if (!dataPoint) return null;\r\n\r\n                const value = dataPoint.y * animationProgress;\r\n                const yRange = Math.max(1, scales.yBounds.max - scales.yBounds.min);\r\n                const barHeight = Math.max(0, (value / yRange) * chartArea.height);\r\n                \r\n                let x: number, y: number, w: number, h: number;\r\n                \r\n                if (stacked) {\r\n                  x = groupX + groupOffset;\r\n                  h = barHeight;\r\n                  y = stackedY - h;\r\n                  w = Math.max(1, totalBarWidth);\r\n                  stackedY = y;\r\n                } else {\r\n                  x = groupX + groupOffset + seriesIdx * effectiveBarWidth;\r\n                  y = scales.yScale!(value);\r\n                  w = Math.max(1, effectiveBarWidth - 2);\r\n                  h = Math.max(0, chartArea.y + chartArea.height - y);\r\n                }\r\n\r\n                const isHovered = hoveredPoint?.seriesId === seriesId && hoveredPoint?.index === xIdx;\r\n\r\n                return (\r\n                  <g key={seriesId}>\r\n                    {/* Gradient definition */}\r\n                    {gradient && (\r\n                      <defs>\r\n                        <linearGradient id={`bar-gradient-${seriesId}-${xIdx}`} x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\">\r\n                          <stop offset=\"0%\" stopColor={color} stopOpacity=\"1\" />\r\n                          <stop offset=\"100%\" stopColor={color} stopOpacity=\"0.7\" />\r\n                        </linearGradient>\r\n                      </defs>\r\n                    )}\r\n                    <rect\r\n                      x={x}\r\n                      y={y}\r\n                      width={w}\r\n                      height={Math.max(0, h)}\r\n                      rx={borderRadius}\r\n                      fill={gradient ? `url(#bar-gradient-${seriesId}-${xIdx})` : color}\r\n                      className={`avakio-chart__bar ${isHovered ? 'avakio-chart__bar--hovered' : ''}`}\r\n                      onMouseEnter={(e) => handlePointHover(s, dataPoint, xIdx, e)}\r\n                      onMouseLeave={() => handlePointHover(null, null, null, {} as React.MouseEvent)}\r\n                      onClick={() => handlePointClick(s, dataPoint, xIdx)}\r\n                      style={{ cursor: onClick ? 'pointer' : 'default' }}\r\n                    />\r\n                    {s.showLabels && (\r\n                      <text\r\n                        x={x + w / 2}\r\n                        y={y - 5}\r\n                        textAnchor=\"middle\"\r\n                        className=\"avakio-chart__data-label\"\r\n                      >\r\n                        {dataPoint.y}\r\n                      </text>\r\n                    )}\r\n                  </g>\r\n                );\r\n              })}\r\n            </g>\r\n          );\r\n        })}\r\n      </g>\r\n    );\r\n  };\r\n\r\n  const renderPieChart = (isDonut: boolean = false) => {\r\n    // Use first series for pie/donut\r\n    const seriesData = visibleSeries[0];\r\n    if (!seriesData) return null;\r\n\r\n    const cx = chartArea.x + chartArea.width / 2;\r\n    const cy = chartArea.y + chartArea.height / 2;\r\n    const radius = Math.min(chartArea.width, chartArea.height) / 2 - 20;\r\n    const innerRadius = isDonut ? radius * donutInnerRadius : 0;\r\n\r\n    const total = seriesData.data.reduce((sum, d) => sum + d.y, 0);\r\n    let currentAngle = pieStartAngle;\r\n\r\n    return (\r\n      <g className=\"avakio-chart__pie\">\r\n        {seriesData.data.map((d, i) => {\r\n          const sliceAngle = (d.y / total) * 360 * animationProgress;\r\n          const startAngle = currentAngle;\r\n          const endAngle = currentAngle + sliceAngle;\r\n          currentAngle = endAngle;\r\n\r\n          const color = d.color || colors[i % colors.length];\r\n          const midAngle = (startAngle + endAngle) / 2;\r\n          const isHovered = hoveredPoint?.seriesId === (seriesData.id || seriesData.name) && hoveredPoint?.index === i;\r\n          \r\n          // Calculate label position\r\n          const labelRadius = radius + 25;\r\n          const labelX = cx + labelRadius * Math.cos((midAngle - 90) * Math.PI / 180);\r\n          const labelY = cy + labelRadius * Math.sin((midAngle - 90) * Math.PI / 180);\r\n\r\n          // Hover offset\r\n          const offsetDistance = isHovered ? 8 : 0;\r\n          const offsetX = offsetDistance * Math.cos((midAngle - 90) * Math.PI / 180);\r\n          const offsetY = offsetDistance * Math.sin((midAngle - 90) * Math.PI / 180);\r\n\r\n          return (\r\n            <g key={i} transform={`translate(${offsetX}, ${offsetY})`}>\r\n              {/* Gradient definition */}\r\n              {gradient && (\r\n                <defs>\r\n                  <radialGradient id={`pie-gradient-${i}`} cx=\"30%\" cy=\"30%\">\r\n                    <stop offset=\"0%\" stopColor={color} stopOpacity=\"1\" />\r\n                    <stop offset=\"100%\" stopColor={color} stopOpacity=\"0.8\" />\r\n                  </radialGradient>\r\n                </defs>\r\n              )}\r\n              <path\r\n                d={describePieSlice(cx, cy, radius, innerRadius, startAngle, endAngle)}\r\n                fill={gradient ? `url(#pie-gradient-${i})` : color}\r\n                stroke=\"#fff\"\r\n                strokeWidth={2}\r\n                className={`avakio-chart__pie-slice ${isHovered ? 'avakio-chart__pie-slice--hovered' : ''}`}\r\n                onMouseEnter={(e) => handlePointHover(seriesData, d, i, e)}\r\n                onMouseLeave={() => handlePointHover(null, null, null, {} as React.MouseEvent)}\r\n                onClick={() => handlePointClick(seriesData, d, i)}\r\n                style={{ cursor: onClick ? 'pointer' : 'default' }}\r\n              />\r\n              {pieLabels && sliceAngle > 15 && (\r\n                <text\r\n                  x={labelX}\r\n                  y={labelY}\r\n                  textAnchor={labelX > cx ? 'start' : 'end'}\r\n                  className=\"avakio-chart__pie-label\"\r\n                >\r\n                  {d.label || d.x || ''} ({((d.y / total) * 100).toFixed(1)}%)\r\n                </text>\r\n              )}\r\n            </g>\r\n          );\r\n        })}\r\n        \r\n        {/* Donut inner text */}\r\n        {isDonut && donutInnerText && (\r\n          <text\r\n            x={cx}\r\n            y={cy}\r\n            textAnchor=\"middle\"\r\n            dominantBaseline=\"middle\"\r\n            className=\"avakio-chart__donut-text\"\r\n          >\r\n            {donutInnerText}\r\n          </text>\r\n        )}\r\n      </g>\r\n    );\r\n  };\r\n\r\n  const renderScatterChart = () => {\r\n    if (!scales.xScale || !scales.yScale) return null;\r\n\r\n    return (\r\n      <g className=\"avakio-chart__series\">\r\n        {visibleSeries.map((s, seriesIdx) => {\r\n          const seriesId = s.id || s.name;\r\n          const color = s.color || colors[seriesIdx % colors.length];\r\n\r\n          return (\r\n            <g key={seriesId} className=\"avakio-chart__scatter-group\">\r\n              {s.data.map((d, i) => {\r\n                const x = scales.xScale!(d.x ?? i);\r\n                const y = scales.yScale!(d.y * animationProgress);\r\n                const isHovered = hoveredPoint?.seriesId === seriesId && hoveredPoint?.index === i;\r\n\r\n                return (\r\n                  <circle\r\n                    key={i}\r\n                    cx={x}\r\n                    cy={y}\r\n                    r={isHovered ? (s.markerSize ?? 6) + 2 : s.markerSize ?? 6}\r\n                    fill={d.color || color}\r\n                    fillOpacity={0.7}\r\n                    stroke={d.color || color}\r\n                    strokeWidth={2}\r\n                    className=\"avakio-chart__scatter-point\"\r\n                    onMouseEnter={(e) => handlePointHover(s, d, i, e)}\r\n                    onMouseLeave={() => handlePointHover(null, null, null, {} as React.MouseEvent)}\r\n                    onClick={() => handlePointClick(s, d, i)}\r\n                    style={{ cursor: onClick ? 'pointer' : 'default' }}\r\n                  />\r\n                );\r\n              })}\r\n            </g>\r\n          );\r\n        })}\r\n      </g>\r\n    );\r\n  };\r\n\r\n  const renderRadarChart = () => {\r\n    // Use first series to get categories from x values\r\n    if (visibleSeries.length === 0) return null;\r\n    \r\n    const categories = visibleSeries[0].data.map((d) => String(d.label || d.x || ''));\r\n    const numCategories = categories.length;\r\n    const angleStep = (Math.PI * 2) / numCategories;\r\n    \r\n    const cx = chartArea.x + chartArea.width / 2;\r\n    const cy = chartArea.y + chartArea.height / 2;\r\n    const radius = Math.min(chartArea.width, chartArea.height) / 2 - 40;\r\n    \r\n    // Calculate max value for scaling\r\n    const maxValue = Math.max(...visibleSeries.flatMap((s) => s.data.map((d) => d.y)));\r\n    const numLevels = 5;\r\n\r\n    return (\r\n      <g className=\"avakio-chart__radar\">\r\n        {/* Background levels */}\r\n        {Array.from({ length: numLevels }).map((_, levelIdx) => {\r\n          const levelRadius = (radius * (levelIdx + 1)) / numLevels;\r\n          const points = Array.from({ length: numCategories }).map((_, i) => {\r\n            const angle = i * angleStep - Math.PI / 2;\r\n            return {\r\n              x: cx + levelRadius * Math.cos(angle),\r\n              y: cy + levelRadius * Math.sin(angle),\r\n            };\r\n          });\r\n          \r\n          return (\r\n            <polygon\r\n              key={levelIdx}\r\n              points={points.map((p) => `${p.x},${p.y}`).join(' ')}\r\n              fill=\"none\"\r\n              stroke=\"currentColor\"\r\n              strokeOpacity={0.2}\r\n              className=\"avakio-chart__radar-level\"\r\n            />\r\n          );\r\n        })}\r\n        \r\n        {/* Axis lines */}\r\n        {categories.map((_, i) => {\r\n          const angle = i * angleStep - Math.PI / 2;\r\n          const x = cx + radius * Math.cos(angle);\r\n          const y = cy + radius * Math.sin(angle);\r\n          \r\n          return (\r\n            <line\r\n              key={i}\r\n              x1={cx}\r\n              y1={cy}\r\n              x2={x}\r\n              y2={y}\r\n              stroke=\"currentColor\"\r\n              strokeOpacity={0.2}\r\n              className=\"avakio-chart__radar-axis\"\r\n            />\r\n          );\r\n        })}\r\n        \r\n        {/* Category labels */}\r\n        {categories.map((cat, i) => {\r\n          const angle = i * angleStep - Math.PI / 2;\r\n          const x = cx + (radius + 20) * Math.cos(angle);\r\n          const y = cy + (radius + 20) * Math.sin(angle);\r\n          \r\n          return (\r\n            <text\r\n              key={i}\r\n              x={x}\r\n              y={y}\r\n              textAnchor=\"middle\"\r\n              dominantBaseline=\"middle\"\r\n              className=\"avakio-chart__radar-label\"\r\n            >\r\n              {cat}\r\n            </text>\r\n          );\r\n        })}\r\n        \r\n        {/* Data polygons */}\r\n        {visibleSeries.map((s, seriesIdx) => {\r\n          const seriesId = s.id || s.name;\r\n          const color = s.color || colors[seriesIdx % colors.length];\r\n          \r\n          const points = s.data.map((d, i) => {\r\n            const angle = i * angleStep - Math.PI / 2;\r\n            const r = (d.y / maxValue) * radius * animationProgress;\r\n            return {\r\n              x: cx + r * Math.cos(angle),\r\n              y: cy + r * Math.sin(angle),\r\n            };\r\n          });\r\n          \r\n          return (\r\n            <g key={seriesId}>\r\n              <polygon\r\n                points={points.map((p) => `${p.x},${p.y}`).join(' ')}\r\n                fill={color}\r\n                fillOpacity={0.2}\r\n                stroke={color}\r\n                strokeWidth={2}\r\n                className=\"avakio-chart__radar-polygon\"\r\n              />\r\n              {points.map((point, i) => (\r\n                <circle\r\n                  key={i}\r\n                  cx={point.x}\r\n                  cy={point.y}\r\n                  r={s.markerSize ?? 4}\r\n                  fill={color}\r\n                  stroke=\"#fff\"\r\n                  strokeWidth={2}\r\n                  className=\"avakio-chart__radar-point\"\r\n                  onMouseEnter={(e) => handlePointHover(s, s.data[i], i, e)}\r\n                  onMouseLeave={() => handlePointHover(null, null, null, {} as React.MouseEvent)}\r\n                  onClick={() => handlePointClick(s, s.data[i], i)}\r\n                  style={{ cursor: onClick ? 'pointer' : 'default' }}\r\n                />\r\n              ))}\r\n            </g>\r\n          );\r\n        })}\r\n      </g>\r\n    );\r\n  };\r\n\r\n  const renderLegend = () => {\r\n    if (!legend.show) return null;\r\n\r\n    const isVertical = legend.position === 'left' || legend.position === 'right';\r\n    \r\n    let x: number, y: number;\r\n    switch (legend.position) {\r\n      case 'top':\r\n        x = dimensions.width / 2;\r\n        y = title ? 60 : 20;\r\n        break;\r\n      case 'bottom':\r\n        x = dimensions.width / 2;\r\n        y = dimensions.height - 15;\r\n        break;\r\n      case 'left':\r\n        x = 20;\r\n        y = chartArea.y + 20;\r\n        break;\r\n      case 'right':\r\n        x = dimensions.width - 100;\r\n        y = chartArea.y + 20;\r\n        break;\r\n      default:\r\n        x = dimensions.width / 2;\r\n        y = dimensions.height - 15;\r\n    }\r\n\r\n    return (\r\n      <g \r\n        className=\"avakio-chart__legend\"\r\n        transform={`translate(${x}, ${y})`}\r\n      >\r\n        {series.map((s, i) => {\r\n          const seriesId = s.id || s.name;\r\n          const color = s.color || colors[i % colors.length];\r\n          const isHidden = hiddenSeries.has(seriesId);\r\n          \r\n          const itemX = isVertical ? 0 : (i - series.length / 2) * 100;\r\n          const itemY = isVertical ? i * 24 : 0;\r\n          \r\n          return (\r\n            <g\r\n              key={seriesId}\r\n              className={`avakio-chart__legend-item ${isHidden ? 'avakio-chart__legend-item--hidden' : ''}`}\r\n              transform={`translate(${itemX}, ${itemY})`}\r\n              onClick={() => handleLegendClick(s)}\r\n              style={{ cursor: legend.toggle ? 'pointer' : 'default' }}\r\n            >\r\n              <rect\r\n                x={0}\r\n                y={-8}\r\n                width={12}\r\n                height={12}\r\n                rx={2}\r\n                fill={isHidden ? 'transparent' : color}\r\n                stroke={color}\r\n                strokeWidth={2}\r\n              />\r\n              <text\r\n                x={18}\r\n                y={0}\r\n                dominantBaseline=\"middle\"\r\n                className=\"avakio-chart__legend-text\"\r\n                style={{ opacity: isHidden ? 0.5 : 1 }}\r\n              >\r\n                {s.name}\r\n              </text>\r\n            </g>\r\n          );\r\n        })}\r\n      </g>\r\n    );\r\n  };\r\n\r\n  const renderTooltip = () => {\r\n    if (!tooltipData) return null;\r\n\r\n    return (\r\n      <div\r\n        className=\"avakio-chart__tooltip\"\r\n        style={{\r\n          left: tooltipData.x + 10,\r\n          top: tooltipData.y - 10,\r\n        }}\r\n      >\r\n        {tooltipData.content}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const renderChartContent = () => {\r\n    switch (type) {\r\n      case 'line':\r\n        return renderLineChart(false, false);\r\n      case 'spline':\r\n        return renderLineChart(true, false);\r\n      case 'area':\r\n        return renderLineChart(false, true);\r\n      case 'splineArea':\r\n        return renderLineChart(true, true);\r\n      case 'bar':\r\n      case 'stackedBar':\r\n        return renderBarChart(false);\r\n      case 'barH':\r\n      case 'stackedBarH':\r\n        return renderBarChart(true);\r\n      case 'pie':\r\n      case 'pie3D':\r\n        return renderPieChart(false);\r\n      case 'donut':\r\n        return renderPieChart(true);\r\n      case 'scatter':\r\n        return renderScatterChart();\r\n      case 'radar':\r\n        return renderRadarChart();\r\n      default:\r\n        return renderLineChart(false, false);\r\n    }\r\n  };\r\n\r\n  const containerStyle: React.CSSProperties = {\r\n    width,\r\n    height,\r\n    ...style,\r\n  };\r\n\r\n  return (\r\n    <div\r\n      ref={containerRef}\r\n      id={id}\r\n      data-testid={testId}\r\n      className={`avakio-chart avakio-chart--${theme} avakio-chart--${type} ${className || ''}`}\r\n      style={containerStyle}\r\n    >\r\n      <svg\r\n        ref={svgRef}\r\n        width={dimensions.width}\r\n        height={dimensions.height}\r\n        className=\"avakio-chart__svg\"\r\n      >\r\n        {renderTitle()}\r\n        {renderAxis()}\r\n        {renderChartContent()}\r\n        {renderLegend()}\r\n      </svg>\r\n      {renderTooltip()}\r\n    </div>\r\n  );\r\n});\r\n\r\nAvakioChart.displayName = 'AvakioChart';\r\n\r\nexport default AvakioChart;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, {\r\n  CSSProperties,\r\n  forwardRef,\r\n  useCallback,\r\n  useEffect,\r\n  useImperativeHandle,\r\n  useMemo,\r\n  useRef,\r\n  useState,\r\n} from 'react';\r\nimport { AvakioGrid, AvakioGridCell, AvakioGridRef } from '../../layouts/avakio-grid/avakio-grid';\r\nimport './avakio-dashboard.css';\r\n\r\nexport type AvakioDashboardTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\n\r\nexport interface AvakioDashboardWidget {\r\n  id: string;\r\n\r\n  x: number;\r\n  y: number;\r\n  dx?: number;\r\n  dy?: number;\r\n\r\n  header?: React.ReactNode;\r\n  icon?: React.ReactNode;\r\n  body?: React.ReactNode;\r\n\r\n  /** Whether this widget can be dragged (when `editable` is true) */\r\n  draggable?: boolean;\r\n  /** Whether this widget can be resized (when `editable` is true) */\r\n  resizable?: boolean;\r\n\r\n  minDx?: number;\r\n  minDy?: number;\r\n\r\n  /** Optional custom class for the widget panel */\r\n  className?: string;\r\n  /** Optional inline styles for the widget panel */\r\n  style?: React.CSSProperties;\r\n}\r\n\r\nexport interface AvakioDashboardLayoutItem {\r\n  id: string;\r\n  x: number;\r\n  y: number;\r\n  dx: number;\r\n  dy: number;\r\n}\r\n\r\nexport interface AvakioDashboardProps {\r\n  id?: string;\r\n  testId?: string;\r\n\r\n  /** Number of columns in the dashboard grid */\r\n  gridColumns?: number;\r\n  /** Number of rows in the dashboard grid */\r\n  gridRows?: number;\r\n\r\n  /** Fixed cell width in px (optional; auto-calculated if not set) */\r\n  cellWidth?: number;\r\n  /** Fixed cell height in px (optional; auto-calculated if not set) */\r\n  cellHeight?: number;\r\n\r\n  /** Margin (gap) between cells in px */\r\n  cellMargin?: number;\r\n\r\n  /** Outer margin around the dashboard container */\r\n  margin?: number;\r\n\r\n  /** Padding around the dashboard content */\r\n  padding?: number | [number, number, number, number];\r\n  paddingX?: number;\r\n  paddingY?: number;\r\n\r\n  width?: number | string;\r\n  height?: number | string;\r\n\r\n  theme?: AvakioDashboardTheme;\r\n\r\n  /** Widgets to render */\r\n  widgets: AvakioDashboardWidget[];\r\n\r\n  /** When true, enables drag and resize interactions */\r\n  editable?: boolean;\r\n\r\n  /** Drag handle behavior */\r\n  dragHandle?: 'any' | 'header';\r\n\r\n  className?: string;\r\n  style?: React.CSSProperties;\r\n\r\n  onChange?: (widgets: AvakioDashboardWidget[]) => void;\r\n  onWidgetClick?: (widget: AvakioDashboardWidget) => void;\r\n  onDragStart?: (widget: AvakioDashboardWidget) => void;\r\n  onDragEnd?: (widget: AvakioDashboardWidget, newPosition: { x: number; y: number }) => void;\r\n  onResizeStart?: (widget: AvakioDashboardWidget) => void;\r\n  onResizeEnd?: (widget: AvakioDashboardWidget, newSize: { dx: number; dy: number }) => void;\r\n}\r\n\r\nexport interface AvakioDashboardRef {\r\n  addWidget: (widget: AvakioDashboardWidget, index?: number) => void;\r\n  removeWidget: (id: string) => void;\r\n  moveWidget: (id: string, position: { x?: number; y?: number; dx?: number; dy?: number }) => void;\r\n  getWidgets: () => AvakioDashboardWidget[];\r\n  getWidget: (id: string) => AvakioDashboardWidget | undefined;\r\n  serialize: () => AvakioDashboardLayoutItem[];\r\n  restore: (layout: AvakioDashboardLayoutItem[]) => void;\r\n}\r\n\r\ntype ResizeState = {\r\n  widgetId: string;\r\n  startClientX: number;\r\n  startClientY: number;\r\n  startDx: number;\r\n  startDy: number;\r\n};\r\n\r\nfunction asBoxPadding(padding: number | [number, number, number, number] | undefined): [number, number, number, number] {\r\n  if (Array.isArray(padding)) return padding;\r\n  if (typeof padding === 'number') return [padding, padding, padding, padding];\r\n  return [0, 0, 0, 0];\r\n}\r\n\r\nfunction intersects(a: { x: number; y: number; dx: number; dy: number }, b: { x: number; y: number; dx: number; dy: number }): boolean {\r\n  return a.x < b.x + b.dx && a.x + a.dx > b.x && a.y < b.y + b.dy && a.y + a.dy > b.y;\r\n}\r\n\r\nexport const AvakioDashboard = forwardRef<AvakioDashboardRef, AvakioDashboardProps>(\r\n  (\r\n    {\r\n      id,\r\n      testId,\r\n      gridColumns = 2,\r\n      gridRows = 2,\r\n      cellWidth,\r\n      cellHeight,\r\n      cellMargin = 10,\r\n      margin,\r\n      padding = 10,\r\n      paddingX,\r\n      paddingY,\r\n      width,\r\n      height,\r\n      theme = 'material',\r\n      widgets: widgetsProp,\r\n      editable = true,\r\n      dragHandle = 'any',\r\n      className = '',\r\n      style,\r\n      onChange,\r\n      onWidgetClick,\r\n      onDragStart,\r\n      onDragEnd,\r\n      onResizeStart,\r\n      onResizeEnd,\r\n    },\r\n    ref\r\n  ) => {\r\n    const gridRef = useRef<AvakioGridRef>(null);\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n\r\n    const [widgets, setWidgets] = useState<AvakioDashboardWidget[]>(widgetsProp);\r\n    const widgetsRef = useRef<AvakioDashboardWidget[]>(widgetsProp);\r\n\r\n    // Resize measuring (for dx/dy updates during interactive resize)\r\n    const [containerSize, setContainerSize] = useState({ width: 0, height: 0 });\r\n    const resizeStateRef = useRef<ResizeState | null>(null);\r\n\r\n    // Keep in sync with prop\r\n    useEffect(() => {\r\n      setWidgets(widgetsProp);\r\n    }, [widgetsProp]);\r\n\r\n    useEffect(() => {\r\n      widgetsRef.current = widgets;\r\n    }, [widgets]);\r\n\r\n    // Observe container size\r\n    useEffect(() => {\r\n      const el = containerRef.current;\r\n      if (!el) return;\r\n\r\n      const update = () => {\r\n        setContainerSize({ width: el.clientWidth, height: el.clientHeight });\r\n      };\r\n      update();\r\n\r\n      let rafId: number | null = null;\r\n      const ro = new ResizeObserver(() => {\r\n        if (rafId !== null) return;\r\n        rafId = requestAnimationFrame(() => {\r\n          rafId = null;\r\n          update();\r\n        });\r\n      });\r\n\r\n      ro.observe(el);\r\n      return () => {\r\n        ro.disconnect();\r\n        if (rafId !== null) cancelAnimationFrame(rafId);\r\n      };\r\n    }, []);\r\n\r\n    const resolvedUnitWidth = useMemo(() => {\r\n      if (cellWidth) return cellWidth;\r\n      const base = asBoxPadding(padding);\r\n      const px = paddingX !== undefined ? paddingX : base[1];\r\n      const availableWidth = containerSize.width - px * 2 - cellMargin * (gridColumns - 1);\r\n      return Math.max(50, availableWidth / Math.max(1, gridColumns));\r\n    }, [cellWidth, containerSize.width, padding, paddingX, cellMargin, gridColumns]);\r\n\r\n    const resolvedUnitHeight = useMemo(() => {\r\n      if (cellHeight) return cellHeight;\r\n      const base = asBoxPadding(padding);\r\n      const py = paddingY !== undefined ? paddingY : base[0];\r\n      const availableHeight = containerSize.height - py * 2 - cellMargin * (gridRows - 1);\r\n      return Math.max(50, availableHeight / Math.max(1, gridRows));\r\n    }, [cellHeight, containerSize.height, padding, paddingY, cellMargin, gridRows]);\r\n\r\n    const updateWidgets = useCallback(\r\n      (\r\n        nextOrUpdater:\r\n          | AvakioDashboardWidget[]\r\n          | ((prev: AvakioDashboardWidget[]) => AvakioDashboardWidget[])\r\n      ) => {\r\n        setWidgets((prev) => {\r\n          const next = typeof nextOrUpdater === 'function' ? nextOrUpdater(prev) : nextOrUpdater;\r\n          onChange?.(next);\r\n          return next;\r\n        });\r\n      },\r\n      [onChange]\r\n    );\r\n\r\n    const getWidgetById = useCallback(\r\n      (wid: string) => widgetsRef.current.find((w) => w.id === wid),\r\n      []\r\n    );\r\n\r\n    const canPlaceRect = useCallback(\r\n      (rect: { id?: string; x: number; y: number; dx: number; dy: number }) => {\r\n        if (rect.x < 0 || rect.y < 0) return false;\r\n        if (rect.x + rect.dx > gridColumns) return false;\r\n        if (rect.y + rect.dy > gridRows) return false;\r\n\r\n        for (const w of widgetsRef.current) {\r\n          if (rect.id && w.id === rect.id) continue;\r\n          const other = { x: w.x, y: w.y, dx: w.dx ?? 1, dy: w.dy ?? 1 };\r\n          if (intersects({ x: rect.x, y: rect.y, dx: rect.dx, dy: rect.dy }, other)) return false;\r\n        }\r\n        return true;\r\n      },\r\n      [gridColumns, gridRows]\r\n    );\r\n\r\n    const findFirstFreeSpot = useCallback(\r\n      (dx: number, dy: number) => {\r\n        for (let y = 0; y <= gridRows - dy; y++) {\r\n          for (let x = 0; x <= gridColumns - dx; x++) {\r\n            if (canPlaceRect({ x, y, dx, dy })) {\r\n              return { x, y };\r\n            }\r\n          }\r\n        }\r\n        return null;\r\n      },\r\n      [gridRows, gridColumns, canPlaceRect]\r\n    );\r\n\r\n    useImperativeHandle(\r\n      ref,\r\n      () => ({\r\n        addWidget: (widget, index) => {\r\n          const dx = widget.dx ?? 1;\r\n          const dy = widget.dy ?? 1;\r\n          const spot = findFirstFreeSpot(dx, dy);\r\n          const placed = spot ? { ...widget, x: spot.x, y: spot.y, dx, dy } : { ...widget, dx, dy };\r\n\r\n          updateWidgets((prev) => {\r\n            const next = [...prev];\r\n            if (typeof index === 'number') next.splice(index, 0, placed);\r\n            else next.push(placed);\r\n            return next;\r\n          });\r\n        },\r\n        removeWidget: (wid) => {\r\n          updateWidgets((prev) => prev.filter((w) => w.id !== wid));\r\n        },\r\n        moveWidget: (wid, position) => {\r\n          const current = getWidgetById(wid);\r\n          if (!current) return;\r\n\r\n          const nextRect = {\r\n            id: wid,\r\n            x: position.x ?? current.x,\r\n            y: position.y ?? current.y,\r\n            dx: position.dx ?? (current.dx ?? 1),\r\n            dy: position.dy ?? (current.dy ?? 1),\r\n          };\r\n\r\n          if (!canPlaceRect(nextRect)) return;\r\n\r\n          updateWidgets((prev) => prev.map((w) => (w.id === wid ? { ...w, ...position } : w)));\r\n        },\r\n        getWidgets: () => [...widgetsRef.current],\r\n        getWidget: (wid) => widgetsRef.current.find((w) => w.id === wid),\r\n        serialize: () =>\r\n          widgetsRef.current.map((w) => ({\r\n            id: w.id,\r\n            x: w.x,\r\n            y: w.y,\r\n            dx: w.dx ?? 1,\r\n            dy: w.dy ?? 1,\r\n          })),\r\n        restore: (layout) => {\r\n          const byId = new Map(layout.map((l) => [l.id, l] as const));\r\n          updateWidgets((prev) =>\r\n            prev.map((w) => {\r\n              const l = byId.get(w.id);\r\n              if (!l) return w;\r\n              return { ...w, x: l.x, y: l.y, dx: l.dx, dy: l.dy };\r\n            })\r\n          );\r\n        },\r\n      }),\r\n      [updateWidgets, getWidgetById, canPlaceRect, findFirstFreeSpot]\r\n    );\r\n\r\n    const handleGridChange = useCallback(\r\n      (cells: AvakioGridCell[]) => {\r\n        updateWidgets((prev) =>\r\n          prev.map((w) => {\r\n            const c = cells.find((x) => x.id === w.id);\r\n            if (!c) return w;\r\n            return { ...w, x: c.x, y: c.y, dx: c.dx ?? 1, dy: c.dy ?? 1 };\r\n          })\r\n        );\r\n      },\r\n      [updateWidgets]\r\n    );\r\n\r\n    const handleDragStartInternal = useCallback(\r\n      (cell: AvakioGridCell) => {\r\n        const w = getWidgetById(cell.id);\r\n        if (w) onDragStart?.(w);\r\n      },\r\n      [getWidgetById, onDragStart]\r\n    );\r\n\r\n    const handleDragEndInternal = useCallback(\r\n      (cell: AvakioGridCell, pos: { x: number; y: number }) => {\r\n        const w = getWidgetById(cell.id);\r\n        if (w) onDragEnd?.({ ...w, x: pos.x, y: pos.y }, pos);\r\n      },\r\n      [getWidgetById, onDragEnd]\r\n    );\r\n\r\n    const beginResize = useCallback(\r\n      (e: React.PointerEvent, widgetId: string) => {\r\n        if (!editable) return;\r\n\r\n        const w = getWidgetById(widgetId);\r\n        if (!w || w.resizable !== true) return;\r\n\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n\r\n        resizeStateRef.current = {\r\n          widgetId,\r\n          startClientX: e.clientX,\r\n          startClientY: e.clientY,\r\n          startDx: w.dx ?? 1,\r\n          startDy: w.dy ?? 1,\r\n        };\r\n\r\n        onResizeStart?.(w);\r\n\r\n        (e.currentTarget as HTMLElement).setPointerCapture?.(e.pointerId);\r\n      },\r\n      [editable, getWidgetById, onResizeStart]\r\n    );\r\n\r\n    const handlePointerMove = useCallback(\r\n      (e: React.PointerEvent) => {\r\n        const state = resizeStateRef.current;\r\n        if (!state) return;\r\n\r\n        const w = getWidgetById(state.widgetId);\r\n        if (!w) return;\r\n\r\n        const unitW = resolvedUnitWidth + cellMargin;\r\n        const unitH = resolvedUnitHeight + cellMargin;\r\n\r\n        const deltaX = e.clientX - state.startClientX;\r\n        const deltaY = e.clientY - state.startClientY;\r\n\r\n        const minDx = Math.max(1, w.minDx ?? 1);\r\n        const minDy = Math.max(1, w.minDy ?? 1);\r\n\r\n        const maxDx = Math.max(1, gridColumns - w.x);\r\n        const maxDy = Math.max(1, gridRows - w.y);\r\n\r\n        const nextDx = Math.max(minDx, Math.min(maxDx, state.startDx + Math.round(deltaX / unitW)));\r\n        const nextDy = Math.max(minDy, Math.min(maxDy, state.startDy + Math.round(deltaY / unitH)));\r\n\r\n        const rect = { id: w.id, x: w.x, y: w.y, dx: nextDx, dy: nextDy };\r\n        if (!canPlaceRect(rect)) return;\r\n\r\n        if ((w.dx ?? 1) === nextDx && (w.dy ?? 1) === nextDy) return;\r\n\r\n        updateWidgets((prev) => prev.map((x) => (x.id === w.id ? { ...x, dx: nextDx, dy: nextDy } : x)));\r\n      },\r\n      [getWidgetById, resolvedUnitWidth, resolvedUnitHeight, cellMargin, gridColumns, gridRows, canPlaceRect, updateWidgets]\r\n    );\r\n\r\n    const handlePointerUp = useCallback(\r\n      () => {\r\n        const state = resizeStateRef.current;\r\n        if (!state) return;\r\n\r\n        const w = getWidgetById(state.widgetId);\r\n        if (w) {\r\n          onResizeEnd?.(w, { dx: w.dx ?? 1, dy: w.dy ?? 1 });\r\n        }\r\n\r\n        resizeStateRef.current = null;\r\n      },\r\n      [getWidgetById, onResizeEnd]\r\n    );\r\n\r\n    const gridCells: AvakioGridCell[] = useMemo(() => {\r\n      return widgets.map((w) => {\r\n        const dx = w.dx ?? 1;\r\n        const dy = w.dy ?? 1;\r\n\r\n        const header = w.header ?? null;\r\n        const hasHeader = header !== null && header !== undefined;\r\n\r\n        const stopBodyDrag = dragHandle === 'header' && editable;\r\n\r\n        return {\r\n          id: w.id,\r\n          x: w.x,\r\n          y: w.y,\r\n          dx,\r\n          dy,\r\n          draggable: w.draggable !== false,\r\n          content: (\r\n            <div\r\n              className={[\r\n                'avakio-dashboard__panel',\r\n                hasHeader ? 'avakio-dashboard__panel--with-header' : 'avakio-dashboard__panel--no-header',\r\n                editable ? 'avakio-dashboard__panel--editable' : 'avakio-dashboard__panel--readonly',\r\n                w.className,\r\n              ]\r\n                .filter(Boolean)\r\n                .join(' ')}\r\n              style={w.style}\r\n              data-widget-id={w.id}\r\n            >\r\n              {hasHeader && (\r\n                <div className=\"avakio-dashboard__panel-header\">\r\n                  {w.icon && <span className=\"avakio-dashboard__panel-icon\">{w.icon}</span>}\r\n                  <div className=\"avakio-dashboard__panel-title\">{header}</div>\r\n                </div>\r\n              )}\r\n\r\n              <div\r\n                className=\"avakio-dashboard__panel-body\"\r\n                onMouseDown={stopBodyDrag ? (e) => e.stopPropagation() : undefined}\r\n                onTouchStart={stopBodyDrag ? (e) => e.stopPropagation() : undefined}\r\n              >\r\n                {w.body}\r\n              </div>\r\n\r\n              {editable && w.resizable === true && (\r\n                <div\r\n                  className=\"avakio-dashboard__resize-handle\"\r\n                  onPointerDown={(e) => beginResize(e, w.id)}\r\n                  onMouseDown={(e) => e.stopPropagation()}\r\n                  onTouchStart={(e) => e.stopPropagation()}\r\n                />\r\n              )}\r\n            </div>\r\n          ),\r\n        };\r\n      });\r\n    }, [widgets, dragHandle, editable, beginResize]);\r\n\r\n    const containerStyle: CSSProperties = {\r\n      width,\r\n      height,\r\n      ...(style && typeof style === 'object' && !Array.isArray(style) ? style : {}),\r\n    };\r\n\r\n    return (\r\n      <div\r\n        ref={containerRef}\r\n        id={id}\r\n        data-testid={testId}\r\n        className={['avakio-dashboard', `avakio-dashboard--${theme}`, className].filter(Boolean).join(' ')}\r\n        data-admin-theme={theme}\r\n        style={containerStyle}\r\n        onPointerMove={handlePointerMove}\r\n        onPointerUp={handlePointerUp}\r\n        onPointerCancel={handlePointerUp}\r\n      >\r\n        <AvakioGrid\r\n          ref={gridRef}\r\n          id={id ? `${id}__grid` : undefined}\r\n          testId={testId ? `${testId}__grid` : undefined}\r\n          gridColumns={gridColumns}\r\n          gridRows={gridRows}\r\n          cellWidth={cellWidth}\r\n          cellHeight={cellHeight}\r\n          cellMargin={cellMargin}\r\n          margin={margin}\r\n          padding={padding}\r\n          paddingX={paddingX}\r\n          paddingY={paddingY}\r\n          width={'100%'}\r\n          height={'100%'}\r\n          theme={theme}\r\n          borderless\r\n          cellBorderless\r\n          isDraggable={editable}\r\n          cells={gridCells}\r\n          onChange={handleGridChange}\r\n          onCellClick={(cell) => {\r\n            const w = getWidgetById(cell.id);\r\n            if (w) onWidgetClick?.(w);\r\n          }}\r\n          onDragStart={handleDragStartInternal}\r\n          onDragEnd={handleDragEndInternal}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nAvakioDashboard.displayName = 'AvakioDashboard';\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useState, useEffect, useCallback, forwardRef, useImperativeHandle, useRef } from 'react';\r\nimport './avakio-excel-viewer.css';\r\n\r\nexport type AvakioExcelViewerTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\n\r\n/**\r\n * Column configuration for Excel Viewer\r\n */\r\nexport interface AvakioExcelViewerColumn {\r\n  /** Unique column ID */\r\n  id: string;\r\n  /** Column header text */\r\n  header?: string;\r\n  /** Column width in pixels */\r\n  width?: number;\r\n  /** Minimum column width */\r\n  minWidth?: number;\r\n  /** Maximum column width */\r\n  maxWidth?: number;\r\n  /** CSS class for the column */\r\n  css?: string;\r\n  /** Custom cell renderer */\r\n  template?: (row: any, col: AvakioExcelViewerColumn) => React.ReactNode;\r\n  /** Whether the column is editable */\r\n  editable?: boolean;\r\n  /** Cell editor type */\r\n  editor?: 'text' | 'number' | 'select' | 'date';\r\n  /** Options for select editor */\r\n  options?: { id: string | number; value: string }[];\r\n  /** Text alignment */\r\n  align?: 'left' | 'center' | 'right';\r\n  /** Column sort function or boolean */\r\n  sort?: boolean | 'string' | 'number' | 'date' | ((a: any, b: any) => number);\r\n  /** Whether the column is hidden */\r\n  hidden?: boolean;\r\n}\r\n\r\n/**\r\n * Sheet configuration for Excel Viewer\r\n */\r\nexport interface AvakioExcelViewerSheet {\r\n  /** Sheet name */\r\n  name: string;\r\n  /** Sheet data rows */\r\n  data: Record<string, any>[];\r\n  /** Optional column configuration (auto-generated from data if not provided) */\r\n  columns?: AvakioExcelViewerColumn[];\r\n}\r\n\r\n/**\r\n * Cell span configuration\r\n */\r\nexport interface AvakioExcelViewerSpan {\r\n  /** Row index (0-based) */\r\n  row: number;\r\n  /** Column ID */\r\n  column: string;\r\n  /** Number of rows to span */\r\n  rowspan?: number;\r\n  /** Number of columns to span */\r\n  colspan?: number;\r\n  /** Custom CSS class for the spanned cell */\r\n  css?: string;\r\n}\r\n\r\n/**\r\n * Selection area configuration\r\n */\r\nexport interface AvakioExcelViewerSelection {\r\n  /** Start row index */\r\n  row: number;\r\n  /** Start column index */\r\n  column: number;\r\n  /** End row index (for range selection) */\r\n  endRow?: number;\r\n  /** End column index (for range selection) */\r\n  endColumn?: number;\r\n}\r\n\r\nexport interface AvakioExcelViewerProps {\r\n  /** Unique identifier */\r\n  id?: string;\r\n  /** Test ID for testing */\r\n  testId?: string;\r\n  /** Theme to apply */\r\n  theme?: AvakioExcelViewerTheme;\r\n  /** Array of sheets */\r\n  sheets?: AvakioExcelViewerSheet[];\r\n  /** Single sheet data (for simple use cases) */\r\n  data?: Record<string, any>[];\r\n  /** Column configuration (for single sheet mode) */\r\n  columns?: AvakioExcelViewerColumn[];\r\n  /** Whether to use first row as header */\r\n  excelHeader?: boolean;\r\n  /** Whether to show the toolbar with sheet tabs */\r\n  toolbar?: boolean;\r\n  /** Default column width */\r\n  columnWidth?: number;\r\n  /** Default row height */\r\n  rowHeight?: number;\r\n  /** Header row height */\r\n  headerRowHeight?: number;\r\n  /** Whether to show row numbers */\r\n  showRowNumbers?: boolean;\r\n  /** Whether to enable column resizing */\r\n  resizeColumn?: boolean;\r\n  /** Whether to enable row resizing */\r\n  resizeRow?: boolean;\r\n  /** Whether to enable editing */\r\n  editable?: boolean;\r\n  /** Edit action: 'click' or 'dblclick' */\r\n  editAction?: 'click' | 'dblclick';\r\n  /** Whether to enable cell selection */\r\n  select?: boolean | 'cell' | 'row' | 'column' | 'area';\r\n  /** Whether to enable multi-selection */\r\n  multiselect?: boolean;\r\n  /** Whether to enable block/area selection */\r\n  blockselect?: boolean;\r\n  /** Whether to show grid lines */\r\n  gridLines?: boolean;\r\n  /** Whether to enable keyboard navigation */\r\n  navigation?: boolean;\r\n  /** Whether to freeze header row */\r\n  freezeHeader?: boolean;\r\n  /** Number of columns frozen to left */\r\n  leftSplit?: number;\r\n  /** Number of rows frozen to top */\r\n  topSplit?: number;\r\n  /** Whether the component is disabled */\r\n  disabled?: boolean;\r\n  /** Whether to auto-size columns to fit content */\r\n  autowidth?: boolean;\r\n  /** Whether to auto-size height to fit content */\r\n  autoheight?: boolean;\r\n  /** Maximum visible rows */\r\n  yCount?: number;\r\n  /** Custom CSS class */\r\n  css?: string;\r\n  /** Cell spans configuration */\r\n  spans?: AvakioExcelViewerSpan[];\r\n  /** Callback when cell is clicked */\r\n  onCellClick?: (row: Record<string, any>, column: AvakioExcelViewerColumn, rowIndex: number, colIndex: number) => void;\r\n  /** Callback when cell is double-clicked */\r\n  onCellDoubleClick?: (row: Record<string, any>, column: AvakioExcelViewerColumn, rowIndex: number, colIndex: number) => void;\r\n  /** Callback when cell value changes */\r\n  onCellChange?: (row: Record<string, any>, column: AvakioExcelViewerColumn, oldValue: any, newValue: any, rowIndex: number) => void;\r\n  /** Callback when selection changes */\r\n  onSelectionChange?: (selection: AvakioExcelViewerSelection | null) => void;\r\n  /** Callback when sheet changes */\r\n  onSheetChange?: (sheetName: string, sheetIndex: number) => void;\r\n  /** Callback when column is resized */\r\n  onColumnResize?: (column: AvakioExcelViewerColumn, newWidth: number) => void;\r\n  /** Callback when row is resized */\r\n  onRowResize?: (rowIndex: number, newHeight: number) => void;\r\n  /** Callback when data is sorted */\r\n  onSort?: (column: AvakioExcelViewerColumn, direction: 'asc' | 'desc') => void;\r\n  /** Callback when data is loaded */\r\n  onDataLoad?: (data: Record<string, any>[]) => void;\r\n}\r\n\r\nexport interface AvakioExcelViewerRef {\r\n  /** Get all sheet names */\r\n  getSheets: () => string[];\r\n  /** Switch to a specific sheet */\r\n  showSheet: (name: string) => void;\r\n  /** Get current sheet name */\r\n  getCurrentSheet: () => string;\r\n  /** Get data from current sheet */\r\n  getData: () => Record<string, any>[];\r\n  /** Set data for current sheet */\r\n  setData: (data: Record<string, any>[]) => void;\r\n  /** Get column configuration */\r\n  getColumns: () => AvakioExcelViewerColumn[];\r\n  /** Set column configuration */\r\n  setColumns: (columns: AvakioExcelViewerColumn[]) => void;\r\n  /** Get selected cells */\r\n  getSelectedId: () => AvakioExcelViewerSelection | null;\r\n  /** Select a cell or range */\r\n  select: (row: number, column: number, endRow?: number, endColumn?: number) => void;\r\n  /** Clear selection */\r\n  clearSelection: () => void;\r\n  /** Get cell value */\r\n  getCellValue: (rowIndex: number, columnId: string) => any;\r\n  /** Set cell value */\r\n  setCellValue: (rowIndex: number, columnId: string, value: any) => void;\r\n  /** Add a row */\r\n  addRow: (row: Record<string, any>, index?: number) => void;\r\n  /** Remove a row */\r\n  removeRow: (index: number) => void;\r\n  /** Refresh the view */\r\n  refresh: () => void;\r\n  /** Get row by index */\r\n  getItem: (index: number) => Record<string, any> | undefined;\r\n  /** Get total row count */\r\n  count: () => number;\r\n  /** Scroll to a specific cell */\r\n  showCell: (rowIndex: number, columnId: string) => void;\r\n  /** Hide a column */\r\n  hideColumn: (columnId: string) => void;\r\n  /** Show a hidden column */\r\n  showColumn: (columnId: string) => void;\r\n  /** Check if column is visible */\r\n  isColumnVisible: (columnId: string) => boolean;\r\n  /** Sort data */\r\n  sort: (columnId: string, direction?: 'asc' | 'desc') => void;\r\n  /** Filter data */\r\n  filter: (columnId: string, value: any, compare?: (cellValue: any, filterValue: any) => boolean) => void;\r\n  /** Clear all filters */\r\n  clearFilter: () => void;\r\n}\r\n\r\n// Helper to generate column letter (A, B, C, ..., Z, AA, AB, ...)\r\nconst getColumnLetter = (index: number): string => {\r\n  let letter = '';\r\n  let tempIndex = index;\r\n  while (tempIndex >= 0) {\r\n    letter = String.fromCharCode((tempIndex % 26) + 65) + letter;\r\n    tempIndex = Math.floor(tempIndex / 26) - 1;\r\n  }\r\n  return letter;\r\n};\r\n\r\n// Helper to auto-generate columns from data\r\nconst generateColumnsFromData = (data: Record<string, any>[], excelHeader?: boolean): AvakioExcelViewerColumn[] => {\r\n  if (!data || data.length === 0) return [];\r\n  \r\n  const firstRow = data[0];\r\n  const keys = Object.keys(firstRow);\r\n  \r\n  return keys.map((key, index) => ({\r\n    id: key,\r\n    header: excelHeader ? String(firstRow[key] || getColumnLetter(index)) : key,\r\n    width: 100,\r\n  }));\r\n};\r\n\r\nexport const AvakioExcelViewer = forwardRef<AvakioExcelViewerRef, AvakioExcelViewerProps>((props, ref) => {\r\n  const {\r\n    id,\r\n    testId,\r\n    theme = 'material',\r\n    sheets: initialSheets,\r\n    data: initialData,\r\n    columns: initialColumns,\r\n    excelHeader = false,\r\n    toolbar = true,\r\n    columnWidth = 100,\r\n    rowHeight = 32,\r\n    headerRowHeight = 36,\r\n    showRowNumbers = true,\r\n    resizeColumn = true,\r\n    resizeRow = false,\r\n    editable = false,\r\n    editAction = 'dblclick',\r\n    select = 'cell',\r\n    multiselect = false,\r\n    blockselect = false,\r\n    gridLines = true,\r\n    navigation = true,\r\n    freezeHeader = true,\r\n    leftSplit = 0,\r\n    topSplit = 0,\r\n    disabled = false,\r\n    autowidth = false,\r\n    autoheight = false,\r\n    yCount,\r\n    css,\r\n    spans = [],\r\n    onCellClick,\r\n    onCellDoubleClick,\r\n    onCellChange,\r\n    onSelectionChange,\r\n    onSheetChange,\r\n    onColumnResize,\r\n    onRowResize,\r\n    onSort,\r\n    onDataLoad,\r\n  } = props;\r\n\r\n  // State\r\n  const [sheets, setSheets] = useState<AvakioExcelViewerSheet[]>(() => {\r\n    if (initialSheets && initialSheets.length > 0) {\r\n      return initialSheets;\r\n    }\r\n    if (initialData) {\r\n      const cols = initialColumns || generateColumnsFromData(initialData, excelHeader);\r\n      return [{ name: 'Sheet1', data: excelHeader ? initialData.slice(1) : initialData, columns: cols }];\r\n    }\r\n    return [{ name: 'Sheet1', data: [], columns: [] }];\r\n  });\r\n  \r\n  const [activeSheet, setActiveSheet] = useState(0);\r\n  const [columns, setColumns] = useState<AvakioExcelViewerColumn[]>(() => {\r\n    const sheet = sheets[0];\r\n    return sheet?.columns || generateColumnsFromData(sheet?.data || [], excelHeader);\r\n  });\r\n  const [data, setData] = useState<Record<string, any>[]>(() => sheets[0]?.data || []);\r\n  const [selection, setSelection] = useState<AvakioExcelViewerSelection | null>(null);\r\n  const [editingCell, setEditingCell] = useState<{ row: number; col: number } | null>(null);\r\n  const [editValue, setEditValue] = useState<string>('');\r\n  const [sortConfig, setSortConfig] = useState<{ columnId: string; direction: 'asc' | 'desc' } | null>(null);\r\n  const [columnWidths, setColumnWidths] = useState<Record<string, number>>({});\r\n  const [rowHeights, setRowHeights] = useState<Record<number, number>>({});\r\n  const [hiddenColumns, setHiddenColumns] = useState<Set<string>>(new Set());\r\n  const [filterConfig, setFilterConfig] = useState<{ columnId: string; value: any; compare?: (cellValue: any, filterValue: any) => boolean } | null>(null);\r\n  \r\n  // Refs\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n  const tableRef = useRef<HTMLTableElement>(null);\r\n  const resizeRef = useRef<{ columnId: string; startX: number; startWidth: number } | null>(null);\r\n  const selectionStartRef = useRef<{ row: number; col: number } | null>(null);\r\n  \r\n  // Update sheets when props change\r\n  useEffect(() => {\r\n    if (initialSheets && initialSheets.length > 0) {\r\n      setSheets(initialSheets);\r\n      const sheet = initialSheets[activeSheet] || initialSheets[0];\r\n      setData(sheet.data);\r\n      setColumns(sheet.columns || generateColumnsFromData(sheet.data, excelHeader));\r\n    }\r\n  }, [initialSheets, activeSheet, excelHeader]);\r\n  \r\n  useEffect(() => {\r\n    if (initialData && !initialSheets) {\r\n      const cols = initialColumns || generateColumnsFromData(initialData, excelHeader);\r\n      const processedData = excelHeader ? initialData.slice(1) : initialData;\r\n      setSheets([{ name: 'Sheet1', data: processedData, columns: cols }]);\r\n      setData(processedData);\r\n      setColumns(cols);\r\n    }\r\n  }, [initialData, initialColumns, initialSheets, excelHeader]);\r\n\r\n  // Get visible columns\r\n  const visibleColumns = columns.filter(col => !col.hidden && !hiddenColumns.has(col.id));\r\n  \r\n  // Get filtered and sorted data\r\n  const processedData = React.useMemo(() => {\r\n    let result = [...data];\r\n    \r\n    // Apply filter\r\n    if (filterConfig) {\r\n      const { columnId, value, compare } = filterConfig;\r\n      result = result.filter(row => {\r\n        const cellValue = row[columnId];\r\n        if (compare) {\r\n          return compare(cellValue, value);\r\n        }\r\n        if (value === '' || value === null || value === undefined) return true;\r\n        return String(cellValue).toLowerCase().includes(String(value).toLowerCase());\r\n      });\r\n    }\r\n    \r\n    // Apply sort\r\n    if (sortConfig) {\r\n      const { columnId, direction } = sortConfig;\r\n      const column = columns.find(c => c.id === columnId);\r\n      \r\n      result.sort((a, b) => {\r\n        const aVal = a[columnId];\r\n        const bVal = b[columnId];\r\n        \r\n        let comparison = 0;\r\n        \r\n        if (typeof column?.sort === 'function') {\r\n          comparison = column.sort(aVal, bVal);\r\n        } else if (column?.sort === 'number') {\r\n          comparison = (Number(aVal) || 0) - (Number(bVal) || 0);\r\n        } else if (column?.sort === 'date') {\r\n          comparison = new Date(aVal).getTime() - new Date(bVal).getTime();\r\n        } else {\r\n          comparison = String(aVal || '').localeCompare(String(bVal || ''));\r\n        }\r\n        \r\n        return direction === 'desc' ? -comparison : comparison;\r\n      });\r\n    }\r\n    \r\n    return result;\r\n  }, [data, filterConfig, sortConfig, columns]);\r\n\r\n  // Handle sheet change\r\n  const handleSheetChange = useCallback((index: number) => {\r\n    if (index >= 0 && index < sheets.length) {\r\n      setActiveSheet(index);\r\n      const sheet = sheets[index];\r\n      setData(sheet.data);\r\n      setColumns(sheet.columns || generateColumnsFromData(sheet.data, excelHeader));\r\n      setSelection(null);\r\n      setEditingCell(null);\r\n      setSortConfig(null);\r\n      setFilterConfig(null);\r\n      onSheetChange?.(sheet.name, index);\r\n    }\r\n  }, [sheets, excelHeader, onSheetChange]);\r\n\r\n  // Handle cell click\r\n  const handleCellClick = useCallback((rowIndex: number, colIndex: number, e: React.MouseEvent) => {\r\n    if (disabled) return;\r\n    \r\n    const column = visibleColumns[colIndex];\r\n    const row = processedData[rowIndex];\r\n    \r\n    if (select) {\r\n      if (blockselect && e.shiftKey && selection) {\r\n        // Extend selection\r\n        setSelection({\r\n          ...selection,\r\n          endRow: rowIndex,\r\n          endColumn: colIndex,\r\n        });\r\n      } else {\r\n        setSelection({ row: rowIndex, column: colIndex });\r\n        selectionStartRef.current = { row: rowIndex, col: colIndex };\r\n      }\r\n      onSelectionChange?.({ row: rowIndex, column: colIndex });\r\n    }\r\n    \r\n    if (editable && editAction === 'click' && column?.editable !== false) {\r\n      setEditingCell({ row: rowIndex, col: colIndex });\r\n      setEditValue(String(row?.[column?.id] || ''));\r\n    }\r\n    \r\n    onCellClick?.(row, column, rowIndex, colIndex);\r\n  }, [disabled, select, blockselect, selection, editable, editAction, visibleColumns, processedData, onSelectionChange, onCellClick]);\r\n\r\n  // Handle cell double click\r\n  const handleCellDoubleClick = useCallback((rowIndex: number, colIndex: number) => {\r\n    if (disabled) return;\r\n    \r\n    const column = visibleColumns[colIndex];\r\n    const row = processedData[rowIndex];\r\n    \r\n    if (editable && editAction === 'dblclick' && column?.editable !== false) {\r\n      setEditingCell({ row: rowIndex, col: colIndex });\r\n      setEditValue(String(row?.[column?.id] || ''));\r\n    }\r\n    \r\n    onCellDoubleClick?.(row, column, rowIndex, colIndex);\r\n  }, [disabled, editable, editAction, visibleColumns, processedData, onCellDoubleClick]);\r\n\r\n  // Handle edit complete\r\n  const handleEditComplete = useCallback(() => {\r\n    if (!editingCell) return;\r\n    \r\n    const { row: rowIndex, col: colIndex } = editingCell;\r\n    const column = visibleColumns[colIndex];\r\n    const row = processedData[rowIndex];\r\n    const oldValue = row?.[column?.id];\r\n    \r\n    if (editValue !== String(oldValue || '')) {\r\n      const newData = [...data];\r\n      const originalIndex = data.indexOf(row);\r\n      if (originalIndex >= 0) {\r\n        newData[originalIndex] = { ...newData[originalIndex], [column.id]: editValue };\r\n        setData(newData);\r\n        onCellChange?.(row, column, oldValue, editValue, originalIndex);\r\n      }\r\n    }\r\n    \r\n    setEditingCell(null);\r\n    setEditValue('');\r\n  }, [editingCell, editValue, visibleColumns, processedData, data, onCellChange]);\r\n\r\n  // Handle column resize\r\n  const handleColumnResizeStart = useCallback((columnId: string, e: React.MouseEvent) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    \r\n    const column = columns.find(c => c.id === columnId);\r\n    const currentWidth = columnWidths[columnId] || column?.width || columnWidth;\r\n    \r\n    resizeRef.current = { columnId, startX: e.clientX, startWidth: currentWidth };\r\n    \r\n    const handleMouseMove = (moveEvent: MouseEvent) => {\r\n      if (!resizeRef.current) return;\r\n      \r\n      const diff = moveEvent.clientX - resizeRef.current.startX;\r\n      const newWidth = Math.max(50, resizeRef.current.startWidth + diff);\r\n      \r\n      setColumnWidths(prev => ({ ...prev, [columnId]: newWidth }));\r\n    };\r\n    \r\n    const handleMouseUp = () => {\r\n      if (resizeRef.current) {\r\n        const column = columns.find(c => c.id === resizeRef.current!.columnId);\r\n        const newWidth = columnWidths[resizeRef.current.columnId] || column?.width || columnWidth;\r\n        onColumnResize?.(column!, newWidth);\r\n      }\r\n      resizeRef.current = null;\r\n      document.removeEventListener('mousemove', handleMouseMove);\r\n      document.removeEventListener('mouseup', handleMouseUp);\r\n    };\r\n    \r\n    document.addEventListener('mousemove', handleMouseMove);\r\n    document.addEventListener('mouseup', handleMouseUp);\r\n  }, [columns, columnWidths, columnWidth, onColumnResize]);\r\n\r\n  // Handle sort\r\n  const handleHeaderClick = useCallback((column: AvakioExcelViewerColumn) => {\r\n    if (!column.sort) return;\r\n    \r\n    let direction: 'asc' | 'desc' = 'asc';\r\n    if (sortConfig?.columnId === column.id) {\r\n      direction = sortConfig.direction === 'asc' ? 'desc' : 'asc';\r\n    }\r\n    \r\n    setSortConfig({ columnId: column.id, direction });\r\n    onSort?.(column, direction);\r\n  }, [sortConfig, onSort]);\r\n\r\n  // Handle keyboard navigation\r\n  const handleKeyDown = useCallback((e: React.KeyboardEvent) => {\r\n    if (disabled || !navigation || !selection) return;\r\n    \r\n    const { row, column } = selection;\r\n    let newRow = row;\r\n    let newCol = column;\r\n    \r\n    switch (e.key) {\r\n      case 'ArrowUp':\r\n        newRow = Math.max(0, row - 1);\r\n        break;\r\n      case 'ArrowDown':\r\n        newRow = Math.min(processedData.length - 1, row + 1);\r\n        break;\r\n      case 'ArrowLeft':\r\n        newCol = Math.max(0, column - 1);\r\n        break;\r\n      case 'ArrowRight':\r\n        newCol = Math.min(visibleColumns.length - 1, column + 1);\r\n        break;\r\n      case 'Tab':\r\n        e.preventDefault();\r\n        if (e.shiftKey) {\r\n          newCol = column - 1;\r\n          if (newCol < 0) {\r\n            newCol = visibleColumns.length - 1;\r\n            newRow = Math.max(0, row - 1);\r\n          }\r\n        } else {\r\n          newCol = column + 1;\r\n          if (newCol >= visibleColumns.length) {\r\n            newCol = 0;\r\n            newRow = Math.min(processedData.length - 1, row + 1);\r\n          }\r\n        }\r\n        break;\r\n      case 'Enter':\r\n        if (editingCell) {\r\n          handleEditComplete();\r\n          newRow = Math.min(processedData.length - 1, row + 1);\r\n        } else if (editable) {\r\n          const col = visibleColumns[column];\r\n          if (col?.editable !== false) {\r\n            setEditingCell({ row, col: column });\r\n            setEditValue(String(processedData[row]?.[col?.id] || ''));\r\n            return;\r\n          }\r\n        }\r\n        break;\r\n      case 'Escape':\r\n        if (editingCell) {\r\n          setEditingCell(null);\r\n          setEditValue('');\r\n          return;\r\n        }\r\n        break;\r\n      case 'Home':\r\n        if (e.ctrlKey) {\r\n          newRow = 0;\r\n          newCol = 0;\r\n        } else {\r\n          newCol = 0;\r\n        }\r\n        break;\r\n      case 'End':\r\n        if (e.ctrlKey) {\r\n          newRow = processedData.length - 1;\r\n          newCol = visibleColumns.length - 1;\r\n        } else {\r\n          newCol = visibleColumns.length - 1;\r\n        }\r\n        break;\r\n      default:\r\n        return;\r\n    }\r\n    \r\n    if (newRow !== row || newCol !== column) {\r\n      e.preventDefault();\r\n      setSelection({ row: newRow, column: newCol });\r\n      onSelectionChange?.({ row: newRow, column: newCol });\r\n    }\r\n  }, [disabled, navigation, selection, processedData, visibleColumns, editingCell, editable, handleEditComplete, onSelectionChange]);\r\n\r\n  // Check if cell is in selection range\r\n  const isCellSelected = useCallback((rowIndex: number, colIndex: number): boolean => {\r\n    if (!selection) return false;\r\n    \r\n    const { row, column, endRow, endColumn } = selection;\r\n    \r\n    if (endRow !== undefined && endColumn !== undefined) {\r\n      const minRow = Math.min(row, endRow);\r\n      const maxRow = Math.max(row, endRow);\r\n      const minCol = Math.min(column, endColumn);\r\n      const maxCol = Math.max(column, endColumn);\r\n      \r\n      return rowIndex >= minRow && rowIndex <= maxRow && colIndex >= minCol && colIndex <= maxCol;\r\n    }\r\n    \r\n    return row === rowIndex && column === colIndex;\r\n  }, [selection]);\r\n\r\n  // Check if cell is spanned\r\n  const getCellSpan = useCallback((rowIndex: number, columnId: string): { rowspan?: number; colspan?: number; hidden?: boolean } => {\r\n    for (const span of spans) {\r\n      if (span.row === rowIndex && span.column === columnId) {\r\n        return { rowspan: span.rowspan, colspan: span.colspan };\r\n      }\r\n      \r\n      // Check if this cell is hidden by a span\r\n      if (span.rowspan && span.colspan) {\r\n        const spanEndRow = span.row + (span.rowspan - 1);\r\n        const colIndex = visibleColumns.findIndex(c => c.id === span.column);\r\n        const spanEndCol = colIndex + (span.colspan - 1);\r\n        const currentColIndex = visibleColumns.findIndex(c => c.id === columnId);\r\n        \r\n        if (\r\n          rowIndex >= span.row && rowIndex <= spanEndRow &&\r\n          currentColIndex >= colIndex && currentColIndex <= spanEndCol &&\r\n          !(rowIndex === span.row && columnId === span.column)\r\n        ) {\r\n          return { hidden: true };\r\n        }\r\n      }\r\n    }\r\n    return {};\r\n  }, [spans, visibleColumns]);\r\n\r\n  // Imperative handle\r\n  useImperativeHandle(ref, () => ({\r\n    getSheets: () => sheets.map(s => s.name),\r\n    showSheet: (name: string) => {\r\n      const index = sheets.findIndex(s => s.name === name);\r\n      if (index >= 0) handleSheetChange(index);\r\n    },\r\n    getCurrentSheet: () => sheets[activeSheet]?.name || '',\r\n    getData: () => data,\r\n    setData: (newData: Record<string, any>[]) => {\r\n      setData(newData);\r\n      onDataLoad?.(newData);\r\n    },\r\n    getColumns: () => columns,\r\n    setColumns: (newColumns: AvakioExcelViewerColumn[]) => setColumns(newColumns),\r\n    getSelectedId: () => selection,\r\n    select: (row: number, column: number, endRow?: number, endColumn?: number) => {\r\n      setSelection({ row, column, endRow, endColumn });\r\n      onSelectionChange?.({ row, column, endRow, endColumn });\r\n    },\r\n    clearSelection: () => {\r\n      setSelection(null);\r\n      onSelectionChange?.(null);\r\n    },\r\n    getCellValue: (rowIndex: number, columnId: string) => data[rowIndex]?.[columnId],\r\n    setCellValue: (rowIndex: number, columnId: string, value: any) => {\r\n      const newData = [...data];\r\n      if (newData[rowIndex]) {\r\n        newData[rowIndex] = { ...newData[rowIndex], [columnId]: value };\r\n        setData(newData);\r\n      }\r\n    },\r\n    addRow: (row: Record<string, any>, index?: number) => {\r\n      const newData = [...data];\r\n      if (index !== undefined) {\r\n        newData.splice(index, 0, row);\r\n      } else {\r\n        newData.push(row);\r\n      }\r\n      setData(newData);\r\n    },\r\n    removeRow: (index: number) => {\r\n      const newData = [...data];\r\n      newData.splice(index, 1);\r\n      setData(newData);\r\n    },\r\n    refresh: () => {\r\n      setData([...data]);\r\n    },\r\n    getItem: (index: number) => data[index],\r\n    count: () => data.length,\r\n    showCell: (rowIndex: number, columnId: string) => {\r\n      const cell = containerRef.current?.querySelector(`[data-row=\"${rowIndex}\"][data-col=\"${columnId}\"]`);\r\n      cell?.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'nearest' });\r\n    },\r\n    hideColumn: (columnId: string) => {\r\n      setHiddenColumns(prev => new Set([...Array.from(prev), columnId]));\r\n    },\r\n    showColumn: (columnId: string) => {\r\n      setHiddenColumns(prev => {\r\n        const next = new Set(prev);\r\n        next.delete(columnId);\r\n        return next;\r\n      });\r\n    },\r\n    isColumnVisible: (columnId: string) => !hiddenColumns.has(columnId),\r\n    sort: (columnId: string, direction?: 'asc' | 'desc') => {\r\n      const column = columns.find(c => c.id === columnId);\r\n      if (column) {\r\n        const dir = direction || (sortConfig?.columnId === columnId && sortConfig?.direction === 'asc' ? 'desc' : 'asc');\r\n        setSortConfig({ columnId, direction: dir });\r\n        onSort?.(column, dir);\r\n      }\r\n    },\r\n    filter: (columnId: string, value: any, compare?: (cellValue: any, filterValue: any) => boolean) => {\r\n      setFilterConfig({ columnId, value, compare });\r\n    },\r\n    clearFilter: () => {\r\n      setFilterConfig(null);\r\n    },\r\n  }), [sheets, activeSheet, data, columns, selection, hiddenColumns, sortConfig, handleSheetChange, onDataLoad, onSelectionChange, onSort]);\r\n\r\n  // Calculate table height\r\n  const tableHeight = yCount ? yCount * rowHeight + headerRowHeight : undefined;\r\n\r\n  return (\r\n    <div\r\n      ref={containerRef}\r\n      id={id}\r\n      data-testid={testId}\r\n      className={`avakio-excel-viewer avakio-excel-viewer-theme-${theme} ${css || ''} ${disabled ? 'avakio-excel-viewer-disabled' : ''} ${gridLines ? 'avakio-excel-viewer-grid-lines' : ''}`}\r\n      tabIndex={navigation ? 0 : -1}\r\n      onKeyDown={handleKeyDown}\r\n    >\r\n      {toolbar && sheets.length > 1 && (\r\n        <div className=\"avakio-excel-viewer-toolbar\">\r\n          {sheets.map((sheet, index) => (\r\n            <button\r\n              key={sheet.name}\r\n              className={`avakio-excel-viewer-sheet-tab ${index === activeSheet ? 'active' : ''}`}\r\n              onClick={() => handleSheetChange(index)}\r\n              disabled={disabled}\r\n            >\r\n              {sheet.name}\r\n            </button>\r\n          ))}\r\n        </div>\r\n      )}\r\n      \r\n      <div \r\n        className=\"avakio-excel-viewer-table-container\"\r\n        style={{ maxHeight: tableHeight }}\r\n      >\r\n        <table \r\n          ref={tableRef}\r\n          className=\"avakio-excel-viewer-table\"\r\n        >\r\n          <thead className={freezeHeader ? 'avakio-excel-viewer-sticky-header' : ''}>\r\n            <tr style={{ height: headerRowHeight }}>\r\n              {showRowNumbers && (\r\n                <th className=\"avakio-excel-viewer-row-number-header\">#</th>\r\n              )}\r\n              {visibleColumns.map((column, colIndex) => (\r\n                <th\r\n                  key={column.id}\r\n                  className={`avakio-excel-viewer-header-cell ${column.css || ''} ${column.sort ? 'sortable' : ''} ${sortConfig?.columnId === column.id ? `sorted-${sortConfig.direction}` : ''}`}\r\n                  style={{\r\n                    width: columnWidths[column.id] || column.width || columnWidth,\r\n                    minWidth: column.minWidth,\r\n                    maxWidth: column.maxWidth,\r\n                    textAlign: column.align || 'left',\r\n                  }}\r\n                  onClick={() => handleHeaderClick(column)}\r\n                >\r\n                  <span className=\"avakio-excel-viewer-header-text\">{column.header || column.id}</span>\r\n                  {column.sort && sortConfig?.columnId === column.id && (\r\n                    <span className=\"avakio-excel-viewer-sort-icon\">\r\n                      {sortConfig.direction === 'asc' ? 'â–²' : 'â–¼'}\r\n                    </span>\r\n                  )}\r\n                  {resizeColumn && (\r\n                    <div\r\n                      className=\"avakio-excel-viewer-resize-handle\"\r\n                      onMouseDown={(e) => handleColumnResizeStart(column.id, e)}\r\n                    />\r\n                  )}\r\n                </th>\r\n              ))}\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {processedData.length === 0 ? (\r\n              <tr>\r\n                <td \r\n                  colSpan={visibleColumns.length + (showRowNumbers ? 1 : 0)}\r\n                  className=\"avakio-excel-viewer-empty\"\r\n                >\r\n                  No data available\r\n                </td>\r\n              </tr>\r\n            ) : (\r\n              processedData.map((row, rowIndex) => (\r\n                <tr\r\n                  key={rowIndex}\r\n                  style={{ height: rowHeights[rowIndex] || rowHeight }}\r\n                  className={select === 'row' && selection?.row === rowIndex ? 'selected-row' : ''}\r\n                >\r\n                  {showRowNumbers && (\r\n                    <td className=\"avakio-excel-viewer-row-number\">{rowIndex + 1}</td>\r\n                  )}\r\n                  {visibleColumns.map((column, colIndex) => {\r\n                    const span = getCellSpan(rowIndex, column.id);\r\n                    if (span.hidden) return null;\r\n                    \r\n                    const isEditing = editingCell?.row === rowIndex && editingCell?.col === colIndex;\r\n                    const isSelected = isCellSelected(rowIndex, colIndex);\r\n                    const cellValue = row[column.id];\r\n                    \r\n                    return (\r\n                      <td\r\n                        key={column.id}\r\n                        data-row={rowIndex}\r\n                        data-col={column.id}\r\n                        className={`avakio-excel-viewer-cell ${column.css || ''} ${isSelected ? 'selected' : ''} ${isEditing ? 'editing' : ''}`}\r\n                        style={{\r\n                          textAlign: column.align || 'left',\r\n                          width: columnWidths[column.id] || column.width || columnWidth,\r\n                        }}\r\n                        rowSpan={span.rowspan}\r\n                        colSpan={span.colspan}\r\n                        onClick={(e) => handleCellClick(rowIndex, colIndex, e)}\r\n                        onDoubleClick={() => handleCellDoubleClick(rowIndex, colIndex)}\r\n                      >\r\n                        {isEditing ? (\r\n                          <input\r\n                            type={column.editor === 'number' ? 'number' : 'text'}\r\n                            className=\"avakio-excel-viewer-editor\"\r\n                            value={editValue}\r\n                            onChange={(e) => setEditValue(e.target.value)}\r\n                            onBlur={handleEditComplete}\r\n                            onKeyDown={(e) => {\r\n                              if (e.key === 'Enter') {\r\n                                handleEditComplete();\r\n                              } else if (e.key === 'Escape') {\r\n                                setEditingCell(null);\r\n                                setEditValue('');\r\n                              }\r\n                              e.stopPropagation();\r\n                            }}\r\n                            autoFocus\r\n                          />\r\n                        ) : column.template ? (\r\n                          column.template(row, column)\r\n                        ) : (\r\n                          <span className=\"avakio-excel-viewer-cell-text\">\r\n                            {cellValue !== undefined && cellValue !== null ? String(cellValue) : ''}\r\n                          </span>\r\n                        )}\r\n                      </td>\r\n                    );\r\n                  })}\r\n                </tr>\r\n              ))\r\n            )}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    </div>\r\n  );\r\n});\r\n\r\nAvakioExcelViewer.displayName = 'AvakioExcelViewer';\r\n\r\nexport default AvakioExcelViewer;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, {\r\n  forwardRef,\r\n  useImperativeHandle,\r\n  useRef,\r\n  useState,\r\n  useCallback,\r\n  useEffect,\r\n  ReactNode,\r\n  CSSProperties,\r\n} from 'react';\r\nimport './avakio-form.css';\r\n\r\n// ============================================================================\r\n// Types and Interfaces\r\n// ============================================================================\r\n\r\nexport type AvakioFormTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\n\r\n/** Validation rule function - returns true if valid, false or error message if invalid */\r\nexport type ValidationRule<T = any> = (value: T, name: string, values: FormValues) => boolean | string;\r\n\r\n/** Built-in validation rules */\r\nexport const FormRules = {\r\n  /** Field is required (not empty) */\r\n  isRequired: (value: any) => {\r\n    if (value === null || value === undefined) return false;\r\n    if (typeof value === 'string') return value.trim().length > 0;\r\n    if (Array.isArray(value)) return value.length > 0;\r\n    return true;\r\n  },\r\n  /** Must be a valid email */\r\n  isEmail: (value: any) => {\r\n    if (!value) return true; // Allow empty - combine with isRequired if needed\r\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n    return emailRegex.test(String(value));\r\n  },\r\n  /** Must be a valid number */\r\n  isNumber: (value: any) => {\r\n    if (!value && value !== 0) return true;\r\n    return !isNaN(Number(value));\r\n  },\r\n  /** Must be a positive number */\r\n  isPositive: (value: any) => {\r\n    if (!value && value !== 0) return true;\r\n    const num = Number(value);\r\n    return !isNaN(num) && num > 0;\r\n  },\r\n  /** Must be an integer */\r\n  isInteger: (value: any) => {\r\n    if (!value && value !== 0) return true;\r\n    return Number.isInteger(Number(value));\r\n  },\r\n  /** Must match given regex pattern */\r\n  pattern: (regex: RegExp) => (value: any) => {\r\n    if (!value) return true;\r\n    return regex.test(String(value));\r\n  },\r\n  /** Minimum length */\r\n  minLength: (min: number) => (value: any) => {\r\n    if (!value) return true;\r\n    return String(value).length >= min;\r\n  },\r\n  /** Maximum length */\r\n  maxLength: (max: number) => (value: any) => {\r\n    if (!value) return true;\r\n    return String(value).length <= max;\r\n  },\r\n  /** Minimum value (for numbers) */\r\n  minValue: (min: number) => (value: any) => {\r\n    if (!value && value !== 0) return true;\r\n    return Number(value) >= min;\r\n  },\r\n  /** Maximum value (for numbers) */\r\n  maxValue: (max: number) => (value: any) => {\r\n    if (!value && value !== 0) return true;\r\n    return Number(value) <= max;\r\n  },\r\n  /** Custom validation function */\r\n  custom: (fn: (value: any) => boolean | string) => fn,\r\n};\r\n\r\n/** Form values object */\r\nexport type FormValues = Record<string, any>;\r\n\r\n/** Validation rules configuration */\r\nexport type FormValidationRules = Record<string, ValidationRule | ValidationRule[]>;\r\n\r\n/** Validation errors object */\r\nexport type FormErrors = Record<string, string | undefined>;\r\n\r\n/** Form element configuration */\r\nexport interface FormElement {\r\n  /** Unique name for the element - used for value binding */\r\n  name?: string;\r\n  /** Form control component */\r\n  view?: ReactNode;\r\n  /** Nested columns layout */\r\n  cols?: FormElement[];\r\n  /** Nested rows layout */\r\n  rows?: FormElement[];\r\n  /** Element label (for section headers) */\r\n  label?: string;\r\n  /** Element type - 'section' for section headers */\r\n  type?: 'section' | 'clean';\r\n  /** CSS class */\r\n  css?: string;\r\n  /** Width */\r\n  width?: number | string;\r\n  /** Height */\r\n  height?: number | string;\r\n  /** Gravity (flex grow) */\r\n  gravity?: number;\r\n  /** Padding */\r\n  padding?: number | string;\r\n  /** Margin */\r\n  margin?: number | string;\r\n  /** Hidden */\r\n  hidden?: boolean;\r\n  /** Disabled */\r\n  disabled?: boolean;\r\n  /** Batch name for visibility toggling */\r\n  batch?: string;\r\n}\r\n\r\nexport interface AvakioFormProps {\r\n  /** Child elements (React children) */\r\n  children?: ReactNode;\r\n  /** Form elements configuration (alternative to children) */\r\n  elements?: FormElement[];\r\n  /** Initial form values */\r\n  values?: FormValues;\r\n  /** Default values (used by getCleanValues and isDirty) */\r\n  defaultValues?: FormValues;\r\n  /** Validation rules */\r\n  rules?: FormValidationRules;\r\n  /** Whether to parse complex data (dot notation in names) */\r\n  complexData?: boolean;\r\n  /** Auto height based on content */\r\n  autoHeight?: boolean;\r\n  /** Remove borders */\r\n  borderless?: boolean;\r\n  /** Disabled state */\r\n  disabled?: boolean;\r\n  /** Width */\r\n  width?: number | string;\r\n  /** Height */\r\n  height?: number | string;\r\n  /** Min width */\r\n  minWidth?: number | string;\r\n  /** Max width */\r\n  maxWidth?: number | string;\r\n  /** Min height */\r\n  minHeight?: number | string;\r\n  /** Max height */\r\n  maxHeight?: number | string;\r\n  /** Padding (applies to all sides) */\r\n  padding?: number | string;\r\n  /** Horizontal padding */\r\n  paddingX?: number | string;\r\n  /** Vertical padding */\r\n  paddingY?: number | string;\r\n  /** Margin between elements */\r\n  margin?: number | string;\r\n  /** Enable scroll */\r\n  scroll?: boolean | 'x' | 'y' | 'xy';\r\n  /** Layout type */\r\n  type?: 'clean' | 'line' | 'wide' | 'space' | 'form';\r\n  /** Theme variant */\r\n  theme?: AvakioFormTheme;\r\n  /** Custom class name */\r\n  className?: string;\r\n  /** Custom style */\r\n  style?: CSSProperties;\r\n  /** Currently visible batch */\r\n  visibleBatch?: string;\r\n  /** Callback when form values change */\r\n  onChange?: (name: string, value: any, values: FormValues) => void;\r\n  /** Callback after validation */\r\n  onValidation?: (isValid: boolean, errors: FormErrors) => void;\r\n  /** Callback on validation error */\r\n  onValidationError?: (name: string, error: string) => void;\r\n  /** Callback on validation success */\r\n  onValidationSuccess?: (name: string) => void;\r\n  /** Callback when form is submitted (Enter pressed) */\r\n  onSubmit?: (values: FormValues) => void;\r\n  /** Callback when values are set */\r\n  onValues?: (values: FormValues) => void;\r\n}\r\n\r\nexport interface AvakioFormRef {\r\n  /** Get the DOM node */\r\n  getNode: () => HTMLFormElement | null;\r\n  /** Get all form values */\r\n  getValues: () => FormValues;\r\n  /** Set form values */\r\n  setValues: (values: FormValues, updateDirty?: boolean) => void;\r\n  /** Get clean (unchanged) values */\r\n  getCleanValues: () => FormValues;\r\n  /** Get dirty (changed) values */\r\n  getDirtyValues: () => FormValues;\r\n  /** Check if form has changes */\r\n  isDirty: () => boolean;\r\n  /** Set dirty state */\r\n  setDirty: (dirty: boolean) => void;\r\n  /** Validate the form */\r\n  validate: () => boolean;\r\n  /** Clear validation errors */\r\n  clearValidation: () => void;\r\n  /** Mark a field as invalid */\r\n  markInvalid: (name: string, message?: string) => void;\r\n  /** Clear all form values */\r\n  clear: () => void;\r\n  /** Focus a specific field or first field */\r\n  focus: (name?: string) => void;\r\n  /** Check if form is enabled */\r\n  isEnabled: () => boolean;\r\n  /** Enable the form */\r\n  enable: () => void;\r\n  /** Disable the form */\r\n  disable: () => void;\r\n  /** Show a batch of elements */\r\n  showBatch: (batchName: string) => void;\r\n  /** Get validation errors */\r\n  getErrors: () => FormErrors;\r\n}\r\n\r\n// ============================================================================\r\n// Form Context\r\n// ============================================================================\r\n\r\ninterface FormContextValue {\r\n  values: FormValues;\r\n  errors: FormErrors;\r\n  disabled: boolean;\r\n  onChange: (name: string, value: any) => void;\r\n  registerField: (name: string, element: HTMLElement | null) => void;\r\n  unregisterField: (name: string) => void;\r\n}\r\n\r\nconst FormContext = React.createContext<FormContextValue | null>(null);\r\n\r\nexport const useFormContext = () => {\r\n  const context = React.useContext(FormContext);\r\n  return context;\r\n};\r\n\r\n// ============================================================================\r\n// Helper Functions\r\n// ============================================================================\r\n\r\n/** Parse dot notation path and set value in object */\r\nfunction setNestedValue(obj: FormValues, path: string, value: any): FormValues {\r\n  const keys = path.split('.');\r\n  const result = { ...obj };\r\n  let current: any = result;\r\n\r\n  for (let i = 0; i < keys.length - 1; i++) {\r\n    const key = keys[i];\r\n    current[key] = current[key] ? { ...current[key] } : {};\r\n    current = current[key];\r\n  }\r\n\r\n  current[keys[keys.length - 1]] = value;\r\n  return result;\r\n}\r\n\r\n/** Get nested value from object using dot notation */\r\nfunction getNestedValue(obj: FormValues, path: string): any {\r\n  return path.split('.').reduce((acc, key) => acc?.[key], obj);\r\n}\r\n\r\n/** Flatten nested object to dot notation keys */\r\nfunction flattenObject(obj: any, prefix = ''): FormValues {\r\n  const result: FormValues = {};\r\n\r\n  for (const key in obj) {\r\n    const newKey = prefix ? `${prefix}.${key}` : key;\r\n    if (obj[key] && typeof obj[key] === 'object' && !Array.isArray(obj[key]) && !(obj[key] instanceof Date)) {\r\n      Object.assign(result, flattenObject(obj[key], newKey));\r\n    } else {\r\n      result[newKey] = obj[key];\r\n    }\r\n  }\r\n\r\n  return result;\r\n}\r\n\r\n// ============================================================================\r\n// Main Component\r\n// ============================================================================\r\n\r\nexport const AvakioForm = forwardRef<AvakioFormRef, AvakioFormProps>((props, ref) => {\r\n  const {\r\n    children,\r\n    elements,\r\n    values: initialValues = {},\r\n    defaultValues: initialDefaultValues,\r\n    rules = {},\r\n    complexData = false,\r\n    autoHeight = false,\r\n    borderless = false,\r\n    disabled: initialDisabled = false,\r\n    width,\r\n    height,\r\n    minWidth,\r\n    maxWidth,\r\n    minHeight,\r\n    maxHeight,\r\n    padding,\r\n    paddingX,\r\n    paddingY,\r\n    margin,\r\n    scroll,\r\n    type = 'form',\r\n    theme,\r\n    className,\r\n    style,\r\n    visibleBatch: initialVisibleBatch,\r\n    onChange,\r\n    onValidation,\r\n    onValidationError,\r\n    onValidationSuccess,\r\n    onSubmit,\r\n    onValues,\r\n  } = props;\r\n\r\n  const formRef = useRef<HTMLFormElement>(null);\r\n  const fieldsRef = useRef<Map<string, HTMLElement | null>>(new Map());\r\n  \r\n  const [values, setValues] = useState<FormValues>(() => {\r\n    if (complexData) {\r\n      return flattenObject(initialValues);\r\n    }\r\n    return { ...initialValues };\r\n  });\r\n  \r\n  const [defaultValues, setDefaultValues] = useState<FormValues>(() => {\r\n    const defaults = initialDefaultValues || initialValues;\r\n    if (complexData) {\r\n      return flattenObject(defaults);\r\n    }\r\n    return { ...defaults };\r\n  });\r\n  \r\n  const [errors, setErrors] = useState<FormErrors>({});\r\n  const [disabled, setDisabled] = useState(initialDisabled);\r\n  const [dirty, setDirtyState] = useState(false);\r\n  const [visibleBatch, setVisibleBatch] = useState<string | undefined>(initialVisibleBatch);\r\n\r\n  // Update disabled when prop changes\r\n  useEffect(() => {\r\n    setDisabled(initialDisabled);\r\n  }, [initialDisabled]);\r\n\r\n  // Handle field value change\r\n  const handleChange = useCallback((name: string, value: any) => {\r\n    setValues(prev => {\r\n      const newValues = complexData \r\n        ? setNestedValue(prev, name, value)\r\n        : { ...prev, [name]: value };\r\n      \r\n      // Trigger onChange callback\r\n      onChange?.(name, value, newValues);\r\n      \r\n      return newValues;\r\n    });\r\n    \r\n    // Mark as dirty\r\n    setDirtyState(true);\r\n    \r\n    // Clear error for this field\r\n    setErrors(prev => {\r\n      if (prev[name]) {\r\n        const newErrors = { ...prev };\r\n        delete newErrors[name];\r\n        return newErrors;\r\n      }\r\n      return prev;\r\n    });\r\n  }, [complexData, onChange]);\r\n\r\n  // Register field reference\r\n  const registerField = useCallback((name: string, element: HTMLElement | null) => {\r\n    if (element) {\r\n      fieldsRef.current.set(name, element);\r\n    }\r\n  }, []);\r\n\r\n  // Unregister field reference\r\n  const unregisterField = useCallback((name: string) => {\r\n    fieldsRef.current.delete(name);\r\n  }, []);\r\n\r\n  // Validate a single field\r\n  const validateField = useCallback((name: string, value: any): string | undefined => {\r\n    const fieldRules = rules[name];\r\n    if (!fieldRules) return undefined;\r\n\r\n    const rulesArray = Array.isArray(fieldRules) ? fieldRules : [fieldRules];\r\n    \r\n    for (const rule of rulesArray) {\r\n      const result = rule(value, name, values);\r\n      if (result === false) {\r\n        return 'Invalid value';\r\n      }\r\n      if (typeof result === 'string') {\r\n        return result;\r\n      }\r\n    }\r\n    \r\n    return undefined;\r\n  }, [rules, values]);\r\n\r\n  // Validate all fields\r\n  const validate = useCallback((): boolean => {\r\n    const newErrors: FormErrors = {};\r\n    let isValid = true;\r\n\r\n    for (const name in rules) {\r\n      const value = complexData ? getNestedValue(values, name) : values[name];\r\n      const error = validateField(name, value);\r\n      \r\n      if (error) {\r\n        newErrors[name] = error;\r\n        isValid = false;\r\n        onValidationError?.(name, error);\r\n      } else {\r\n        onValidationSuccess?.(name);\r\n      }\r\n    }\r\n\r\n    setErrors(newErrors);\r\n    onValidation?.(isValid, newErrors);\r\n    \r\n    return isValid;\r\n  }, [rules, values, complexData, validateField, onValidation, onValidationError, onValidationSuccess]);\r\n\r\n  // Get values (with complex data reconstruction if needed)\r\n  const getFormValues = useCallback((): FormValues => {\r\n    if (!complexData) return { ...values };\r\n    \r\n    // Reconstruct nested object from flat values\r\n    const result: FormValues = {};\r\n    for (const key in values) {\r\n      if (key.includes('.')) {\r\n        const keys = key.split('.');\r\n        let current = result;\r\n        for (let i = 0; i < keys.length - 1; i++) {\r\n          if (!current[keys[i]]) current[keys[i]] = {};\r\n          current = current[keys[i]];\r\n        }\r\n        current[keys[keys.length - 1]] = values[key];\r\n      } else {\r\n        result[key] = values[key];\r\n      }\r\n    }\r\n    return result;\r\n  }, [values, complexData]);\r\n\r\n  // Set form values\r\n  const setFormValues = useCallback((newValues: FormValues, updateDirty = true) => {\r\n    const processedValues = complexData ? flattenObject(newValues) : { ...newValues };\r\n    setValues(processedValues);\r\n    \r\n    if (updateDirty) {\r\n      setDefaultValues(processedValues);\r\n      setDirtyState(false);\r\n    }\r\n    \r\n    onValues?.(newValues);\r\n  }, [complexData, onValues]);\r\n\r\n  // Get clean (unchanged) values\r\n  const getCleanValues = useCallback((): FormValues => {\r\n    const result: FormValues = {};\r\n    for (const key in values) {\r\n      if (values[key] === defaultValues[key]) {\r\n        result[key] = values[key];\r\n      }\r\n    }\r\n    return result;\r\n  }, [values, defaultValues]);\r\n\r\n  // Get dirty (changed) values\r\n  const getDirtyValues = useCallback((): FormValues => {\r\n    const result: FormValues = {};\r\n    for (const key in values) {\r\n      if (values[key] !== defaultValues[key]) {\r\n        result[key] = values[key];\r\n      }\r\n    }\r\n    return result;\r\n  }, [values, defaultValues]);\r\n\r\n  // Check if form is dirty\r\n  const isDirty = useCallback((): boolean => {\r\n    for (const key in values) {\r\n      if (values[key] !== defaultValues[key]) {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }, [values, defaultValues]);\r\n\r\n  // Clear validation\r\n  const clearValidation = useCallback(() => {\r\n    setErrors({});\r\n  }, []);\r\n\r\n  // Mark field invalid\r\n  const markInvalid = useCallback((name: string, message = 'Invalid value') => {\r\n    setErrors(prev => ({ ...prev, [name]: message }));\r\n  }, []);\r\n\r\n  // Clear form\r\n  const clear = useCallback(() => {\r\n    setValues({});\r\n    setErrors({});\r\n    setDirtyState(false);\r\n  }, []);\r\n\r\n  // Focus field\r\n  const focus = useCallback((name?: string) => {\r\n    if (name) {\r\n      const field = fieldsRef.current.get(name);\r\n      if (field) {\r\n        const input = field.querySelector('input, textarea, select, [tabindex]') as HTMLElement;\r\n        (input || field).focus();\r\n      }\r\n    } else {\r\n      // Focus first field\r\n      const firstField = fieldsRef.current.values().next().value;\r\n      if (firstField) {\r\n        const input = firstField.querySelector('input, textarea, select, [tabindex]') as HTMLElement;\r\n        (input || firstField).focus();\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  // Handle form submit\r\n  const handleSubmit = useCallback((e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    \r\n    if (validate()) {\r\n      onSubmit?.(getFormValues());\r\n    }\r\n  }, [validate, onSubmit, getFormValues]);\r\n\r\n  // Handle keydown for submit on Enter\r\n  const handleKeyDown = useCallback((e: React.KeyboardEvent) => {\r\n    if (e.key === 'Enter' && !e.shiftKey) {\r\n      const target = e.target as HTMLElement;\r\n      // Don't submit if in textarea\r\n      if (target.tagName !== 'TEXTAREA') {\r\n        // Check if there's an explicit submit button\r\n        const form = formRef.current;\r\n        if (form) {\r\n          const submitButton = form.querySelector('button[type=\"submit\"]');\r\n          if (!submitButton) {\r\n            e.preventDefault();\r\n            if (validate()) {\r\n              onSubmit?.(getFormValues());\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }, [validate, onSubmit, getFormValues]);\r\n\r\n  // Expose ref methods\r\n  useImperativeHandle(ref, () => ({\r\n    getNode: () => formRef.current,\r\n    getValues: getFormValues,\r\n    setValues: setFormValues,\r\n    getCleanValues,\r\n    getDirtyValues,\r\n    isDirty,\r\n    setDirty: setDirtyState,\r\n    validate,\r\n    clearValidation,\r\n    markInvalid,\r\n    clear,\r\n    focus,\r\n    isEnabled: () => !disabled,\r\n    enable: () => setDisabled(false),\r\n    disable: () => setDisabled(true),\r\n    showBatch: setVisibleBatch,\r\n    getErrors: () => ({ ...errors }),\r\n  }), [\r\n    getFormValues,\r\n    setFormValues,\r\n    getCleanValues,\r\n    getDirtyValues,\r\n    isDirty,\r\n    validate,\r\n    clearValidation,\r\n    markInvalid,\r\n    clear,\r\n    focus,\r\n    disabled,\r\n    errors,\r\n  ]);\r\n\r\n  // Build style object\r\n  const formStyle: CSSProperties = {\r\n    ...style,\r\n    width: typeof width === 'number' ? `${width}px` : width,\r\n    height: autoHeight ? 'auto' : (typeof height === 'number' ? `${height}px` : height),\r\n    minWidth: typeof minWidth === 'number' ? `${minWidth}px` : minWidth,\r\n    maxWidth: typeof maxWidth === 'number' ? `${maxWidth}px` : maxWidth,\r\n    minHeight: typeof minHeight === 'number' ? `${minHeight}px` : minHeight,\r\n    maxHeight: typeof maxHeight === 'number' ? `${maxHeight}px` : maxHeight,\r\n  };\r\n\r\n  // Build padding styles\r\n  if (padding !== undefined) {\r\n    formStyle.padding = typeof padding === 'number' ? `${padding}px` : padding;\r\n  }\r\n  if (paddingX !== undefined) {\r\n    const px = typeof paddingX === 'number' ? `${paddingX}px` : paddingX;\r\n    formStyle.paddingLeft = px;\r\n    formStyle.paddingRight = px;\r\n  }\r\n  if (paddingY !== undefined) {\r\n    const py = typeof paddingY === 'number' ? `${paddingY}px` : paddingY;\r\n    formStyle.paddingTop = py;\r\n    formStyle.paddingBottom = py;\r\n  }\r\n\r\n  // Build class names\r\n  const classNames = [\r\n    'avakio-form',\r\n    `avakio-form--type-${type}`,\r\n    borderless && 'avakio-form--borderless',\r\n    disabled && 'avakio-form--disabled',\r\n    scroll === true && 'avakio-form--scroll',\r\n    scroll === 'x' && 'avakio-form--scroll-x',\r\n    scroll === 'y' && 'avakio-form--scroll-y',\r\n    scroll === 'xy' && 'avakio-form--scroll',\r\n    theme && `avakio-form--theme-${theme}`,\r\n    className,\r\n  ].filter(Boolean).join(' ');\r\n\r\n  // Context value\r\n  const contextValue: FormContextValue = {\r\n    values,\r\n    errors,\r\n    disabled,\r\n    onChange: handleChange,\r\n    registerField,\r\n    unregisterField,\r\n  };\r\n\r\n  // Render elements from configuration\r\n  const renderElement = (element: FormElement, index: number): ReactNode => {\r\n    if (element.hidden) return null;\r\n    \r\n    // Check batch visibility\r\n    if (element.batch && visibleBatch && element.batch !== visibleBatch) {\r\n      return null;\r\n    }\r\n\r\n    // Section header\r\n    if (element.type === 'section') {\r\n      return (\r\n        <div key={index} className=\"avakio-form__section\">\r\n          <div className=\"avakio-form__section-header\">\r\n            {element.label}\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    // Columns layout\r\n    if (element.cols) {\r\n      const colStyle: CSSProperties = {};\r\n      if (element.margin !== undefined) {\r\n        colStyle.gap = typeof element.margin === 'number' ? `${element.margin}px` : element.margin;\r\n      }\r\n      \r\n      return (\r\n        <div \r\n          key={index} \r\n          className={`avakio-form__cols ${element.css || ''}`}\r\n          style={colStyle}\r\n        >\r\n          {element.cols.map((col, colIndex) => renderElement(col, colIndex))}\r\n        </div>\r\n      );\r\n    }\r\n\r\n    // Rows layout\r\n    if (element.rows) {\r\n      const rowStyle: CSSProperties = {};\r\n      if (element.margin !== undefined) {\r\n        rowStyle.gap = typeof element.margin === 'number' ? `${element.margin}px` : element.margin;\r\n      }\r\n      \r\n      return (\r\n        <div \r\n          key={index} \r\n          className={`avakio-form__rows ${element.css || ''}`}\r\n          style={rowStyle}\r\n        >\r\n          {element.rows.map((row, rowIndex) => renderElement(row, rowIndex))}\r\n        </div>\r\n      );\r\n    }\r\n\r\n    // Single element with view\r\n    if (element.view) {\r\n      const elementStyle: CSSProperties = {};\r\n      if (element.width !== undefined) {\r\n        elementStyle.width = typeof element.width === 'number' ? `${element.width}px` : element.width;\r\n      }\r\n      if (element.height !== undefined) {\r\n        elementStyle.height = typeof element.height === 'number' ? `${element.height}px` : element.height;\r\n      }\r\n      if (element.gravity !== undefined) {\r\n        elementStyle.flex = element.gravity;\r\n      }\r\n      if (element.padding !== undefined) {\r\n        elementStyle.padding = typeof element.padding === 'number' ? `${element.padding}px` : element.padding;\r\n      }\r\n\r\n      return (\r\n        <div \r\n          key={index} \r\n          className={`avakio-form__element ${element.css || ''}`}\r\n          style={elementStyle}\r\n        >\r\n          {element.view}\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return null;\r\n  };\r\n\r\n  // Render form elements with margin\r\n  const contentStyle: CSSProperties = {};\r\n  if (margin !== undefined) {\r\n    contentStyle.gap = typeof margin === 'number' ? `${margin}px` : margin;\r\n  }\r\n\r\n  return (\r\n    <FormContext.Provider value={contextValue}>\r\n      <form\r\n        ref={formRef}\r\n        className={classNames}\r\n        style={formStyle}\r\n        onSubmit={handleSubmit}\r\n        onKeyDown={handleKeyDown}\r\n        data-admin-theme={theme}\r\n      >\r\n        <div className=\"avakio-form__content\" style={contentStyle}>\r\n          {elements ? elements.map((el, i) => renderElement(el, i)) : children}\r\n        </div>\r\n      </form>\r\n    </FormContext.Provider>\r\n  );\r\n});\r\n\r\nAvakioForm.displayName = 'AvakioForm';\r\n\r\n// ============================================================================\r\n// Form Field Wrapper Component\r\n// ============================================================================\r\n\r\nexport interface AvakioFormFieldProps {\r\n  /** Field name - must match a key in form values */\r\n  name: string;\r\n  /** The form control component */\r\n  children: ReactNode;\r\n  /** Custom render function for more control */\r\n  render?: (props: {\r\n    value: any;\r\n    error?: string;\r\n    onChange: (value: any) => void;\r\n    disabled: boolean;\r\n  }) => ReactNode;\r\n}\r\n\r\nexport const AvakioFormField: React.FC<AvakioFormFieldProps> = ({ name, children, render }) => {\r\n  const context = useFormContext();\r\n  const fieldRef = useRef<HTMLDivElement>(null);\r\n\r\n  useEffect(() => {\r\n    if (context && fieldRef.current) {\r\n      context.registerField(name, fieldRef.current);\r\n      return () => context.unregisterField(name);\r\n    }\r\n  }, [context, name]);\r\n\r\n  if (!context) {\r\n    // Render without form context\r\n    return <div ref={fieldRef} className=\"avakio-form__field\">{children}</div>;\r\n  }\r\n\r\n  const { values, errors, disabled, onChange } = context;\r\n  const value = values[name];\r\n  const error = errors[name];\r\n\r\n  const handleChange = (newValue: any) => {\r\n    onChange(name, newValue);\r\n  };\r\n\r\n  if (render) {\r\n    return (\r\n      <div ref={fieldRef} className=\"avakio-form__field\">\r\n        {render({ value, error, onChange: handleChange, disabled })}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Clone children and inject props\r\n  const enhancedChildren = React.Children.map(children, child => {\r\n    if (React.isValidElement(child)) {\r\n      return React.cloneElement(child as React.ReactElement<any>, {\r\n        value,\r\n        error,\r\n        onChange: handleChange,\r\n        disabled: disabled || (child.props as any).disabled,\r\n        invalid: !!error,\r\n        invalidMessage: error,\r\n      });\r\n    }\r\n    return child;\r\n  });\r\n\r\n  return (\r\n    <div ref={fieldRef} className=\"avakio-form__field\">\r\n      {enhancedChildren}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AvakioForm;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useMemo } from \"react\";\r\nimport \"./avakio-gage.css\";\r\n\r\nexport interface AvakioGageProps {\r\n  value?: number;\r\n  defaultValue?: number;\r\n  min?: number;\r\n  max?: number;\r\n  label?: string;\r\n  subLabel?: string;\r\n  size?: \"sm\" | \"md\" | \"lg\";\r\n  thickness?: number;\r\n  prefix?: string;\r\n  suffix?: string;\r\n  formatValue?: (value: number) => string;\r\n  showValue?: boolean;\r\n  showMinMax?: boolean;\r\n  trackColor?: string;\r\n  color?: string;\r\n  target?: number;\r\n  className?: string;\r\n  style?: React.CSSProperties;\r\n  /** ID of the component */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n}\r\n\r\nexport function AvakioGage({\r\n  value,\r\n  defaultValue,\r\n  min = 0,\r\n  max = 100,\r\n  label,\r\n  subLabel,\r\n  size = \"md\",\r\n  thickness,\r\n  prefix = \"\",\r\n  suffix = \"\",\r\n  formatValue,\r\n  showValue = true,\r\n  showMinMax = true,\r\n  trackColor,\r\n  color,\r\n  target,\r\n  className,\r\n  style,\r\n  id,\r\n  testId,\r\n}: AvakioGageProps) {\r\n  const safeRange = max - min === 0 ? 1 : max - min;\r\n  const rawValue = value ?? defaultValue ?? min;\r\n  const clamped = Math.min(Math.max(rawValue, min), max);\r\n  const percent = ((clamped - min) / safeRange) * 100;\r\n\r\n  const strokeWidth = thickness ?? (size === \"sm\" ? 10 : size === \"lg\" ? 14 : 12);\r\n  const radius = 88;\r\n  const circumference = 2 * Math.PI * radius;\r\n  const dashOffset = circumference * (1 - percent / 100);\r\n\r\n  const targetPosition = useMemo(() => {\r\n    if (target === undefined || target === null) return null;\r\n    const targetPercent = ((Math.min(Math.max(target, min), max) - min) / safeRange) * 100;\r\n    const angle = (targetPercent / 100) * 2 * Math.PI - Math.PI / 2;\r\n    const x = 100 + (radius * Math.cos(angle));\r\n    const y = 100 + (radius * Math.sin(angle));\r\n    return { x, y };\r\n  }, [target, min, max, safeRange]);\r\n\r\n  const displayValue = useMemo(() => {\r\n    if (!showValue) return \"\";\r\n    const base = formatValue ? formatValue(clamped) : clamped.toString();\r\n    return `${prefix}${base}${suffix}`;\r\n  }, [clamped, formatValue, prefix, suffix, showValue]);\r\n\r\n  const mergedClass = [\"avakio-gage\", `avakio-gage-${size}`, className].filter(Boolean).join(\" \");\r\n  const styleVars: React.CSSProperties = {\r\n    ...style,\r\n    ...(color ? { [\"--gg-fill\" as string]: color } : null),\r\n    ...(trackColor ? { [\"--gg-track\" as string]: trackColor } : null),\r\n  };\r\n\r\n  return (\r\n    <div id={id} data-testid={testId} className={mergedClass} style={styleVars} data-percent={percent.toFixed(1)}>\r\n      {label && <div className=\"avakio-gage-label\">{label}</div>}\r\n      <div className=\"avakio-gage-shell\">\r\n        <svg viewBox=\"0 0 200 200\" role=\"img\" aria-label={label ? `${label} ${displayValue}` : displayValue}>\r\n          <circle\r\n            className=\"avakio-gage-track\"\r\n            cx=\"100\"\r\n            cy=\"100\"\r\n            r={radius}\r\n            strokeWidth={strokeWidth}\r\n          />\r\n          <circle\r\n            className=\"avakio-gage-value\"\r\n            cx=\"100\"\r\n            cy=\"100\"\r\n            r={radius}\r\n            strokeWidth={strokeWidth}\r\n            strokeDasharray={`${circumference} ${circumference}`}\r\n            strokeDashoffset={dashOffset}\r\n          />\r\n          {targetPosition && (\r\n            <circle\r\n              className=\"avakio-gage-target\"\r\n              cx={targetPosition.x}\r\n              cy={targetPosition.y}\r\n              r={6}\r\n              strokeWidth={2}\r\n            />\r\n          )}\r\n        </svg>\r\n        {showValue && (\r\n          <div className=\"avakio-gage-center\">\r\n            <div className=\"avakio-gage-value-text\">{displayValue}</div>\r\n            {subLabel && <div className=\"avakio-gage-sublabel\">{subLabel}</div>}\r\n          </div>\r\n        )}\r\n      </div>\r\n      {showMinMax && (\r\n        <div className=\"avakio-gage-minmax\">\r\n          <span>{min}</span>\r\n          <span>{max}</span>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useEffect, useMemo, useRef } from \"react\";\r\nimport \"./avakio-googlemap.css\";\r\n\r\ntype LatLng = { lat: number; lng: number };\r\n\r\ntype MapMarker = {\r\n  id?: string;\r\n  label?: string;\r\n  position: LatLng;\r\n};\r\n\r\nexport const avakioThemes = [\"material\", \"flat\", \"compact\", \"dark\", \"ocean\", \"sunset\"] as const;\r\nexport type AvakioTheme = (typeof avakioThemes)[number];\r\n\r\ndeclare global {\r\n  interface Window {\r\n    google?: any;\r\n    __avakioGooglePromise?: Promise<any>;\r\n  }\r\n}\r\n\r\nconst GOOGLE_SCRIPT_ID = \"avakio-googlemaps-script\";\r\n\r\nfunction loadGoogleMaps(apiKey: string) {\r\n  if (typeof window === \"undefined\") return Promise.reject(new Error(\"window not available\"));\r\n  if (window.google?.maps) return Promise.resolve(window.google);\r\n  if (window.__avakioGooglePromise) return window.__avakioGooglePromise;\r\n\r\n  window.__avakioGooglePromise = new Promise((resolve, reject) => {\r\n    const existing = document.getElementById(GOOGLE_SCRIPT_ID) as HTMLScriptElement | null;\r\n    if (existing) {\r\n      existing.addEventListener(\"load\", () => resolve(window.google));\r\n      existing.addEventListener(\"error\", reject);\r\n      return;\r\n    }\r\n\r\n    const script = document.createElement(\"script\");\r\n    script.id = GOOGLE_SCRIPT_ID;\r\n    script.src = `https://maps.googleapis.com/maps/api/js?key=${encodeURIComponent(apiKey)}`;\r\n    script.async = true;\r\n    script.defer = true;\r\n    script.onload = () => resolve(window.google);\r\n    script.onerror = reject;\r\n    document.head.appendChild(script);\r\n  });\r\n\r\n  return window.__avakioGooglePromise;\r\n}\r\n\r\nexport interface AvakioGoogleMapProps {\r\n  center: LatLng;\r\n  zoom?: number;\r\n  markers?: MapMarker[];\r\n  mapType?: \"roadmap\" | \"satellite\" | \"hybrid\" | \"terrain\";\r\n  height?: number | string;\r\n  className?: string;\r\n  style?: React.CSSProperties;\r\n  apiKey?: string | null;\r\n  theme?: AvakioTheme;\r\n  /** ID of the component */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n}\r\n\r\nexport function AvakioGoogleMap({\r\n  center,\r\n  zoom = 12,\r\n  markers = [],\r\n  mapType = \"roadmap\",\r\n  height = 360,\r\n  className,\r\n  style,\r\n  apiKey,\r\n  theme,\r\n  id,\r\n  testId,\r\n}: AvakioGoogleMapProps) {\r\n  const containerRef = useRef<HTMLDivElement | null>(null);\r\n  const mapRef = useRef<any>(null);\r\n  const markerRefs = useRef<any[]>([]);\r\n\r\n  const resolvedApiKey = apiKey ?? (typeof import.meta !== \"undefined\" ? (import.meta as any).env?.VITE_GOOGLE_MAPS_API_KEY : undefined) ?? null;\r\n\r\n  const iframeSrc = useMemo(() => {\r\n    const lat = center.lat.toFixed(6);\r\n    const lng = center.lng.toFixed(6);\r\n    const urlZoom = zoom ?? 12;\r\n    return `https://www.google.com/maps?q=${lat},${lng}&z=${urlZoom}&output=embed`;\r\n  }, [center.lat, center.lng, zoom]);\r\n\r\n  // Initialize interactive map when an API key is available.\r\n  useEffect(() => {\r\n    if (!resolvedApiKey || typeof window === \"undefined\") return;\r\n    let cancelled = false;\r\n\r\n    loadGoogleMaps(resolvedApiKey)\r\n      .then((google) => {\r\n        if (cancelled || !containerRef.current) return;\r\n\r\n        if (!mapRef.current) {\r\n          mapRef.current = new google.maps.Map(containerRef.current, {\r\n            center,\r\n            zoom,\r\n            mapTypeId: mapType,\r\n            streetViewControl: false,\r\n            fullscreenControl: false,\r\n          });\r\n        } else {\r\n          mapRef.current.setOptions({ center, zoom, mapTypeId: mapType });\r\n        }\r\n\r\n        // Reset markers\r\n        markerRefs.current.forEach((m) => m.setMap(null));\r\n        markerRefs.current = markers.map((marker) => new google.maps.Marker({\r\n          position: marker.position,\r\n          title: marker.label,\r\n          map: mapRef.current,\r\n        }));\r\n      })\r\n      .catch(() => {\r\n        // If script load fails we silently fall back to the embed iframe.\r\n      });\r\n\r\n    return () => {\r\n      cancelled = true;\r\n      markerRefs.current.forEach((m) => m.setMap(null));\r\n      markerRefs.current = [];\r\n    };\r\n  }, [resolvedApiKey, center.lat, center.lng, zoom, mapType, markers]);\r\n\r\n  const heightValue = typeof height === \"number\" ? `${height}px` : height;\r\n\r\n  return (\r\n    <div\r\n      id={id}\r\n      data-testid={testId}\r\n      className={[\"avakio-googlemap\", className].filter(Boolean).join(\" \")}\r\n      style={{ ...style, [\"--agm-height\" as string]: heightValue }}\r\n      data-admin-theme={theme}\r\n    >\r\n      {resolvedApiKey ? (\r\n        <div ref={containerRef} data-testid=\"avakio-googlemap-interactive\" className=\"avakio-googlemap-canvas\" />\r\n      ) : (\r\n        <iframe\r\n          data-testid=\"avakio-googlemap-embed\"\r\n          title=\"Google Map\"\r\n          src={iframeSrc}\r\n          className=\"avakio-googlemap-embed\"\r\n          allowFullScreen\r\n          loading=\"lazy\"\r\n          referrerPolicy=\"no-referrer-when-downgrade\"\r\n        />\r\n      )}\r\n\r\n      {markers.length > 0 && (\r\n        <div className=\"avakio-googlemap-markerlist\" aria-label=\"Markers\">\r\n          {markers.map((marker, idx) => (\r\n            <div key={marker.id ?? idx} className=\"avakio-googlemap-markeritem\">\r\n              <span className=\"avakio-googlemap-markerbadge\">{idx + 1}</span>\r\n              <div className=\"avakio-googlemap-markertext\">\r\n                <strong>{marker.label ?? `Marker ${idx + 1}`}</strong>\r\n                <span>{marker.position.lat}, {marker.position.lng}</span>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useState, useCallback, useMemo, useRef, useEffect } from \"react\";\r\nimport { ChevronRight, ChevronLeft } from \"lucide-react\";\r\nimport \"./avakio-grouplist.css\";\r\n\r\nexport interface GroupListItem {\r\n  /** Unique identifier for the item */\r\n  id: string | number;\r\n  /** Display value/label for the item */\r\n  value: string;\r\n  /** Optional icon to display */\r\n  icon?: React.ReactNode;\r\n  /** Child items - presence indicates this is a group header */\r\n  data?: GroupListItem[];\r\n  /** Whether the item is disabled */\r\n  disabled?: boolean;\r\n  /** Additional CSS class */\r\n  className?: string;\r\n  /** Any additional data to store */\r\n  [key: string]: any;\r\n}\r\n\r\nexport interface GroupListOpenState {\r\n  /** Array of parent IDs from root to current level */\r\n  parents: (string | number)[];\r\n  /** Items in the currently displayed branch */\r\n  branch: GroupListItem[];\r\n}\r\n\r\nexport interface AvakioGroupListProps {\r\n  /** Data source - hierarchical array of items */\r\n  data: GroupListItem[];\r\n  /** Currently selected item ID */\r\n  value?: string | number | null;\r\n  /** Default selected item ID (uncontrolled) */\r\n  defaultValue?: string | number | null;\r\n  /** Callback when an item is selected */\r\n  onSelect?: (item: GroupListItem) => void;\r\n  /** Callback when selection changes (item or null if navigating) */\r\n  onChange?: (value: string | number | null, item: GroupListItem | null) => void;\r\n  /** Callback when navigation state changes */\r\n  onNavigate?: (state: GroupListOpenState) => void;\r\n  /** Custom template for rendering items (leaf nodes) */\r\n  templateItem?: (item: GroupListItem) => React.ReactNode;\r\n  /** Custom template for rendering group headers (collapsed state - shows arrow) */\r\n  templateGroup?: (item: GroupListItem, count: number) => React.ReactNode;\r\n  /** Custom template for back button header (expanded state) */\r\n  templateBack?: (item: GroupListItem, count: number) => React.ReactNode;\r\n  /** Enable/disable item selection */\r\n  select?: boolean;\r\n  /** Enable animation when navigating */\r\n  animate?: boolean;\r\n  /** Animation duration in ms */\r\n  animationDuration?: number;\r\n  /** Show back navigation button */\r\n  showBack?: boolean;\r\n  /** Custom back button label */\r\n  backLabel?: string;\r\n  /** Width of the component */\r\n  width?: number | string;\r\n  /** Height of the component */\r\n  height?: number | string;\r\n  /** Enable scrolling */\r\n  scroll?: boolean;\r\n  /** Additional CSS class */\r\n  className?: string;\r\n  /** Inline styles */\r\n  style?: React.CSSProperties;\r\n  /** Component ID */\r\n  id?: string;\r\n  /** Test ID for testing */\r\n  testId?: string;\r\n}\r\n\r\nexport function AvakioGroupList({\r\n  data,\r\n  value: controlledValue,\r\n  defaultValue,\r\n  onSelect,\r\n  onChange,\r\n  onNavigate,\r\n  templateItem,\r\n  templateGroup,\r\n  templateBack,\r\n  select = true,\r\n  animate = true,\r\n  animationDuration = 250,\r\n  showBack = true,\r\n  backLabel = \"Back\",\r\n  width,\r\n  height,\r\n  scroll = true,\r\n  className,\r\n  style,\r\n  id,\r\n  testId,\r\n}: AvakioGroupListProps) {\r\n  // Track navigation stack (array of parent IDs)\r\n  const [parentStack, setParentStack] = useState<(string | number)[]>([]);\r\n  // Track current branch items\r\n  const [currentBranch, setCurrentBranch] = useState<GroupListItem[]>(data);\r\n  // Internal selected value for uncontrolled mode\r\n  const [internalValue, setInternalValue] = useState<string | number | null>(defaultValue ?? null);\r\n  // Animation state\r\n  const [animating, setAnimating] = useState(false);\r\n  const [animationDirection, setAnimationDirection] = useState<'forward' | 'backward'>('forward');\r\n  \r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n\r\n  // Controlled vs uncontrolled\r\n  const selectedValue = controlledValue !== undefined ? controlledValue : internalValue;\r\n\r\n  // Get items at a specific path\r\n  const getItemsAtPath = useCallback((path: (string | number)[]): GroupListItem[] => {\r\n    let items = data;\r\n    for (const parentId of path) {\r\n      const parent = items.find(item => item.id === parentId);\r\n      if (parent?.data) {\r\n        items = parent.data;\r\n      } else {\r\n        return [];\r\n      }\r\n    }\r\n    return items;\r\n  }, [data]);\r\n\r\n  // Get parent item at current level\r\n  const getCurrentParent = useCallback((): GroupListItem | null => {\r\n    if (parentStack.length === 0) return null;\r\n    \r\n    let items = data;\r\n    let parent: GroupListItem | null = null;\r\n    \r\n    for (const parentId of parentStack) {\r\n      parent = items.find(item => item.id === parentId) || null;\r\n      if (parent?.data) {\r\n        items = parent.data;\r\n      }\r\n    }\r\n    \r\n    return parent;\r\n  }, [data, parentStack]);\r\n\r\n  // Navigate into a group\r\n  const navigateInto = useCallback((item: GroupListItem) => {\r\n    if (!item.data || item.disabled) return;\r\n    \r\n    if (animate) {\r\n      setAnimating(true);\r\n      setAnimationDirection('forward');\r\n    }\r\n    \r\n    const newStack = [...parentStack, item.id];\r\n    setParentStack(newStack);\r\n    \r\n    setTimeout(() => {\r\n      setCurrentBranch(item.data!);\r\n      setAnimating(false);\r\n      \r\n      onNavigate?.({\r\n        parents: newStack,\r\n        branch: item.data!,\r\n      });\r\n    }, animate ? animationDuration : 0);\r\n  }, [parentStack, animate, animationDuration, onNavigate]);\r\n\r\n  // Navigate back one level\r\n  const navigateBack = useCallback(() => {\r\n    if (parentStack.length === 0) return;\r\n    \r\n    if (animate) {\r\n      setAnimating(true);\r\n      setAnimationDirection('backward');\r\n    }\r\n    \r\n    const newStack = parentStack.slice(0, -1);\r\n    setParentStack(newStack);\r\n    \r\n    setTimeout(() => {\r\n      const items = getItemsAtPath(newStack);\r\n      setCurrentBranch(items);\r\n      setAnimating(false);\r\n      \r\n      onNavigate?.({\r\n        parents: newStack,\r\n        branch: items,\r\n      });\r\n    }, animate ? animationDuration : 0);\r\n  }, [parentStack, animate, animationDuration, getItemsAtPath, onNavigate]);\r\n\r\n  // Handle item click\r\n  const handleItemClick = useCallback((item: GroupListItem) => {\r\n    if (item.disabled) return;\r\n    \r\n    // If item has children, navigate into it\r\n    if (item.data && item.data.length > 0) {\r\n      navigateInto(item);\r\n    } else if (select) {\r\n      // Select the item\r\n      setInternalValue(item.id);\r\n      onSelect?.(item);\r\n      onChange?.(item.id, item);\r\n    }\r\n  }, [navigateInto, select, onSelect, onChange]);\r\n\r\n  // Get open state\r\n  const getOpenState = useCallback((): GroupListOpenState => ({\r\n    parents: parentStack,\r\n    branch: currentBranch,\r\n  }), [parentStack, currentBranch]);\r\n\r\n  // Set open state programmatically\r\n  const setOpenState = useCallback((itemId: string | number) => {\r\n    // Find path to item\r\n    const findPath = (items: GroupListItem[], targetId: string | number, path: (string | number)[]): (string | number)[] | null => {\r\n      for (const item of items) {\r\n        if (item.id === targetId) {\r\n          return path;\r\n        }\r\n        if (item.data) {\r\n          const result = findPath(item.data, targetId, [...path, item.id]);\r\n          if (result) return result;\r\n        }\r\n      }\r\n      return null;\r\n    };\r\n    \r\n    const path = findPath(data, itemId, []);\r\n    if (path) {\r\n      setParentStack(path);\r\n      const items = getItemsAtPath(path);\r\n      setCurrentBranch(items);\r\n    }\r\n  }, [data, getItemsAtPath]);\r\n\r\n  // Reset to root level when data changes\r\n  useEffect(() => {\r\n    setParentStack([]);\r\n    setCurrentBranch(data);\r\n  }, [data]);\r\n\r\n  // Render a single item\r\n  const renderItem = useCallback((item: GroupListItem) => {\r\n    const isGroup = item.data && item.data.length > 0;\r\n    const isSelected = selectedValue === item.id;\r\n    const itemCount = item.data?.length || 0;\r\n    \r\n    const itemClass = [\r\n      'avakio-grouplist-item',\r\n      isGroup && 'avakio-grouplist-item-group',\r\n      isSelected && 'avakio-grouplist-item-selected',\r\n      item.disabled && 'avakio-grouplist-item-disabled',\r\n      item.className,\r\n    ].filter(Boolean).join(' ');\r\n\r\n    return (\r\n      <div\r\n        key={item.id}\r\n        className={itemClass}\r\n        onClick={() => handleItemClick(item)}\r\n        role={isGroup ? 'button' : 'option'}\r\n        aria-selected={isSelected}\r\n        aria-disabled={item.disabled}\r\n        tabIndex={item.disabled ? -1 : 0}\r\n        onKeyDown={(e) => {\r\n          if (e.key === 'Enter' || e.key === ' ') {\r\n            e.preventDefault();\r\n            handleItemClick(item);\r\n          }\r\n        }}\r\n      >\r\n        <div className=\"avakio-grouplist-item-content\">\r\n          {item.icon && <span className=\"avakio-grouplist-item-icon\">{item.icon}</span>}\r\n          <span className=\"avakio-grouplist-item-value\">\r\n            {isGroup\r\n              ? (templateGroup ? templateGroup(item, itemCount) : item.value)\r\n              : (templateItem ? templateItem(item) : item.value)\r\n            }\r\n          </span>\r\n          {isGroup && <span className=\"avakio-grouplist-item-count\">({itemCount})</span>}\r\n        </div>\r\n        {isGroup && (\r\n          <ChevronRight className=\"avakio-grouplist-item-arrow\" size={18} />\r\n        )}\r\n      </div>\r\n    );\r\n  }, [selectedValue, templateItem, templateGroup, handleItemClick]);\r\n\r\n  // Render back header\r\n  const renderBackHeader = useCallback(() => {\r\n    if (!showBack || parentStack.length === 0) return null;\r\n    \r\n    const currentParent = getCurrentParent();\r\n    const itemCount = currentBranch.length;\r\n    \r\n    return (\r\n      <div\r\n        className=\"avakio-grouplist-back\"\r\n        onClick={navigateBack}\r\n        role=\"button\"\r\n        tabIndex={0}\r\n        onKeyDown={(e) => {\r\n          if (e.key === 'Enter' || e.key === ' ') {\r\n            e.preventDefault();\r\n            navigateBack();\r\n          }\r\n        }}\r\n      >\r\n        <ChevronLeft className=\"avakio-grouplist-back-arrow\" size={18} />\r\n        <span className=\"avakio-grouplist-back-content\">\r\n          {currentParent && templateBack\r\n            ? templateBack(currentParent, itemCount)\r\n            : (currentParent?.value || backLabel)\r\n          }\r\n        </span>\r\n        <span className=\"avakio-grouplist-back-count\">({itemCount})</span>\r\n      </div>\r\n    );\r\n  }, [showBack, parentStack, currentBranch, getCurrentParent, navigateBack, templateBack, backLabel]);\r\n\r\n  // Build class names\r\n  const containerClass = useMemo(() => [\r\n    'avakio-grouplist',\r\n    animating && `avakio-grouplist-animating avakio-grouplist-${animationDirection}`,\r\n    scroll && 'avakio-grouplist-scroll',\r\n    className,\r\n  ].filter(Boolean).join(' '), [animating, animationDirection, scroll, className]);\r\n\r\n  // Build styles\r\n  const containerStyle: React.CSSProperties = useMemo(() => ({\r\n    ...style,\r\n    ...(width !== undefined ? { width: typeof width === 'number' ? `${width}px` : width } : {}),\r\n    ...(height !== undefined ? { height: typeof height === 'number' ? `${height}px` : height } : {}),\r\n    ...(animate ? { '--grouplist-animation-duration': `${animationDuration}ms` } as React.CSSProperties : {}),\r\n  }), [style, width, height, animate, animationDuration]);\r\n\r\n  return (\r\n    <div\r\n      ref={containerRef}\r\n      id={id}\r\n      data-testid={testId}\r\n      className={containerClass}\r\n      style={containerStyle}\r\n      role=\"listbox\"\r\n      aria-label=\"Group list\"\r\n    >\r\n      {renderBackHeader()}\r\n      <div className=\"avakio-grouplist-items\">\r\n        {currentBranch.map(renderItem)}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useState, useEffect, useCallback, useRef, forwardRef, useImperativeHandle } from 'react';\r\nimport { createPortal } from 'react-dom';\r\nimport './avakio-hint.css';\r\n\r\nexport type AvakioHintTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\n\r\n/**\r\n * Step configuration for AvakioHint\r\n */\r\nexport interface AvakioHintStep {\r\n  /** CSS selector or element ID (without #) for the element to highlight */\r\n  el: string;\r\n  /** Title of the hint step */\r\n  title?: string;\r\n  /** Description/instruction text */\r\n  text?: string | React.ReactNode;\r\n  /** Event that triggers moving to the next step: 'click' or 'enter' */\r\n  event?: 'click' | 'enter' | 'none';\r\n  /** Optional selector for the element that triggers the event (defaults to el) */\r\n  eventEl?: string;\r\n  /** Padding around the highlighted element - can be a number (all sides) or array [top, right, bottom, left] */\r\n  padding?: number | [number, number, number, number];\r\n  /** Custom position for the hint popup */\r\n  position?: 'top' | 'bottom' | 'left' | 'right' | 'auto';\r\n  /** Custom top offset for the hint popup */\r\n  top?: number;\r\n  /** Custom left offset for the hint popup */\r\n  left?: number;\r\n}\r\n\r\nexport interface AvakioHintProps {\r\n  /** Unique identifier */\r\n  id?: string;\r\n  /** Test ID for testing */\r\n  testId?: string;\r\n  /** Array of hint steps */\r\n  steps: AvakioHintStep[];\r\n  /** Theme to apply */\r\n  theme?: AvakioHintTheme;\r\n  /** Whether to show the Previous button */\r\n  prevButton?: boolean | string;\r\n  /** Whether to show the Next button */\r\n  nextButton?: boolean | string;\r\n  /** Label for the last step's Next button */\r\n  endLabel?: string;\r\n  /** Time in ms before auto-advancing to next step (0 = manual only) */\r\n  stepTimeout?: number;\r\n  /** Whether the hint is visible */\r\n  visible?: boolean;\r\n  /** Callback when hint starts */\r\n  onStart?: () => void;\r\n  /** Callback before hint starts */\r\n  onBeforeStart?: () => boolean | void;\r\n  /** Callback after hint starts */\r\n  onAfterStart?: () => void;\r\n  /** Callback when hint ends (last step completed) */\r\n  onEnd?: (step: number) => void;\r\n  /** Callback when hint is skipped/closed */\r\n  onSkip?: (step: number) => void;\r\n  /** Callback when moving to next step */\r\n  onNext?: (step: number) => void;\r\n  /** Callback when moving to previous step */\r\n  onPrevious?: (step: number) => void;\r\n  /** Callback when step changes */\r\n  onStepChange?: (step: number) => void;\r\n}\r\n\r\nexport interface AvakioHintRef {\r\n  /** Start showing hints from the beginning */\r\n  start: () => void;\r\n  /** End the hint tour */\r\n  end: () => void;\r\n  /** Resume from a specific step (1-indexed) */\r\n  resume: (step?: number) => void;\r\n  /** Get current step number (1-indexed) */\r\n  getCurrentStep: () => number;\r\n  /** Get all steps */\r\n  getSteps: () => AvakioHintStep[];\r\n  /** Set new steps */\r\n  setSteps: (steps: AvakioHintStep[]) => void;\r\n  /** Show the hint */\r\n  show: () => void;\r\n  /** Hide the hint */\r\n  hide: () => void;\r\n  /** Check if hint is visible */\r\n  isVisible: () => boolean;\r\n}\r\n\r\nexport const AvakioHint = forwardRef<AvakioHintRef, AvakioHintProps>((props, ref) => {\r\n  const {\r\n    id,\r\n    testId,\r\n    steps: initialSteps,\r\n    theme = 'material',\r\n    prevButton = true,\r\n    nextButton = true,\r\n    endLabel = 'End Tour',\r\n    stepTimeout = 0,\r\n    visible: controlledVisible,\r\n    onStart,\r\n    onBeforeStart,\r\n    onAfterStart,\r\n    onEnd,\r\n    onSkip,\r\n    onNext,\r\n    onPrevious,\r\n    onStepChange,\r\n  } = props;\r\n\r\n  const [steps, setSteps] = useState<AvakioHintStep[]>(initialSteps);\r\n  const [currentStep, setCurrentStep] = useState(0); // 0-indexed internally\r\n  const [isVisible, setIsVisible] = useState(false);\r\n  const [highlightRect, setHighlightRect] = useState<DOMRect | null>(null);\r\n  const [popupPosition, setPopupPosition] = useState({ top: 0, left: 0 });\r\n  const popupRef = useRef<HTMLDivElement>(null);\r\n  const timeoutRef = useRef<NodeJS.Timeout | null>(null);\r\n\r\n  // Sync with controlled visible prop\r\n  useEffect(() => {\r\n    if (controlledVisible !== undefined) {\r\n      setIsVisible(controlledVisible);\r\n    }\r\n  }, [controlledVisible]);\r\n\r\n  // Update steps when props change\r\n  useEffect(() => {\r\n    setSteps(initialSteps);\r\n  }, [initialSteps]);\r\n\r\n  // Get the target element for the current step\r\n  const getTargetElement = useCallback((selector: string): Element | null => {\r\n    if (!selector) return null;\r\n    \r\n    // Try as CSS selector first\r\n    let element = document.querySelector(selector);\r\n    if (element) return element;\r\n    \r\n    // Try as ID (without #)\r\n    element = document.getElementById(selector);\r\n    if (element) return element;\r\n    \r\n    // Try with # prefix\r\n    if (!selector.startsWith('#') && !selector.startsWith('.')) {\r\n      element = document.querySelector(`#${selector}`);\r\n      if (element) return element;\r\n    }\r\n    \r\n    return null;\r\n  }, []);\r\n\r\n  // Calculate highlight rectangle for current step\r\n  const updateHighlight = useCallback(() => {\r\n    if (!isVisible || currentStep >= steps.length) {\r\n      setHighlightRect(null);\r\n      return;\r\n    }\r\n\r\n    const step = steps[currentStep];\r\n    const element = getTargetElement(step.el);\r\n    \r\n    if (element) {\r\n      const rect = element.getBoundingClientRect();\r\n      const padding = step.padding || 8;\r\n      \r\n      // Handle array padding [top, right, bottom, left]\r\n      const [pTop, pRight, pBottom, pLeft] = Array.isArray(padding) \r\n        ? padding \r\n        : [padding, padding, padding, padding];\r\n      \r\n      setHighlightRect(new DOMRect(\r\n        rect.left - pLeft + window.scrollX,\r\n        rect.top - pTop + window.scrollY,\r\n        rect.width + pLeft + pRight,\r\n        rect.height + pTop + pBottom\r\n      ));\r\n    } else {\r\n      setHighlightRect(null);\r\n    }\r\n  }, [isVisible, currentStep, steps, getTargetElement]);\r\n\r\n  // Calculate popup position\r\n  const updatePopupPosition = useCallback(() => {\r\n    if (!highlightRect || !popupRef.current) return;\r\n\r\n    const popup = popupRef.current;\r\n    const popupRect = popup.getBoundingClientRect();\r\n    const step = steps[currentStep];\r\n    const viewportWidth = window.innerWidth;\r\n    const viewportHeight = window.innerHeight;\r\n    \r\n    let top = 0;\r\n    let left = 0;\r\n    \r\n    // Calculate based on position preference or auto\r\n    const position = step.position || 'auto';\r\n    const scrollTop = window.scrollY;\r\n    const scrollLeft = window.scrollX;\r\n    \r\n    // Adjust highlightRect for scroll position for calculations\r\n    const highlightTop = highlightRect.top - scrollTop;\r\n    const highlightLeft = highlightRect.left - scrollLeft;\r\n    const highlightBottom = highlightTop + highlightRect.height;\r\n    const highlightRight = highlightLeft + highlightRect.width;\r\n    \r\n    const gap = 16; // Gap between highlight and popup\r\n    \r\n    if (position === 'auto') {\r\n      // Prefer bottom, then top, then right, then left\r\n      const spaceBelow = viewportHeight - highlightBottom;\r\n      const spaceAbove = highlightTop;\r\n      const spaceRight = viewportWidth - highlightRight;\r\n      const spaceLeft = highlightLeft;\r\n      \r\n      if (spaceBelow >= popupRect.height + gap) {\r\n        // Position below\r\n        top = highlightRect.top + highlightRect.height + gap;\r\n        left = highlightRect.left + (highlightRect.width - popupRect.width) / 2;\r\n      } else if (spaceAbove >= popupRect.height + gap) {\r\n        // Position above\r\n        top = highlightRect.top - popupRect.height - gap;\r\n        left = highlightRect.left + (highlightRect.width - popupRect.width) / 2;\r\n      } else if (spaceRight >= popupRect.width + gap) {\r\n        // Position right\r\n        top = highlightRect.top + (highlightRect.height - popupRect.height) / 2;\r\n        left = highlightRect.left + highlightRect.width + gap;\r\n      } else {\r\n        // Position left\r\n        top = highlightRect.top + (highlightRect.height - popupRect.height) / 2;\r\n        left = highlightRect.left - popupRect.width - gap;\r\n      }\r\n    } else {\r\n      switch (position) {\r\n        case 'bottom':\r\n          top = highlightRect.top + highlightRect.height + gap;\r\n          left = highlightRect.left + (highlightRect.width - popupRect.width) / 2;\r\n          break;\r\n        case 'top':\r\n          top = highlightRect.top - popupRect.height - gap;\r\n          left = highlightRect.left + (highlightRect.width - popupRect.width) / 2;\r\n          break;\r\n        case 'right':\r\n          top = highlightRect.top + (highlightRect.height - popupRect.height) / 2;\r\n          left = highlightRect.left + highlightRect.width + gap;\r\n          break;\r\n        case 'left':\r\n          top = highlightRect.top + (highlightRect.height - popupRect.height) / 2;\r\n          left = highlightRect.left - popupRect.width - gap;\r\n          break;\r\n      }\r\n    }\r\n    \r\n    // Apply custom offsets if provided\r\n    if (step.top !== undefined) top = step.top + scrollTop;\r\n    if (step.left !== undefined) left = step.left + scrollLeft;\r\n    \r\n    // Keep popup within viewport\r\n    top = Math.max(scrollTop + 16, Math.min(top, scrollTop + viewportHeight - popupRect.height - 16));\r\n    left = Math.max(scrollLeft + 16, Math.min(left, scrollLeft + viewportWidth - popupRect.width - 16));\r\n    \r\n    setPopupPosition({ top, left });\r\n  }, [highlightRect, currentStep, steps]);\r\n\r\n  // Update highlight and popup position\r\n  useEffect(() => {\r\n    updateHighlight();\r\n  }, [updateHighlight]);\r\n\r\n  useEffect(() => {\r\n    if (highlightRect) {\r\n      // Use requestAnimationFrame to ensure popup is rendered before calculating position\r\n      requestAnimationFrame(() => {\r\n        updatePopupPosition();\r\n      });\r\n    }\r\n  }, [highlightRect, updatePopupPosition]);\r\n\r\n  // Handle window resize and scroll\r\n  useEffect(() => {\r\n    if (!isVisible) return;\r\n\r\n    const handleUpdate = () => {\r\n      updateHighlight();\r\n    };\r\n\r\n    window.addEventListener('resize', handleUpdate);\r\n    window.addEventListener('scroll', handleUpdate, true);\r\n\r\n    return () => {\r\n      window.removeEventListener('resize', handleUpdate);\r\n      window.removeEventListener('scroll', handleUpdate, true);\r\n    };\r\n  }, [isVisible, updateHighlight]);\r\n\r\n  // Go to next step function (defined before event listeners)\r\n  const goToNextStep = useCallback(() => {\r\n    if (currentStep >= steps.length - 1) {\r\n      // Last step completed\r\n      onEnd?.(currentStep + 1);\r\n      setIsVisible(false);\r\n      setCurrentStep(0);\r\n    } else {\r\n      const nextStep = currentStep + 1;\r\n      onNext?.(currentStep + 1);\r\n      onStepChange?.(nextStep + 1);\r\n      setCurrentStep(nextStep);\r\n    }\r\n  }, [currentStep, steps.length, onEnd, onNext, onStepChange]);\r\n\r\n  // Handle step event listeners\r\n  useEffect(() => {\r\n    if (!isVisible || currentStep >= steps.length) return;\r\n\r\n    const step = steps[currentStep];\r\n    if (step.event === 'none' || !step.event) return;\r\n\r\n    const eventSelector = step.eventEl || step.el;\r\n    const element = getTargetElement(eventSelector);\r\n    \r\n    if (!element) return;\r\n\r\n    const handleClick = () => {\r\n      if (step.event === 'click') {\r\n        goToNextStep();\r\n      }\r\n    };\r\n\r\n    const handleKeyDown = (e: Event) => {\r\n      if (step.event === 'enter' && (e as KeyboardEvent).key === 'Enter') {\r\n        goToNextStep();\r\n      }\r\n    };\r\n\r\n    if (step.event === 'click') {\r\n      element.addEventListener('click', handleClick, true); // Use capture phase\r\n    } else if (step.event === 'enter') {\r\n      element.addEventListener('keydown', handleKeyDown);\r\n    }\r\n\r\n    return () => {\r\n      element.removeEventListener('click', handleClick, true);\r\n      element.removeEventListener('keydown', handleKeyDown);\r\n    };\r\n  }, [isVisible, currentStep, steps, getTargetElement, goToNextStep]);\r\n\r\n  // Handle step timeout\r\n  useEffect(() => {\r\n    if (!isVisible || stepTimeout <= 0 || currentStep >= steps.length) return;\r\n\r\n    timeoutRef.current = setTimeout(() => {\r\n      goToNextStep();\r\n    }, stepTimeout);\r\n\r\n    return () => {\r\n      if (timeoutRef.current) {\r\n        clearTimeout(timeoutRef.current);\r\n      }\r\n    };\r\n  }, [isVisible, stepTimeout, currentStep, steps.length, goToNextStep]);\r\n\r\n  // Handle keyboard events (Escape to close)\r\n  useEffect(() => {\r\n    if (!isVisible) return;\r\n\r\n    const handleKeyDown = (e: KeyboardEvent) => {\r\n      if (e.key === 'Escape') {\r\n        handleSkip();\r\n      }\r\n    };\r\n\r\n    document.addEventListener('keydown', handleKeyDown);\r\n    return () => document.removeEventListener('keydown', handleKeyDown);\r\n  }, [isVisible]);\r\n\r\n  const goToPreviousStep = useCallback(() => {\r\n    if (currentStep > 0) {\r\n      const prevStep = currentStep - 1;\r\n      onPrevious?.(currentStep + 1);\r\n      onStepChange?.(prevStep + 1);\r\n      setCurrentStep(prevStep);\r\n    }\r\n  }, [currentStep, onPrevious, onStepChange]);\r\n\r\n  const handleSkip = useCallback(() => {\r\n    onSkip?.(currentStep + 1);\r\n    setIsVisible(false);\r\n    setCurrentStep(0);\r\n  }, [currentStep, onSkip]);\r\n\r\n  const start = useCallback(() => {\r\n    const shouldStart = onBeforeStart?.();\r\n    if (shouldStart === false) return;\r\n    \r\n    onStart?.();\r\n    setCurrentStep(0);\r\n    setIsVisible(true);\r\n    onAfterStart?.();\r\n  }, [onBeforeStart, onStart, onAfterStart]);\r\n\r\n  const end = useCallback(() => {\r\n    onEnd?.(currentStep + 1);\r\n    setIsVisible(false);\r\n    setCurrentStep(0);\r\n  }, [currentStep, onEnd]);\r\n\r\n  const resume = useCallback((step?: number) => {\r\n    const targetStep = step !== undefined ? Math.max(1, Math.min(step, steps.length)) - 1 : 0;\r\n    setCurrentStep(targetStep);\r\n    setIsVisible(true);\r\n    onStepChange?.(targetStep + 1);\r\n  }, [steps.length, onStepChange]);\r\n\r\n  // Expose methods via ref\r\n  useImperativeHandle(ref, () => ({\r\n    start,\r\n    end,\r\n    resume,\r\n    getCurrentStep: () => currentStep + 1,\r\n    getSteps: () => [...steps],\r\n    setSteps: (newSteps: AvakioHintStep[]) => setSteps(newSteps),\r\n    show: () => setIsVisible(true),\r\n    hide: () => setIsVisible(false),\r\n    isVisible: () => isVisible,\r\n  }), [start, end, resume, currentStep, steps, isVisible]);\r\n\r\n  if (!isVisible || steps.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  const step = steps[currentStep];\r\n  const isFirstStep = currentStep === 0;\r\n  const isLastStep = currentStep === steps.length - 1;\r\n\r\n  const prevLabel = typeof prevButton === 'string' ? prevButton : 'Previous';\r\n  const nextLabel = typeof nextButton === 'string' ? nextButton : (isLastStep ? endLabel : 'Next');\r\n  const showPrev = prevButton !== false && !isFirstStep;\r\n  const showNext = nextButton !== false;\r\n\r\n  return createPortal(\r\n    <div\r\n      id={id}\r\n      data-testid={testId}\r\n      className={`avakio-hint avakio-hint-theme-${theme}`}\r\n    >\r\n      {/* Overlay with cutout */}\r\n      <div className=\"avakio-hint-overlay\">\r\n        <svg className=\"avakio-hint-mask\" width=\"100%\" height=\"100%\">\r\n          <defs>\r\n            <mask id={`avakio-hint-mask-${id || 'default'}`}>\r\n              <rect x=\"0\" y=\"0\" width=\"100%\" height=\"100%\" fill=\"white\" />\r\n              {highlightRect && (\r\n                <rect\r\n                  x={highlightRect.left}\r\n                  y={highlightRect.top}\r\n                  width={highlightRect.width}\r\n                  height={highlightRect.height}\r\n                  rx=\"8\"\r\n                  ry=\"8\"\r\n                  fill=\"black\"\r\n                />\r\n              )}\r\n            </mask>\r\n          </defs>\r\n          <rect\r\n            x=\"0\"\r\n            y=\"0\"\r\n            width=\"100%\"\r\n            height=\"100%\"\r\n            fill=\"rgba(0, 0, 0, 0.5)\"\r\n            mask={`url(#avakio-hint-mask-${id || 'default'})`}\r\n          />\r\n        </svg>\r\n      </div>\r\n\r\n      {/* Highlight border */}\r\n      {highlightRect && (\r\n        <div\r\n          className=\"avakio-hint-highlight\"\r\n          style={{\r\n            top: highlightRect.top,\r\n            left: highlightRect.left,\r\n            width: highlightRect.width,\r\n            height: highlightRect.height,\r\n          }}\r\n        />\r\n      )}\r\n\r\n      {/* Popup */}\r\n      <div\r\n        ref={popupRef}\r\n        className=\"avakio-hint-popup\"\r\n        style={{\r\n          top: popupPosition.top,\r\n          left: popupPosition.left,\r\n        }}\r\n      >\r\n        <button\r\n          className=\"avakio-hint-close\"\r\n          onClick={handleSkip}\r\n          aria-label=\"Close hint\"\r\n        >\r\n          Ã—\r\n        </button>\r\n\r\n        {step.title && (\r\n          <div className=\"avakio-hint-title\">{step.title}</div>\r\n        )}\r\n\r\n        {step.text && (\r\n          <div className=\"avakio-hint-text\">\r\n            {typeof step.text === 'string' ? step.text : step.text}\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"avakio-hint-footer\">\r\n          <div className=\"avakio-hint-step-indicator\">\r\n            {currentStep + 1} / {steps.length}\r\n          </div>\r\n          <div className=\"avakio-hint-buttons\">\r\n            {showPrev && (\r\n              <button\r\n                className=\"avakio-hint-btn avakio-hint-btn-prev\"\r\n                onClick={goToPreviousStep}\r\n              >\r\n                {prevLabel}\r\n              </button>\r\n            )}\r\n            {showNext && (\r\n              <button\r\n                className=\"avakio-hint-btn avakio-hint-btn-next\"\r\n                onClick={goToNextStep}\r\n              >\r\n                {nextLabel}\r\n              </button>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>,\r\n    document.body\r\n  );\r\n});\r\n\r\nAvakioHint.displayName = 'AvakioHint';\r\n\r\nexport default AvakioHint;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useEffect, useRef, useState, useCallback } from 'react';\r\nimport './avakio-view.css';\r\n\r\nexport interface AvakioViewProps {\r\n  /** The content to display inside the view */\r\n  children?: React.ReactNode;\r\n  \r\n  /** Custom CSS class name */\r\n  className?: string;\r\n  \r\n  /** Custom CSS styles object */\r\n  css?: React.CSSProperties;\r\n  \r\n  /** Width of the view */\r\n  width?: number | string;\r\n  \r\n  /** Height of the view */\r\n  height?: number | string;\r\n  \r\n  /** Minimum width */\r\n  minWidth?: number | string;\r\n  \r\n  /** Minimum height */\r\n  minHeight?: number | string;\r\n  \r\n  /** Maximum width */\r\n  maxWidth?: number | string;\r\n  \r\n  /** Maximum height */\r\n  maxHeight?: number | string;\r\n  \r\n  /** Whether to remove borders */\r\n  borderless?: boolean;\r\n  \r\n  /** Whether the view is initially hidden */\r\n  hidden?: boolean;\r\n  \r\n  /** Whether the view is disabled */\r\n  disabled?: boolean;\r\n  \r\n  /** View gravity for flexible layouts */\r\n  gravity?: number;\r\n  \r\n  /** ID of the view */\r\n  id?: string;\r\n  \r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n  \r\n  /** Animation type for showing/hiding */\r\n  animate?: boolean | 'fade' | 'slide' | 'flip';\r\n  \r\n  /** Container element or selector */\r\n  container?: string | HTMLElement;\r\n  \r\n  /** Padding inside the view - can be a number (all sides), string, or array [top, right, bottom, left] */\r\n  padding?: number | string | [number, number, number, number];\r\n  \r\n  /** Theme to apply */\r\n  theme?: 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\n  \r\n  /** View type (header, section, clean) */\r\n  type?: 'header' | 'section' | 'clean';\r\n  \r\n  /** Event handlers */\r\n  onShow?: () => void;\r\n  onHide?: () => void;\r\n  onResize?: (width: number, height: number) => void;\r\n  onClick?: (e: React.MouseEvent) => void;\r\n  onFocus?: () => void;\r\n  onBlur?: () => void;\r\n  onKeyPress?: (e: React.KeyboardEvent) => void;\r\n}\r\n\r\nexport function AvakioView({\r\n  children,\r\n  className = '',\r\n  css,\r\n  width,\r\n  height,\r\n  minWidth,\r\n  minHeight,\r\n  maxWidth,\r\n  maxHeight,\r\n  borderless = false,\r\n  hidden = false,\r\n  disabled = false,\r\n  gravity,\r\n  id,\r\n  testId,\r\n  animate = false,\r\n  padding,\r\n  theme = 'material',\r\n  type = 'clean',\r\n  onShow,\r\n  onHide,\r\n  onResize,\r\n  onClick,\r\n  onFocus,\r\n  onBlur,\r\n  onKeyPress,\r\n}: AvakioViewProps) {\r\n  const viewRef = useRef<HTMLDivElement>(null);\r\n  const [isVisible, setIsVisible] = useState(!hidden);\r\n  const [isEnabled, setIsEnabled] = useState(!disabled);\r\n  const [dimensions, setDimensions] = useState({ width: 0, height: 0 });\r\n\r\n  // Handle visibility\r\n  useEffect(() => {\r\n    setIsVisible(!hidden);\r\n  }, [hidden]);\r\n\r\n  // Handle disabled state\r\n  useEffect(() => {\r\n    setIsEnabled(!disabled);\r\n  }, [disabled]);\r\n\r\n  // Resize observer\r\n  useEffect(() => {\r\n    if (!viewRef.current) return;\r\n\r\n    const resizeObserver = new ResizeObserver((entries) => {\r\n      for (const entry of entries) {\r\n        const { width, height } = entry.contentRect;\r\n        setDimensions({ width, height });\r\n        if (onResize) {\r\n          onResize(width, height);\r\n        }\r\n      }\r\n    });\r\n\r\n    resizeObserver.observe(viewRef.current);\r\n\r\n    return () => {\r\n      resizeObserver.disconnect();\r\n    };\r\n  }, [onResize]);\r\n\r\n  // Show/hide callbacks\r\n  useEffect(() => {\r\n    if (isVisible && onShow) {\r\n      onShow();\r\n    } else if (!isVisible && onHide) {\r\n      onHide();\r\n    }\r\n  }, [isVisible, onShow, onHide]);\r\n\r\n  // Public methods via ref (can be exposed if needed)\r\n  const show = useCallback(() => {\r\n    setIsVisible(true);\r\n  }, []);\r\n\r\n  const hide = useCallback(() => {\r\n    setIsVisible(false);\r\n  }, []);\r\n\r\n  const enable = useCallback(() => {\r\n    setIsEnabled(true);\r\n  }, []);\r\n\r\n  const disable = useCallback(() => {\r\n    setIsEnabled(false);\r\n  }, []);\r\n\r\n  const resize = useCallback((newWidth?: number | string, newHeight?: number | string) => {\r\n    if (viewRef.current) {\r\n      if (newWidth) viewRef.current.style.width = typeof newWidth === 'number' ? `${newWidth}px` : newWidth;\r\n      if (newHeight) viewRef.current.style.height = typeof newHeight === 'number' ? `${newHeight}px` : newHeight;\r\n    }\r\n  }, []);\r\n\r\n  // Build inline styles\r\n  const inlineStyles: React.CSSProperties = {\r\n    ...(css && typeof css === 'object' && !Array.isArray(css) ? css : {}),\r\n    ...(typeof width !== 'undefined' && { width: typeof width === 'number' ? `${width}px` : width }),\r\n    ...(typeof height !== 'undefined' && { height: typeof height === 'number' ? `${height}px` : height }),\r\n    ...(typeof minWidth !== 'undefined' && { minWidth: typeof minWidth === 'number' ? `${minWidth}px` : minWidth }),\r\n    ...(typeof minHeight !== 'undefined' && { minHeight: typeof minHeight === 'number' ? `${minHeight}px` : minHeight }),\r\n    ...(typeof maxWidth !== 'undefined' && { maxWidth: typeof maxWidth === 'number' ? `${maxWidth}px` : maxWidth }),\r\n    ...(typeof maxHeight !== 'undefined' && { maxHeight: typeof maxHeight === 'number' ? `${maxHeight}px` : maxHeight }),\r\n    ...(typeof padding !== 'undefined' && { \r\n      padding: Array.isArray(padding) \r\n        ? `${padding[0]}px ${padding[1]}px ${padding[2]}px ${padding[3]}px`\r\n        : typeof padding === 'number' ? `${padding}px` : padding \r\n    }),\r\n    ...(typeof gravity !== 'undefined' && { flex: gravity }),\r\n  };\r\n\r\n  // Build class names\r\n  const getAnimationClass = () => {\r\n    if (!animate) return '';\r\n    if (animate === true) return 'avakio-view-animate-fade';\r\n    if (animate === 'fade') return 'avakio-view-animate-fade';\r\n    if (animate === 'slide') return 'avakio-view-animate-slide';\r\n    if (animate === 'flip') return 'avakio-view-animate-flip';\r\n    return '';\r\n  };\r\n\r\n  const classNames = [\r\n    'avakio-view',\r\n    `avakio-view-theme-${theme}`,\r\n    type ? `avakio-view-type-${type}` : '',\r\n    borderless ? 'avakio-view-borderless' : '',\r\n    !isVisible ? 'avakio-view-hidden' : '',\r\n    !isEnabled ? 'avakio-view-disabled' : '',\r\n    getAnimationClass(),\r\n    className,\r\n  ]\r\n    .filter(Boolean)\r\n    .join(' ');\r\n\r\n  // Handle focus\r\n  const handleFocus = useCallback(() => {\r\n    if (onFocus && isEnabled) {\r\n      onFocus();\r\n    }\r\n  }, [onFocus, isEnabled]);\r\n\r\n  const handleBlur = useCallback(() => {\r\n    if (onBlur && isEnabled) {\r\n      onBlur();\r\n    }\r\n  }, [onBlur, isEnabled]);\r\n\r\n  const handleClick = useCallback(\r\n    (e: React.MouseEvent) => {\r\n      if (onClick && isEnabled) {\r\n        onClick(e);\r\n      }\r\n    },\r\n    [onClick, isEnabled]\r\n  );\r\n\r\n  const handleKeyPress = useCallback(\r\n    (e: React.KeyboardEvent) => {\r\n      if (onKeyPress && isEnabled) {\r\n        onKeyPress(e);\r\n      }\r\n    },\r\n    [onKeyPress, isEnabled]\r\n  );\r\n\r\n  if (!isVisible) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div\r\n      ref={viewRef}\r\n      id={id}\r\n      data-testid={testId}\r\n      className={classNames}\r\n      style={inlineStyles}\r\n      onClick={handleClick}\r\n      onFocus={handleFocus}\r\n      onBlur={handleBlur}\r\n      onKeyDown={handleKeyPress}\r\n      tabIndex={isEnabled ? 0 : -1}\r\n      role=\"region\"\r\n      aria-disabled={!isEnabled}\r\n    >\r\n      {children}\r\n    </div>\r\n  );\r\n}\r\n\r\n// Export a version with imperative handle for advanced usage\r\nexport interface AvakioViewHandle {\r\n  show: () => void;\r\n  hide: () => void;\r\n  enable: () => void;\r\n  disable: () => void;\r\n  resize: (width?: number | string, height?: number | string) => void;\r\n  getNode: () => HTMLDivElement | null;\r\n  isVisible: () => boolean;\r\n  isEnabled: () => boolean;\r\n}\r\n\r\nexport const AvakioViewWithRef = React.forwardRef<AvakioViewHandle, AvakioViewProps>(\r\n  (props, ref) => {\r\n    const viewRef = useRef<HTMLDivElement>(null);\r\n    const [isVisible, setIsVisible] = useState(!props.hidden);\r\n    const [isEnabled, setIsEnabled] = useState(!props.disabled);\r\n\r\n    React.useImperativeHandle(ref, () => ({\r\n      show: () => setIsVisible(true),\r\n      hide: () => setIsVisible(false),\r\n      enable: () => setIsEnabled(true),\r\n      disable: () => setIsEnabled(false),\r\n      resize: (newWidth?: number | string, newHeight?: number | string) => {\r\n        if (viewRef.current) {\r\n          if (newWidth) viewRef.current.style.width = typeof newWidth === 'number' ? `${newWidth}px` : newWidth;\r\n          if (newHeight) viewRef.current.style.height = typeof newHeight === 'number' ? `${newHeight}px` : newHeight;\r\n        }\r\n      },\r\n      getNode: () => viewRef.current,\r\n      isVisible: () => isVisible,\r\n      isEnabled: () => isEnabled,\r\n    }));\r\n\r\n    return <AvakioView {...props} hidden={!isVisible} disabled={!isEnabled} />;\r\n  }\r\n);\r\n\r\nAvakioViewWithRef.displayName = 'AvakioViewWithRef';\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React from 'react';\r\nimport { AvakioView } from '../../views/avakio-view/avakio-view';\r\n\r\nexport interface AvakioViewHeaderProps {\r\n  /** Component ID */\r\n  id?: string;\r\n  /** Test ID for testing */\r\n  testId?: string;\r\n  /** Show/hide the label */\r\n  showLabel?: boolean;\r\n  /** Show/hide the title */\r\n  showTitle?: boolean;\r\n  /** Show/hide the subtitle */\r\n  showSubTitle?: boolean;\r\n  /** Label text */\r\n  label?: string;\r\n  /** Title text */\r\n  title?: string;\r\n  /** Subtitle text */\r\n  subTitle?: string;\r\n  /** Theme (material, flat, compact, dark, ocean, sunset) */\r\n  theme?: string;\r\n  /** Custom CSS class */\r\n  className?: string;\r\n  /** Custom styles */\r\n  style?: React.CSSProperties;\r\n  /** Whether the header should stick to the top when scrolling */\r\n  isSticky?: boolean;\r\n}\r\n\r\nexport const AvakioViewHeader: React.FC<AvakioViewHeaderProps> = ({\r\n  id,\r\n  testId,\r\n  showLabel = true,\r\n  showTitle = true,\r\n  showSubTitle = true,\r\n  label = '',\r\n  title = '',\r\n  subTitle = '',\r\n  theme,\r\n  className = '',\r\n  style = {},\r\n  isSticky = true,\r\n}) => {\r\n  const wrapperStyle = isSticky ? { position: 'sticky' as const, top: 0, zIndex: 1000 } : {};\r\n  \r\n  // Only set data-admin-theme if theme is explicitly provided\r\n  const wrapperProps: React.HTMLAttributes<HTMLDivElement> & { 'data-admin-theme'?: string } = {\r\n    style: wrapperStyle,\r\n  };\r\n  if (theme) {\r\n    wrapperProps['data-admin-theme'] = theme;\r\n  }\r\n  \r\n  return (\r\n    <div {...wrapperProps}>\r\n    <AvakioView\r\n        theme={theme as any}\r\n        type=\"header\"\r\n        borderless={false}\r\n        id={id}\r\n        testId={testId}\r\n        css={{ \r\n          ...style, \r\n          display: 'flex', \r\n          justifyContent: 'flex-start', \r\n          alignItems: 'flex-start',\r\n          background: 'var(--view-focus-color)',\r\n          color: '#ffffff'\r\n        }}\r\n        className={className}\r\n    >\r\n        <div style={{ textAlign: 'left' }}>\r\n            {showLabel && label && (\r\n                <div style={{ \r\n                    margin: 0, \r\n                    marginBottom: '8px', \r\n                    fontSize: '14px', \r\n                    fontWeight: 500,\r\n                    lineHeight: '1.5',\r\n                    fontFamily: '-apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, sans-serif',\r\n                    color: 'inherit'\r\n                }}>\r\n                    {label}\r\n                </div>\r\n            )}\r\n            {showTitle && title && (\r\n                <h1 style={{ \r\n                    margin: 0, \r\n                    fontSize: '24px', \r\n                    fontWeight: 600,                    \r\n                    letterSpacing: '0.01em',\r\n                    lineHeight: '1.2',\r\n                    fontFamily: '-apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, sans-serif',\r\n                    WebkitFontSmoothing: 'antialiased',\r\n                    color: 'inherit'\r\n                }}>\r\n                    {title}\r\n                </h1>\r\n            )}\r\n            {showSubTitle && subTitle && (\r\n                <p style={{ \r\n                    margin: 0, \r\n                    marginTop: '8px', \r\n                    fontSize: '14px', \r\n                    fontWeight: 500,\r\n                    lineHeight: '1.5',\r\n                    fontFamily: '-apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, sans-serif',\r\n                    color: 'inherit'\r\n                }}>\r\n                    {subTitle}\r\n                </p>\r\n            )}  \r\n        </div>                            \r\n    </AvakioView>\r\n    </div>\r\n  );\r\n};\r\n\r\nAvakioViewHeader.displayName = 'AvakioViewHeader';\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, {\r\n  forwardRef,\r\n  useImperativeHandle,\r\n  useState,\r\n  useRef,\r\n  useEffect,\r\n  useMemo,\r\n  CSSProperties,\r\n  ReactNode,\r\n} from 'react';\r\nimport './avakio-multiview.css';\r\n\r\n// Types\r\nexport type AvakioMultiviewTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\nexport type AvakioMultiviewAnimationType = 'slide' | 'flip' | 'none';\r\nexport type AvakioMultiviewSlideDirection = 'left' | 'right' | 'top' | 'bottom';\r\nexport type AvakioMultiviewFlipDirection = 'horizontal' | 'vertical';\r\n\r\nexport interface AvakioMultiviewCell {\r\n  /** Unique identifier for the cell */\r\n  id: string;\r\n  /** Content to render in this cell */\r\n  content: ReactNode;\r\n  /** Optional CSS class for this cell */\r\n  className?: string;\r\n  /** Optional inline styles for this cell */\r\n  css?: CSSProperties;\r\n}\r\n\r\nexport interface AvakioMultiviewAnimateConfig {\r\n  /** Animation type */\r\n  type?: AvakioMultiviewAnimationType;\r\n  /** Animation duration in ms */\r\n  duration?: number;\r\n  /** Animation direction for slide (left, right, top, bottom) */\r\n  direction?: AvakioMultiviewSlideDirection;\r\n  /** Animation direction for flip (horizontal, vertical) */\r\n  flipDirection?: AvakioMultiviewFlipDirection;\r\n}\r\n\r\nexport interface AvakioMultiviewProps {\r\n  /** Unique identifier */\r\n  id?: string;\r\n  /** Test ID for testing */\r\n  testId?: string;\r\n  /** Array of view cells */\r\n  cells: AvakioMultiviewCell[];\r\n  /** Initially active view ID (defaults to first cell) */\r\n  activeView?: string;\r\n  /** Animation configuration */\r\n  animate?: boolean | AvakioMultiviewAnimateConfig;\r\n  /** Keep inactive views in DOM */\r\n  keepViews?: boolean;\r\n  /** Size container to biggest cell */\r\n  fitBiggest?: boolean;\r\n  /** Theme */\r\n  theme?: AvakioMultiviewTheme;\r\n  /** Custom CSS class */\r\n  className?: string;\r\n  /** Inline styles */\r\n  css?: CSSProperties;\r\n  /** Width */\r\n  width?: number | string;\r\n  /** Height */\r\n  height?: number | string;\r\n  /** Fired when view changes */\r\n  onViewChange?: (newViewId: string, oldViewId: string) => void;\r\n  /** Fired when a view is shown */\r\n  onViewShow?: (viewId: string) => void;\r\n  /** Fired before going back */\r\n  onBeforeBack?: (currentViewId: string) => boolean | void;\r\n}\r\n\r\nexport interface AvakioMultiviewRef {\r\n  /** Get the ID of the currently active view */\r\n  getValue: () => string;\r\n  /** Alias for getValue */\r\n  getActiveId: () => string;\r\n  /** Switch to a specific view */\r\n  setValue: (viewId: string) => void;\r\n  /** Go back to the previous view */\r\n  back: () => boolean;\r\n  /** Add a new view dynamically */\r\n  addView: (cell: AvakioMultiviewCell, index?: number) => void;\r\n  /** Remove a view by ID */\r\n  removeView: (viewId: string) => boolean;\r\n  /** Get all view IDs */\r\n  getViews: () => string[];\r\n  /** Check if a view exists */\r\n  hasView: (viewId: string) => boolean;\r\n  /** Get the view history */\r\n  getHistory: () => string[];\r\n  /** Clear navigation history */\r\n  clearHistory: () => void;\r\n  /** Show the component */\r\n  show: () => void;\r\n  /** Hide the component */\r\n  hide: () => void;\r\n  /** Check if visible */\r\n  isVisible: () => boolean;\r\n}\r\n\r\n/**\r\n * Get the opposite direction for back navigation\r\n */\r\nfunction getOppositeDirection(direction: AvakioMultiviewSlideDirection): AvakioMultiviewSlideDirection {\r\n  const opposites: Record<AvakioMultiviewSlideDirection, AvakioMultiviewSlideDirection> = {\r\n    left: 'right',\r\n    right: 'left',\r\n    top: 'bottom',\r\n    bottom: 'top',\r\n  };\r\n  return opposites[direction];\r\n}\r\n\r\nexport const AvakioMultiview = forwardRef<AvakioMultiviewRef, AvakioMultiviewProps>(\r\n  (\r\n    {\r\n      id,\r\n      testId,\r\n      cells: initialCells,\r\n      activeView,\r\n      animate = true,\r\n      keepViews = false,\r\n      fitBiggest = false,\r\n      theme = 'material',\r\n      className,\r\n      css,\r\n      width,\r\n      height,\r\n      onViewChange,\r\n      onViewShow,\r\n      onBeforeBack,\r\n    },\r\n    ref\r\n  ) => {\r\n    // Compute animation config directly from props (no memoization to avoid stale values)\r\n    let animationType: AvakioMultiviewAnimationType = 'slide';\r\n    let animationDuration = 300;\r\n    let animationDirection: AvakioMultiviewSlideDirection = 'left';\r\n    let animationFlipDirection: AvakioMultiviewFlipDirection = 'horizontal';\r\n    \r\n    if (typeof animate === 'object' && animate !== null) {\r\n      animationType = animate.type ?? 'slide';\r\n      animationDuration = animate.duration ?? 300;\r\n      animationDirection = animate.direction ?? 'left';\r\n      animationFlipDirection = animate.flipDirection ?? 'horizontal';\r\n    } else if (typeof animate === 'boolean') {\r\n      animationType = animate ? 'slide' : 'none';\r\n    }\r\n    \r\n    // Validate animation type\r\n    if (!['slide', 'flip', 'none'].includes(animationType)) {\r\n      animationType = 'slide';\r\n    }\r\n    \r\n    // Ensure minimum duration\r\n    animationDuration = Math.max(animationDuration, 200);\r\n    \r\n    const animateConfig: AvakioMultiviewAnimateConfig = {\r\n      type: animationType,\r\n      duration: animationDuration,\r\n      direction: animationDirection,\r\n      flipDirection: animationFlipDirection,\r\n    };\r\n\r\n    // State\r\n    const [cells, setCells] = useState<AvakioMultiviewCell[]>(initialCells);\r\n    const [currentViewId, setCurrentViewId] = useState<string>(\r\n      activeView || initialCells[0]?.id || ''\r\n    );\r\n    const [previousViewId, setPreviousViewId] = useState<string | null>(null);\r\n    const [isAnimating, setIsAnimating] = useState(false);\r\n    const [activeDirection, setActiveDirection] = useState<AvakioMultiviewSlideDirection>(\r\n      animateConfig.direction || 'left'\r\n    );\r\n    const [hidden, setHidden] = useState(false);\r\n\r\n    // Refs for avoiding stale closures\r\n    const historyRef = useRef<string[]>([activeView || initialCells[0]?.id || '']);\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n    const cellsRef = useRef<AvakioMultiviewCell[]>(initialCells);\r\n    const currentViewIdRef = useRef<string>(activeView || initialCells[0]?.id || '');\r\n    const isAnimatingRef = useRef(false);\r\n    const animationTimeoutRef = useRef<ReturnType<typeof setTimeout> | null>(null);\r\n    const animateConfigRef = useRef(animateConfig);\r\n\r\n    // Keep animateConfig ref updated\r\n    useEffect(() => {\r\n      animateConfigRef.current = animateConfig;\r\n    }, [animateConfig.type, animateConfig.direction, animateConfig.duration]);\r\n\r\n    // Update cells if prop changes\r\n    useEffect(() => {\r\n      setCells(initialCells);\r\n      cellsRef.current = initialCells;\r\n    }, [initialCells]);\r\n\r\n    // Keep refs in sync with state\r\n    useEffect(() => {\r\n      cellsRef.current = cells;\r\n    }, [cells]);\r\n\r\n    useEffect(() => {\r\n      currentViewIdRef.current = currentViewId;\r\n    }, [currentViewId]);\r\n\r\n    // Cleanup animation timeout on unmount\r\n    useEffect(() => {\r\n      return () => {\r\n        if (animationTimeoutRef.current) {\r\n          clearTimeout(animationTimeoutRef.current);\r\n        }\r\n      };\r\n    }, []);\r\n\r\n    /**\r\n     * Core view switching function with animation\r\n     */\r\n    const switchView = (\r\n      newViewId: string,\r\n      direction: AvakioMultiviewSlideDirection\r\n    ) => {\r\n      // Guard: same view or already animating\r\n      const currentId = currentViewIdRef.current;\r\n      if (newViewId === currentId || isAnimatingRef.current) return;\r\n\r\n      // Guard: view must exist\r\n      if (!cellsRef.current.find((c) => c.id === newViewId)) return;\r\n\r\n      const oldViewId = currentId;\r\n\r\n      // Clear any pending animation timeout\r\n      if (animationTimeoutRef.current) {\r\n        clearTimeout(animationTimeoutRef.current);\r\n      }\r\n\r\n      // Add to history\r\n      historyRef.current.push(newViewId);\r\n\r\n      // Start animation\r\n      setActiveDirection(direction);\r\n      setPreviousViewId(oldViewId);\r\n      setCurrentViewId(newViewId);\r\n      currentViewIdRef.current = newViewId;\r\n      setIsAnimating(true);\r\n      isAnimatingRef.current = true;\r\n\r\n      // Fire callbacks\r\n      onViewChange?.(newViewId, oldViewId);\r\n      onViewShow?.(newViewId);\r\n\r\n      // End animation after duration\r\n      animationTimeoutRef.current = setTimeout(() => {\r\n        setIsAnimating(false);\r\n        isAnimatingRef.current = false;\r\n        setPreviousViewId(null);\r\n      }, animationDuration);\r\n    };\r\n\r\n    // Imperative methods\r\n    useImperativeHandle(ref, () => ({\r\n      getValue: () => currentViewIdRef.current,\r\n      getActiveId: () => currentViewIdRef.current,\r\n\r\n      setValue: (viewId: string) => {\r\n        // Use the configured direction from animate prop\r\n        switchView(viewId, animateConfigRef.current.direction || 'left');\r\n      },\r\n\r\n      back: () => {\r\n        if (historyRef.current.length <= 1) return false;\r\n\r\n        const currentId = currentViewIdRef.current;\r\n        const shouldProceed = onBeforeBack?.(currentId);\r\n        if (shouldProceed === false) return false;\r\n\r\n        // Remove current from history\r\n        historyRef.current.pop();\r\n        const targetId = historyRef.current[historyRef.current.length - 1];\r\n\r\n        if (targetId) {\r\n          // Clear any pending animation timeout\r\n          if (animationTimeoutRef.current) {\r\n            clearTimeout(animationTimeoutRef.current);\r\n          }\r\n\r\n          const oldViewId = currentId;\r\n          // Use opposite direction for back navigation\r\n          const backDirection = getOppositeDirection(animateConfigRef.current.direction || 'left');\r\n\r\n          // Start animation\r\n          setActiveDirection(backDirection);\r\n          setPreviousViewId(oldViewId);\r\n          setCurrentViewId(targetId);\r\n          currentViewIdRef.current = targetId;\r\n          setIsAnimating(true);\r\n          isAnimatingRef.current = true;\r\n\r\n          // Fire callbacks\r\n          onViewChange?.(targetId, oldViewId);\r\n          onViewShow?.(targetId);\r\n\r\n          // End animation after duration\r\n          animationTimeoutRef.current = setTimeout(() => {\r\n            setIsAnimating(false);\r\n            isAnimatingRef.current = false;\r\n            setPreviousViewId(null);\r\n          }, animationDuration);\r\n\r\n          return true;\r\n        }\r\n        return false;\r\n      },\r\n\r\n      addView: (cell: AvakioMultiviewCell, index?: number) => {\r\n        if (cellsRef.current.find((c) => c.id === cell.id)) return;\r\n\r\n        if (index !== undefined) {\r\n          const newCells = [...cellsRef.current];\r\n          newCells.splice(index, 0, cell);\r\n          cellsRef.current = newCells;\r\n        } else {\r\n          cellsRef.current = [...cellsRef.current, cell];\r\n        }\r\n\r\n        setCells([...cellsRef.current]);\r\n      },\r\n\r\n      removeView: (viewId: string) => {\r\n        if (viewId === currentViewIdRef.current) return false;\r\n        const newCells = cellsRef.current.filter((c) => c.id !== viewId);\r\n        cellsRef.current = newCells;\r\n        setCells(newCells);\r\n        historyRef.current = historyRef.current.filter((id) => id !== viewId);\r\n        return true;\r\n      },\r\n\r\n      getViews: () => cellsRef.current.map((c) => c.id),\r\n\r\n      hasView: (viewId: string) => cellsRef.current.some((c) => c.id === viewId),\r\n\r\n      getHistory: () => [...historyRef.current],\r\n\r\n      clearHistory: () => {\r\n        historyRef.current = [currentViewIdRef.current];\r\n      },\r\n\r\n      show: () => setHidden(false),\r\n      hide: () => setHidden(true),\r\n      isVisible: () => !hidden,\r\n    }));\r\n\r\n    // Build class names\r\n    const containerClasses = [\r\n      'avakio-multiview',\r\n      `avakio-multiview-theme-${theme}`,\r\n      `avakio-multiview-animate-${animateConfig.type}`,\r\n      animateConfig.type === 'flip' && `avakio-multiview-flip-${animateConfig.flipDirection}`,\r\n      fitBiggest && 'avakio-multiview-fit-biggest',\r\n      isAnimating && 'avakio-multiview-animating',\r\n      hidden && 'avakio-multiview-hidden',\r\n      className,\r\n    ]\r\n      .filter(Boolean)\r\n      .join(' ');\r\n\r\n    // Build styles\r\n    const containerStyle: CSSProperties = {\r\n      ...(css && typeof css === 'object' && !Array.isArray(css) ? css : {}),\r\n      width: width,\r\n      height: height,\r\n      '--animation-duration': `${animationDuration}ms`,\r\n    } as CSSProperties;\r\n\r\n    // Determine which cells to render\r\n    const allCells = cellsRef.current;\r\n    const activeViewId = currentViewId;\r\n    const cellsToRender = keepViews\r\n      ? allCells\r\n      : allCells.filter(\r\n          (c) =>\r\n            c.id === activeViewId || (isAnimating && c.id === previousViewId)\r\n        );\r\n\r\n    return (\r\n      <div\r\n        ref={containerRef}\r\n        id={id}\r\n        data-testid={testId}\r\n        className={containerClasses}\r\n        style={containerStyle}\r\n      >\r\n        <div className=\"avakio-multiview-cells\">\r\n          {cellsToRender.map((cell) => {\r\n            const isActive = cell.id === activeViewId;\r\n            const isLeaving = isAnimating && cell.id === previousViewId;\r\n            const isEntering = isAnimating && isActive;\r\n\r\n            const cellClasses = [\r\n              'avakio-multiview-cell',\r\n              isActive && !isEntering && 'avakio-multiview-cell-active',\r\n              isEntering && `avakio-multiview-cell-entering-${activeDirection}`,\r\n              isLeaving && `avakio-multiview-cell-leaving-${activeDirection}`,\r\n              !isActive && !isLeaving && 'avakio-multiview-cell-hidden',\r\n              cell.className,\r\n            ]\r\n              .filter(Boolean)\r\n              .join(' ');\r\n\r\n            const cellStyle: CSSProperties = { ...cell.css };\r\n            if (isEntering || isLeaving) {\r\n              cellStyle.animationDuration = `${animationDuration}ms`;\r\n              cellStyle.animationTimingFunction = 'ease-out';\r\n              cellStyle.animationFillMode = 'both';\r\n              cellStyle.animationPlayState = 'running';\r\n            }\r\n\r\n            return (\r\n              <div\r\n                key={cell.id}\r\n                data-view-id={cell.id}\r\n                className={cellClasses}\r\n                style={cellStyle}\r\n              >\r\n                {cell.content}\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nAvakioMultiview.displayName = 'AvakioMultiview';\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { forwardRef, useImperativeHandle, useState, useRef, useEffect } from 'react';\r\nimport './avakio-template.css';\r\n\r\nexport type AvakioTemplateTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\nexport type AvakioTemplateBorderType = 'space' | 'wide' | 'clean' | 'line' | 'material';\r\nexport type AvakioTemplateType = 'header' | 'section' | 'clean';\r\n\r\nexport interface AvakioTemplateProps {\r\n  /** Template string or function that returns HTML/JSX */\r\n  template?: string | ((data: any) => React.ReactNode);\r\n  \r\n  /** Data object to populate the template */\r\n  data?: Record<string, any>;\r\n  \r\n  /** Direct HTML content (alternative to template) */\r\n  content?: React.ReactNode;\r\n  \r\n  /** URL to load content from */\r\n  url?: string;\r\n  \r\n  /** Theme to apply */\r\n  theme?: AvakioTemplateTheme;\r\n  \r\n  /** Border type */\r\n  borderType?: AvakioTemplateBorderType;\r\n  \r\n  /** Template type (header, section, clean) */\r\n  type?: AvakioTemplateType;\r\n  \r\n  /** Whether to remove borders */\r\n  borderless?: boolean;\r\n  \r\n  /** Auto-height based on content */\r\n  autoheight?: boolean;\r\n  \r\n  /** Enable scrolling */\r\n  scroll?: boolean | 'x' | 'y' | 'xy';\r\n  \r\n  /** Width of the template */\r\n  width?: number | string;\r\n  \r\n  /** Height of the template */\r\n  height?: number | string;\r\n  \r\n  /** Minimum width */\r\n  minWidth?: number | string;\r\n  \r\n  /** Minimum height */\r\n  minHeight?: number | string;\r\n  \r\n  /** Maximum width */\r\n  maxWidth?: number | string;\r\n  \r\n  /** Maximum height */\r\n  maxHeight?: number | string;\r\n  \r\n  /** Padding around content - can be a number (all sides), string, or array [top, right, bottom, left] */\r\n  padding?: number | string | [number, number, number, number];\r\n  \r\n  /** Margin around template - can be a number (all sides), string, or array [top, right, bottom, left] */\r\n  margin?: number | string | [number, number, number, number];\r\n  \r\n  /** Custom CSS class */\r\n  className?: string;\r\n  \r\n  /** Custom CSS styles */\r\n  css?: React.CSSProperties;\r\n  \r\n  /** Whether the template is hidden */\r\n  hidden?: boolean;\r\n  \r\n  /** Whether the template is disabled */\r\n  disabled?: boolean;\r\n  \r\n  /** ID of the template */\r\n  id?: string;\r\n  \r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n  \r\n  /** Callback when content is loaded */\r\n  onLoad?: () => void;\r\n  \r\n  /** Callback when content changes */\r\n  onChange?: (data: any) => void;\r\n  \r\n  /** Callback on click */\r\n  onClick?: (e: React.MouseEvent) => void;\r\n}\r\n\r\nexport interface AvakioTemplateRef {\r\n  /** Set values/data for the template */\r\n  setValues: (data: Record<string, any>) => void;\r\n  \r\n  /** Get current values/data */\r\n  getValues: () => Record<string, any>;\r\n  \r\n  /** Set HTML content directly */\r\n  setHTML: (html: string) => void;\r\n  \r\n  /** Get current HTML content */\r\n  getHTML: () => string;\r\n  \r\n  /** Refresh/re-render the template */\r\n  refresh: () => void;\r\n  \r\n  /** Parse and apply new data */\r\n  parse: (data: Record<string, any>) => void;\r\n  \r\n  /** Show the template */\r\n  show: () => void;\r\n  \r\n  /** Hide the template */\r\n  hide: () => void;\r\n  \r\n  /** Enable the template */\r\n  enable: () => void;\r\n  \r\n  /** Disable the template */\r\n  disable: () => void;\r\n  \r\n  /** Get the DOM node */\r\n  getNode: () => HTMLDivElement | null;\r\n}\r\n\r\nexport const AvakioTemplate = forwardRef<AvakioTemplateRef, AvakioTemplateProps>(\r\n  (\r\n    {\r\n      template,\r\n      data = {},\r\n      content,\r\n      url,\r\n      theme = 'material',\r\n      borderType = 'space',\r\n      type = 'clean',\r\n      borderless = false,\r\n      autoheight = false,\r\n      scroll = false,\r\n      width,\r\n      height,\r\n      minWidth,\r\n      minHeight,\r\n      maxWidth,\r\n      maxHeight,\r\n      padding,\r\n      margin,\r\n      className = '',\r\n      css,\r\n      hidden = false,\r\n      disabled = false,\r\n      id,\r\n      testId,\r\n      onLoad,\r\n      onChange,\r\n      onClick,\r\n    },\r\n    ref\r\n  ) => {\r\n    const [internalData, setInternalData] = useState<Record<string, any>>(data);\r\n    const [internalContent, setInternalContent] = useState<React.ReactNode>(content);\r\n    const [internalHtml, setInternalHtml] = useState<string>('');\r\n    const [isHidden, setIsHidden] = useState(hidden);\r\n    const [isDisabled, setIsDisabled] = useState(disabled);\r\n    const [loadedContent, setLoadedContent] = useState<string>('');\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n    const onLoadRef = useRef(onLoad);\r\n\r\n    // Keep onLoad ref in sync\r\n    useEffect(() => {\r\n      onLoadRef.current = onLoad;\r\n    }, [onLoad]);\r\n\r\n    // Sync hidden and disabled props\r\n    useEffect(() => {\r\n      setIsHidden(hidden);\r\n    }, [hidden]);\r\n\r\n    useEffect(() => {\r\n      setIsDisabled(disabled);\r\n    }, [disabled]);\r\n\r\n    // Load content from URL\r\n    useEffect(() => {\r\n      if (url) {\r\n        fetch(url)\r\n          .then((res) => res.text())\r\n          .then((html) => {\r\n            setLoadedContent(html);\r\n            onLoadRef.current?.();\r\n          })\r\n          .catch((err) => console.error('Failed to load template from URL:', err));\r\n      }\r\n    }, [url]);\r\n\r\n    // Update internal data when prop changes (use JSON comparison for objects)\r\n    const dataJsonRef = useRef<string>(JSON.stringify(data));\r\n    useEffect(() => {\r\n      const newDataJson = JSON.stringify(data);\r\n      if (newDataJson !== dataJsonRef.current) {\r\n        dataJsonRef.current = newDataJson;\r\n        setInternalData(data);\r\n      }\r\n    }, [data]);\r\n\r\n    // Update internal content when prop changes (only for primitive content)\r\n    const prevContentRef = useRef(content);\r\n    useEffect(() => {\r\n      // Only update if content is a primitive or actually different\r\n      if (content !== prevContentRef.current) {\r\n        prevContentRef.current = content;\r\n        setInternalContent(content);\r\n      }\r\n    }, [content]);\r\n\r\n    // Process template with data\r\n    const processTemplate = (tmpl: string, dataObj: Record<string, any>): string => {\r\n      return tmpl.replace(/#(\\w+)#/g, (match, key) => {\r\n        return dataObj[key] !== undefined ? String(dataObj[key]) : match;\r\n      });\r\n    };\r\n\r\n    // Render content based on template, content, or URL\r\n    const renderContent = () => {\r\n      // If HTML was set via setHTML\r\n      if (internalHtml) {\r\n        return <div dangerouslySetInnerHTML={{ __html: internalHtml }} />;\r\n      }\r\n\r\n      // If URL content was loaded\r\n      if (loadedContent) {\r\n        return <div dangerouslySetInnerHTML={{ __html: processTemplate(loadedContent, internalData) }} />;\r\n      }\r\n\r\n      // If template is a function\r\n      if (typeof template === 'function') {\r\n        return template(internalData);\r\n      }\r\n\r\n      // If template is a string\r\n      if (typeof template === 'string') {\r\n        const processedHtml = processTemplate(template, internalData);\r\n        return <div dangerouslySetInnerHTML={{ __html: processedHtml }} />;\r\n      }\r\n\r\n      // If direct content is provided\r\n      if (internalContent) {\r\n        return internalContent;\r\n      }\r\n\r\n      return null;\r\n    };\r\n\r\n    // Imperative handle for ref methods\r\n    useImperativeHandle(ref, () => ({\r\n      setValues: (newData: Record<string, any>) => {\r\n        setInternalData(newData);\r\n        onChange?.(newData);\r\n      },\r\n      getValues: () => internalData,\r\n      setHTML: (html: string) => {\r\n        setInternalHtml(html);\r\n      },\r\n      getHTML: () => {\r\n        return containerRef.current?.innerHTML || '';\r\n      },\r\n      refresh: () => {\r\n        setInternalData({ ...internalData });\r\n      },\r\n      parse: (newData: Record<string, any>) => {\r\n        setInternalData(newData);\r\n        onChange?.(newData);\r\n      },\r\n      show: () => {\r\n        setIsHidden(false);\r\n      },\r\n      hide: () => {\r\n        setIsHidden(true);\r\n      },\r\n      enable: () => {\r\n        setIsDisabled(false);\r\n      },\r\n      disable: () => {\r\n        setIsDisabled(true);\r\n      },\r\n      getNode: () => containerRef.current,\r\n    }));\r\n\r\n    // Build CSS classes\r\n    const classes = [\r\n      'avakio-template',\r\n      `avakio-template-theme-${theme}`,\r\n      `avakio-template-border-${borderType}`,\r\n      `avakio-template-type-${type}`,\r\n      borderless ? 'avakio-template-borderless' : '',\r\n      autoheight ? 'avakio-template-autoheight' : '',\r\n      scroll === true || scroll === 'xy' ? 'avakio-template-scroll-xy' : '',\r\n      scroll === 'x' ? 'avakio-template-scroll-x' : '',\r\n      scroll === 'y' ? 'avakio-template-scroll-y' : '',\r\n      isHidden ? 'avakio-template-hidden' : '',\r\n      isDisabled ? 'avakio-template-disabled' : '',\r\n      className,\r\n    ]\r\n      .filter(Boolean)\r\n      .join(' ');\r\n\r\n    // Build inline styles\r\n    const styles: React.CSSProperties = {\r\n      width: typeof width === 'number' ? `${width}px` : width,\r\n      height: typeof height === 'number' ? `${height}px` : height,\r\n      minWidth: typeof minWidth === 'number' ? `${minWidth}px` : minWidth,\r\n      minHeight: typeof minHeight === 'number' ? `${minHeight}px` : minHeight,\r\n      maxWidth: typeof maxWidth === 'number' ? `${maxWidth}px` : maxWidth,\r\n      maxHeight: typeof maxHeight === 'number' ? `${maxHeight}px` : maxHeight,\r\n      padding: Array.isArray(padding) \r\n        ? `${padding[0]}px ${padding[1]}px ${padding[2]}px ${padding[3]}px`\r\n        : typeof padding === 'number' ? `${padding}px` : padding,\r\n      margin: Array.isArray(margin) \r\n        ? `${margin[0]}px ${margin[1]}px ${margin[2]}px ${margin[3]}px`\r\n        : typeof margin === 'number' ? `${margin}px` : margin,\r\n      ...(css && typeof css === 'object' && !Array.isArray(css) ? css : {}),\r\n    };\r\n\r\n    return (\r\n      <div\r\n        ref={containerRef}\r\n        id={id}\r\n        data-testid={testId}\r\n        className={classes}\r\n        style={styles}\r\n        onClick={onClick}\r\n      >\r\n        <div className=\"avakio-template-content\">{renderContent()}</div>\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nAvakioTemplate.displayName = 'AvakioTemplate';\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],"names":["clamp","value","min","max","AvakioPopup","open","anchorRef","anchorRect","x","y","offset","width","height","theme","modal","closeOnOutside","closeOnEsc","onClose","className","style","children","id","testId","popupRef","useRef","coords","setCoords","useState","numericWidth","useMemo","parsed","useEffect","updatePosition","nextLeft","nextTop","rect","maxLeft","onKey","e","handleClick","popupNode","jsxs","Fragment","jsx","createPortal","avakioPortletThemes","AvakioPortletBoard","columns","items","onMove","draggingId","setDraggingId","grouped","map","c","item","handleDragStart","ev","handleDragOver","handleDrop","columnId","itemId","col","dragging","toKebabCase","string","toCamelCase","match","p1","p2","toPascalCase","camelCase","mergeClasses","classes","index","array","hasA11yProp","props","prop","defaultAttributes","Icon","forwardRef","color","size","strokeWidth","absoluteStrokeWidth","iconNode","rest","ref","createElement","tag","attrs","createLucideIcon","iconName","Component","Calendar","Check","ChevronDown","ChevronLeft","ChevronRight","ChevronUp","ChevronsLeft","ChevronsRight","ChevronsUpDown","Clock","Copy","EllipsisVertical","EyeOff","Eye","File","FolderOpen","Folder","GripVertical","Minus","Pen","Plus","Search","Send","Trash2","X","Button","Input","Popover","PopoverTrigger","PopoverContent","cn","formatDisplayDate","showTime","d","AvakioDatePickerCalendar","onChange","selectedDate","viewDate","setViewDate","monthNames","weekDays","year","month","calendarDays","firstDay","lastDay","startDay","daysInMonth","daysInPrevMonth","days","i","remainingDays","handlePrevMonth","handleNextMonth","handleDateSelect","date","newDate","day","handleTimeChange","hours","minutes","handleToday","now","handleClear","isSelected","isToday","today","dayInfo","ampm","AvakioDatePicker","label","placeholder","inline","setOpen","rootRef","themeAttr","setThemeAttr","host","nearest","observer","displayValue","CalendarIcon","val","AvakioCheckbox","name","checked","defaultChecked","indeterminate","description","disabled","error","required","padding","margin","isControlled","internalChecked","setInternalChecked","checkboxRef","isChecked","status","handleToggle","prev","handleKeyDown","handleIconClick","paddingStyle","marginStyle","containerStyle","AvakioButton","icon","iconRight","variant","block","loading","badge","autowidth","tooltip","buttonType","align","image","hotkey","popup","onClick","isDisabled","buttonRef","React","keys","ctrl","shift","alt","key","buttonTypeClass","normalizeHex","hex","cleaned","AvakioColorPicker","defaultValue","readOnly","presets","allowCustomInput","showPreview","internal","setInternal","inputRef","currentColor","allPresets","handleSelect","normalized","handleInputChange","handleNativeChange","preset","AvakioCombo","options","onInputChange","labelAlign","labelWidth","readonly","filterMode","customFilter","template","maxHeight","isOpen","setIsOpen","inputValue","setInputValue","highlightedIndex","setHighlightedIndex","selectedOption","setSelectedOption","dropdownRef","containerRef","normalizedOptions","opt","option","filteredOptions","searchValue","optionValue","newValue","handleSelectOption","highlightedElement","handleClickOutside","event","renderOption","AvakioCounter","step","labelPosition","allowInput","next","current","emitChange","handleStep","delta","handleInput","raw","canDecrement","canIncrement","formatDate","normalize","range","allowSingleDay","s","AvakioDateRangePicker","internalRange","setInternalRange","applyRange","presetItems","iso","end","start","handleStart","handleEnd","display","p","AvakioGridSuggest","data","textValue","body","editable","firstItem","getDisplayText","rendered","_","firstCol","k","cellValue","highlightedRow","showHeader","showBorderless","enableScroll","rowIndex","isHighlighted","AvakioMultiCombo","showCount","maxDisplayItems","searchQuery","setSearchQuery","query","selectedOptions","handleToggleOption","v","handleRemoveItem","handleClearAll","handleInputClick","handleSelectAll","allFilteredValues","newValues","renderSelectedItems","displayItems","remainingCount","allFilteredSelected","AvakioRichSelect","yCount","clearable","currentIndex","calculatedMaxHeight","AvakioRichSelectAPI","AvakioSlider","showValue","formatValue","marks","normalizeToRange","defaultMin","defaultMax","normalizeToSingle","defaultVal","internalSingle","setInternalSingle","currentRange","currentSingle","lowPercent","highPercent","formattedLow","formattedHigh","safeMarks","m","handleSingleChange","useCallback","clamped","handleRangeChange","newRange","trackRef","handleTrackClick","percent","clickValue","snappedValue","distToLow","distToHigh","sliderStyle","isInRange","AvakioProperty","dense","showBorders","rows","setRows","lastChanged","setLastChanged","openDateId","setOpenDateId","openDatePlacement","setOpenDatePlacement","dateBtnRefs","evt","computeDatePlacement","btn","viewportHeight","estimatedHeight","spaceBelow","spaceAbove","coerceDate","formatDisplayValue","groupedRows","groups","row","handleChange","r","changed","renderControl","common","richOptions","propOpt","inputVal","numericVal","el","placement","text","vals","rootClass","themeProps","group","rowsInGroup","isSameDay","date1","date2","formatDateKey","parseDate","str","AvakioCalendar","mode","minDate","maxDate","disabledDates","markers","showWeekNumbers","monthsToShow","weekStart","onMonthChange","getInitialViewDate","firstDate","safeMonthsToShow","selectedDates","disabledDatesSet","markersByDate","marker","getMonthGrid","baseDate","getWeekNumber","dayNum","yearStart","isDateDisabled","isDateSelected","selected","isDateInRange","a","b","handleDateClick","dateKey","currentDates","newDates","sorted","todayKey","renderMonth","monthOffset","displayDate","dayMarkers","showWeekNum","uniqueKey","displayWeekNumber","idx","startOfWeek","addDays","parseDateKey","formatTime","formatDay","AvakioScheduler","events","defaultView","defaultDate","userId","dataUrl","eventsUrl","loadRemoteOnNavigate","fetchOptions","transformEvent","buildEventsQuery","mutationUrl","buildMutationUrl","mutationMethod","onNavigate","onViewChange","onEventClick","onEventCreate","view","setView","anchor","setAnchor","selectedDateKey","setSelectedDateKey","isMobile","setIsMobile","remoteEvents","setRemoteEvents","setLoading","setError","hasFetchedOnce","setHasFetchedOnce","morePopup","setMorePopup","eventsEndpoint","rangeForView","currentView","currentAnchor","cancelled","url","mapEvent","hasLegacyShape","res","json","mapped","err","detect","onResize","monthGrid","first","cells","weekGrid","dayGrid","filteredEvents","monthAgenda","visibleEvents","go","changeView","createEvent","target","saved","eventsForDay","eventsForDayKey","eventsForDateKey","mobileMarkers","selectedDateEvents","renderEventPill","renderEventsForDay","nextKey","AvakioSidebar","collapsed","position","collapsedWidth","activeTitle","titleHeight","multipleOpen","onSelect","onToggle","mobileBreakpoint","tabletBreakpoint","autoCloseMobile","showOverlay","onOverlayClick","showMobileDongle","dongleIcon","isCollapsed","setIsCollapsed","openItems","setOpenItems","hoveredItem","setHoveredItem","selectedItem","setSelectedItem","isTablet","setIsTablet","checkScreenSize","isMobileScreen","isTabletScreen","newCollapsed","toggleItem","hasChildren","handleItemClick","level","parentId","handleOverlayClick","renderIcon","renderArrow","renderItem","isHovered","child","AvakioSidebarToggleButton","defaultDateFormatter","diff","generateId","AvakioComment","initialData","users","currentUser","sendAction","moreButtonLabel","hasMore","mentions","keepButtonVisible","borderless","css","disabledProp","onAdd","onDelete","onEdit","onLoadMore","onUserMentioned","dateFormatter","renderAvatar","listRef","comments","setComments","setDisabled","editingId","setEditingId","editValue","setEditValue","activeMenuId","setActiveMenuId","showMentions","setShowMentions","mentionSearch","setMentionSearch","currentUserId","setCurrentUserId","sortedComments","dateA","dateB","getUserById","u","filteredMentionUsers","search","handleSend","newComment","mentionRegex","mentionedUser","atIndex","insertMention","user","handleDelete","commentId","handleEditStart","comment","handleEditSave","updatedComment","handleEditCancel","defaultRenderAvatar","initials","n","renderText","part","useImperativeHandle","containerClassNames","containerStyles","isOwner","isEditing","MoreVertical","Edit2","SelectContext","Select","onValueChange","internalValue","setInternalValue","currentValue","handleValueChange","SelectTrigger","context","SelectValue","SelectContent","SelectItem","AvakioDataTable","spans","select","multiselect","rowHeight","headerHeight","fixedRowNumber","hover","resizable","sortable","filterable","paging","pageSize","autoConfig","scroll","serverSide","onRowClick","onRowDoubleClick","onSelectChange","onSort","onFilter","emptyText","totalCount","currentPage","onPageChange","onPageSizeChange","selectedRows","setSelectedRows","sortColumn","setSortColumn","sortDirection","setSortDirection","spanMap","rowId","colspan","rowspan","cssClass","rowKey","cellKey","colIndex","nextCol","allRowIds","nextRowIndex","nextRowKey","filters","setFilters","columnWidths","setColumnWidths","page","setPage","localPageSize","setLocalPageSize","resizingColumn","setResizingColumn","resizeStartX","setResizeStartX","resizeStartWidth","setResizeStartWidth","filteredData","result","filterValue","column","stringValue","fv","filterStringValue","rowDate","filterDate","sortedData","aVal","bVal","comparison","paginatedData","startIndex","totalPages","handleSort","newDirection","handleFilter","newFilters","handleRowClick","newSet","handleRowDoubleClick","handleResizeStart","currentWidth","handleMouseMove","newWidth","handleMouseUp","getColumnWidth","customWidth","renderCell","visibleColumns","spanInfo","cellClasses","newPageSize","newPage","AvakioTimeline","onItemClick","orientation","rootClasses","vertical","isLast","dotClass","showDateInCard","leftLabel","showConnector","clickable","handleKey","horizontal","isFirst","isColorBand","topLabel","positionClass","buildNodeMap","nodes","depth","node","getDescendantIds","ids","getAllNodeIds","AvakioTree","checkbox","threeState","showIcons","showToggle","showLines","navigation","drag","itemHeight","onDblClick","onOpen","onCheck","onContext","autoId","useId","treeId","selectedIds","setSelectedIds","openIds","setOpenIds","initialOpen","collectOpen","checkedIds","setCheckedIds","initialChecked","collectChecked","focusedId","setFocusedId","filterFn","setFilterFn","forceUpdate","nodeMap","getCheckState","nodeId","entry","descendantIds","checkedCount","handleCheckToggle","newChecked","parentEntry","parentNode","childIds","allChecked","handleNodeClick","handleNodeDblClick","handleEditSubmit","handleContextMenu","visibleIds","allBranchIds","allIds","fn","toOpen","renderNode","isBranch","isFocused","checkState","nodeClasses","indent","detectedTheme","setDetectedTheme","globalTheme","newTheme","containerClasses","toCssValue","AvakioAbsoluteLayout","initialCells","minWidth","minHeight","maxWidth","initialHidden","initialDisabled","initialVisibleBatch","background","onCellClick","setCells","isHidden","setIsHidden","setIsDisabled","visibleBatch","setVisibleBatch","resizeObserverRef","entries","handleCellClick","cell","isCellVisible","newCells","idOrIndex","batchName","cellId","cellStyle","AvakioGrid","gridColumns","gridRows","cellWidth","cellHeight","cellMargin","paddingX","paddingY","cellBorderless","hidden","autoplace","factory","isDraggable","onDragStart","onDragEnd","containerSize","setContainerSize","cellsRef","draggingCell","setDraggingCell","dragOffset","setDragOffset","dragPosition","setDragPosition","initialWidth","initialHeight","rafId","pendingSize","resizeObserver","calculatedCellWidth","basePadding","paddingHorizontal","totalMargin","availableWidth","cellHeights","acc","paddingVertical","availableHeight","fixedHeightTotal","flexibleRowCount","rowHeights","fixedHeightCell","remainingHeight","flexRowHeight","heights","dy","totalHeight","rowH","rowPositions","positions","h","getCellStyle","dx","px","py","left","top","renderCellContent","getGridPositionFromPixels","pixelX","pixelY","adjustedX","colWidth","gridX","adjustedY","gridY","rowMid","excludeCellId","clientX","clientY","cellLeft","cellTop","handleDragMove","handleDragEnd","newGridPos","canPlace","j","checkX","checkY","positionChanged","isSingleColumn","allCellsSimple","oldY","newY","updated","targetCell","cDx","cDy","handleMove","handleUp","findNextPosition","occupied","newCell","marginValue","isDragging","AvakioLayout","cols","type","gravity","responsive","gap","justify","autoResize","layoutRef","responsiveMode","setResponsiveMode","isRows","checkResponsive","handleResize","layoutClasses","layoutStyles","shouldItemFlex","itemClasses","AvakioResizer","direction","onResizeStart","onResizeEnd","resizerRef","startPosRef","setIsDragging","currentPos","handleMouseDown","AvakioDoubleList","labelLeft","labelRight","labelBottomLeft","labelBottomRight","showButtons","searchable","draggable","listHeight","leftSearch","setLeftSearch","rightSearch","setRightSearch","leftSelection","setLeftSelection","rightSelection","setRightSelection","draggedItem","setDraggedItem","dragOverSide","setDragOverSide","leftListRef","rightListRef","selectedSet","leftItems","rightItems","filteredLeftItems","filteredRightItems","moveToRight","validIds","moveToLeft","idsToRemove","moveAllToRight","newIds","moveAllToLeft","disabledIds","side","setSelection","selection","lastSelected","lastIndex","rangeIds","handleItemDoubleClick","handleDragLeave","isCurrentlySelected","listStyle","AvakioFieldset","collapsible","defaultCollapsed","collapsedProp","onCollapse","fieldsetRef","bodyRef","isControlledCollapse","internalCollapsed","setInternalCollapsed","handleCollapseToggle","bodyStyles","AvakioLabel","html","fontSize","fontWeight","backgroundColor","border","borderRadius","currentLabel","setCurrentLabel","currentHtml","setCurrentHtml","isVisible","setIsVisible","htmlContent","inlineStyles","fieldIdCounter","generateFieldId","AvakioMultitext","invalidMessage","bottomLabel","inputAlign","inputWidth","iconWidth","maxFields","separator","subConfig","showNumbers","addButtonLabel","addButtonTooltip","validate","validateEvent","maxLength","pattern","autoComplete","onSectionAdd","onSectionRemove","onFocus","onBlur","onEnter","parseValue","values","fields","setFields","isInvalid","setIsInvalid","validationMessage","setValidationMessage","refreshKey","setRefreshKey","inputRefs","getCombinedValue","f","getValuesArray","validateFields","handleFieldChange","fieldId","combined","handleAddSection","initialValue","newFieldId","newField","handleRemoveSection","targetId","fieldToRemove","handleKeyPress","field","handleFocus","handleBlur","primary","primaryField","input","canAddMore","normalizeOptions","AvakioRadio","optionsProp","invalid","customRadio","optionHeight","radioName","optionStates","setOptionStates","getOptionState","override","firstEnabled","optId","optionId","visibleOptions","currentVisibleIndex","nextIndex","nextOption","optState","optionClasses","optionStyle","AvakioSegmentedButton","fill","optionWidth","multiview","inputHeight","onBeforeTabClick","onAfterTabClick","onOptionAdd","onOptionRemove","segmentRefs","internalOptions","setInternalOptions","visible","setVisible","hiddenOptions","setHiddenOptions","disabledOptions","setDisabledOptions","fallback","handleSegmentClick","targetIndex","newOptions","focusIndex","inputContainerStyles","hasError","isActive","AvakioSwitchButton","onLabel","offLabel","switchRef","normalizeValue","isOn","switchClassNames","labelStyles","hasInnerLabels","AvakioTabBar","renderTab","closable","scrollable","closedIds","setClosedIds","canScrollLeft","setCanScrollLeft","canScrollRight","setCanScrollRight","tabRefs","checkScrollButtons","track","scrollLeft","scrollWidth","clientWidth","scrollRight","setTabRef","focusTabById","selectTab","handleClose","nextActive","moveFocus","enabled","currentIdx","safeIdx","active","closeButton","defaultContent","tabContent","AvakioText","clear","enableValueCopyButton","enablePlaceHolderCopyButton","iconPosition","multiline","onKeyPress","textWidth","setCurrentValue","setIsFocused","showPassword","setShowPassword","validateInput","num","togglePasswordVisibility","handleCopyToClipboard","handleCopyPlaceholder","labelStyle","inputType","hasActionButton","inputClasses","wrapperStyle","AvakioToggleButton","onIcon","offIcon","onImage","offImage","isPressed","currentIcon","currentImage","AvakioAccordion","multi","collapseIcon","expandIcon","animate","onExpand","generatedId","accordionId","contentRefs","getInitialExpandedIds","expanded","expandedIds","setExpandedIds","setDisabledIds","isCurrentlyExpanded","newExpandedIds","otherItem","enabledItems","nextItem","prevItem","lastItem","firstExpanded","renderToggleIcon","isExpanded","headerVisible","headerId","panelId","DEFAULT_BANDS","AvakioBulletGraph","minRange","maxRange","markerColor","bands","stroke","scale","tickSize","flowTime","smoothFlow","layout","labelHeight","showLabel","showScale","animatedValue","setAnimatedValue","animationRef","prevValueRef","clampedValue","startValue","endValue","startTime","currentTime","elapsed","progress","easeProgress","getPercentage","barColor","scaleTicks","ticks","sortedBands","formattedPlaceholder","isVertical","band","tick","AvakioCarousel","slides","autoplay","autoplayDelay","scrollSpeed","loop","activeIndex","onShow","onSlideChange","setCurrentIndex","slidesList","setSlidesList","isTransitioning","setIsTransitioning","touchStart","setTouchStart","touchEnd","setTouchEnd","autoplayTimerRef","minSwipeDistance","goToSlide","skipTransition","slide","showNext","showPrev","setActive","slideId","setActiveIndex","getActiveId","getActiveIndex","addView","removeView","newSlides","onTouchStart","onTouchMove","onTouchEnd","distance","isLeftSwipe","isRightSwipe","isSideNavigation","showItems","DEFAULT_COLORS","calculateAxisBounds","dataMin","dataMax","magnitude","residual","niceStep","createSplinePath","points","tension","path","p0","p3","cp1x","cp1y","cp2x","cp2y","describePieSlice","cx","cy","innerR","startAngle","endAngle","startOuter","endOuter","startInner","endInner","largeArcFlag","AvakioChart","series","xAxis","yAxis","legend","title","subtitle","colors","animateDuration","gradient","barWidth","barOffset","donutInnerRadius","pieStartAngle","pieLabels","donutInnerText","stacked","onHover","onLegendClick","svgRef","dimensions","setDimensions","hiddenSeries","setHiddenSeries","hoveredPoint","setHoveredPoint","tooltipData","setTooltipData","animationProgress","setAnimationProgress","container","animateFrame","easeOutCubic","t","chartArea","pad","visibleSeries","seriesId","scales","allXValues","allYValues","uniqueXValues","isXNumeric","yBounds","calculateStackedMaxValues","numValue","maxValues","numPoints","sum","handleLegendClick","seriesItem","newHidden","handlePointHover","point","content","handlePointClick","format","svgData","canvas","ctx","resolve","img","renderTitle","renderAxis","xAxisY","yAxisX","renderLineChart","isSpline","isArea","seriesIdx","linePath","areaPath","renderBarChart","numSeries","groupWidth","effectiveBarWidth","totalBarWidth","groupOffset","xVal","xIdx","groupX","stackedY","dataPoint","yRange","barHeight","w","renderPieChart","isDonut","seriesData","radius","innerRadius","total","currentAngle","sliceAngle","midAngle","labelRadius","labelX","labelY","offsetDistance","offsetX","offsetY","renderScatterChart","renderRadarChart","categories","numCategories","angleStep","maxValue","numLevels","levelIdx","levelRadius","angle","cat","renderLegend","itemX","itemY","renderTooltip","renderChartContent","asBoxPadding","intersects","AvakioDashboard","widgetsProp","dragHandle","onWidgetClick","gridRef","widgets","setWidgets","widgetsRef","resizeStateRef","update","ro","resolvedUnitWidth","base","resolvedUnitHeight","updateWidgets","nextOrUpdater","getWidgetById","wid","canPlaceRect","other","findFirstFreeSpot","widget","spot","placed","nextRect","byId","l","handleGridChange","handleDragStartInternal","handleDragEndInternal","pos","beginResize","widgetId","handlePointerMove","state","unitW","unitH","deltaX","deltaY","minDx","minDy","maxDx","maxDy","nextDx","nextDy","handlePointerUp","gridCells","header","hasHeader","stopBodyDrag","getColumnLetter","letter","tempIndex","generateColumnsFromData","excelHeader","firstRow","AvakioExcelViewer","initialSheets","initialColumns","toolbar","columnWidth","headerRowHeight","showRowNumbers","resizeColumn","resizeRow","editAction","blockselect","gridLines","freezeHeader","leftSplit","topSplit","autoheight","onCellDoubleClick","onCellChange","onSelectionChange","onSheetChange","onColumnResize","onRowResize","onDataLoad","sheets","setSheets","activeSheet","setActiveSheet","setColumns","sheet","setData","editingCell","setEditingCell","sortConfig","setSortConfig","setRowHeights","hiddenColumns","setHiddenColumns","filterConfig","setFilterConfig","tableRef","resizeRef","selectionStartRef","processedData","compare","handleSheetChange","handleCellDoubleClick","handleEditComplete","oldValue","newData","originalIndex","handleColumnResizeStart","moveEvent","handleHeaderClick","newRow","newCol","isCellSelected","endRow","endColumn","minRow","maxRow","minCol","maxCol","getCellSpan","span","spanEndRow","spanEndCol","currentColIndex","newColumns","dir","tableHeight","FormRules","regex","FormContext","useFormContext","setNestedValue","obj","getNestedValue","flattenObject","prefix","newKey","AvakioForm","elements","initialValues","initialDefaultValues","rules","complexData","autoHeight","onValidation","onValidationError","onValidationSuccess","onSubmit","onValues","formRef","fieldsRef","setValues","defaultValues","setDefaultValues","defaults","errors","setErrors","dirty","setDirtyState","newErrors","registerField","element","unregisterField","validateField","fieldRules","rulesArray","rule","isValid","getFormValues","setFormValues","updateDirty","processedValues","getCleanValues","getDirtyValues","isDirty","clearValidation","markInvalid","message","focus","firstField","handleSubmit","form","formStyle","classNames","contextValue","renderElement","colStyle","rowStyle","elementStyle","contentStyle","AvakioFormField","render","fieldRef","enhancedChildren","AvakioGage","subLabel","thickness","suffix","showMinMax","trackColor","safeRange","circumference","dashOffset","targetPosition","mergedClass","styleVars","avakioThemes","GOOGLE_SCRIPT_ID","loadGoogleMaps","apiKey","reject","existing","script","AvakioGoogleMap","center","zoom","mapType","mapRef","markerRefs","resolvedApiKey","_documentCurrentScript","__vite_import_meta_env__","iframeSrc","lat","lng","google","heightValue","AvakioGroupList","controlledValue","templateItem","templateGroup","templateBack","animationDuration","showBack","backLabel","parentStack","setParentStack","currentBranch","setCurrentBranch","animating","setAnimating","animationDirection","setAnimationDirection","selectedValue","getItemsAtPath","parent","getCurrentParent","navigateInto","newStack","navigateBack","findPath","isGroup","itemCount","itemClass","renderBackHeader","currentParent","containerClass","AvakioHint","initialSteps","prevButton","nextButton","endLabel","stepTimeout","controlledVisible","onStart","onBeforeStart","onAfterStart","onEnd","onSkip","onNext","onPrevious","onStepChange","steps","setSteps","currentStep","setCurrentStep","highlightRect","setHighlightRect","popupPosition","setPopupPosition","timeoutRef","getTargetElement","selector","updateHighlight","pTop","pRight","pBottom","pLeft","updatePopupPosition","popupRect","viewportWidth","scrollTop","highlightTop","highlightLeft","highlightBottom","highlightRight","spaceRight","handleUpdate","goToNextStep","nextStep","eventSelector","handleSkip","goToPreviousStep","prevStep","resume","targetStep","newSteps","isFirstStep","isLastStep","prevLabel","nextLabel","AvakioView","onHide","viewRef","isEnabled","setIsEnabled","newHeight","getAnimationClass","AvakioViewWithRef","AvakioViewHeader","showTitle","showSubTitle","subTitle","isSticky","wrapperProps","getOppositeDirection","AvakioMultiview","activeView","keepViews","fitBiggest","onViewShow","onBeforeBack","animationType","animationFlipDirection","animateConfig","currentViewId","setCurrentViewId","previousViewId","setPreviousViewId","isAnimating","setIsAnimating","activeDirection","setActiveDirection","setHidden","historyRef","currentViewIdRef","isAnimatingRef","animationTimeoutRef","animateConfigRef","switchView","newViewId","currentId","oldViewId","viewId","backDirection","allCells","activeViewId","cellsToRender","isLeaving","isEntering","AvakioTemplate","borderType","onLoad","internalData","setInternalData","internalContent","setInternalContent","internalHtml","setInternalHtml","loadedContent","setLoadedContent","onLoadRef","dataJsonRef","newDataJson","prevContentRef","processTemplate","tmpl","dataObj","renderContent","processedHtml","styles"],"mappings":"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","x_google_ignoreList":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30]}
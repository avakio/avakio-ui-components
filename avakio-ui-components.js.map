{"version":3,"file":"avakio-ui-components.js","sources":["../src/components/avakio/avakio-popup/avakio-popup.tsx","../src/components/avakio/avakio-portlet/avakio-portlet.tsx","../node_modules/lucide-react/dist/esm/shared/src/utils.js","../node_modules/lucide-react/dist/esm/defaultAttributes.js","../node_modules/lucide-react/dist/esm/Icon.js","../node_modules/lucide-react/dist/esm/createLucideIcon.js","../node_modules/lucide-react/dist/esm/icons/calendar.js","../node_modules/lucide-react/dist/esm/icons/check.js","../node_modules/lucide-react/dist/esm/icons/chevron-down.js","../node_modules/lucide-react/dist/esm/icons/chevron-left.js","../node_modules/lucide-react/dist/esm/icons/chevron-right.js","../node_modules/lucide-react/dist/esm/icons/chevron-up.js","../node_modules/lucide-react/dist/esm/icons/chevrons-left.js","../node_modules/lucide-react/dist/esm/icons/chevrons-right.js","../node_modules/lucide-react/dist/esm/icons/chevrons-up-down.js","../node_modules/lucide-react/dist/esm/icons/clock.js","../node_modules/lucide-react/dist/esm/icons/copy.js","../node_modules/lucide-react/dist/esm/icons/ellipsis-vertical.js","../node_modules/lucide-react/dist/esm/icons/eye-off.js","../node_modules/lucide-react/dist/esm/icons/eye.js","../node_modules/lucide-react/dist/esm/icons/file.js","../node_modules/lucide-react/dist/esm/icons/folder-open.js","../node_modules/lucide-react/dist/esm/icons/folder.js","../node_modules/lucide-react/dist/esm/icons/grip-vertical.js","../node_modules/lucide-react/dist/esm/icons/minus.js","../node_modules/lucide-react/dist/esm/icons/pen.js","../node_modules/lucide-react/dist/esm/icons/plus.js","../node_modules/lucide-react/dist/esm/icons/search.js","../node_modules/lucide-react/dist/esm/icons/send.js","../node_modules/lucide-react/dist/esm/icons/trash-2.js","../node_modules/lucide-react/dist/esm/icons/x.js","../src/components/ui/button.tsx","../src/components/ui/input.tsx","../src/components/ui/popover.tsx","../src/lib/utils.ts","../src/components/avakio/ui-controls/avakio-datepicker/avakio-datepicker.tsx","../src/components/avakio/ui-controls/avakio-checkbox/avakio-checkbox.tsx","../src/components/avakio/ui-controls/avakio-button/avakio-button.tsx","../src/components/avakio/ui-controls/avakio-colorpicker/avakio-colorpicker.tsx","../src/components/avakio/ui-controls/avakio-combo/avakio-combo.tsx","../src/components/avakio/ui-controls/avakio-counter/avakio-counter.tsx","../src/components/avakio/ui-controls/avakio-daterangepicker/avakio-daterangepicker.tsx","../src/components/avakio/ui-controls/avakio-gridsuggest/avakio-gridsuggest.tsx","../src/components/avakio/ui-controls/avakio-multicombo/avakio-multicombo.tsx","../src/components/avakio/ui-controls/avakio-richselect/avakio-richselect.tsx","../src/components/avakio/ui-controls/avakio-slider/avakio-slider.tsx","../src/components/avakio/data-presentation/avakio-property/avakio-property.tsx","../src/components/avakio/ui-controls/avakio-calendar/avakio-calendar.tsx","../src/components/avakio/avakio-scheduler/avakio-scheduler.tsx","../src/components/avakio/avakio-sidebar/avakio-sidebar.tsx","../src/components/avakio/data-presentation/avakio-comment/avakio-comment.tsx","../src/components/ui/select.tsx","../src/components/avakio/data-presentation/avakio-datatable/AvakioDataTable.tsx","../src/components/avakio/data-presentation/avakio-timeline/avakio-timeline.tsx","../src/components/avakio/data-presentation/avakio-tree/avakio-tree.tsx","../src/components/avakio/layouts/avakio-absolute-layout/avakio-absolute-layout.tsx","../src/components/avakio/layouts/avakio-grid/avakio-grid.tsx","../src/components/avakio/layouts/avakio-layout/avakio-layout.tsx","../src/components/avakio/layouts/avakio-resizer/avakio-resizer.tsx","../src/components/avakio/ui-controls/avakio-doublelist/avakio-doublelist.tsx","../src/components/avakio/ui-controls/avakio-fieldset/avakio-fieldset.tsx","../src/components/avakio/ui-controls/avakio-label/avakio-label.tsx","../src/components/avakio/ui-controls/avakio-multitext/avakio-multitext.tsx","../src/components/avakio/ui-controls/avakio-radio/avakio-radio.tsx","../src/components/avakio/ui-controls/avakio-segmented-button/avakio-segmented-button.tsx","../src/components/avakio/ui-controls/avakio-switch-button/avakio-switch-button.tsx","../src/components/avakio/ui-controls/avakio-tabbar/avakio-tabbar.tsx","../src/components/avakio/ui-controls/avakio-text/avakio-text.tsx","../src/components/avakio/ui-controls/avakio-toggle-button/avakio-toggle-button.tsx","../src/components/avakio/ui-widgets/avakio-accordion/avakio-accordion.tsx","../src/components/avakio/ui-widgets/avakio-bullet-graph/avakio-bullet-graph.tsx","../src/components/avakio/ui-widgets/avakio-carousel/avakio-carousel.tsx","../src/components/avakio/ui-widgets/avakio-chart/avakio-chart.tsx","../src/components/avakio/ui-widgets/avakio-dashboard/avakio-dashboard.tsx","../src/components/avakio/ui-widgets/avakio-excel-viewer/avakio-excel-viewer.tsx","../src/components/avakio/ui-widgets/avakio-form/avakio-form.tsx","../src/components/avakio/ui-widgets/avakio-gage/avakio-gage.tsx","../src/components/avakio/ui-widgets/avakio-googlemap/avakio-googlemap.tsx","../src/components/avakio/ui-widgets/avakio-grouplist/avakio-grouplist.tsx","../src/components/avakio/ui-widgets/avakio-hint/avakio-hint.tsx","../src/components/avakio/views/avakio-view/avakio-view.tsx","../src/components/avakio/ui-widgets/avakio-view-header/avakio-view-header.tsx","../src/components/avakio/views/avakio-multiview/avakio-multiview.tsx","../src/components/avakio/views/avakio-template/avakio-template.tsx"],"sourcesContent":["import React, { useEffect, useMemo, useRef, useState } from \"react\";\r\nimport { createPortal } from \"react-dom\";\r\nimport \"./avakio-popup.css\";\r\n\r\nexport type AvakioPopupProps = {\r\n  open: boolean;\r\n  anchorRef?: React.RefObject<HTMLElement | null>;\r\n  anchorRect?: DOMRect;\r\n  x?: number;\r\n  y?: number;\r\n  offset?: { x?: number; y?: number };\r\n  width?: number | string;\r\n  height?: number | string;\r\n  theme?: string;\r\n  modal?: boolean;\r\n  closeOnOutside?: boolean;\r\n  closeOnEsc?: boolean;\r\n  onClose?: () => void;\r\n  className?: string;\r\n  style?: React.CSSProperties;\r\n  children: React.ReactNode;\r\n  /** ID of the component */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n};\r\n\r\nconst clamp = (value: number, min: number, max: number) => Math.min(Math.max(value, min), max);\r\n\r\nexport function AvakioPopup({\r\n  open,\r\n  anchorRef,\r\n  anchorRect,\r\n  x,\r\n  y,\r\n  offset,\r\n  width,\r\n  height,\r\n  theme,\r\n  modal,\r\n  closeOnOutside = true,\r\n  closeOnEsc = true,\r\n  onClose,\r\n  className,\r\n  style,\r\n  children,\r\n  id,\r\n  testId,\r\n}: AvakioPopupProps) {\r\n  const popupRef = useRef<HTMLDivElement>(null);\r\n  const [coords, setCoords] = useState({ top: 0, left: 0 });\r\n\r\n  const numericWidth = useMemo(() => {\r\n    if (typeof width === \"number\") return width;\r\n    if (typeof width === \"string\") {\r\n      const parsed = parseInt(width, 10);\r\n      return isNaN(parsed) ? 320 : parsed;\r\n    }\r\n    return 320;\r\n  }, [width]);\r\n\r\n  useEffect(() => {\r\n    if (!open) return;\r\n\r\n    const updatePosition = () => {\r\n      let nextLeft = typeof x === \"number\" ? x : (window.innerWidth - numericWidth) / 2;\r\n      let nextTop = typeof y === \"number\" ? y : 96;\r\n\r\n      if (anchorRef?.current) {\r\n        const rect = anchorRef.current.getBoundingClientRect();\r\n        nextLeft = rect.left + (offset?.x ?? 0);\r\n        nextTop = rect.bottom + (offset?.y ?? 8);\r\n      } else if (anchorRect) {\r\n        nextLeft = anchorRect.left + (offset?.x ?? 0);\r\n        nextTop = anchorRect.bottom + (offset?.y ?? 8);\r\n      }\r\n\r\n      const maxLeft = Math.max(8, window.innerWidth - numericWidth - 8);\r\n      nextLeft = clamp(nextLeft, 8, maxLeft);\r\n      nextTop = Math.max(8, nextTop);\r\n\r\n      setCoords({ top: nextTop, left: nextLeft });\r\n    };\r\n\r\n    updatePosition();\r\n    window.addEventListener(\"resize\", updatePosition);\r\n    window.addEventListener(\"scroll\", updatePosition, true);\r\n    return () => {\r\n      window.removeEventListener(\"resize\", updatePosition);\r\n      window.removeEventListener(\"scroll\", updatePosition, true);\r\n    };\r\n  }, [open, anchorRef, anchorRect, x, y, offset, numericWidth]);\r\n\r\n  useEffect(() => {\r\n    if (!open || !closeOnEsc) return;\r\n    const onKey = (e: KeyboardEvent) => {\r\n      if (e.key === \"Escape\") onClose?.();\r\n    };\r\n    window.addEventListener(\"keydown\", onKey);\r\n    return () => window.removeEventListener(\"keydown\", onKey);\r\n  }, [open, closeOnEsc, onClose]);\r\n\r\n  useEffect(() => {\r\n    if (!open || !closeOnOutside) return;\r\n    const handleClick = (e: MouseEvent) => {\r\n      if (!popupRef.current) return;\r\n      if (popupRef.current.contains(e.target as Node)) return;\r\n      onClose?.();\r\n    };\r\n    document.addEventListener(\"mousedown\", handleClick, true);\r\n    return () => document.removeEventListener(\"mousedown\", handleClick, true);\r\n  }, [open, closeOnOutside, onClose]);\r\n\r\n  if (!open) return null;\r\n\r\n  const popupNode = (\r\n    <>\r\n      {modal && (\r\n        <div\r\n          className=\"avakio-popup-overlay\"\r\n          data-admin-theme={theme}\r\n          onClick={closeOnOutside ? onClose : undefined}\r\n        />\r\n      )}\r\n      <div\r\n        ref={popupRef}\r\n        id={id}\r\n        data-testid={testId}\r\n        className={[\"avakio-popup\", className || \"\"].join(\" \").trim()}\r\n        data-admin-theme={theme}\r\n        style={{\r\n          top: coords.top,\r\n          left: coords.left,\r\n          width: width ?? `${numericWidth}px`,\r\n          height,\r\n          ...style,\r\n        }}\r\n      >\r\n        {children}\r\n      </div>\r\n    </>\r\n  );\r\n\r\n  return createPortal(popupNode, document.body);\r\n}\r\n\r\nexport default AvakioPopup;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useMemo, useState } from \"react\";\r\nimport \"./avakio-portlet.css\";\r\n\r\nexport const avakioPortletThemes = [\"material\", \"flat\", \"compact\", \"dark\", \"ocean\", \"sunset\"] as const;\r\nexport type AvakioPortletTheme = (typeof avakioPortletThemes)[number];\r\n\r\nexport type PortletColumn = {\r\n  id: string;\r\n  title: string;\r\n};\r\n\r\nexport type PortletItem = {\r\n  id: string;\r\n  title: string;\r\n  content: React.ReactNode;\r\n  columnId: string;\r\n};\r\n\r\nexport interface AvakioPortletBoardProps {\r\n  columns: PortletColumn[];\r\n  items: PortletItem[];\r\n  onMove?: (itemId: string, toColumnId: string) => void;\r\n  className?: string;\r\n  style?: React.CSSProperties;\r\n  theme?: AvakioPortletTheme;\r\n  /** ID of the component */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n}\r\n\r\nexport function AvakioPortletBoard({ columns, items, onMove, className, style, theme, id, testId }: AvakioPortletBoardProps) {\r\n  const [draggingId, setDraggingId] = useState<string | null>(null);\r\n\r\n  const grouped = useMemo(() => {\r\n    const map: Record<string, PortletItem[]> = {};\r\n    columns.forEach((c) => {\r\n      map[c.id] = [];\r\n    });\r\n    items.forEach((item) => {\r\n      if (!map[item.columnId]) map[item.columnId] = [];\r\n      map[item.columnId].push(item);\r\n    });\r\n    return map;\r\n  }, [columns, items]);\r\n\r\n  const handleDragStart = (id: string) => (ev: React.DragEvent<HTMLDivElement>) => {\r\n    setDraggingId(id);\r\n    ev.dataTransfer.effectAllowed = \"move\";\r\n    ev.dataTransfer.setData(\"text/plain\", id);\r\n  };\r\n\r\n  const handleDragOver = (ev: React.DragEvent<HTMLDivElement>) => {\r\n    ev.preventDefault();\r\n    ev.dataTransfer.dropEffect = \"move\";\r\n  };\r\n\r\n  const handleDrop = (columnId: string) => (ev: React.DragEvent<HTMLDivElement>) => {\r\n    ev.preventDefault();\r\n    const itemId = ev.dataTransfer.getData(\"text/plain\") || draggingId;\r\n    if (itemId && onMove) {\r\n      onMove(itemId, columnId);\r\n    }\r\n    setDraggingId(null);\r\n  };\r\n\r\n  return (\r\n    <div\r\n      id={id}\r\n      data-testid={testId}\r\n      className={[\"avakio-portlet\", className].filter(Boolean).join(\" \")}\r\n      style={style}\r\n      data-admin-theme={theme}\r\n    >\r\n      <div className=\"avakio-portlet-grid\">\r\n        {columns.map((col) => (\r\n          <div\r\n            key={col.id}\r\n            className=\"avakio-portlet-column\"\r\n            onDragOver={handleDragOver}\r\n            onDrop={handleDrop(col.id)}\r\n            data-column-id={col.id}\r\n            data-testid={`portlet-column-${col.id}`}\r\n          >\r\n            <div className=\"avakio-portlet-column-header\">{col.title}</div>\r\n            <div className=\"avakio-portlet-column-body\">\r\n              {grouped[col.id]?.map((item) => {\r\n                const dragging = draggingId === item.id;\r\n                return (\r\n                  <div\r\n                    key={item.id}\r\n                    className={\"avakio-portlet-item\" + (dragging ? \" avakio-portlet-item-dragging\" : \"\")}\r\n                    draggable\r\n                    onDragStart={handleDragStart(item.id)}\r\n                    onDragEnd={() => setDraggingId(null)}\r\n                    data-testid={`portlet-item-${item.id}`}\r\n                  >\r\n                    <div className=\"avakio-portlet-item-title\">{item.title}</div>\r\n                    <div className=\"avakio-portlet-item-content\">{item.content}</div>\r\n                  </div>\r\n                );\r\n              })}\r\n              {(!grouped[col.id] || grouped[col.id].length === 0) && (\r\n                <div className=\"avakio-portlet-empty\">Drop items here</div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nconst toKebabCase = (string) => string.replace(/([a-z0-9])([A-Z])/g, \"$1-$2\").toLowerCase();\nconst toCamelCase = (string) => string.replace(\n  /^([A-Z])|[\\s-_]+(\\w)/g,\n  (match, p1, p2) => p2 ? p2.toUpperCase() : p1.toLowerCase()\n);\nconst toPascalCase = (string) => {\n  const camelCase = toCamelCase(string);\n  return camelCase.charAt(0).toUpperCase() + camelCase.slice(1);\n};\nconst mergeClasses = (...classes) => classes.filter((className, index, array) => {\n  return Boolean(className) && className.trim() !== \"\" && array.indexOf(className) === index;\n}).join(\" \").trim();\nconst hasA11yProp = (props) => {\n  for (const prop in props) {\n    if (prop.startsWith(\"aria-\") || prop === \"role\" || prop === \"title\") {\n      return true;\n    }\n  }\n};\n\nexport { hasA11yProp, mergeClasses, toCamelCase, toKebabCase, toPascalCase };\n//# sourceMappingURL=utils.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nvar defaultAttributes = {\n  xmlns: \"http://www.w3.org/2000/svg\",\n  width: 24,\n  height: 24,\n  viewBox: \"0 0 24 24\",\n  fill: \"none\",\n  stroke: \"currentColor\",\n  strokeWidth: 2,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\"\n};\n\nexport { defaultAttributes as default };\n//# sourceMappingURL=defaultAttributes.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport { forwardRef, createElement } from 'react';\nimport defaultAttributes from './defaultAttributes.js';\nimport { mergeClasses, hasA11yProp } from './shared/src/utils.js';\n\nconst Icon = forwardRef(\n  ({\n    color = \"currentColor\",\n    size = 24,\n    strokeWidth = 2,\n    absoluteStrokeWidth,\n    className = \"\",\n    children,\n    iconNode,\n    ...rest\n  }, ref) => createElement(\n    \"svg\",\n    {\n      ref,\n      ...defaultAttributes,\n      width: size,\n      height: size,\n      stroke: color,\n      strokeWidth: absoluteStrokeWidth ? Number(strokeWidth) * 24 / Number(size) : strokeWidth,\n      className: mergeClasses(\"lucide\", className),\n      ...!children && !hasA11yProp(rest) && { \"aria-hidden\": \"true\" },\n      ...rest\n    },\n    [\n      ...iconNode.map(([tag, attrs]) => createElement(tag, attrs)),\n      ...Array.isArray(children) ? children : [children]\n    ]\n  )\n);\n\nexport { Icon as default };\n//# sourceMappingURL=Icon.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport { forwardRef, createElement } from 'react';\nimport { mergeClasses, toKebabCase, toPascalCase } from './shared/src/utils.js';\nimport Icon from './Icon.js';\n\nconst createLucideIcon = (iconName, iconNode) => {\n  const Component = forwardRef(\n    ({ className, ...props }, ref) => createElement(Icon, {\n      ref,\n      iconNode,\n      className: mergeClasses(\n        `lucide-${toKebabCase(toPascalCase(iconName))}`,\n        `lucide-${iconName}`,\n        className\n      ),\n      ...props\n    })\n  );\n  Component.displayName = toPascalCase(iconName);\n  return Component;\n};\n\nexport { createLucideIcon as default };\n//# sourceMappingURL=createLucideIcon.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M8 2v4\", key: \"1cmpym\" }],\n  [\"path\", { d: \"M16 2v4\", key: \"4m81vk\" }],\n  [\"rect\", { width: \"18\", height: \"18\", x: \"3\", y: \"4\", rx: \"2\", key: \"1hopcy\" }],\n  [\"path\", { d: \"M3 10h18\", key: \"8toen8\" }]\n];\nconst Calendar = createLucideIcon(\"calendar\", __iconNode);\n\nexport { __iconNode, Calendar as default };\n//# sourceMappingURL=calendar.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [[\"path\", { d: \"M20 6 9 17l-5-5\", key: \"1gmf2c\" }]];\nconst Check = createLucideIcon(\"check\", __iconNode);\n\nexport { __iconNode, Check as default };\n//# sourceMappingURL=check.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [[\"path\", { d: \"m6 9 6 6 6-6\", key: \"qrunsl\" }]];\nconst ChevronDown = createLucideIcon(\"chevron-down\", __iconNode);\n\nexport { __iconNode, ChevronDown as default };\n//# sourceMappingURL=chevron-down.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [[\"path\", { d: \"m15 18-6-6 6-6\", key: \"1wnfg3\" }]];\nconst ChevronLeft = createLucideIcon(\"chevron-left\", __iconNode);\n\nexport { __iconNode, ChevronLeft as default };\n//# sourceMappingURL=chevron-left.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [[\"path\", { d: \"m9 18 6-6-6-6\", key: \"mthhwq\" }]];\nconst ChevronRight = createLucideIcon(\"chevron-right\", __iconNode);\n\nexport { __iconNode, ChevronRight as default };\n//# sourceMappingURL=chevron-right.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [[\"path\", { d: \"m18 15-6-6-6 6\", key: \"153udz\" }]];\nconst ChevronUp = createLucideIcon(\"chevron-up\", __iconNode);\n\nexport { __iconNode, ChevronUp as default };\n//# sourceMappingURL=chevron-up.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"m11 17-5-5 5-5\", key: \"13zhaf\" }],\n  [\"path\", { d: \"m18 17-5-5 5-5\", key: \"h8a8et\" }]\n];\nconst ChevronsLeft = createLucideIcon(\"chevrons-left\", __iconNode);\n\nexport { __iconNode, ChevronsLeft as default };\n//# sourceMappingURL=chevrons-left.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"m6 17 5-5-5-5\", key: \"xnjwq\" }],\n  [\"path\", { d: \"m13 17 5-5-5-5\", key: \"17xmmf\" }]\n];\nconst ChevronsRight = createLucideIcon(\"chevrons-right\", __iconNode);\n\nexport { __iconNode, ChevronsRight as default };\n//# sourceMappingURL=chevrons-right.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"m7 15 5 5 5-5\", key: \"1hf1tw\" }],\n  [\"path\", { d: \"m7 9 5-5 5 5\", key: \"sgt6xg\" }]\n];\nconst ChevronsUpDown = createLucideIcon(\"chevrons-up-down\", __iconNode);\n\nexport { __iconNode, ChevronsUpDown as default };\n//# sourceMappingURL=chevrons-up-down.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M12 6v6l4 2\", key: \"mmk7yg\" }],\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"10\", key: \"1mglay\" }]\n];\nconst Clock = createLucideIcon(\"clock\", __iconNode);\n\nexport { __iconNode, Clock as default };\n//# sourceMappingURL=clock.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"rect\", { width: \"14\", height: \"14\", x: \"8\", y: \"8\", rx: \"2\", ry: \"2\", key: \"17jyea\" }],\n  [\"path\", { d: \"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2\", key: \"zix9uf\" }]\n];\nconst Copy = createLucideIcon(\"copy\", __iconNode);\n\nexport { __iconNode, Copy as default };\n//# sourceMappingURL=copy.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"1\", key: \"41hilf\" }],\n  [\"circle\", { cx: \"12\", cy: \"5\", r: \"1\", key: \"gxeob9\" }],\n  [\"circle\", { cx: \"12\", cy: \"19\", r: \"1\", key: \"lyex9k\" }]\n];\nconst EllipsisVertical = createLucideIcon(\"ellipsis-vertical\", __iconNode);\n\nexport { __iconNode, EllipsisVertical as default };\n//# sourceMappingURL=ellipsis-vertical.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49\",\n      key: \"ct8e1f\"\n    }\n  ],\n  [\"path\", { d: \"M14.084 14.158a3 3 0 0 1-4.242-4.242\", key: \"151rxh\" }],\n  [\n    \"path\",\n    {\n      d: \"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143\",\n      key: \"13bj9a\"\n    }\n  ],\n  [\"path\", { d: \"m2 2 20 20\", key: \"1ooewy\" }]\n];\nconst EyeOff = createLucideIcon(\"eye-off\", __iconNode);\n\nexport { __iconNode, EyeOff as default };\n//# sourceMappingURL=eye-off.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0\",\n      key: \"1nclc0\"\n    }\n  ],\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"3\", key: \"1v7zrd\" }]\n];\nconst Eye = createLucideIcon(\"eye\", __iconNode);\n\nexport { __iconNode, Eye as default };\n//# sourceMappingURL=eye.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z\",\n      key: \"1oefj6\"\n    }\n  ],\n  [\"path\", { d: \"M14 2v5a1 1 0 0 0 1 1h5\", key: \"wfsgrz\" }]\n];\nconst File = createLucideIcon(\"file\", __iconNode);\n\nexport { __iconNode, File as default };\n//# sourceMappingURL=file.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2\",\n      key: \"usdka0\"\n    }\n  ]\n];\nconst FolderOpen = createLucideIcon(\"folder-open\", __iconNode);\n\nexport { __iconNode, FolderOpen as default };\n//# sourceMappingURL=folder-open.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z\",\n      key: \"1kt360\"\n    }\n  ]\n];\nconst Folder = createLucideIcon(\"folder\", __iconNode);\n\nexport { __iconNode, Folder as default };\n//# sourceMappingURL=folder.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"circle\", { cx: \"9\", cy: \"12\", r: \"1\", key: \"1vctgf\" }],\n  [\"circle\", { cx: \"9\", cy: \"5\", r: \"1\", key: \"hp0tcf\" }],\n  [\"circle\", { cx: \"9\", cy: \"19\", r: \"1\", key: \"fkjjf6\" }],\n  [\"circle\", { cx: \"15\", cy: \"12\", r: \"1\", key: \"1tmaij\" }],\n  [\"circle\", { cx: \"15\", cy: \"5\", r: \"1\", key: \"19l28e\" }],\n  [\"circle\", { cx: \"15\", cy: \"19\", r: \"1\", key: \"f4zoj3\" }]\n];\nconst GripVertical = createLucideIcon(\"grip-vertical\", __iconNode);\n\nexport { __iconNode, GripVertical as default };\n//# sourceMappingURL=grip-vertical.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [[\"path\", { d: \"M5 12h14\", key: \"1ays0h\" }]];\nconst Minus = createLucideIcon(\"minus\", __iconNode);\n\nexport { __iconNode, Minus as default };\n//# sourceMappingURL=minus.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z\",\n      key: \"1a8usu\"\n    }\n  ]\n];\nconst Pen = createLucideIcon(\"pen\", __iconNode);\n\nexport { __iconNode, Pen as default };\n//# sourceMappingURL=pen.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M5 12h14\", key: \"1ays0h\" }],\n  [\"path\", { d: \"M12 5v14\", key: \"s699le\" }]\n];\nconst Plus = createLucideIcon(\"plus\", __iconNode);\n\nexport { __iconNode, Plus as default };\n//# sourceMappingURL=plus.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"m21 21-4.34-4.34\", key: \"14j7rj\" }],\n  [\"circle\", { cx: \"11\", cy: \"11\", r: \"8\", key: \"4ej97u\" }]\n];\nconst Search = createLucideIcon(\"search\", __iconNode);\n\nexport { __iconNode, Search as default };\n//# sourceMappingURL=search.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z\",\n      key: \"1ffxy3\"\n    }\n  ],\n  [\"path\", { d: \"m21.854 2.147-10.94 10.939\", key: \"12cjpa\" }]\n];\nconst Send = createLucideIcon(\"send\", __iconNode);\n\nexport { __iconNode, Send as default };\n//# sourceMappingURL=send.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M10 11v6\", key: \"nco0om\" }],\n  [\"path\", { d: \"M14 11v6\", key: \"outv1u\" }],\n  [\"path\", { d: \"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6\", key: \"miytrc\" }],\n  [\"path\", { d: \"M3 6h18\", key: \"d0wm0j\" }],\n  [\"path\", { d: \"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\", key: \"e791ji\" }]\n];\nconst Trash2 = createLucideIcon(\"trash-2\", __iconNode);\n\nexport { __iconNode, Trash2 as default };\n//# sourceMappingURL=trash-2.js.map\n","/**\n * @license lucide-react v0.562.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M18 6 6 18\", key: \"1bl5f8\" }],\n  [\"path\", { d: \"m6 6 12 12\", key: \"d8bk6v\" }]\n];\nconst X = createLucideIcon(\"x\", __iconNode);\n\nexport { __iconNode, X as default };\n//# sourceMappingURL=x.js.map\n","import React from 'react';\r\n\r\nexport const Button = ({ children, className, ...props }: any) => (\r\n  <button className={className} {...props}>\r\n    {children}\r\n  </button>\r\n);\r\n","import React from 'react';\r\n\r\nexport const Input = ({ className, ...props }: any) => (\r\n  <input className={className} {...props} />\r\n);\r\n","import * as React from 'react';\r\n\r\nexport interface PopoverProps {\r\n  children?: React.ReactNode;\r\n  open?: boolean;\r\n  onOpenChange?: (open: boolean) => void;\r\n}\r\n\r\nexport const Popover: React.FC<PopoverProps> = ({ children }) => {\r\n  return <div className=\"relative\">{children}</div>;\r\n};\r\n\r\nexport interface PopoverTriggerProps {\r\n  asChild?: boolean;\r\n  children?: React.ReactNode;\r\n}\r\n\r\nexport const PopoverTrigger: React.FC<PopoverTriggerProps> = ({ children }) => {\r\n  return <div>{children}</div>;\r\n};\r\n\r\nexport interface PopoverContentProps {\r\n  className?: string;\r\n  align?: 'start' | 'center' | 'end';\r\n  children?: React.ReactNode;\r\n}\r\n\r\nexport const PopoverContent: React.FC<PopoverContentProps> = ({ className, children }) => {\r\n  return (\r\n    <div className={`absolute z-50 w-72 rounded-md border bg-white p-4 shadow-md ${className || ''}`}>\r\n      {children}\r\n    </div>\r\n  );\r\n};\r\n","export function cn(...classes: any[]) {\r\n  return classes.filter(Boolean).join(' ');\r\n}\r\n","import React, { useState, useMemo, useEffect, useRef } from 'react';\r\nimport { ChevronLeft, ChevronRight, Clock, Calendar as CalendarIcon } from 'lucide-react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Popover, PopoverContent, PopoverTrigger } from '@/components/ui/popover';\r\nimport { cn } from '@/lib/utils';\r\nimport './avakio-datepicker.css';\r\n\r\nexport interface AvakioDatePickerProps {\r\n  value?: string;\r\n  onChange: (value: string) => void;\r\n  className?: string;\r\n  showTime?: boolean; // If false, only returns date (YYYY-MM-DD), if true returns full ISO datetime\r\n  /** ID of the component */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n  /** Label displayed in the trigger button */\r\n  label?: string;\r\n  /** Placeholder when no date is selected */\r\n  placeholder?: string;\r\n  /** Use inline calendar instead of dropdown (legacy mode) */\r\n  inline?: boolean;\r\n}\r\n\r\nconst formatDisplayDate = (value: string | null | undefined, showTime: boolean) => {\r\n  if (!value) return \"â€”\";\r\n  const d = new Date(value);\r\n  if (Number.isNaN(d.getTime())) return value;\r\n  if (showTime) {\r\n    return d.toLocaleString(undefined, { \r\n      year: \"numeric\", \r\n      month: \"short\", \r\n      day: \"numeric\",\r\n      hour: \"2-digit\",\r\n      minute: \"2-digit\"\r\n    });\r\n  }\r\n  return d.toLocaleDateString(undefined, { year: \"numeric\", month: \"short\", day: \"numeric\" });\r\n};\r\n\r\n// Internal calendar component (can be used inline or in popover)\r\nfunction AvakioDatePickerCalendar({ \r\n  value, \r\n  onChange, \r\n  className, \r\n  showTime = true \r\n}: { \r\n  value?: string; \r\n  onChange: (value: string) => void; \r\n  className?: string; \r\n  showTime?: boolean;\r\n}) {\r\n  const selectedDate = value ? new Date(value) : null;\r\n  const [viewDate, setViewDate] = useState(selectedDate || new Date());\r\n\r\n  const monthNames = [\r\n    'January', 'February', 'March', 'April', 'May', 'June',\r\n    'July', 'August', 'September', 'October', 'November', 'December'\r\n  ];\r\n\r\n  const weekDays = ['SU', 'MO', 'TU', 'WE', 'TH', 'FR', 'SA'];\r\n\r\n  const { year, month } = useMemo(() => ({\r\n    year: viewDate.getFullYear(),\r\n    month: viewDate.getMonth()\r\n  }), [viewDate]);\r\n\r\n  const calendarDays = useMemo(() => {\r\n    const firstDay = new Date(year, month, 1);\r\n    const lastDay = new Date(year, month + 1, 0);\r\n    const startDay = firstDay.getDay();\r\n    const daysInMonth = lastDay.getDate();\r\n    const daysInPrevMonth = new Date(year, month, 0).getDate();\r\n\r\n    const days: Array<{ day: number; isCurrentMonth: boolean; date: Date }> = [];\r\n\r\n    // Previous month days\r\n    for (let i = startDay - 1; i >= 0; i--) {\r\n      days.push({\r\n        day: daysInPrevMonth - i,\r\n        isCurrentMonth: false,\r\n        date: new Date(year, month - 1, daysInPrevMonth - i)\r\n      });\r\n    }\r\n\r\n    // Current month days\r\n    for (let i = 1; i <= daysInMonth; i++) {\r\n      days.push({\r\n        day: i,\r\n        isCurrentMonth: true,\r\n        date: new Date(year, month, i)\r\n      });\r\n    }\r\n\r\n    // Next month days to fill the grid\r\n    const remainingDays = 42 - days.length; // 6 rows * 7 days\r\n    for (let i = 1; i <= remainingDays; i++) {\r\n      days.push({\r\n        day: i,\r\n        isCurrentMonth: false,\r\n        date: new Date(year, month + 1, i)\r\n      });\r\n    }\r\n\r\n    return days;\r\n  }, [year, month]);\r\n\r\n  const handlePrevMonth = () => {\r\n    setViewDate(new Date(year, month - 1, 1));\r\n  };\r\n\r\n  const handleNextMonth = () => {\r\n    setViewDate(new Date(year, month + 1, 1));\r\n  };\r\n\r\n  const handleDateSelect = (date: Date) => {\r\n    const newDate = new Date(date);\r\n    if (showTime) {\r\n      // Include time in the result\r\n      if (selectedDate) {\r\n        newDate.setHours(selectedDate.getHours());\r\n        newDate.setMinutes(selectedDate.getMinutes());\r\n      } else {\r\n        newDate.setHours(0);\r\n        newDate.setMinutes(0);\r\n      }\r\n      newDate.setSeconds(0);\r\n      newDate.setMilliseconds(0);\r\n      onChange(newDate.toISOString());\r\n    } else {\r\n      // Return only date without time (YYYY-MM-DD)\r\n      const year = newDate.getFullYear();\r\n      const month = String(newDate.getMonth() + 1).padStart(2, '0');\r\n      const day = String(newDate.getDate()).padStart(2, '0');\r\n      onChange(`${year}-${month}-${day}`);\r\n    }\r\n  };\r\n\r\n  const handleTimeChange = (hours: number, minutes: number) => {\r\n    const date = selectedDate ? new Date(selectedDate) : new Date();\r\n    date.setHours(hours);\r\n    date.setMinutes(minutes);\r\n    date.setSeconds(0);\r\n    date.setMilliseconds(0);\r\n    onChange(date.toISOString());\r\n  };\r\n\r\n  const handleToday = () => {\r\n    const now = new Date();\r\n    now.setSeconds(0);\r\n    now.setMilliseconds(0);\r\n    onChange(now.toISOString());\r\n    setViewDate(now);\r\n  };\r\n\r\n  const handleClear = () => {\r\n    onChange('');\r\n  };\r\n\r\n  const isSelected = (date: Date) => {\r\n    if (!selectedDate) return false;\r\n    return (\r\n      date.getDate() === selectedDate.getDate() &&\r\n      date.getMonth() === selectedDate.getMonth() &&\r\n      date.getFullYear() === selectedDate.getFullYear()\r\n    );\r\n  };\r\n\r\n  const isToday = (date: Date) => {\r\n    const today = new Date();\r\n    return (\r\n      date.getDate() === today.getDate() &&\r\n      date.getMonth() === today.getMonth() &&\r\n      date.getFullYear() === today.getFullYear()\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className={cn('avakio-datepicker-container', className)}>\r\n      {/* Navigation */}\r\n      <div className=\"avakio-dp-nav\">\r\n        <button\r\n          type=\"button\"\r\n          onClick={handlePrevMonth}\r\n          className=\"avakio-dp-nav-btn\"\r\n        >\r\n          <ChevronLeft className=\"h-4 w-4\" />\r\n        </button>\r\n        <div className=\"avakio-dp-nav-label\">\r\n          {monthNames[month]} {year}\r\n        </div>\r\n        <button\r\n          type=\"button\"\r\n          onClick={handleNextMonth}\r\n          className=\"avakio-dp-nav-btn\"\r\n        >\r\n          <ChevronRight className=\"h-4 w-4\" />\r\n        </button>\r\n      </div>\r\n\r\n      {/* Weekday headers */}\r\n      <div className=\"avakio-dp-weekdays\">\r\n        {weekDays.map(day => (\r\n          <div key={day} className=\"avakio-dp-weekday\">\r\n            {day}\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n      {/* Calendar grid */}\r\n      <div className=\"avakio-dp-days\">\r\n        {calendarDays.map((dayInfo, index) => (\r\n          <button\r\n            key={index}\r\n            type=\"button\"\r\n            onClick={() => handleDateSelect(dayInfo.date)}\r\n            className={cn(\r\n              'avakio-dp-day',\r\n              !dayInfo.isCurrentMonth && 'avakio-dp-day-outside',\r\n              isSelected(dayInfo.date) && 'avakio-dp-day-selected',\r\n              isToday(dayInfo.date) && !isSelected(dayInfo.date) && 'avakio-dp-day-today'\r\n            )}\r\n          >\r\n            {dayInfo.day}\r\n          </button>\r\n        ))}\r\n      </div>\r\n\r\n      {/* Time picker */}\r\n      {showTime && (\r\n      <div className=\"avakio-dp-time\">\r\n        <div className=\"avakio-dp-time-header\">\r\n          <Clock className=\"h-4 w-4\" />\r\n          <span className=\"avakio-dp-time-display\">\r\n            {selectedDate ? (\r\n              (() => {\r\n                const hours = selectedDate.getHours();\r\n                const minutes = selectedDate.getMinutes();\r\n                const ampm = hours >= 12 ? 'PM' : 'AM';\r\n                const displayHours = hours % 12 || 12;\r\n                return `${displayHours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')} ${ampm}`;\r\n              })()\r\n            ) : '00:00 AM'}\r\n          </span>\r\n        </div>\r\n        <div className=\"avakio-dp-time-inputs\">\r\n          <Input\r\n            type=\"number\"\r\n            min=\"0\"\r\n            max=\"23\"\r\n            placeholder=\"00\"\r\n            value={selectedDate ? selectedDate.getHours().toString().padStart(2, '0') : ''}\r\n            onChange={(e) => {\r\n              if (!e.target.value) return;\r\n              const hours = Math.max(0, Math.min(23, parseInt(e.target.value) || 0));\r\n              const minutes = selectedDate ? selectedDate.getMinutes() : 0;\r\n              handleTimeChange(hours, minutes);\r\n            }}\r\n            className=\"avakio-dp-time-input\"\r\n            disabled={!selectedDate}\r\n          />\r\n          <span className=\"avakio-dp-time-separator\">:</span>\r\n          <Input\r\n            type=\"number\"\r\n            min=\"0\"\r\n            max=\"59\"\r\n            placeholder=\"00\"\r\n            value={selectedDate ? selectedDate.getMinutes().toString().padStart(2, '0') : ''}\r\n            onChange={(e) => {\r\n              if (!e.target.value) return;\r\n              const minutes = Math.max(0, Math.min(59, parseInt(e.target.value) || 0));\r\n              const hours = selectedDate ? selectedDate.getHours() : 0;\r\n              handleTimeChange(hours, minutes);\r\n            }}\r\n            className=\"avakio-dp-time-input\"\r\n            disabled={!selectedDate}\r\n          />\r\n        </div>\r\n        {!selectedDate && (\r\n          <p className=\"avakio-dp-hint\">Select a date first</p>\r\n        )}\r\n      </div>\r\n      )}\r\n\r\n      {/* Action buttons - always visible */}\r\n      <div className=\"avakio-dp-actions\">\r\n        <Button\r\n          type=\"button\"\r\n          variant=\"ghost\"\r\n          size=\"sm\"\r\n          onClick={handleToday}\r\n          className=\"avakio-dp-action-btn\"\r\n        >\r\n          Today\r\n        </Button>\r\n        <Button\r\n          type=\"button\"\r\n          variant=\"ghost\"\r\n          size=\"sm\"\r\n          onClick={handleClear}\r\n          className=\"avakio-dp-action-btn\"\r\n        >\r\n          Clear\r\n        </Button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// Main exported component - dropdown version by default\r\nexport function AvakioDatePicker({ \r\n  value, \r\n  onChange, \r\n  className, \r\n  showTime = true, \r\n  id, \r\n  testId,\r\n  label = \"Date\",\r\n  placeholder = \"Select date\",\r\n  inline = false\r\n}: AvakioDatePickerProps) {\r\n  const [open, setOpen] = useState(false);\r\n  const rootRef = useRef<HTMLDivElement | null>(null);\r\n  const [themeAttr, setThemeAttr] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    const host = rootRef.current;\r\n    if (!host) return;\r\n    const nearest = host.closest('[data-admin-theme]') as HTMLElement | null;\r\n    setThemeAttr(nearest?.getAttribute('data-admin-theme') ?? null);\r\n\r\n    if (!nearest) return;\r\n    const observer = new MutationObserver(() => {\r\n      setThemeAttr(nearest.getAttribute('data-admin-theme') ?? null);\r\n    });\r\n    observer.observe(nearest, { attributes: true, attributeFilter: ['data-admin-theme'] });\r\n    return () => observer.disconnect();\r\n  }, []);\r\n\r\n  const displayValue = formatDisplayDate(value, showTime);\r\n\r\n  // If inline mode, render the calendar directly\r\n  if (inline) {\r\n    return (\r\n      <div \r\n        ref={rootRef}\r\n        id={id} \r\n        data-testid={testId} \r\n        className={cn('avakio-dp-inline', className)}\r\n        data-admin-theme={themeAttr || undefined}\r\n      >\r\n        <AvakioDatePickerCalendar \r\n          value={value} \r\n          onChange={onChange} \r\n          showTime={showTime} \r\n        />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Dropdown mode (default)\r\n  return (\r\n    <div\r\n      ref={rootRef}\r\n      id={id}\r\n      data-testid={testId}\r\n      className={cn('avakio-dp', className)}\r\n      data-admin-theme={themeAttr || undefined}\r\n    >\r\n      <Popover open={open} onOpenChange={setOpen}>\r\n        <PopoverTrigger asChild>\r\n          <button type=\"button\" className=\"avakio-dp-trigger\">\r\n            <div className=\"avakio-dp-trigger-label\">\r\n              <CalendarIcon size={16} />\r\n              <span>{label}</span>\r\n            </div>\r\n            <div className=\"avakio-dp-trigger-value\">\r\n              {value ? displayValue : <span className=\"avakio-dp-placeholder\">{placeholder}</span>}\r\n            </div>\r\n          </button>\r\n        </PopoverTrigger>\r\n        <PopoverContent\r\n          className=\"avakio-dp-popover\"\r\n          align=\"start\"\r\n          data-admin-theme={themeAttr || undefined}\r\n        >\r\n          <AvakioDatePickerCalendar \r\n            value={value} \r\n            onChange={(val) => {\r\n              onChange(val);\r\n              // Auto-close after selection if not showing time\r\n              if (!showTime && val) {\r\n                setOpen(false);\r\n              }\r\n            }} \r\n            showTime={showTime} \r\n          />\r\n          <div className=\"avakio-dp-footer\">\r\n            <button \r\n              type=\"button\" \r\n              className=\"avakio-dp-footer-action\" \r\n              onClick={() => {\r\n                onChange('');\r\n                setOpen(false);\r\n              }}\r\n            >\r\n              Clear\r\n            </button>\r\n            <button \r\n              type=\"button\" \r\n              className=\"avakio-dp-footer-action avakio-dp-footer-action-primary\" \r\n              onClick={() => setOpen(false)}\r\n            >\r\n              Done\r\n            </button>\r\n          </div>\r\n        </PopoverContent>\r\n      </Popover>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useEffect, useMemo, useRef, useState } from 'react';\r\nimport './avakio-checkbox.css';\r\n\r\nexport type AvakioCheckboxSize = 'sm' | 'md';\r\n\r\nexport interface AvakioCheckboxProps extends Omit<React.InputHTMLAttributes<HTMLInputElement>, 'size' | 'onChange'> {\r\n  checked?: boolean;\r\n  defaultChecked?: boolean;\r\n  indeterminate?: boolean;\r\n  label?: string;\r\n  description?: string;\r\n  size?: AvakioCheckboxSize;\r\n  error?: string;\r\n  required?: boolean;\r\n  onChange?: (checked: boolean) => void;\r\n  /** Padding (number for all sides, string for CSS, or [top, right, bottom, left]) */\r\n  padding?: string | number | [number, number, number, number];\r\n  /** Margin (number for all sides, string for CSS, or [top, right, bottom, left]) */\r\n  margin?: string | number | [number, number, number, number];\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n}\r\n\r\nexport function AvakioCheckbox({\r\n  id,\r\n  name,\r\n  value,\r\n  checked,\r\n  defaultChecked,\r\n  indeterminate = false,\r\n  label,\r\n  description,\r\n  size = 'md',\r\n  disabled = false,\r\n  error,\r\n  required = false,\r\n  className = '',\r\n  onChange,\r\n  padding,\r\n  margin,\r\n  testId,\r\n  ...rest\r\n}: AvakioCheckboxProps) {\r\n  const isControlled = checked !== undefined;\r\n  const [internalChecked, setInternalChecked] = useState<boolean>(defaultChecked ?? false);\r\n  const checkboxRef = useRef<HTMLInputElement>(null);\r\n\r\n  const isChecked = isControlled ? !!checked : internalChecked;\r\n\r\n  useEffect(() => {\r\n    if (checkboxRef.current) {\r\n      checkboxRef.current.indeterminate = indeterminate && !isChecked;\r\n    }\r\n  }, [indeterminate, isChecked]);\r\n\r\n  const status = useMemo(() => {\r\n    if (indeterminate && !isChecked) return 'indeterminate';\r\n    return isChecked ? 'checked' : 'unchecked';\r\n  }, [indeterminate, isChecked]);\r\n\r\n  const handleToggle = () => {\r\n    if (disabled) return;\r\n    if (!isControlled) {\r\n      setInternalChecked((prev) => (indeterminate ? true : !prev));\r\n    }\r\n    const next = indeterminate ? true : !isChecked;\r\n    onChange?.(next);\r\n  };\r\n\r\n  const handleKeyDown = (e: React.KeyboardEvent<HTMLDivElement>) => {\r\n    if (e.key === ' ' || e.key === 'Enter') {\r\n      e.preventDefault();\r\n      handleToggle();\r\n    }\r\n  };\r\n\r\n  const handleIconClick = (e: React.MouseEvent<HTMLSpanElement>) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    handleToggle();\r\n  };\r\n\r\n  // Handle padding\r\n  const paddingStyle = padding\r\n    ? typeof padding === 'number'\r\n      ? `${padding}px`\r\n      : Array.isArray(padding)\r\n      ? `${padding[0]}px ${padding[1]}px ${padding[2]}px ${padding[3]}px`\r\n      : padding\r\n    : undefined;\r\n\r\n  // Handle margin\r\n  const marginStyle = margin\r\n    ? typeof margin === 'number'\r\n      ? `${margin}px`\r\n      : Array.isArray(margin)\r\n      ? `${margin[0]}px ${margin[1]}px ${margin[2]}px ${margin[3]}px`\r\n      : margin\r\n    : undefined;\r\n\r\n  const containerStyle: React.CSSProperties = {\r\n    ...(paddingStyle && { padding: paddingStyle }),\r\n    ...(marginStyle && { margin: marginStyle }),\r\n  };\r\n\r\n  return (\r\n    <label\r\n      data-testid={testId}\r\n      className={[\r\n        'avakio-checkbox',\r\n        `avakio-checkbox-${size}`,\r\n        disabled ? 'avakio-checkbox-disabled' : '',\r\n        error ? 'avakio-checkbox-error' : '',\r\n        className,\r\n      ].filter(Boolean).join(' ')}\r\n      htmlFor={id}\r\n      data-status={status}\r\n      style={containerStyle}\r\n    >\r\n      <div\r\n        className=\"avakio-checkbox-box\"\r\n        role=\"checkbox\"\r\n        tabIndex={disabled ? -1 : 0}\r\n        aria-checked={status === 'indeterminate' ? 'mixed' : isChecked}\r\n        aria-disabled={disabled}\r\n        aria-invalid={!!error}\r\n        onKeyDown={handleKeyDown}\r\n        onClick={handleToggle}\r\n      >\r\n        <input\r\n          ref={checkboxRef}\r\n          id={id}\r\n          name={name}\r\n          value={value}\r\n          type=\"checkbox\"\r\n          checked={isChecked}\r\n          onChange={() => {}}\r\n          disabled={disabled}\r\n          tabIndex={-1}\r\n          {...rest}\r\n        />\r\n        <span className=\"avakio-checkbox-mark\" onClick={handleIconClick} />\r\n      </div>\r\n\r\n      {(label || description || error) && (\r\n        <div className=\"avakio-checkbox-text\">\r\n          <div className=\"avakio-checkbox-label-row\">\r\n            {label && <span className=\"avakio-checkbox-label\">{label}</span>}\r\n            {required && <span className=\"avakio-checkbox-required\">*</span>}\r\n          </div>\r\n          {description && <div className=\"avakio-checkbox-description\">{description}</div>}\r\n          {error && <div className=\"avakio-checkbox-error-text\">{error}</div>}\r\n        </div>\r\n      )}\r\n    </label>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useRef } from 'react';\r\nimport './avakio-button.css';\r\n\r\nexport type AvakioButtonVariant = 'primary' | 'secondary' | 'outline' | 'ghost' | 'danger';\r\nexport type AvakioButtonSize = 'sm' | 'md' | 'lg';\r\nexport type AvakioButtonType = 'default' | 'icon' | 'iconButton' | 'iconTop';\r\nexport type AvakioButtonAlign = 'left' | 'center' | 'right';\r\nexport type AvakioButtonTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\n\r\nexport interface AvakioButtonProps extends React.ButtonHTMLAttributes<HTMLButtonElement> {\r\n  /** Button text (children override this) */\r\n  label?: string;\r\n  /** Left icon */\r\n  icon?: React.ReactNode;\r\n  /** Right icon */\r\n  iconRight?: React.ReactNode;\r\n  /** Visual style variant */\r\n  variant?: AvakioButtonVariant;\r\n  /** Button size */\r\n  size?: AvakioButtonSize;\r\n  /** Full width button */\r\n  block?: boolean;\r\n  /** Loading state with spinner */\r\n  loading?: boolean;\r\n  /** Badge notification */\r\n  badge?: string | number;\r\n  /** Auto-adjust width to content */\r\n  autowidth?: boolean;\r\n  /** Tooltip text */\r\n  tooltip?: string;\r\n  /** Button type/layout */\r\n  buttonType?: AvakioButtonType;\r\n  /** Text alignment */\r\n  align?: AvakioButtonAlign;\r\n  /** Image URL for image button */\r\n  image?: string;\r\n  /** Keyboard hotkey (e.g., 'ctrl+s') */\r\n  hotkey?: string;\r\n  /** Popup menu ID or component */\r\n  popup?: string | React.ReactNode;\r\n  /** Value for form submission */\r\n  value?: string;\r\n  /** Name for form submission */\r\n  name?: string;\r\n  /** ID of the button */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n  /** Theme variant */\r\n  theme?: AvakioButtonTheme;\r\n}\r\n\r\nexport function AvakioButton({\r\n  label,\r\n  icon,\r\n  iconRight,\r\n  variant = 'primary',\r\n  size = 'md',\r\n  block = false,\r\n  loading = false,\r\n  badge,\r\n  disabled,\r\n  className = '',\r\n  children,\r\n  autowidth = false,\r\n  tooltip,\r\n  buttonType = 'default',\r\n  align = 'center',\r\n  image,\r\n  hotkey,\r\n  popup,\r\n  value,\r\n  name,\r\n  id,\r\n  testId,\r\n  theme,\r\n  onClick,\r\n  ...rest\r\n}: AvakioButtonProps) {\r\n  const isDisabled = disabled || loading;\r\n  const buttonRef = useRef<HTMLButtonElement>(null);\r\n\r\n  // Handle hotkey\r\n  React.useEffect(() => {\r\n    if (!hotkey) return;\r\n\r\n    const handleKeyDown = (e: KeyboardEvent) => {\r\n      const keys = hotkey.toLowerCase().split('+');\r\n      const ctrl = keys.includes('ctrl') || keys.includes('control');\r\n      const shift = keys.includes('shift');\r\n      const alt = keys.includes('alt');\r\n      const key = keys[keys.length - 1];\r\n\r\n      if (\r\n        (ctrl === (e.ctrlKey || e.metaKey)) &&\r\n        shift === e.shiftKey &&\r\n        alt === e.altKey &&\r\n        e.key.toLowerCase() === key\r\n      ) {\r\n        e.preventDefault();\r\n        buttonRef.current?.click();\r\n      }\r\n    };\r\n\r\n    document.addEventListener('keydown', handleKeyDown);\r\n    return () => document.removeEventListener('keydown', handleKeyDown);\r\n  }, [hotkey]);\r\n\r\n  const buttonTypeClass = buttonType === 'icon' || buttonType === 'iconButton' ? 'icon' : buttonType === 'iconTop' ? 'icon-top' : 'default';\r\n\r\n  return (\r\n    <button\r\n      ref={buttonRef}\r\n      id={id}\r\n      data-testid={testId}\r\n      data-admin-theme={theme}\r\n      className={[\r\n        'avakio-button',\r\n        `avakio-button-${variant}`,\r\n        `avakio-button-${size}`,\r\n        `avakio-button-type-${buttonTypeClass}`,\r\n        `avakio-button-align-${align}`,\r\n        block ? 'avakio-button-block' : '',\r\n        autowidth ? 'avakio-button-autowidth' : '',\r\n        loading ? 'avakio-button-loading' : '',\r\n        image ? 'avakio-button-image' : '',\r\n        className,\r\n      ].filter(Boolean).join(' ')}\r\n      disabled={isDisabled}\r\n      title={tooltip}\r\n      value={value}\r\n      name={name}\r\n      onClick={onClick}\r\n      {...rest}\r\n    >\r\n      <span className=\"avakio-button-inner\">\r\n        {loading && <span className=\"avakio-button-spinner\" aria-hidden />}\r\n        {image && <img src={image} alt=\"\" className=\"avakio-button-image-el\" />}\r\n        {icon && <span className=\"avakio-button-icon-left\">{icon}</span>}\r\n        {(children || label) && <span className=\"avakio-button-label\">{children ?? label}</span>}\r\n        {badge !== undefined && <span className=\"avakio-button-badge\">{badge}</span>}\r\n        {iconRight && <span className=\"avakio-button-icon-right\">{iconRight}</span>}\r\n        {hotkey && <span className=\"avakio-button-hotkey\">{hotkey}</span>}\r\n      </span>\r\n      {popup && typeof popup === 'string' && <div className=\"avakio-button-popup-ref\" data-popup={popup} />}\r\n    </button>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useEffect, useMemo, useRef, useState } from 'react';\r\nimport './avakio-colorpicker.css';\r\n\r\nexport interface AvakioColorPickerPreset {\r\n  label?: string;\r\n  value: string; // e.g. #1ca1c1\r\n}\r\n\r\nexport interface AvakioColorPickerProps {\r\n  id?: string;\r\n  value?: string;\r\n  defaultValue?: string;\r\n  onChange?: (color: string) => void;\r\n  label?: string;\r\n  description?: string;\r\n  error?: string;\r\n  disabled?: boolean;\r\n  readOnly?: boolean;\r\n  required?: boolean;\r\n  presets?: AvakioColorPickerPreset[];\r\n  allowCustomInput?: boolean;\r\n  showPreview?: boolean;\r\n  className?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n}\r\n\r\nconst normalizeHex = (hex: string) => {\r\n  if (!hex) return '';\r\n  const cleaned = hex.trim();\r\n  if (/^#?[0-9a-fA-F]{6}$/.test(cleaned)) {\r\n    return cleaned.startsWith('#') ? cleaned : `#${cleaned}`;\r\n  }\r\n  if (/^#?[0-9a-fA-F]{3}$/.test(cleaned)) {\r\n    const c = cleaned.replace('#', '');\r\n    const expanded = `#${c[0]}${c[0]}${c[1]}${c[1]}${c[2]}${c[2]}`;\r\n    return expanded;\r\n  }\r\n  return '';\r\n};\r\n\r\nexport function AvakioColorPicker({\r\n  id,\r\n  value,\r\n  defaultValue = '#1ca1c1',\r\n  onChange,\r\n  label,\r\n  description,\r\n  error,\r\n  disabled = false,\r\n  readOnly = false,\r\n  required = false,\r\n  presets = [],\r\n  allowCustomInput = true,\r\n  showPreview = true,\r\n  className = '',\r\n  testId,\r\n}: AvakioColorPickerProps) {\r\n  const isControlled = value !== undefined;\r\n  const [internal, setInternal] = useState<string>(normalizeHex(defaultValue) || '#1ca1c1');\r\n  const inputRef = useRef<HTMLInputElement>(null);\r\n\r\n  const currentColor = isControlled ? normalizeHex(value || '') || '#1ca1c1' : internal;\r\n\r\n  useEffect(() => {\r\n    if (!isControlled && !internal) {\r\n      setInternal('#1ca1c1');\r\n    }\r\n  }, [isControlled, internal]);\r\n\r\n  const allPresets = useMemo(() => {\r\n    if (presets.length) return presets;\r\n    return [\r\n      { label: 'Cyan', value: '#1ca1c1' },\r\n      { label: 'Blue', value: '#3b82f6' },\r\n      { label: 'Indigo', value: '#6366f1' },\r\n      { label: 'Violet', value: '#8b5cf6' },\r\n      { label: 'Emerald', value: '#10b981' },\r\n      { label: 'Amber', value: '#f59e0b' },\r\n      { label: 'Orange', value: '#f57c00' },\r\n      { label: 'Red', value: '#ef4444' },\r\n      { label: 'Gray', value: '#9ca3af' },\r\n      { label: 'Dark', value: '#111827' },\r\n    ];\r\n  }, [presets]);\r\n\r\n  const handleSelect = (hex: string) => {\r\n    const normalized = normalizeHex(hex);\r\n    if (!normalized) return;\r\n    if (!isControlled) {\r\n      setInternal(normalized);\r\n    }\r\n    onChange?.(normalized);\r\n  };\r\n\r\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const val = e.target.value;\r\n    const normalized = normalizeHex(val);\r\n    if (!isControlled) {\r\n      setInternal(val);\r\n    }\r\n    if (normalized) {\r\n      onChange?.(normalized);\r\n    }\r\n  };\r\n\r\n  const handleNativeChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const val = e.target.value;\r\n    handleSelect(val);\r\n  };\r\n\r\n  return (\r\n    <div\r\n      data-testid={testId}\r\n      className={[\r\n        'avakio-colorpicker',\r\n        disabled ? 'avakio-colorpicker-disabled' : '',\r\n        error ? 'avakio-colorpicker-error' : '',\r\n        className,\r\n      ].filter(Boolean).join(' ')}\r\n      data-color={currentColor}\r\n    >\r\n      {(label || description || error) && (\r\n        <div className=\"avakio-colorpicker-header\">\r\n          <div className=\"avakio-colorpicker-label-row\">\r\n            {label && <span className=\"avakio-colorpicker-label\">{label}</span>}\r\n            {required && <span className=\"avakio-colorpicker-required\">*</span>}\r\n          </div>\r\n          {description && <div className=\"avakio-colorpicker-description\">{description}</div>}\r\n          {error && <div className=\"avakio-colorpicker-error-text\">{error}</div>}\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"avakio-colorpicker-body\">\r\n        {showPreview && (\r\n          <div className=\"avakio-colorpicker-preview\" style={{ backgroundColor: currentColor }} aria-label=\"Color preview\" />\r\n        )}\r\n\r\n        <div className=\"avakio-colorpicker-controls\">\r\n          <input\r\n            ref={inputRef}\r\n            type=\"color\"\r\n            className=\"avakio-colorpicker-native\"\r\n            value={currentColor}\r\n            onChange={handleNativeChange}\r\n            disabled={disabled || readOnly}\r\n            aria-label=\"Pick color\"\r\n          />\r\n\r\n          {allowCustomInput && (\r\n            <input\r\n              type=\"text\"\r\n              className=\"avakio-colorpicker-hex\"\r\n              value={currentColor}\r\n              onChange={handleInputChange}\r\n              disabled={disabled || readOnly}\r\n              maxLength={7}\r\n              aria-label=\"Hex value\"\r\n            />\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {allPresets.length > 0 && (\r\n        <div className=\"avakio-colorpicker-swatches\" aria-label=\"Color presets\">\r\n          {allPresets.map((preset) => (\r\n            <button\r\n              key={preset.value}\r\n              type=\"button\"\r\n              className=\"avakio-colorpicker-swatch\"\r\n              style={{ backgroundColor: preset.value }}\r\n              onClick={() => handleSelect(preset.value)}\r\n              disabled={disabled || readOnly}\r\n              aria-label={preset.label || preset.value}\r\n            >\r\n              <span className=\"avakio-colorpicker-swatch-inner\" />\r\n              {currentColor.toLowerCase() === preset.value.toLowerCase() && (\r\n                <span className=\"avakio-colorpicker-swatch-active\" />\r\n              )}\r\n            </button>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useState, useRef, useEffect, useCallback } from 'react';\r\nimport { ChevronDown, X, Search } from 'lucide-react';\r\nimport './avakio-combo.css';\r\n\r\nexport interface AvakioComboOption {\r\n  id: string | number;\r\n  value: string;\r\n  [key: string]: any;\r\n}\r\n\r\nexport interface AvakioComboProps {\r\n  id?: string;\r\n  value?: string | number;\r\n  options: AvakioComboOption[] | string[];\r\n  onChange?: (value: string | number, option?: AvakioComboOption) => void;\r\n  onInputChange?: (inputValue: string) => void;\r\n  placeholder?: string;\r\n  label?: string;\r\n  labelAlign?: 'left' | 'right';\r\n  labelWidth?: number;\r\n  disabled?: boolean;\r\n  readonly?: boolean;\r\n  filterMode?: 'startsWith' | 'contains' | 'custom';\r\n  customFilter?: (option: AvakioComboOption, inputValue: string) => boolean;\r\n  template?: (option: AvakioComboOption) => React.ReactNode;\r\n  width?: number | string;\r\n  maxHeight?: number;\r\n  required?: boolean;\r\n  error?: string;\r\n  className?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n}\r\n\r\nexport function AvakioCombo({\r\n  id,\r\n  value,\r\n  options = [],\r\n  onChange,\r\n  onInputChange,\r\n  placeholder = 'Select or type...',\r\n  label,\r\n  labelAlign = 'left',\r\n  labelWidth = 100,\r\n  disabled = false,\r\n  readonly = false,\r\n  filterMode = 'contains',\r\n  customFilter,\r\n  template,\r\n  width,\r\n  maxHeight = 300,\r\n  required = false,\r\n  error,\r\n  className = '',\r\n  testId,\r\n}: AvakioComboProps) {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [inputValue, setInputValue] = useState('');\r\n  const [highlightedIndex, setHighlightedIndex] = useState(-1);\r\n  const [selectedOption, setSelectedOption] = useState<AvakioComboOption | null>(null);\r\n  const inputRef = useRef<HTMLInputElement>(null);\r\n  const dropdownRef = useRef<HTMLDivElement>(null);\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n\r\n  // Normalize options to AvakioComboOption format\r\n  const normalizedOptions: AvakioComboOption[] = options.map((opt) => {\r\n    if (typeof opt === 'string') {\r\n      return { id: opt, value: opt };\r\n    }\r\n    return opt;\r\n  });\r\n\r\n  // Initialize selected option based on value prop\r\n  useEffect(() => {\r\n    if (value !== undefined && value !== null && value !== '') {\r\n      const option = normalizedOptions.find(\r\n        (opt) => opt.id === value || opt.value === value\r\n      );\r\n      if (option) {\r\n        setSelectedOption(option);\r\n        setInputValue(option.value);\r\n      }\r\n    } else {\r\n      setSelectedOption(null);\r\n      setInputValue('');\r\n    }\r\n  }, [value]);\r\n\r\n  // Filter options based on input\r\n  const filteredOptions = normalizedOptions.filter((option) => {\r\n    if (!inputValue) return true;\r\n\r\n    if (customFilter) {\r\n      return customFilter(option, inputValue);\r\n    }\r\n\r\n    const searchValue = inputValue.toLowerCase();\r\n    const optionValue = option.value.toLowerCase();\r\n\r\n    switch (filterMode) {\r\n      case 'startsWith':\r\n        return optionValue.startsWith(searchValue);\r\n      case 'contains':\r\n      default:\r\n        return optionValue.includes(searchValue);\r\n    }\r\n  });\r\n\r\n  // Handle input change\r\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const newValue = e.target.value;\r\n    setInputValue(newValue);\r\n    setIsOpen(true);\r\n    setHighlightedIndex(-1);\r\n    \r\n    onInputChange?.(newValue);\r\n  };\r\n\r\n  // Handle option selection\r\n  const handleSelectOption = (option: AvakioComboOption) => {\r\n    setSelectedOption(option);\r\n    setInputValue(option.value);\r\n    setIsOpen(false);\r\n    setHighlightedIndex(-1);\r\n    \r\n    onChange?.(option.id, option);\r\n  };\r\n\r\n  // Handle clear\r\n  const handleClear = (e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    setSelectedOption(null);\r\n    setInputValue('');\r\n    setIsOpen(false);\r\n    \r\n    onChange?.('', undefined);\r\n    inputRef.current?.focus();\r\n  };\r\n\r\n  // Handle keyboard navigation\r\n  const handleKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\r\n    if (disabled || readonly) return;\r\n\r\n    switch (e.key) {\r\n      case 'ArrowDown':\r\n        e.preventDefault();\r\n        if (!isOpen) {\r\n          setIsOpen(true);\r\n        } else {\r\n          setHighlightedIndex((prev) =>\r\n            prev < filteredOptions.length - 1 ? prev + 1 : prev\r\n          );\r\n        }\r\n        break;\r\n\r\n      case 'ArrowUp':\r\n        e.preventDefault();\r\n        if (isOpen) {\r\n          setHighlightedIndex((prev) => (prev > 0 ? prev - 1 : -1));\r\n        }\r\n        break;\r\n\r\n      case 'Enter':\r\n        e.preventDefault();\r\n        if (isOpen && highlightedIndex >= 0 && filteredOptions[highlightedIndex]) {\r\n          handleSelectOption(filteredOptions[highlightedIndex]);\r\n        }\r\n        break;\r\n\r\n      case 'Escape':\r\n        e.preventDefault();\r\n        setIsOpen(false);\r\n        setHighlightedIndex(-1);\r\n        break;\r\n\r\n      case 'Tab':\r\n        setIsOpen(false);\r\n        break;\r\n    }\r\n  };\r\n\r\n  // Scroll highlighted option into view\r\n  useEffect(() => {\r\n    if (highlightedIndex >= 0 && dropdownRef.current) {\r\n      const highlightedElement = dropdownRef.current.children[highlightedIndex] as HTMLElement;\r\n      if (highlightedElement) {\r\n        highlightedElement.scrollIntoView({\r\n          block: 'nearest',\r\n          behavior: 'smooth',\r\n        });\r\n      }\r\n    }\r\n  }, [highlightedIndex]);\r\n\r\n  // Close dropdown when clicking outside\r\n  useEffect(() => {\r\n    const handleClickOutside = (event: MouseEvent) => {\r\n      if (\r\n        containerRef.current &&\r\n        !containerRef.current.contains(event.target as Node)\r\n      ) {\r\n        setIsOpen(false);\r\n        setHighlightedIndex(-1);\r\n      }\r\n    };\r\n\r\n    document.addEventListener('mousedown', handleClickOutside);\r\n    return () => document.removeEventListener('mousedown', handleClickOutside);\r\n  }, []);\r\n\r\n  const renderOption = (option: AvakioComboOption) => {\r\n    if (template) {\r\n      return template(option);\r\n    }\r\n    return option.value;\r\n  };\r\n\r\n  return (\r\n    <div\r\n      ref={containerRef}\r\n      data-testid={testId}\r\n      className={`avakio-combo-wrapper ${className}`}\r\n      style={{ width: width || '100%' }}\r\n    >\r\n      {label && (\r\n        <label\r\n          htmlFor={id}\r\n          className={`avakio-combo-label avakio-combo-label-${labelAlign}`}\r\n          style={{ width: labelWidth }}\r\n        >\r\n          {label}\r\n          {required && <span className=\"avakio-combo-required\">*</span>}\r\n        </label>\r\n      )}\r\n      <div className=\"avakio-combo-container\">\r\n        <div\r\n          className={`avakio-combo-input-wrapper ${isOpen ? 'open' : ''} ${\r\n            error ? 'error' : ''\r\n          } ${disabled ? 'disabled' : ''}`}\r\n        >\r\n          <Search className=\"avakio-combo-search-icon\" size={16} />\r\n          <input\r\n            ref={inputRef}\r\n            id={id}\r\n            type=\"text\"\r\n            className=\"avakio-combo-input\"\r\n            value={inputValue}\r\n            onChange={handleInputChange}\r\n            onKeyDown={handleKeyDown}\r\n            onFocus={() => !readonly && setIsOpen(true)}\r\n            placeholder={placeholder}\r\n            disabled={disabled}\r\n            readOnly={readonly}\r\n            required={required}\r\n          />\r\n          {inputValue && !disabled && !readonly && (\r\n            <button\r\n              type=\"button\"\r\n              className=\"avakio-combo-clear-btn\"\r\n              onClick={handleClear}\r\n              tabIndex={-1}\r\n            >\r\n              <X size={16} />\r\n            </button>\r\n          )}\r\n          <button\r\n            type=\"button\"\r\n            className=\"avakio-combo-toggle-btn\"\r\n            onClick={() => !disabled && !readonly && setIsOpen(!isOpen)}\r\n            disabled={disabled}\r\n            tabIndex={-1}\r\n          >\r\n            <ChevronDown size={16} className={isOpen ? 'rotate' : ''} />\r\n          </button>\r\n        </div>\r\n\r\n        {isOpen && !disabled && !readonly && (\r\n          <div\r\n            className=\"avakio-combo-dropdown\"\r\n            style={{ maxHeight }}\r\n          >\r\n            <div ref={dropdownRef} className=\"avakio-combo-options\">\r\n              {filteredOptions.length > 0 ? (\r\n                filteredOptions.map((option, index) => (\r\n                  <div\r\n                    key={option.id}\r\n                    className={`avakio-combo-option ${\r\n                      highlightedIndex === index ? 'highlighted' : ''\r\n                    } ${selectedOption?.id === option.id ? 'selected' : ''}`}\r\n                    onClick={() => handleSelectOption(option)}\r\n                    onMouseEnter={() => setHighlightedIndex(index)}\r\n                  >\r\n                    {renderOption(option)}\r\n                  </div>\r\n                ))\r\n              ) : (\r\n                <div className=\"avakio-combo-no-options\">No options found</div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {error && <div className=\"avakio-combo-error-message\">{error}</div>}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useEffect, useState } from 'react';\r\nimport './avakio-counter.css';\r\nimport { Minus, Plus } from 'lucide-react';\r\n\r\ntype Size = 'sm' | 'md' | 'lg';\r\n\r\nexport interface AvakioCounterProps {\r\n  id?: string;\r\n  value?: number;\r\n  defaultValue?: number;\r\n  step?: number;\r\n  min?: number;\r\n  max?: number;\r\n  label?: string;\r\n  labelPosition?: 'left' | 'top';\r\n  labelWidth?: number;\r\n  description?: string;\r\n  error?: string;\r\n  required?: boolean;\r\n  disabled?: boolean;\r\n  readOnly?: boolean;\r\n  size?: Size;\r\n  allowInput?: boolean;\r\n  onChange?: (value: number) => void;\r\n  className?: string;\r\n  /** Padding (number for all sides, string for CSS, or [top, right, bottom, left]) */\r\n  padding?: string | number | [number, number, number, number];\r\n  /** Margin (number for all sides, string for CSS, or [top, right, bottom, left]) */\r\n  margin?: string | number | [number, number, number, number];\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n}\r\n\r\nexport function AvakioCounter({\r\n  id,\r\n  value,\r\n  defaultValue = 0,\r\n  step = 1,\r\n  min,\r\n  max,\r\n  label,\r\n  labelPosition = 'top',\r\n  labelWidth = 100,\r\n  description,\r\n  error,\r\n  required = false,\r\n  disabled = false,\r\n  readOnly = false,\r\n  size = 'md',\r\n  allowInput = true,\r\n  onChange,\r\n  className = '',\r\n  padding,\r\n  margin,\r\n  testId,\r\n}: AvakioCounterProps) {\r\n  const isControlled = value !== undefined;\r\n  const [internal, setInternal] = useState<number>(value ?? defaultValue);\r\n\r\n  useEffect(() => {\r\n    if (isControlled && value !== undefined) {\r\n      setInternal(value);\r\n    }\r\n  }, [isControlled, value]);\r\n\r\n  const clamp = (val: number) => {\r\n    let next = val;\r\n    if (min !== undefined) next = Math.max(next, min);\r\n    if (max !== undefined) next = Math.min(next, max);\r\n    return next;\r\n  };\r\n\r\n  const current = clamp(internal);\r\n\r\n  const emitChange = (next: number) => {\r\n    if (!isControlled) {\r\n      setInternal(next);\r\n    }\r\n    onChange?.(next);\r\n  };\r\n\r\n  const handleStep = (delta: number) => {\r\n    if (disabled || readOnly) return;\r\n    const next = clamp(current + delta * step);\r\n    emitChange(next);\r\n  };\r\n\r\n  const handleInput = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    if (disabled || readOnly) return;\r\n    const raw = e.target.value;\r\n    if (raw === '') {\r\n      if (!isControlled) setInternal(NaN);\r\n      return;\r\n    }\r\n    const parsed = Number(raw);\r\n    if (Number.isNaN(parsed)) return;\r\n    emitChange(clamp(parsed));\r\n  };\r\n\r\n  const displayValue = Number.isNaN(current) ? '' : current;\r\n  const canDecrement = min === undefined ? true : displayValue === '' ? true : displayValue > min;\r\n  const canIncrement = max === undefined ? true : displayValue === '' ? true : displayValue < max;\r\n\r\n  // Handle padding\r\n  const paddingStyle = padding\r\n    ? typeof padding === 'number'\r\n      ? `${padding}px`\r\n      : Array.isArray(padding)\r\n      ? `${padding[0]}px ${padding[1]}px ${padding[2]}px ${padding[3]}px`\r\n      : padding\r\n    : undefined;\r\n\r\n  // Handle margin\r\n  const marginStyle = margin\r\n    ? typeof margin === 'number'\r\n      ? `${margin}px`\r\n      : Array.isArray(margin)\r\n      ? `${margin[0]}px ${margin[1]}px ${margin[2]}px ${margin[3]}px`\r\n      : margin\r\n    : undefined;\r\n\r\n  const containerStyle: React.CSSProperties = {\r\n    ...(paddingStyle && { padding: paddingStyle }),\r\n    ...(marginStyle && { margin: marginStyle }),\r\n  };\r\n\r\n  return (\r\n    <div\r\n      data-testid={testId}\r\n      className={[\r\n        'avakio-counter',\r\n        `avakio-counter-${size}`,\r\n        `avakio-counter-label-${labelPosition}`,\r\n        disabled ? 'avakio-counter-disabled' : '',\r\n        error ? 'avakio-counter-error' : '',\r\n        className,\r\n      ].filter(Boolean).join(' ')}\r\n      style={containerStyle}\r\n    >\r\n      {(label || description || error) && labelPosition === 'top' && (\r\n        <div className=\"avakio-counter-header\">\r\n          <div className=\"avakio-counter-label-row\">\r\n            {label && <span className=\"avakio-counter-label\">{label}</span>}\r\n            {required && <span className=\"avakio-counter-required\">*</span>}\r\n          </div>\r\n          {description && <div className=\"avakio-counter-description\">{description}</div>}\r\n          {error && <div className=\"avakio-counter-error-text\">{error}</div>}\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"avakio-counter-content\">\r\n        {label && labelPosition === 'left' && (\r\n          <div className=\"avakio-counter-label-left\" style={{ width: labelWidth }}>\r\n            <span className=\"avakio-counter-label\">{label}</span>\r\n            {required && <span className=\"avakio-counter-required\">*</span>}\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"avakio-counter-body\">\r\n        <button\r\n          type=\"button\"\r\n          className=\"avakio-counter-btn\"\r\n          onClick={() => handleStep(-1)}\r\n          disabled={disabled || readOnly || !canDecrement}\r\n          aria-label=\"Decrease\"\r\n        >\r\n          <Minus size={16} />\r\n        </button>\r\n\r\n        <input\r\n          id={id}\r\n          type=\"number\"\r\n          className=\"avakio-counter-input\"\r\n          value={displayValue}\r\n          onChange={handleInput}\r\n          disabled={disabled || readOnly || !allowInput}\r\n          readOnly={!allowInput}\r\n          min={min}\r\n          max={max}\r\n          step={step}\r\n          aria-live=\"polite\"\r\n        />\r\n\r\n        <button\r\n          type=\"button\"\r\n          className=\"avakio-counter-btn\"\r\n          onClick={() => handleStep(1)}\r\n          disabled={disabled || readOnly || !canIncrement}\r\n          aria-label=\"Increase\"\r\n        >\r\n          <Plus size={16} />\r\n        </button>\r\n      </div>\r\n\r\n      {labelPosition === 'left' && (description || error) && (\r\n        <div className=\"avakio-counter-footer\">\r\n          {description && <div className=\"avakio-counter-description\">{description}</div>}\r\n          {error && <div className=\"avakio-counter-error-text\">{error}</div>}\r\n        </div>\r\n      )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useEffect, useMemo, useRef, useState } from \"react\";\r\nimport { Calendar as CalendarIcon } from \"lucide-react\";\r\nimport { Popover, PopoverContent, PopoverTrigger } from '@/components/ui/popover';\r\nimport { AvakioDatePicker } from \"../avakio-datepicker/avakio-datepicker\";\r\nimport \"./avakio-daterangepicker.css\";\r\n\r\nexport type AvakioDateRange = {\r\n  start: string | null; // ISO or YYYY-MM-DD\r\n  end: string | null;\r\n};\r\n\r\nexport type PresetRange = {\r\n  label: string;\r\n  range: () => AvakioDateRange;\r\n};\r\n\r\nexport interface AvakioDateRangePickerProps {\r\n  value?: AvakioDateRange;\r\n  defaultValue?: AvakioDateRange;\r\n  onChange?: (range: AvakioDateRange) => void;\r\n  presets?: PresetRange[];\r\n  allowSingleDay?: boolean;\r\n  showTime?: boolean;\r\n  className?: string;\r\n  /** ID of the component */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n}\r\n\r\nconst formatDate = (value: string | null) => {\r\n  if (!value) return \"â€”\";\r\n  const d = new Date(value);\r\n  if (Number.isNaN(d.getTime())) return value;\r\n  return d.toLocaleDateString(undefined, { year: \"numeric\", month: \"short\", day: \"numeric\" });\r\n};\r\n\r\nconst normalize = (range: AvakioDateRange, allowSingleDay: boolean): AvakioDateRange => {\r\n  if (!range.start || !range.end) return range;\r\n  const s = new Date(range.start);\r\n  const e = new Date(range.end);\r\n  if (s.getTime() > e.getTime()) return { start: range.end, end: range.start };\r\n  if (!allowSingleDay && s.getTime() === e.getTime()) return { start: range.start, end: null };\r\n  return range;\r\n};\r\n\r\nexport function AvakioDateRangePicker({\r\n  value,\r\n  defaultValue,\r\n  onChange,\r\n  presets,\r\n  allowSingleDay = true,\r\n  showTime = false,\r\n  className,\r\n  id,\r\n  testId,\r\n}: AvakioDateRangePickerProps) {\r\n  const isControlled = value !== undefined;\r\n  const [internalRange, setInternalRange] = useState<AvakioDateRange>(\r\n    value || defaultValue || { start: null, end: null }\r\n  );\r\n  const [open, setOpen] = useState(false);\r\n  const rootRef = useRef<HTMLDivElement | null>(null);\r\n  const [themeAttr, setThemeAttr] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    const host = rootRef.current;\r\n    if (!host) return;\r\n    const nearest = host.closest('[data-admin-theme]') as HTMLElement | null;\r\n    setThemeAttr(nearest?.getAttribute('data-admin-theme') ?? null);\r\n\r\n    if (!nearest) return;\r\n    const observer = new MutationObserver(() => {\r\n      setThemeAttr(nearest.getAttribute('data-admin-theme') ?? null);\r\n    });\r\n    observer.observe(nearest, { attributes: true, attributeFilter: ['data-admin-theme'] });\r\n    return () => observer.disconnect();\r\n  }, []);\r\n\r\n  const range = useMemo(\r\n    () => normalize(isControlled ? value! : internalRange, allowSingleDay),\r\n    [isControlled, value, internalRange, allowSingleDay]\r\n  );\r\n\r\n  const applyRange = (next: AvakioDateRange) => {\r\n    const normalized = normalize(next, allowSingleDay);\r\n    if (!isControlled) setInternalRange(normalized);\r\n    onChange?.(normalized);\r\n  };\r\n\r\n  const presetItems: PresetRange[] = presets || [\r\n    {\r\n      label: \"Today\",\r\n      range: () => {\r\n        const t = new Date();\r\n        const iso = t.toISOString();\r\n        return { start: iso, end: iso };\r\n      },\r\n    },\r\n    {\r\n      label: \"Last 7 days\",\r\n      range: () => {\r\n        const end = new Date();\r\n        const start = new Date();\r\n        start.setDate(end.getDate() - 6);\r\n        return { start: start.toISOString(), end: end.toISOString() };\r\n      },\r\n    },\r\n    {\r\n      label: \"This month\",\r\n      range: () => {\r\n        const now = new Date();\r\n        const start = new Date(now.getFullYear(), now.getMonth(), 1);\r\n        const end = new Date(now.getFullYear(), now.getMonth() + 1, 0);\r\n        return { start: start.toISOString(), end: end.toISOString() };\r\n      },\r\n    },\r\n    {\r\n      label: \"Clear\",\r\n      range: () => ({ start: null, end: null }),\r\n    },\r\n  ];\r\n\r\n  const handleStart = (next: string) => {\r\n    applyRange({ start: next, end: range?.end ?? null });\r\n  };\r\n\r\n  const handleEnd = (next: string) => {\r\n    applyRange({ start: range?.start ?? null, end: next });\r\n  };\r\n\r\n  const display = `${formatDate(range?.start)} â†’ ${formatDate(range?.end)}`;\r\n\r\n  return (\r\n    <div\r\n      ref={rootRef}\r\n      id={id}\r\n      data-testid={testId}\r\n      className={[\"avakio-drp\", className || \"\"].join(\" \")}\r\n      data-admin-theme={themeAttr || undefined}\r\n    >\r\n      <Popover open={open} onOpenChange={setOpen}>\r\n        <PopoverTrigger asChild>\r\n          <button type=\"button\" className=\"avakio-drp-trigger\">\r\n            <div className=\"avakio-drp-trigger-label\">\r\n              <CalendarIcon size={16} />\r\n              <span>Date Range</span>\r\n            </div>\r\n            <div className=\"avakio-drp-trigger-value\">{display}</div>\r\n          </button>\r\n        </PopoverTrigger>\r\n        <PopoverContent\r\n          className=\"avakio-drp-popover\"\r\n          align=\"center\"\r\n          data-admin-theme={themeAttr || undefined}\r\n        >\r\n          <div className=\"avakio-drp-panel\">\r\n            <div className=\"avakio-drp-col\">\r\n              <div className=\"avakio-drp-col-header\">From</div>\r\n              <div data-admin-theme={themeAttr || undefined}>\r\n                <AvakioDatePicker value={range?.start || \"\"} onChange={handleStart} showTime={showTime} inline />\r\n              </div>\r\n            </div>\r\n            <div className=\"avakio-drp-col\">\r\n              <div className=\"avakio-drp-col-header\">To</div>\r\n              <div data-admin-theme={themeAttr || undefined}>\r\n                <AvakioDatePicker value={range?.end || \"\"} onChange={handleEnd} showTime={showTime} inline />\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"avakio-drp-presets\">\r\n            {presetItems.map((p) => (\r\n              <button\r\n                key={p.label}\r\n                type=\"button\"\r\n                className=\"avakio-drp-preset\"\r\n                onClick={() => applyRange(p.range())}\r\n              >\r\n                {p.label}\r\n              </button>\r\n            ))}\r\n          </div>\r\n\r\n          <div className=\"avakio-drp-footer\">\r\n            <button type=\"button\" className=\"avakio-drp-action\" onClick={() => applyRange({ start: null, end: null })}>\r\n              Clear\r\n            </button>\r\n            <button type=\"button\" className=\"avakio-drp-action\" onClick={() => setOpen(false)}>\r\n              Close\r\n            </button>\r\n          </div>\r\n        </PopoverContent>\r\n      </Popover>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useState, useRef, useEffect } from 'react';\r\nimport { ChevronDown, X, Search } from 'lucide-react';\r\nimport './avakio-gridsuggest.css';\r\n\r\nexport interface AvakioGridSuggestColumn {\r\n  id: string;\r\n  header?: string;\r\n  width?: number | string;\r\n  template?: (value: any, item: any) => React.ReactNode;\r\n}\r\n\r\nexport interface AvakioGridSuggestOption {\r\n  id: string | number;\r\n  [key: string]: any;\r\n}\r\n\r\nexport interface AvakioGridSuggestBodyConfig {\r\n  columns?: AvakioGridSuggestColumn[];\r\n  autoConfig?: boolean;\r\n  header?: boolean;\r\n  borderless?: boolean;\r\n  scroll?: boolean;\r\n  autoheight?: boolean;\r\n  yCount?: number;\r\n  data?: AvakioGridSuggestOption[];\r\n}\r\n\r\nexport interface AvakioGridSuggestProps {\r\n  id?: string;\r\n  value?: string | number;\r\n  data?: AvakioGridSuggestOption[];\r\n  onChange?: (value: string | number, option?: AvakioGridSuggestOption) => void;\r\n  onInputChange?: (inputValue: string) => void;\r\n  placeholder?: string;\r\n  label?: string;\r\n  labelAlign?: 'left' | 'right';\r\n  labelWidth?: number;\r\n  disabled?: boolean;\r\n  readonly?: boolean;\r\n  textValue?: string; // Template string for display value (e.g., \"#name#\")\r\n  template?: (item: AvakioGridSuggestOption) => React.ReactNode;\r\n  width?: number | string;\r\n  body?: AvakioGridSuggestBodyConfig;\r\n  required?: boolean;\r\n  error?: string;\r\n  className?: string;\r\n  editable?: boolean; // Allow typing/filtering like combo\r\n  filterMode?: 'startsWith' | 'contains';\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n}\r\n\r\nexport function AvakioGridSuggest({\r\n  id,\r\n  value,\r\n  data = [],\r\n  onChange,\r\n  onInputChange,\r\n  placeholder = 'Select...',\r\n  label,\r\n  labelAlign = 'left',\r\n  labelWidth = 100,\r\n  disabled = false,\r\n  readonly = false,\r\n  textValue,\r\n  template,\r\n  width,\r\n  body = { autoConfig: true, header: true, borderless: false },\r\n  required = false,\r\n  error,\r\n  className = '',\r\n  editable = true,\r\n  filterMode = 'contains',\r\n  testId,\r\n}: AvakioGridSuggestProps) {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [inputValue, setInputValue] = useState('');\r\n  const [highlightedIndex, setHighlightedIndex] = useState(-1);\r\n  const [selectedOption, setSelectedOption] = useState<AvakioGridSuggestOption | null>(null);\r\n  const inputRef = useRef<HTMLInputElement>(null);\r\n  const dropdownRef = useRef<HTMLDivElement>(null);\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n\r\n  // Use body.data if provided, otherwise use data prop\r\n  const options = body?.data || data;\r\n\r\n  // Auto-generate columns if autoConfig is true\r\n  const columns: AvakioGridSuggestColumn[] = React.useMemo(() => {\r\n    if (body?.columns) {\r\n      return body.columns;\r\n    }\r\n    if (body?.autoConfig && options.length > 0) {\r\n      const firstItem = options[0];\r\n      return Object.keys(firstItem)\r\n        .filter((key) => key !== 'id')\r\n        .map((key) => ({\r\n          id: key,\r\n          header: key.charAt(0).toUpperCase() + key.slice(1),\r\n        }));\r\n    }\r\n    return [];\r\n  }, [body?.columns, body?.autoConfig, options]);\r\n\r\n  // Get display text from item based on textValue template or first non-id field\r\n  const getDisplayText = (item: AvakioGridSuggestOption): string => {\r\n    if (template) {\r\n      const rendered = template(item);\r\n      if (typeof rendered === 'string') return rendered;\r\n      return String(item[columns[0]?.id] || '');\r\n    }\r\n    if (textValue) {\r\n      // Parse template like \"#name#\" or \"#name# (#code#)\"\r\n      return textValue.replace(/#(\\w+)#/g, (_, key) => String(item[key] || ''));\r\n    }\r\n    // Default: use first column value\r\n    const firstCol = columns[0]?.id || Object.keys(item).find((k) => k !== 'id');\r\n    return firstCol ? String(item[firstCol]) : '';\r\n  };\r\n\r\n  // Initialize selected option based on value prop\r\n  useEffect(() => {\r\n    if (value !== undefined && value !== null && value !== '') {\r\n      const option = options.find((opt) => opt.id === value);\r\n      if (option) {\r\n        setSelectedOption(option);\r\n        setInputValue(getDisplayText(option));\r\n      }\r\n    } else {\r\n      setSelectedOption(null);\r\n      setInputValue('');\r\n    }\r\n  }, [value, options]);\r\n\r\n  // Filter options based on input (if editable)\r\n  const filteredOptions = options.filter((option) => {\r\n    if (!editable || !inputValue) return true;\r\n\r\n    const searchValue = inputValue.toLowerCase();\r\n    \r\n    // Search across all column values\r\n    return columns.some((col) => {\r\n      const cellValue = String(option[col.id] || '').toLowerCase();\r\n      switch (filterMode) {\r\n        case 'startsWith':\r\n          return cellValue.startsWith(searchValue);\r\n        case 'contains':\r\n        default:\r\n          return cellValue.includes(searchValue);\r\n      }\r\n    });\r\n  });\r\n\r\n  // Close dropdown when clicking outside\r\n  useEffect(() => {\r\n    const handleClickOutside = (event: MouseEvent) => {\r\n      if (containerRef.current && !containerRef.current.contains(event.target as Node)) {\r\n        setIsOpen(false);\r\n        // Reset input if no valid selection\r\n        if (selectedOption && editable) {\r\n          setInputValue(getDisplayText(selectedOption));\r\n        }\r\n      }\r\n    };\r\n\r\n    if (isOpen) {\r\n      document.addEventListener('mousedown', handleClickOutside);\r\n    }\r\n\r\n    return () => {\r\n      document.removeEventListener('mousedown', handleClickOutside);\r\n    };\r\n  }, [isOpen, selectedOption]);\r\n\r\n  // Handle keyboard navigation\r\n  useEffect(() => {\r\n    const handleKeyDown = (e: KeyboardEvent) => {\r\n      if (!isOpen) return;\r\n\r\n      switch (e.key) {\r\n        case 'ArrowDown':\r\n          e.preventDefault();\r\n          setHighlightedIndex((prev) =>\r\n            prev < filteredOptions.length - 1 ? prev + 1 : prev\r\n          );\r\n          break;\r\n        case 'ArrowUp':\r\n          e.preventDefault();\r\n          setHighlightedIndex((prev) => (prev > 0 ? prev - 1 : 0));\r\n          break;\r\n        case 'Enter':\r\n          e.preventDefault();\r\n          if (highlightedIndex >= 0 && highlightedIndex < filteredOptions.length) {\r\n            handleSelect(filteredOptions[highlightedIndex]);\r\n          }\r\n          break;\r\n        case 'Escape':\r\n          e.preventDefault();\r\n          setIsOpen(false);\r\n          if (selectedOption && editable) {\r\n            setInputValue(getDisplayText(selectedOption));\r\n          }\r\n          break;\r\n      }\r\n    };\r\n\r\n    if (isOpen) {\r\n      document.addEventListener('keydown', handleKeyDown);\r\n    }\r\n\r\n    return () => {\r\n      document.removeEventListener('keydown', handleKeyDown);\r\n    };\r\n  }, [isOpen, highlightedIndex, filteredOptions, selectedOption]);\r\n\r\n  // Scroll highlighted row into view\r\n  useEffect(() => {\r\n    if (isOpen && highlightedIndex >= 0 && dropdownRef.current) {\r\n      const highlightedRow = dropdownRef.current.querySelector(\r\n        `[data-row-index=\"${highlightedIndex}\"]`\r\n      ) as HTMLElement;\r\n      if (highlightedRow) {\r\n        highlightedRow.scrollIntoView({\r\n          block: 'nearest',\r\n          behavior: 'smooth',\r\n        });\r\n      }\r\n    }\r\n  }, [highlightedIndex, isOpen]);\r\n\r\n  const handleSelect = (option: AvakioGridSuggestOption) => {\r\n    setSelectedOption(option);\r\n    setInputValue(getDisplayText(option));\r\n    setIsOpen(false);\r\n    setHighlightedIndex(-1);\r\n    onChange?.(option.id, option);\r\n  };\r\n\r\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const newValue = e.target.value;\r\n    setInputValue(newValue);\r\n    onInputChange?.(newValue);\r\n    \r\n    if (!isOpen) {\r\n      setIsOpen(true);\r\n    }\r\n    setHighlightedIndex(0);\r\n  };\r\n\r\n  const handleClear = (e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    setSelectedOption(null);\r\n    setInputValue('');\r\n    onChange?.('' as any, undefined);\r\n    inputRef.current?.focus();\r\n  };\r\n\r\n  const handleToggle = () => {\r\n    if (!disabled && !readonly) {\r\n      setIsOpen(!isOpen);\r\n      if (!isOpen) {\r\n        setHighlightedIndex(0);\r\n        inputRef.current?.focus();\r\n      }\r\n    }\r\n  };\r\n\r\n  const showHeader = body?.header !== false;\r\n  const showBorderless = body?.borderless === true;\r\n  const enableScroll = body?.scroll === true;\r\n  const maxHeight = body?.yCount ? body.yCount * 40 : enableScroll ? 300 : undefined;\r\n\r\n  return (\r\n    <div\r\n      ref={containerRef}\r\n      data-testid={testId}\r\n      className={`avakio-gridsuggest ${className}`}\r\n      style={{ width }}\r\n      data-disabled={disabled}\r\n      data-readonly={readonly}\r\n      data-error={!!error}\r\n    >\r\n      {label && (\r\n        <label\r\n          className=\"avakio-gridsuggest-label\"\r\n          style={{\r\n            width: labelAlign === 'left' ? labelWidth : undefined,\r\n            textAlign: labelAlign,\r\n          }}\r\n        >\r\n          {label}\r\n          {required && <span className=\"avakio-gridsuggest-required\">*</span>}\r\n        </label>\r\n      )}\r\n\r\n      <div className=\"avakio-gridsuggest-wrapper\">\r\n        <div className=\"avakio-gridsuggest-input-wrapper\">\r\n          <input\r\n            ref={inputRef}\r\n            type=\"text\"\r\n            id={id}\r\n            className=\"avakio-gridsuggest-input\"\r\n            value={inputValue}\r\n            onChange={handleInputChange}\r\n            onFocus={() => !disabled && !readonly && setIsOpen(true)}\r\n            placeholder={placeholder}\r\n            disabled={disabled}\r\n            readOnly={readonly || !editable}\r\n            aria-haspopup=\"grid\"\r\n            aria-expanded={isOpen}\r\n            aria-label={label || 'Grid select input'}\r\n          />\r\n\r\n          <div className=\"avakio-gridsuggest-icons\">\r\n            {editable && <Search size={16} className=\"avakio-gridsuggest-search-icon\" />}\r\n            {inputValue && !disabled && !readonly && (\r\n              <button\r\n                type=\"button\"\r\n                className=\"avakio-gridsuggest-clear\"\r\n                onClick={handleClear}\r\n                aria-label=\"Clear selection\"\r\n              >\r\n                <X size={16} />\r\n              </button>\r\n            )}\r\n            <button\r\n              type=\"button\"\r\n              className=\"avakio-gridsuggest-toggle\"\r\n              onClick={handleToggle}\r\n              disabled={disabled}\r\n              aria-label=\"Toggle dropdown\"\r\n            >\r\n              <ChevronDown size={18} className={isOpen ? 'open' : ''} />\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {isOpen && (\r\n          <div\r\n            ref={dropdownRef}\r\n            className={`avakio-gridsuggest-dropdown ${showBorderless ? 'borderless' : ''}`}\r\n            style={{ maxHeight }}\r\n            role=\"grid\"\r\n          >\r\n            {filteredOptions.length === 0 ? (\r\n              <div className=\"avakio-gridsuggest-empty\">No data found</div>\r\n            ) : (\r\n              <div className=\"avakio-gridsuggest-table\">\r\n                {showHeader && (\r\n                  <div className=\"avakio-gridsuggest-header\">\r\n                    {columns.map((col) => (\r\n                      <div\r\n                        key={col.id}\r\n                        className=\"avakio-gridsuggest-header-cell\"\r\n                        style={{ width: col.width }}\r\n                      >\r\n                        {col.header || col.id}\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                )}\r\n\r\n                <div className={`avakio-gridsuggest-body ${enableScroll ? 'scrollable' : ''}`}>\r\n                  {filteredOptions.map((option, rowIndex) => {\r\n                    const isSelected = selectedOption?.id === option.id;\r\n                    const isHighlighted = rowIndex === highlightedIndex;\r\n\r\n                    return (\r\n                      <div\r\n                        key={option.id}\r\n                        data-row-index={rowIndex}\r\n                        className={`avakio-gridsuggest-row ${isSelected ? 'selected' : ''} ${\r\n                          isHighlighted ? 'highlighted' : ''\r\n                        }`}\r\n                        onClick={() => handleSelect(option)}\r\n                        role=\"row\"\r\n                        aria-selected={isSelected}\r\n                      >\r\n                        {columns.map((col) => (\r\n                          <div\r\n                            key={col.id}\r\n                            className=\"avakio-gridsuggest-cell\"\r\n                            style={{ width: col.width }}\r\n                            role=\"gridcell\"\r\n                          >\r\n                            {col.template\r\n                              ? col.template(option[col.id], option)\r\n                              : option[col.id]}\r\n                          </div>\r\n                        ))}\r\n                      </div>\r\n                    );\r\n                  })}\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {error && <div className=\"avakio-gridsuggest-error\">{error}</div>}\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useState, useRef, useEffect, useMemo } from 'react';\r\nimport { Check, ChevronDown, X } from 'lucide-react';\r\nimport { cn } from '@/lib/utils';\r\nimport './avakio-multicombo.css';\r\n\r\nexport interface AvakioMultiComboOption {\r\n  value: string;\r\n  label: string;\r\n}\r\n\r\ninterface AvakioMultiComboProps {\r\n  options: AvakioMultiComboOption[];\r\n  value: string[];\r\n  onChange: (value: string[]) => void;\r\n  placeholder?: string;\r\n  className?: string;\r\n  showCount?: boolean;\r\n  maxDisplayItems?: number;\r\n  disabled?: boolean;\r\n  /** ID of the component */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n}\r\n\r\nexport function AvakioMultiCombo({\r\n  options,\r\n  value = [],\r\n  onChange,\r\n  placeholder = \"Select items...\",\r\n  className,\r\n  showCount = false,\r\n  maxDisplayItems = 3,\r\n  disabled = false,\r\n  id,\r\n  testId\r\n}: AvakioMultiComboProps) {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n  const inputRef = useRef<HTMLInputElement>(null);\r\n\r\n  // Filter options based on search query\r\n  const filteredOptions = useMemo(() => {\r\n    if (!searchQuery.trim()) return options;\r\n    const query = searchQuery.toLowerCase();\r\n    return options.filter(opt => \r\n      opt.label.toLowerCase().includes(query) || \r\n      opt.value.toLowerCase().includes(query)\r\n    );\r\n  }, [options, searchQuery]);\r\n\r\n  // Get selected option labels\r\n  const selectedOptions = useMemo(() => {\r\n    return options.filter(opt => value.includes(opt.value));\r\n  }, [options, value]);\r\n\r\n  // Handle click outside to close\r\n  useEffect(() => {\r\n    const handleClickOutside = (event: MouseEvent) => {\r\n      if (containerRef.current && !containerRef.current.contains(event.target as Node)) {\r\n        setIsOpen(false);\r\n        setSearchQuery('');\r\n      }\r\n    };\r\n\r\n    if (isOpen) {\r\n      document.addEventListener('mousedown', handleClickOutside);\r\n    }\r\n\r\n    return () => {\r\n      document.removeEventListener('mousedown', handleClickOutside);\r\n    };\r\n  }, [isOpen]);\r\n\r\n  const handleToggleOption = (optionValue: string) => {\r\n    if (value.includes(optionValue)) {\r\n      onChange(value.filter(v => v !== optionValue));\r\n    } else {\r\n      onChange([...value, optionValue]);\r\n    }\r\n  };\r\n\r\n  const handleRemoveItem = (optionValue: string, e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    onChange(value.filter(v => v !== optionValue));\r\n  };\r\n\r\n  const handleClearAll = (e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    onChange([]);\r\n  };\r\n\r\n  const handleInputClick = () => {\r\n    if (!disabled) {\r\n      setIsOpen(true);\r\n      inputRef.current?.focus();\r\n    }\r\n  };\r\n\r\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    setSearchQuery(e.target.value);\r\n    if (!isOpen) {\r\n      setIsOpen(true);\r\n    }\r\n  };\r\n\r\n  const handleSelectAll = () => {\r\n    if (filteredOptions.length === 0) return;\r\n    const allFilteredValues = filteredOptions.map(opt => opt.value);\r\n    const allSelected = allFilteredValues.every(v => value.includes(v));\r\n    \r\n    if (allSelected) {\r\n      // Deselect all filtered items\r\n      onChange(value.filter(v => !allFilteredValues.includes(v)));\r\n    } else {\r\n      // Select all filtered items\r\n      const newValues = Array.from(new Set([...value, ...allFilteredValues]));\r\n      onChange(newValues);\r\n    }\r\n  };\r\n\r\n  const renderSelectedItems = () => {\r\n    if (selectedOptions.length === 0) {\r\n      return <span className=\"avakio-mc-placeholder\">{placeholder}</span>;\r\n    }\r\n\r\n    if (showCount) {\r\n      return (\r\n        <span className=\"avakio-mc-count\">\r\n          {selectedOptions.length} {selectedOptions.length === 1 ? 'item' : 'items'} selected\r\n        </span>\r\n      );\r\n    }\r\n\r\n    const displayItems = selectedOptions.slice(0, maxDisplayItems);\r\n    const remainingCount = selectedOptions.length - maxDisplayItems;\r\n\r\n    return (\r\n      <div className=\"avakio-mc-chips\">\r\n        {displayItems.map(opt => (\r\n          <span key={opt.value} className=\"avakio-mc-chip\">\r\n            <span className=\"avakio-mc-chip-label\">{opt.label}</span>\r\n            <button\r\n              type=\"button\"\r\n              className=\"avakio-mc-chip-remove\"\r\n              onClick={(e) => handleRemoveItem(opt.value, e)}\r\n              disabled={disabled}\r\n            >\r\n              <X className=\"h-3 w-3\" />\r\n            </button>\r\n          </span>\r\n        ))}\r\n        {remainingCount > 0 && (\r\n          <span className=\"avakio-mc-chip avakio-mc-chip-more\">\r\n            +{remainingCount} more\r\n          </span>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const allFilteredSelected = filteredOptions.length > 0 && \r\n    filteredOptions.every(opt => value.includes(opt.value));\r\n\r\n  return (\r\n    <div \r\n      ref={containerRef}\r\n      id={id}\r\n      data-testid={testId}\r\n      className={cn('avakio-multicombo', disabled && 'avakio-mc-disabled', className)}\r\n    >\r\n      {/* Input Area */}\r\n      <div \r\n        className={cn(\r\n          'avakio-mc-input-wrapper',\r\n          isOpen && 'avakio-mc-input-wrapper-open'\r\n        )}\r\n        onClick={handleInputClick}\r\n      >\r\n        <div className=\"avakio-mc-input-content\">\r\n          {!isOpen && renderSelectedItems()}\r\n          {isOpen && (\r\n            <input\r\n              ref={inputRef}\r\n              type=\"text\"\r\n              className=\"avakio-mc-search-input\"\r\n              value={searchQuery}\r\n              onChange={handleInputChange}\r\n              placeholder={selectedOptions.length > 0 ? \"Search...\" : placeholder}\r\n              disabled={disabled}\r\n            />\r\n          )}\r\n        </div>\r\n        <div className=\"avakio-mc-actions\">\r\n          {value.length > 0 && !disabled && (\r\n            <button\r\n              type=\"button\"\r\n              className=\"avakio-mc-clear-btn\"\r\n              onClick={handleClearAll}\r\n            >\r\n              <X className=\"h-4 w-4\" />\r\n            </button>\r\n          )}\r\n          <button\r\n            type=\"button\"\r\n            className=\"avakio-mc-toggle-btn\"\r\n            onClick={(e) => {\r\n              e.stopPropagation();\r\n              if (!disabled) {\r\n                setIsOpen(!isOpen);\r\n                if (!isOpen) {\r\n                  inputRef.current?.focus();\r\n                }\r\n              }\r\n            }}\r\n            disabled={disabled}\r\n          >\r\n            <ChevronDown className={cn('h-4 w-4', isOpen && 'avakio-mc-toggle-open')} />\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Dropdown List */}\r\n      {isOpen && (\r\n        <div className=\"avakio-mc-dropdown\">\r\n          {/* Select All Option */}\r\n          {filteredOptions.length > 0 && (\r\n            <div className=\"avakio-mc-select-all\">\r\n              <button\r\n                type=\"button\"\r\n                className=\"avakio-mc-option\"\r\n                onClick={handleSelectAll}\r\n              >\r\n                <div className={cn(\r\n                  'avakio-mc-checkbox',\r\n                  allFilteredSelected && 'avakio-mc-checkbox-checked'\r\n                )}>\r\n                  {allFilteredSelected && <Check className=\"h-3 w-3\" />}\r\n                </div>\r\n                <span className=\"avakio-mc-option-label avakio-mc-select-all-label\">\r\n                  {allFilteredSelected ? 'Deselect All' : 'Select All'}\r\n                </span>\r\n              </button>\r\n            </div>\r\n          )}\r\n\r\n          {/* Options List */}\r\n          <div className=\"avakio-mc-options\">\r\n            {filteredOptions.length > 0 ? (\r\n              filteredOptions.map(option => {\r\n                const isSelected = value.includes(option.value);\r\n                return (\r\n                  <button\r\n                    key={option.value}\r\n                    type=\"button\"\r\n                    className=\"avakio-mc-option\"\r\n                    onClick={() => handleToggleOption(option.value)}\r\n                  >\r\n                    <div className={cn(\r\n                      'avakio-mc-checkbox',\r\n                      isSelected && 'avakio-mc-checkbox-checked'\r\n                    )}>\r\n                      {isSelected && <Check className=\"h-3 w-3\" />}\r\n                    </div>\r\n                    <span className=\"avakio-mc-option-label\">{option.label}</span>\r\n                  </button>\r\n                );\r\n              })\r\n            ) : (\r\n              <div className=\"avakio-mc-no-results\">\r\n                {searchQuery ? 'No matches found' : 'No options available'}\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Footer with count */}\r\n          {value.length > 0 && (\r\n            <div className=\"avakio-mc-footer\">\r\n              {value.length} {value.length === 1 ? 'item' : 'items'} selected\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useState, useRef, useEffect } from 'react';\r\nimport { ChevronDown, X } from 'lucide-react';\r\nimport './avakio-richselect.css';\r\n\r\nexport interface AvakioRichSelectOption {\r\n  id: string | number;\r\n  value: string;\r\n  [key: string]: any;\r\n}\r\n\r\nexport interface AvakioRichSelectProps {\r\n  id?: string;\r\n  value?: string | number;\r\n  options: AvakioRichSelectOption[] | string[];\r\n  onChange?: (value: string | number, option?: AvakioRichSelectOption) => void;\r\n  placeholder?: string;\r\n  label?: string;\r\n  labelAlign?: 'left' | 'right';\r\n  labelWidth?: number;\r\n  disabled?: boolean;\r\n  readonly?: boolean;\r\n  template?: (option: AvakioRichSelectOption) => React.ReactNode;\r\n  width?: number | string;\r\n  maxHeight?: number;\r\n  yCount?: number; // Number of visible items in the list\r\n  required?: boolean;\r\n  error?: string;\r\n  className?: string;\r\n  clearable?: boolean;\r\n  /** Padding - can be a number (all sides), string, or array [top, right, bottom, left] */\r\n  padding?: string | number | [number, number, number, number];\r\n  /** Margin - can be a number (all sides), string, or array [top, right, bottom, left] */\r\n  margin?: string | number | [number, number, number, number];\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n}\r\n\r\nexport function AvakioRichSelect({\r\n  id,\r\n  value,\r\n  options = [],\r\n  onChange,\r\n  placeholder = 'Select...',\r\n  label,\r\n  labelAlign = 'left',\r\n  labelWidth = 100,\r\n  disabled = false,\r\n  readonly = false,\r\n  template,\r\n  width,\r\n  maxHeight = 300,\r\n  yCount,\r\n  required = false,\r\n  error,\r\n  className = '',\r\n  clearable = true,\r\n  padding,\r\n  margin,\r\n  testId,\r\n}: AvakioRichSelectProps) {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [highlightedIndex, setHighlightedIndex] = useState(-1);\r\n  const [selectedOption, setSelectedOption] = useState<AvakioRichSelectOption | null>(null);\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n  const dropdownRef = useRef<HTMLDivElement>(null);\r\n  const buttonRef = useRef<HTMLButtonElement>(null);\r\n\r\n  // Normalize options to AvakioRichSelectOption format\r\n  const normalizedOptions: AvakioRichSelectOption[] = options.map((opt) => {\r\n    if (typeof opt === 'string') {\r\n      return { id: opt, value: opt };\r\n    }\r\n    return opt;\r\n  });\r\n\r\n  // Initialize selected option based on value prop\r\n  useEffect(() => {\r\n    if (value !== undefined && value !== null && value !== '') {\r\n      const option = normalizedOptions.find(\r\n        (opt) => opt.id === value || opt.value === value\r\n      );\r\n      if (option) {\r\n        setSelectedOption(option);\r\n      }\r\n    } else {\r\n      setSelectedOption(null);\r\n    }\r\n  }, [value]);\r\n\r\n  // Close dropdown when clicking outside\r\n  useEffect(() => {\r\n    const handleClickOutside = (event: MouseEvent) => {\r\n      if (containerRef.current && !containerRef.current.contains(event.target as Node)) {\r\n        setIsOpen(false);\r\n      }\r\n    };\r\n\r\n    if (isOpen) {\r\n      document.addEventListener('mousedown', handleClickOutside);\r\n    }\r\n\r\n    return () => {\r\n      document.removeEventListener('mousedown', handleClickOutside);\r\n    };\r\n  }, [isOpen]);\r\n\r\n  // Handle keyboard navigation\r\n  useEffect(() => {\r\n    const handleKeyDown = (e: KeyboardEvent) => {\r\n      if (!isOpen) return;\r\n\r\n      switch (e.key) {\r\n        case 'ArrowDown':\r\n          e.preventDefault();\r\n          setHighlightedIndex((prev) =>\r\n            prev < normalizedOptions.length - 1 ? prev + 1 : prev\r\n          );\r\n          break;\r\n        case 'ArrowUp':\r\n          e.preventDefault();\r\n          setHighlightedIndex((prev) => (prev > 0 ? prev - 1 : 0));\r\n          break;\r\n        case 'Enter':\r\n          e.preventDefault();\r\n          if (highlightedIndex >= 0 && highlightedIndex < normalizedOptions.length) {\r\n            handleSelect(normalizedOptions[highlightedIndex]);\r\n          }\r\n          break;\r\n        case 'Escape':\r\n          e.preventDefault();\r\n          setIsOpen(false);\r\n          break;\r\n      }\r\n    };\r\n\r\n    if (isOpen) {\r\n      document.addEventListener('keydown', handleKeyDown);\r\n    }\r\n\r\n    return () => {\r\n      document.removeEventListener('keydown', handleKeyDown);\r\n    };\r\n  }, [isOpen, highlightedIndex, normalizedOptions]);\r\n\r\n  // Scroll highlighted item into view\r\n  useEffect(() => {\r\n    if (isOpen && highlightedIndex >= 0 && dropdownRef.current) {\r\n      const highlightedElement = dropdownRef.current.querySelector(\r\n        `[data-index=\"${highlightedIndex}\"]`\r\n      ) as HTMLElement;\r\n      if (highlightedElement) {\r\n        highlightedElement.scrollIntoView({\r\n          block: 'nearest',\r\n          behavior: 'smooth',\r\n        });\r\n      }\r\n    }\r\n  }, [highlightedIndex, isOpen]);\r\n\r\n  const handleSelect = (option: AvakioRichSelectOption) => {\r\n    setSelectedOption(option);\r\n    setIsOpen(false);\r\n    setHighlightedIndex(-1);\r\n    onChange?.(option.id, option);\r\n  };\r\n\r\n  const handleClear = (e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    setSelectedOption(null);\r\n    onChange?.('' as any, undefined);\r\n  };\r\n\r\n  const handleToggle = () => {\r\n    if (!disabled && !readonly) {\r\n      setIsOpen(!isOpen);\r\n      if (!isOpen) {\r\n        // Set highlighted index to current selection when opening\r\n        const currentIndex = normalizedOptions.findIndex(\r\n          (opt) => opt.id === selectedOption?.id\r\n        );\r\n        setHighlightedIndex(currentIndex >= 0 ? currentIndex : 0);\r\n      }\r\n    }\r\n  };\r\n\r\n  const displayValue = selectedOption ? selectedOption.value : '';\r\n  const calculatedMaxHeight = yCount\r\n    ? yCount * 40 // Approximate item height\r\n    : maxHeight;\r\n\r\n  return (\r\n    <div\r\n      ref={containerRef}\r\n      data-testid={testId}\r\n      className={`avakio-richselect ${className}`}\r\n      style={{\r\n        width,\r\n        padding: Array.isArray(padding) \r\n          ? `${padding[0]}px ${padding[1]}px ${padding[2]}px ${padding[3]}px`\r\n          : typeof padding === 'number' ? `${padding}px` : padding,\r\n        margin: Array.isArray(margin) \r\n          ? `${margin[0]}px ${margin[1]}px ${margin[2]}px ${margin[3]}px`\r\n          : typeof margin === 'number' ? `${margin}px` : margin,\r\n      }}\r\n      data-disabled={disabled}\r\n      data-readonly={readonly}\r\n      data-error={!!error}\r\n    >\r\n      {label && (\r\n        <label\r\n          className=\"avakio-richselect-label\"\r\n          style={{\r\n            width: labelAlign === 'left' ? labelWidth : undefined,\r\n            textAlign: labelAlign,\r\n          }}\r\n        >\r\n          {label}\r\n          {required && <span className=\"avakio-richselect-required\">*</span>}\r\n        </label>\r\n      )}\r\n\r\n      <div className=\"avakio-richselect-wrapper\">\r\n        <button\r\n          ref={buttonRef}\r\n          type=\"button\"\r\n          id={id}\r\n          className=\"avakio-richselect-button\"\r\n          onClick={handleToggle}\r\n          disabled={disabled}\r\n          aria-haspopup=\"listbox\"\r\n          aria-expanded={isOpen}\r\n          aria-label={label || 'Select option'}\r\n        >\r\n          <span className={`avakio-richselect-value ${!displayValue ? 'placeholder' : ''}`}>\r\n            {displayValue || placeholder}\r\n          </span>\r\n\r\n          <div className=\"avakio-richselect-icons\">\r\n            {clearable && selectedOption && !disabled && !readonly && (\r\n              <span\r\n                role=\"button\"\r\n                tabIndex={-1}\r\n                className=\"avakio-richselect-clear\"\r\n                onClick={handleClear}\r\n                aria-label=\"Clear selection\"\r\n              >\r\n                <X size={16} />\r\n              </span>\r\n            )}\r\n            <ChevronDown\r\n              size={18}\r\n              className={`avakio-richselect-toggle ${isOpen ? 'open' : ''}`}\r\n            />\r\n          </div>\r\n        </button>\r\n\r\n        {isOpen && (\r\n          <div\r\n            ref={dropdownRef}\r\n            className=\"avakio-richselect-dropdown\"\r\n            style={{ maxHeight: calculatedMaxHeight }}\r\n            role=\"listbox\"\r\n          >\r\n            {normalizedOptions.length === 0 ? (\r\n              <div className=\"avakio-richselect-empty\">No options available</div>\r\n            ) : (\r\n              normalizedOptions.map((option, index) => {\r\n                const isSelected = selectedOption?.id === option.id;\r\n                const isHighlighted = index === highlightedIndex;\r\n\r\n                return (\r\n                  <div\r\n                    key={option.id}\r\n                    data-index={index}\r\n                    className={`avakio-richselect-option ${isSelected ? 'selected' : ''} ${\r\n                      isHighlighted ? 'highlighted' : ''\r\n                    }`}\r\n                    onClick={() => handleSelect(option)}\r\n                    role=\"option\"\r\n                    aria-selected={isSelected}\r\n                  >\r\n                    {template ? template(option) : option.value}\r\n                  </div>\r\n                );\r\n              })\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {error && <div className=\"avakio-richselect-error\">{error}</div>}\r\n    </div>\r\n  );\r\n}\r\n\r\n// Helper methods for API compatibility\r\nexport const AvakioRichSelectAPI = {\r\n  getValue: (ref: React.RefObject<any>) => {\r\n    // Returns the ID of the selected option\r\n    return ref.current?.selectedOption?.id;\r\n  },\r\n  getText: (ref: React.RefObject<any>) => {\r\n    // Returns the text value of the selected option\r\n    return ref.current?.selectedOption?.value;\r\n  },\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useMemo, useState, useRef, useCallback } from \"react\";\r\nimport \"./avakio-slider.css\";\r\n\r\nexport type AvakioSliderValue = number | [number, number];\r\n\r\nexport interface AvakioSliderProps {\r\n  /** Single value or range [min, max] */\r\n  value?: AvakioSliderValue;\r\n  /** Default single value or range [min, max] */\r\n  defaultValue?: AvakioSliderValue;\r\n  /** Callback when value changes */\r\n  onChange?: (value: AvakioSliderValue) => void;\r\n  /** Minimum value */\r\n  min?: number;\r\n  /** Maximum value */\r\n  max?: number;\r\n  /** Step increment */\r\n  step?: number;\r\n  /** Enable range mode with two handles */\r\n  range?: boolean;\r\n  /** Disabled state */\r\n  disabled?: boolean;\r\n  /** Label text */\r\n  label?: string;\r\n  /** Description text */\r\n  description?: string;\r\n  /** Required field indicator */\r\n  required?: boolean;\r\n  /** Error message */\r\n  error?: string;\r\n  /** Show current value */\r\n  showValue?: boolean;\r\n  /** Custom value formatter */\r\n  formatValue?: (value: number) => string;\r\n  /** Mark positions on the track */\r\n  marks?: number[];\r\n  /** Size variant */\r\n  size?: \"sm\" | \"md\" | \"lg\";\r\n  /** ID of the component */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n  /** Theme */\r\n  theme?: string;\r\n}\r\n\r\nfunction clamp(val: number, min: number, max: number) {\r\n  return Math.min(Math.max(val, min), max);\r\n}\r\n\r\nexport function AvakioSlider({\r\n  value,\r\n  defaultValue,\r\n  onChange,\r\n  min = 0,\r\n  max = 100,\r\n  step = 1,\r\n  range = false,\r\n  disabled,\r\n  label,\r\n  description,\r\n  required,\r\n  error,\r\n  showValue = true,\r\n  formatValue,\r\n  marks,\r\n  size = \"md\",\r\n  id,\r\n  testId,\r\n  theme,\r\n}: AvakioSliderProps) {\r\n  const isControlled = value !== undefined;\r\n  \r\n  // Normalize value to always work with [low, high] internally for range mode\r\n  const normalizeToRange = (val: AvakioSliderValue | undefined, defaultMin: number, defaultMax: number): [number, number] => {\r\n    if (val === undefined) return [defaultMin, defaultMax];\r\n    if (Array.isArray(val)) return [clamp(val[0], min, max), clamp(val[1], min, max)];\r\n    return [min, clamp(val, min, max)];\r\n  };\r\n\r\n  const normalizeToSingle = (val: AvakioSliderValue | undefined, defaultVal: number): number => {\r\n    if (val === undefined) return defaultVal;\r\n    if (Array.isArray(val)) return val[1];\r\n    return clamp(val, min, max);\r\n  };\r\n\r\n  const [internalRange, setInternalRange] = useState<[number, number]>(() => \r\n    normalizeToRange(defaultValue, min, range ? max : min)\r\n  );\r\n  const [internalSingle, setInternalSingle] = useState<number>(() => \r\n    normalizeToSingle(defaultValue, min)\r\n  );\r\n\r\n  // Current values\r\n  const currentRange: [number, number] = isControlled \r\n    ? normalizeToRange(value, min, max)\r\n    : internalRange;\r\n  const currentSingle: number = isControlled \r\n    ? normalizeToSingle(value, min)\r\n    : internalSingle;\r\n\r\n  // Percentages for styling\r\n  const lowPercent = range ? ((currentRange[0] - min) / (max - min || 1)) * 100 : 0;\r\n  const highPercent = range \r\n    ? ((currentRange[1] - min) / (max - min || 1)) * 100\r\n    : ((currentSingle - min) / (max - min || 1)) * 100;\r\n\r\n  // Formatted display values\r\n  const formattedLow = useMemo(() => {\r\n    const val = range ? currentRange[0] : currentSingle;\r\n    return formatValue ? formatValue(val) : val.toString();\r\n  }, [range, currentRange, currentSingle, formatValue]);\r\n\r\n  const formattedHigh = useMemo(() => {\r\n    if (!range) return formattedLow;\r\n    return formatValue ? formatValue(currentRange[1]) : currentRange[1].toString();\r\n  }, [range, currentRange, formatValue, formattedLow]);\r\n\r\n  const safeMarks = useMemo(() => {\r\n    if (!marks || !marks.length) return [] as number[];\r\n    return marks.filter((m) => m >= min && m <= max);\r\n  }, [marks, min, max]);\r\n\r\n  // Handle change for single slider\r\n  const handleSingleChange = useCallback((next: number) => {\r\n    const clamped = clamp(next, min, max);\r\n    if (!isControlled) setInternalSingle(clamped);\r\n    onChange?.(clamped);\r\n  }, [min, max, isControlled, onChange]);\r\n\r\n  // Handle change for range slider\r\n  const handleRangeChange = useCallback((index: 0 | 1, next: number) => {\r\n    const clamped = clamp(next, min, max);\r\n    let newRange: [number, number];\r\n    \r\n    if (index === 0) {\r\n      // Low handle - ensure it doesn't exceed high\r\n      newRange = [Math.min(clamped, currentRange[1]), currentRange[1]];\r\n    } else {\r\n      // High handle - ensure it doesn't go below low\r\n      newRange = [currentRange[0], Math.max(clamped, currentRange[0])];\r\n    }\r\n    \r\n    if (!isControlled) setInternalRange(newRange);\r\n    onChange?.(newRange);\r\n  }, [min, max, currentRange, isControlled, onChange]);\r\n\r\n  // Track click handler for range mode\r\n  const trackRef = useRef<HTMLDivElement>(null);\r\n  const handleTrackClick = useCallback((e: React.MouseEvent<HTMLDivElement>) => {\r\n    if (disabled || !range || !trackRef.current) return;\r\n    \r\n    const rect = trackRef.current.getBoundingClientRect();\r\n    const percent = (e.clientX - rect.left) / rect.width;\r\n    const clickValue = min + percent * (max - min);\r\n    const snappedValue = Math.round(clickValue / step) * step;\r\n    \r\n    // Determine which handle is closer\r\n    const distToLow = Math.abs(snappedValue - currentRange[0]);\r\n    const distToHigh = Math.abs(snappedValue - currentRange[1]);\r\n    \r\n    if (distToLow <= distToHigh) {\r\n      handleRangeChange(0, snappedValue);\r\n    } else {\r\n      handleRangeChange(1, snappedValue);\r\n    }\r\n  }, [disabled, range, min, max, step, currentRange, handleRangeChange]);\r\n\r\n  // CSS custom properties for range progress\r\n  const sliderStyle = range\r\n    ? {\r\n        [\"--slider-progress-start\" as string]: `${lowPercent}%`,\r\n        [\"--slider-progress-end\" as string]: `${highPercent}%`,\r\n        [\"--slider-progress\" as string]: `${highPercent}%`,\r\n      }\r\n    : {\r\n        [\"--slider-progress\" as string]: `${highPercent}%`,\r\n      };\r\n\r\n  return (\r\n    <div\r\n      id={id}\r\n      data-testid={testId}\r\n      data-admin-theme={theme}\r\n      className={[\r\n        \"avakio-slider\",\r\n        `avakio-slider-${size}`,\r\n        range && \"avakio-slider-range\",\r\n        error && \"avakio-slider-error\",\r\n        disabled && \"avakio-slider-disabled\",\r\n      ].filter(Boolean).join(\" \")}\r\n      style={sliderStyle}\r\n    >\r\n      {(label || description) && (\r\n        <div className=\"avakio-slider-header\">\r\n          <div className=\"avakio-slider-label-row\">\r\n            {label && <span className=\"avakio-slider-label\">{label}</span>}\r\n            {required && <span className=\"avakio-slider-required\">*</span>}\r\n            {showValue && (\r\n              <span className=\"avakio-slider-value-chip\">\r\n                {range ? `${formattedLow} - ${formattedHigh}` : formattedLow}\r\n              </span>\r\n            )}\r\n          </div>\r\n          {description && <div className=\"avakio-slider-description\">{description}</div>}\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"avakio-slider-body\">\r\n        {range ? (\r\n          <>\r\n            {/* Low handle input */}\r\n            <input\r\n              type=\"range\"\r\n              className=\"avakio-slider-input avakio-slider-input-low\"\r\n              min={min}\r\n              max={max}\r\n              step={step}\r\n              value={currentRange[0]}\r\n              disabled={disabled}\r\n              onChange={(e) => handleRangeChange(0, Number(e.target.value))}\r\n              aria-label=\"Range minimum\"\r\n            />\r\n            {/* High handle input */}\r\n            <input\r\n              type=\"range\"\r\n              className=\"avakio-slider-input avakio-slider-input-high\"\r\n              min={min}\r\n              max={max}\r\n              step={step}\r\n              value={currentRange[1]}\r\n              disabled={disabled}\r\n              onChange={(e) => handleRangeChange(1, Number(e.target.value))}\r\n              aria-label=\"Range maximum\"\r\n            />\r\n          </>\r\n        ) : (\r\n          <input\r\n            type=\"range\"\r\n            className=\"avakio-slider-input\"\r\n            min={min}\r\n            max={max}\r\n            step={step}\r\n            value={currentSingle}\r\n            disabled={disabled}\r\n            onChange={(e) => handleSingleChange(Number(e.target.value))}\r\n          />\r\n        )}\r\n        \r\n        <div \r\n          ref={trackRef} \r\n          className=\"avakio-slider-track\"\r\n          onClick={range ? handleTrackClick : undefined}\r\n        >\r\n          {range ? (\r\n            <div \r\n              className=\"avakio-slider-progress avakio-slider-progress-range\" \r\n              style={{ \r\n                left: `${lowPercent}%`, \r\n                width: `${highPercent - lowPercent}%` \r\n              }}\r\n            />\r\n          ) : (\r\n            <div className=\"avakio-slider-progress\" />\r\n          )}\r\n          \r\n          {range ? (\r\n            <>\r\n              <div \r\n                className=\"avakio-slider-thumb avakio-slider-thumb-low\" \r\n                style={{ left: `${lowPercent}%` }} \r\n              />\r\n              <div \r\n                className=\"avakio-slider-thumb avakio-slider-thumb-high\" \r\n                style={{ left: `${highPercent}%` }} \r\n              />\r\n            </>\r\n          ) : (\r\n            <div className=\"avakio-slider-thumb\" style={{ left: `${highPercent}%` }} />\r\n          )}\r\n        </div>\r\n        \r\n        {safeMarks.length > 0 && (\r\n          <div className=\"avakio-slider-marks\">\r\n            {safeMarks.map((m) => {\r\n              const p = ((m - min) / (max - min || 1)) * 100;\r\n              const isInRange = range \r\n                ? m >= currentRange[0] && m <= currentRange[1]\r\n                : m <= currentSingle;\r\n              return (\r\n                <div \r\n                  key={m} \r\n                  className={`avakio-slider-mark ${isInRange ? 'avakio-slider-mark-active' : ''}`} \r\n                  style={{ left: `${p}%` }}\r\n                >\r\n                  <span className=\"avakio-slider-mark-dot\" />\r\n                  <span className=\"avakio-slider-mark-label\">{m}</span>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {error && <div className=\"avakio-slider-error-text\">{error}</div>}\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useEffect, useMemo, useRef, useState } from \"react\";\r\nimport \"./avakio-property.css\";\r\nimport { AvakioDatePicker } from \"../../ui-controls/avakio-datepicker/avakio-datepicker\";\r\nimport { AvakioCheckbox } from \"../../ui-controls/avakio-checkbox/avakio-checkbox\";\r\nimport { AvakioButton, AvakioButtonSize, AvakioButtonVariant } from \"../../ui-controls/avakio-button/avakio-button\";\r\nimport { AvakioColorPicker, AvakioColorPickerPreset } from \"../../ui-controls/avakio-colorpicker/avakio-colorpicker\";\r\nimport { AvakioCombo, AvakioComboOption } from \"../../ui-controls/avakio-combo/avakio-combo\";\r\nimport { AvakioCounter } from \"../../ui-controls/avakio-counter/avakio-counter\";\r\nimport { AvakioDateRangePicker, AvakioDateRange, PresetRange } from \"../../ui-controls/avakio-daterangepicker/avakio-daterangepicker\";\r\nimport { AvakioGridSuggest, AvakioGridSuggestBodyConfig, AvakioGridSuggestOption } from \"../../ui-controls/avakio-gridsuggest/avakio-gridsuggest\";\r\nimport { AvakioMultiCombo, AvakioMultiComboOption } from \"../../ui-controls/avakio-multicombo/avakio-multicombo\";\r\nimport { AvakioRichSelect, AvakioRichSelectOption } from \"../../ui-controls/avakio-richselect/avakio-richselect\";\r\nimport { AvakioSlider } from \"../../ui-controls/avakio-slider/avakio-slider\";\r\n\r\nexport type AvakioPropertyEditor =\r\n  | \"text\"\r\n  | \"number\"\r\n  | \"select\"\r\n  | \"checkbox\"\r\n  | \"combo\"\r\n  | \"colorpicker\"\r\n  | \"counter\"\r\n  | \"multicombo\"\r\n  | \"date\"\r\n  | \"datetime\"\r\n  | \"button\"\r\n  | \"daterangepicker\"\r\n  | \"gridsuggest\"\r\n  | \"slider\"\r\n  | \"textarea\";\r\n\r\nexport interface AvakioPropertyOption {\r\n  label: string;\r\n  value: string | number | boolean;\r\n}\r\n\r\nexport interface AvakioPropertyItem {\r\n  id: string;\r\n  label: string;\r\n  type?: AvakioPropertyEditor;\r\n  value?: string | number | boolean | string[] | AvakioDateRange | null;\r\n  placeholder?: string;\r\n  description?: string;\r\n  group?: string;\r\n  options?: AvakioPropertyOption[];\r\n  disabled?: boolean;\r\n  required?: boolean;\r\n  checkboxLabel?: string;\r\n  checkboxDescription?: string;\r\n  checkboxOnChange?: (checked: boolean, item: AvakioPropertyItem) => void;\r\n  buttonVariant?: AvakioButtonVariant;\r\n  buttonSize?: AvakioButtonSize;\r\n  buttonBadge?: string | number;\r\n  buttonIcon?: React.ReactNode;\r\n  buttonIconRight?: React.ReactNode;\r\n  buttonBlock?: boolean;\r\n  buttonLabel?: string;\r\n  buttonOnClick?: (item: AvakioPropertyItem) => void;\r\n  comboOptions?: AvakioComboOption[] | string[];\r\n  comboOnChange?: (value: string | number, option: AvakioComboOption | undefined, item: AvakioPropertyItem) => void;\r\n  comboOnInputChange?: (inputValue: string, item: AvakioPropertyItem) => void;\r\n  comboPlaceholder?: string;\r\n  comboLabel?: string;\r\n  comboLabelAlign?: \"left\" | \"right\";\r\n  comboLabelWidth?: number;\r\n  comboDisabled?: boolean;\r\n  comboReadOnly?: boolean;\r\n  comboFilterMode?: \"startsWith\" | \"contains\" | \"custom\";\r\n  comboCustomFilter?: (option: AvakioComboOption, inputValue: string) => boolean;\r\n  comboTemplate?: (option: AvakioComboOption) => React.ReactNode;\r\n  comboWidth?: number | string;\r\n  comboMaxHeight?: number;\r\n  comboRequired?: boolean;\r\n  comboError?: string;\r\n  comboClassName?: string;\r\n  selectOptions?: AvakioRichSelectOption[] | string[];\r\n  selectOnChange?: (value: string | number, option: AvakioRichSelectOption | undefined, item: AvakioPropertyItem) => void;\r\n  selectPlaceholder?: string;\r\n  selectDisabled?: boolean;\r\n  selectReadOnly?: boolean;\r\n  selectTemplate?: (option: AvakioRichSelectOption) => React.ReactNode;\r\n  selectWidth?: number | string;\r\n  selectMaxHeight?: number;\r\n  selectYCount?: number;\r\n  selectRequired?: boolean;\r\n  selectError?: string;\r\n  selectClassName?: string;\r\n  selectClearable?: boolean;\r\n  counterDefaultValue?: number;\r\n  counterStep?: number;\r\n  counterMin?: number;\r\n  counterMax?: number;\r\n  counterLabel?: string;\r\n  counterDescription?: string;\r\n  counterError?: string;\r\n  counterRequired?: boolean;\r\n  counterDisabled?: boolean;\r\n  counterReadOnly?: boolean;\r\n  counterSize?: \"sm\" | \"md\" | \"lg\";\r\n  counterAllowInput?: boolean;\r\n  counterClassName?: string;\r\n  counterOnChange?: (value: number, item: AvakioPropertyItem) => void;\r\n  daterangeDefaultValue?: AvakioDateRange;\r\n  daterangePresets?: PresetRange[];\r\n  daterangeAllowSingleDay?: boolean;\r\n  daterangeShowTime?: boolean;\r\n  daterangeClassName?: string;\r\n  daterangeOnChange?: (range: AvakioDateRange, item: AvakioPropertyItem) => void;\r\n  gridsuggestData?: AvakioGridSuggestOption[];\r\n  gridsuggestOnChange?: (value: string | number, option: AvakioGridSuggestOption | undefined, item: AvakioPropertyItem) => void;\r\n  gridsuggestOnInputChange?: (inputValue: string, item: AvakioPropertyItem) => void;\r\n  gridsuggestPlaceholder?: string;\r\n  gridsuggestLabel?: string;\r\n  gridsuggestLabelAlign?: \"left\" | \"right\";\r\n  gridsuggestLabelWidth?: number;\r\n  gridsuggestDisabled?: boolean;\r\n  gridsuggestReadOnly?: boolean;\r\n  gridsuggestTextValue?: string;\r\n  gridsuggestTemplate?: (item: AvakioGridSuggestOption) => React.ReactNode;\r\n  gridsuggestWidth?: number | string;\r\n  gridsuggestBody?: AvakioGridSuggestBodyConfig;\r\n  gridsuggestRequired?: boolean;\r\n  gridsuggestError?: string;\r\n  gridsuggestClassName?: string;\r\n  gridsuggestEditable?: boolean;\r\n  gridsuggestFilterMode?: \"startsWith\" | \"contains\";\r\n  multicomboOptions?: AvakioMultiComboOption[];\r\n  multicomboValue?: string[];\r\n  multicomboOnChange?: (values: string[], item: AvakioPropertyItem) => void;\r\n  multicomboPlaceholder?: string;\r\n  multicomboClassName?: string;\r\n  multicomboShowCount?: boolean;\r\n  multicomboMaxDisplayItems?: number;\r\n  multicomboDisabled?: boolean;\r\n  sliderDefaultValue?: number;\r\n  sliderMin?: number;\r\n  sliderMax?: number;\r\n  sliderStep?: number;\r\n  sliderDisabled?: boolean;\r\n  sliderLabel?: string;\r\n  sliderDescription?: string;\r\n  sliderRequired?: boolean;\r\n  sliderError?: string;\r\n  sliderShowValue?: boolean;\r\n  sliderFormatValue?: (value: number) => string;\r\n  sliderMarks?: number[];\r\n  sliderSize?: \"sm\" | \"md\" | \"lg\";\r\n  sliderOnChange?: (value: number, item: AvakioPropertyItem) => void;\r\n  dateShowTime?: boolean;\r\n  dateClassName?: string;\r\n  dateOnChange?: (value: string, item: AvakioPropertyItem) => void;\r\n  colorDefaultValue?: string;\r\n  colorLabel?: string;\r\n  colorDescription?: string;\r\n  colorError?: string;\r\n  colorDisabled?: boolean;\r\n  colorReadOnly?: boolean;\r\n  colorRequired?: boolean;\r\n  colorPresets?: AvakioColorPickerPreset[];\r\n  colorAllowCustomInput?: boolean;\r\n  colorShowPreview?: boolean;\r\n  colorClassName?: string;\r\n  colorOnChange?: (color: string, item: AvakioPropertyItem) => void;\r\n}\r\n\r\nexport interface AvakioPropertyProps {\r\n  items: AvakioPropertyItem[];\r\n  onChange?: (items: AvakioPropertyItem[], changed: AvakioPropertyItem) => void;\r\n  theme?: string;\r\n  className?: string;\r\n  style?: React.CSSProperties;\r\n  dense?: boolean;\r\n  showBorders?: boolean;\r\n  /** ID of the component */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n}\r\n\r\nexport function AvakioProperty({\r\n  items,\r\n  onChange,\r\n  theme,\r\n  className,\r\n  style,\r\n  dense,\r\n  showBorders,\r\n  id,\r\n  testId,\r\n}: AvakioPropertyProps) {\r\n  const [rows, setRows] = useState<AvakioPropertyItem[]>(items);\r\n  const [lastChanged, setLastChanged] = useState<AvakioPropertyItem | null>(null);\r\n  const [openDateId, setOpenDateId] = useState<string | null>(null);\r\n  const [openDatePlacement, setOpenDatePlacement] = useState<\"bottom\" | \"top\">(\"bottom\");\r\n  const rootRef = useRef<HTMLDivElement | null>(null);\r\n  const dateBtnRefs = useRef<Record<string, HTMLButtonElement | null>>({});\r\n\r\n  useEffect(() => {\r\n    setRows(items);\r\n  }, [items]);\r\n\r\n  useEffect(() => {\r\n    if (lastChanged) {\r\n      onChange?.(rows, lastChanged);\r\n      setLastChanged(null);\r\n    }\r\n  }, [lastChanged, onChange, rows]);\r\n\r\n  useEffect(() => {\r\n    if (!openDateId) return;\r\n    const handleClickOutside = (evt: MouseEvent) => {\r\n      if (!rootRef.current) return;\r\n      if (!rootRef.current.contains(evt.target as Node)) {\r\n        setOpenDateId(null);\r\n      }\r\n    };\r\n    document.addEventListener(\"mousedown\", handleClickOutside);\r\n    return () => document.removeEventListener(\"mousedown\", handleClickOutside);\r\n  }, [openDateId]);\r\n\r\n  const computeDatePlacement = (id: string) => {\r\n    const btn = dateBtnRefs.current[id];\r\n    if (!btn) return \"bottom\" as const;\r\n    const rect = btn.getBoundingClientRect();\r\n    const viewportHeight = window.innerHeight;\r\n    const estimatedHeight = 360;\r\n    const spaceBelow = viewportHeight - rect.bottom;\r\n    const spaceAbove = rect.top;\r\n    return spaceBelow < estimatedHeight && spaceAbove > spaceBelow ? \"top\" : \"bottom\";\r\n  };\r\n\r\n  const coerceDate = (val: unknown) => {\r\n    if (val === undefined || val === null || val === \"\") return null;\r\n    const raw = String(val);\r\n    const normalized = raw.includes(\"T\") ? raw : `${raw}T00:00:00`;\r\n    const d = new Date(normalized);\r\n    return Number.isNaN(d.getTime()) ? null : d;\r\n  };\r\n\r\n  const formatDisplayValue = (item: AvakioPropertyItem) => {\r\n    if (item.value === undefined || item.value === null || item.value === \"\") {\r\n      return item.placeholder || (item.type === \"datetime\" ? \"Select date & time\" : \"Select date\");\r\n    }\r\n\r\n    if (item.type === \"date\" && typeof item.value === \"string\") {\r\n      const date = coerceDate(item.value);\r\n      return date ? date.toLocaleDateString(undefined, { dateStyle: \"medium\" }) : \"Invalid date\";\r\n    }\r\n\r\n    if (item.type === \"datetime\" && typeof item.value === \"string\") {\r\n      const date = coerceDate(item.value);\r\n      return date ? date.toLocaleString(undefined, { dateStyle: \"medium\", timeStyle: \"short\" }) : \"Invalid date\";\r\n    }\r\n\r\n    return String(item.value);\r\n  };\r\n\r\n  const groupedRows = useMemo(() => {\r\n    const groups: Record<string, AvakioPropertyItem[]> = {};\r\n    rows.forEach((row) => {\r\n      const key = row.group || \"__ungrouped\";\r\n      if (!groups[key]) groups[key] = [];\r\n      groups[key].push(row);\r\n    });\r\n    return groups;\r\n  }, [rows]);\r\n\r\n  const handleChange = (id: string, value: string | number | boolean | string[] | AvakioDateRange | null) => {\r\n    setRows((prev) => {\r\n      const next = prev.map((r) => (r.id === id ? { ...r, value } : r));\r\n      const changed = next.find((r) => r.id === id)!;\r\n      setLastChanged(changed);\r\n      return next;\r\n    });\r\n  };\r\n\r\n  const renderControl = (item: AvakioPropertyItem) => {\r\n    const common = {\r\n      id: item.id,\r\n      name: item.id,\r\n      disabled: item.disabled,\r\n      required: item.required,\r\n      placeholder: item.placeholder,\r\n    } as const;\r\n\r\n    switch (item.type) {\r\n      case \"number\":\r\n        return (\r\n          <input\r\n            type=\"number\"\r\n            className=\"av-prop-input\"\r\n            {...common}\r\n            value={\r\n              item.value === undefined || item.value === null\r\n                ? \"\"\r\n                : (item.value as number | string)\r\n            }\r\n            onChange={(e) => handleChange(item.id, e.target.value === \"\" ? \"\" : Number(e.target.value))}\r\n          />\r\n        );\r\n      case \"select\":\r\n        {\r\n          const richOptions = (item.selectOptions ?? item.options ?? []).map((opt): string | AvakioRichSelectOption => {\r\n            if (typeof opt === \"string\") return opt;\r\n            if ((opt as AvakioRichSelectOption).id !== undefined) return opt as AvakioRichSelectOption;\r\n            const propOpt = opt as AvakioPropertyOption;\r\n            const normalizedId = typeof propOpt.value === \"boolean\" ? String(propOpt.value) : propOpt.value;\r\n            return { id: normalizedId, value: propOpt.label } as AvakioRichSelectOption;\r\n          }) as AvakioRichSelectOption[] | string[];\r\n\r\n          return (\r\n            <AvakioRichSelect\r\n              id={item.id}\r\n              value={typeof item.value === \"string\" || typeof item.value === \"number\" ? item.value : undefined}\r\n              options={richOptions}\r\n              onChange={(val, opt) => {\r\n                item.selectOnChange?.(val, opt, item);\r\n                handleChange(item.id, (val as string | number) ?? \"\");\r\n              }}\r\n              placeholder={item.selectPlaceholder ?? item.placeholder}\r\n              disabled={item.selectDisabled ?? item.disabled}\r\n              readonly={item.selectReadOnly}\r\n              template={item.selectTemplate}\r\n              width={item.selectWidth}\r\n              maxHeight={item.selectMaxHeight}\r\n              yCount={item.selectYCount}\r\n              required={item.selectRequired ?? item.required}\r\n              error={item.selectError}\r\n              className={item.selectClassName}\r\n              clearable={item.selectClearable}\r\n            />\r\n          );\r\n        }\r\n      case \"checkbox\":\r\n        {\r\n          const checked = item.value === undefined ? false : Boolean(item.value);\r\n        return (\r\n          <AvakioCheckbox\r\n            id={item.id}\r\n            name={item.id}\r\n              checked={checked}\r\n              onChange={(next) => {\r\n                item.checkboxOnChange?.(next, item);\r\n                handleChange(item.id, next);\r\n              }}\r\n              label={item.checkboxLabel ?? item.placeholder ?? item.label}\r\n              description={item.checkboxDescription ?? item.description}\r\n            disabled={item.disabled}\r\n            required={item.required}\r\n          />\r\n        );\r\n        }\r\n      case \"combo\":\r\n        return (\r\n          <AvakioCombo\r\n            id={item.id}\r\n            value={typeof item.value === \"string\" || typeof item.value === \"number\" ? item.value : undefined}\r\n            options={(item.comboOptions ?? item.options ?? []) as AvakioComboOption[] | string[]}\r\n            onChange={(val, opt) => {\r\n              item.comboOnChange?.(val, opt, item);\r\n              handleChange(item.id, (val as string | number) ?? \"\");\r\n            }}\r\n            onInputChange={(inputVal) => item.comboOnInputChange?.(inputVal, item)}\r\n            placeholder={item.comboPlaceholder ?? item.placeholder}\r\n            label={item.comboLabel}\r\n            labelAlign={item.comboLabelAlign}\r\n            labelWidth={item.comboLabelWidth}\r\n            disabled={item.comboDisabled ?? item.disabled}\r\n            readonly={item.comboReadOnly}\r\n            filterMode={item.comboFilterMode}\r\n            customFilter={item.comboCustomFilter}\r\n            template={item.comboTemplate}\r\n            width={item.comboWidth}\r\n            maxHeight={item.comboMaxHeight}\r\n            required={item.comboRequired ?? item.required}\r\n            error={item.comboError}\r\n            className={item.comboClassName}\r\n          />\r\n        );\r\n      case \"colorpicker\":\r\n        return (\r\n          <AvakioColorPicker\r\n            id={item.id}\r\n            value={typeof item.value === \"string\" ? item.value : undefined}\r\n            defaultValue={item.colorDefaultValue}\r\n            label={item.colorLabel}\r\n            description={item.colorDescription}\r\n            error={item.colorError}\r\n            disabled={item.colorDisabled ?? item.disabled}\r\n            readOnly={item.colorReadOnly}\r\n            required={item.colorRequired ?? item.required}\r\n            presets={item.colorPresets}\r\n            allowCustomInput={item.colorAllowCustomInput}\r\n            showPreview={item.colorShowPreview}\r\n            className={item.colorClassName}\r\n            onChange={(color) => {\r\n              item.colorOnChange?.(color, item);\r\n              handleChange(item.id, color);\r\n            }}\r\n          />\r\n        );\r\n      case \"counter\":\r\n        return (\r\n          <AvakioCounter\r\n            id={item.id}\r\n            value={typeof item.value === \"number\" ? item.value : undefined}\r\n            defaultValue={item.counterDefaultValue}\r\n            step={item.counterStep}\r\n            min={item.counterMin}\r\n            max={item.counterMax}\r\n            label={item.counterLabel ?? item.label}\r\n            description={item.counterDescription ?? item.description}\r\n            error={item.counterError}\r\n            required={item.counterRequired ?? item.required}\r\n            disabled={item.counterDisabled ?? item.disabled}\r\n            readOnly={item.counterReadOnly}\r\n            size={item.counterSize}\r\n            allowInput={item.counterAllowInput}\r\n            className={item.counterClassName}\r\n            onChange={(val) => {\r\n              item.counterOnChange?.(val, item);\r\n              handleChange(item.id, val);\r\n            }}\r\n          />\r\n        );\r\n      case \"slider\":\r\n        return (\r\n          <AvakioSlider\r\n            value={typeof item.value === \"number\" ? item.value : undefined}\r\n            defaultValue={item.sliderDefaultValue}\r\n            min={item.sliderMin}\r\n            max={item.sliderMax}\r\n            step={item.sliderStep}\r\n            disabled={item.sliderDisabled ?? item.disabled}\r\n            label={item.sliderLabel ?? item.label}\r\n            description={item.sliderDescription ?? item.description}\r\n            required={item.sliderRequired ?? item.required}\r\n            error={item.sliderError}\r\n            showValue={item.sliderShowValue}\r\n            formatValue={item.sliderFormatValue}\r\n            marks={item.sliderMarks}\r\n            size={item.sliderSize}\r\n            onChange={(val) => {\r\n              const numericVal = typeof val === \"number\" ? val : val[0];\r\n              item.sliderOnChange?.(numericVal, item);\r\n              handleChange(item.id, numericVal);\r\n            }}\r\n          />\r\n        );\r\n      case \"date\":\r\n        return (\r\n          <div className=\"av-prop-datewrap\">\r\n            <button\r\n              type=\"button\"\r\n              className=\"av-prop-datebtn\"\r\n              ref={(el) => {\r\n                dateBtnRefs.current[item.id] = el;\r\n              }}\r\n              onClick={() => {\r\n                if (openDateId === item.id) {\r\n                  setOpenDateId(null);\r\n                  return;\r\n                }\r\n                const placement = computeDatePlacement(item.id);\r\n                setOpenDatePlacement(placement);\r\n                setOpenDateId(item.id);\r\n              }}\r\n            >\r\n              {formatDisplayValue(item)}\r\n            </button>\r\n            {openDateId === item.id && (\r\n              <div className={`av-prop-datepop ${openDatePlacement === \"top\" ? \"is-top\" : \"\"}`}>\r\n                <AvakioDatePicker\r\n                  value={(item.value as string | undefined) ?? \"\"}\r\n                  onChange={(val) => {\r\n                    item.dateOnChange?.(val, item);\r\n                    handleChange(item.id, val);\r\n                    setOpenDateId(null);\r\n                  }}\r\n                  showTime={item.dateShowTime ?? false}\r\n                  className={item.dateClassName ?? \"av-prop-datepicker\"}\r\n                />\r\n              </div>\r\n            )}\r\n          </div>\r\n        );\r\n      case \"daterangepicker\":\r\n        return (\r\n          <AvakioDateRangePicker\r\n            value={item.value && typeof item.value === \"object\" ? (item.value as AvakioDateRange) : undefined}\r\n            defaultValue={item.daterangeDefaultValue}\r\n            presets={item.daterangePresets}\r\n            allowSingleDay={item.daterangeAllowSingleDay}\r\n            showTime={item.daterangeShowTime}\r\n            className={item.daterangeClassName}\r\n            onChange={(range) => {\r\n              item.daterangeOnChange?.(range, item);\r\n              handleChange(item.id, range);\r\n            }}\r\n          />\r\n        );\r\n      case \"gridsuggest\":\r\n        return (\r\n          <AvakioGridSuggest\r\n            id={item.id}\r\n            value={typeof item.value === \"string\" || typeof item.value === \"number\" ? item.value : undefined}\r\n            data={item.gridsuggestData ?? (item.options as unknown as AvakioGridSuggestOption[] | undefined) ?? []}\r\n            onChange={(val, opt) => {\r\n              item.gridsuggestOnChange?.(val, opt, item);\r\n              handleChange(item.id, (val as string | number) ?? \"\");\r\n            }}\r\n            onInputChange={(text) => item.gridsuggestOnInputChange?.(text, item)}\r\n            placeholder={item.gridsuggestPlaceholder ?? item.placeholder}\r\n            label={item.gridsuggestLabel}\r\n            labelAlign={item.gridsuggestLabelAlign}\r\n            labelWidth={item.gridsuggestLabelWidth}\r\n            disabled={item.gridsuggestDisabled ?? item.disabled}\r\n            readonly={item.gridsuggestReadOnly}\r\n            textValue={item.gridsuggestTextValue}\r\n            template={item.gridsuggestTemplate}\r\n            width={item.gridsuggestWidth}\r\n            body={item.gridsuggestBody}\r\n            required={item.gridsuggestRequired ?? item.required}\r\n            error={item.gridsuggestError}\r\n            className={item.gridsuggestClassName}\r\n            editable={item.gridsuggestEditable}\r\n            filterMode={item.gridsuggestFilterMode}\r\n          />\r\n        );\r\n      case \"multicombo\":\r\n        return (\r\n          <AvakioMultiCombo\r\n            options={item.multicomboOptions ?? []}\r\n            value={Array.isArray(item.multicomboValue ?? item.value) ? (item.multicomboValue ?? (item.value as string[])) : []}\r\n            onChange={(vals) => {\r\n              item.multicomboOnChange?.(vals, item);\r\n              handleChange(item.id, vals);\r\n            }}\r\n            placeholder={item.multicomboPlaceholder ?? item.placeholder}\r\n            className={item.multicomboClassName}\r\n            showCount={item.multicomboShowCount}\r\n            maxDisplayItems={item.multicomboMaxDisplayItems}\r\n            disabled={item.multicomboDisabled ?? item.disabled}\r\n          />\r\n        );\r\n      case \"datetime\":\r\n        return (\r\n          <div className=\"av-prop-datewrap\">\r\n            <button\r\n              type=\"button\"\r\n              className=\"av-prop-datebtn\"\r\n              ref={(el) => {\r\n                dateBtnRefs.current[item.id] = el;\r\n              }}\r\n              onClick={() => {\r\n                if (openDateId === item.id) {\r\n                  setOpenDateId(null);\r\n                  return;\r\n                }\r\n                const placement = computeDatePlacement(item.id);\r\n                setOpenDatePlacement(placement);\r\n                setOpenDateId(item.id);\r\n              }}\r\n            >\r\n              {formatDisplayValue(item)}\r\n            </button>\r\n            {openDateId === item.id && (\r\n              <div className={`av-prop-datepop ${openDatePlacement === \"top\" ? \"is-top\" : \"\"}`}>\r\n                <AvakioDatePicker\r\n                  value={(item.value as string | undefined) ?? \"\"}\r\n                  onChange={(val) => {\r\n                    item.dateOnChange?.(val, item);\r\n                    handleChange(item.id, val);\r\n                    setOpenDateId(null);\r\n                  }}\r\n                  showTime={item.dateShowTime ?? true}\r\n                  className={item.dateClassName ?? \"av-prop-datepicker\"}\r\n                />\r\n              </div>\r\n            )}\r\n          </div>\r\n        );\r\n      case \"button\":\r\n        return (\r\n          <AvakioButton\r\n            label={item.buttonLabel || item.placeholder || \"Action\"}\r\n            onClick={() => {\r\n              if (item.disabled) return;\r\n              item.buttonOnClick?.(item);\r\n              handleChange(item.id, true);\r\n            }}\r\n            disabled={item.disabled}\r\n            variant={item.buttonVariant}\r\n            size={item.buttonSize}\r\n            badge={item.buttonBadge}\r\n            icon={item.buttonIcon}\r\n            iconRight={item.buttonIconRight}\r\n            block={item.buttonBlock}\r\n          />\r\n        );\r\n      case \"textarea\":\r\n        return (\r\n          <textarea\r\n            className=\"av-prop-input av-prop-textarea\"\r\n            {...common}\r\n            value={(item.value as string | undefined) ?? \"\"}\r\n            onChange={(e) => handleChange(item.id, e.target.value)}\r\n          />\r\n        );\r\n      case \"text\":\r\n      default:\r\n        return (\r\n          <input\r\n            type=\"text\"\r\n            className=\"av-prop-input\"\r\n            {...common}\r\n            value={(item.value as string | undefined) ?? \"\"}\r\n            onChange={(e) => handleChange(item.id, e.target.value)}\r\n          />\r\n        );\r\n    }\r\n  };\r\n\r\n  const rootClass = [\r\n    \"avakio-property\",\r\n    dense ? \"is-dense\" : \"\",\r\n    showBorders ? \"has-borders\" : \"\",\r\n    className || \"\",\r\n  ]\r\n    .filter(Boolean)\r\n    .join(\" \");\r\n\r\n  const themeProps = theme ? { \"data-admin-theme\": theme } : undefined;\r\n\r\n  return (\r\n    <div ref={rootRef} id={id} data-testid={testId} className={rootClass} style={style} {...themeProps}>\r\n      <div className=\"av-prop-table\">\r\n        {Object.entries(groupedRows).map(([group, rowsInGroup]) => (\r\n          <React.Fragment key={group}>\r\n            {group !== \"__ungrouped\" && <div className=\"av-prop-group\">{group}</div>}\r\n            {rowsInGroup.map((item) => (\r\n              <div key={item.id} className=\"av-prop-row\">\r\n                <div className=\"av-prop-label\">\r\n                  <label htmlFor={item.id}>{item.label}</label>\r\n                  {item.description && <div className=\"av-prop-desc\">{item.description}</div>}\r\n                </div>\r\n                <div className=\"av-prop-control\">{renderControl(item)}</div>\r\n              </div>\r\n            ))}\r\n          </React.Fragment>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useState, useMemo, useEffect } from 'react';\r\nimport { ChevronLeft, ChevronRight } from 'lucide-react';\r\nimport './avakio-calendar.css';\r\n\r\nexport type AvakioCalendarMode = 'single' | 'multiple' | 'range';\r\n\r\nexport interface AvakioCalendarMarker {\r\n  date: string; // ISO date string\r\n  color?: string;\r\n  text?: string;\r\n}\r\n\r\nexport interface AvakioCalendarProps {\r\n  value?: string | string[]; // ISO date string(s)\r\n  onChange?: (value: string | string[]) => void;\r\n  mode?: AvakioCalendarMode;\r\n  minDate?: string; // ISO date string\r\n  maxDate?: string; // ISO date string\r\n  disabledDates?: string[]; // Array of ISO date strings\r\n  markers?: AvakioCalendarMarker[]; // Event indicators\r\n  showWeekNumbers?: boolean;\r\n  monthsToShow?: number; // Display multiple months (1-3)\r\n  weekStart?: 0 | 1; // 0 = Sunday, 1 = Monday\r\n  className?: string;\r\n  onMonthChange?: (date: Date) => void;\r\n  /** ID of the component */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n}\r\n\r\nfunction isSameDay(date1: Date, date2: Date): boolean {\r\n  return (\r\n    date1.getFullYear() === date2.getFullYear() &&\r\n    date1.getMonth() === date2.getMonth() &&\r\n    date1.getDate() === date2.getDate()\r\n  );\r\n}\r\n\r\nfunction formatDateKey(date: Date): string {\r\n  const year = date.getFullYear();\r\n  const month = String(date.getMonth() + 1).padStart(2, '0');\r\n  const day = String(date.getDate()).padStart(2, '0');\r\n  return `${year}-${month}-${day}`;\r\n}\r\n\r\nfunction parseDate(str: string): Date {\r\n  // Parse as local date to avoid timezone shifts\r\n  const [year, month, day] = str.split('-').map(Number);\r\n  return new Date(year, month - 1, day);\r\n}\r\n\r\nexport function AvakioCalendar({\r\n  value,\r\n  onChange,\r\n  mode = 'single',\r\n  minDate,\r\n  maxDate,\r\n  disabledDates = [],\r\n  markers = [],\r\n  showWeekNumbers = false,\r\n  monthsToShow = 1,\r\n  weekStart = 0,\r\n  className = '',\r\n  onMonthChange,\r\n  id,\r\n  testId,\r\n}: AvakioCalendarProps) {\r\n  // Initialize view to the first selected date's month, or today if no selection\r\n  const getInitialViewDate = () => {\r\n    if (value) {\r\n      const firstDate = Array.isArray(value) ? value[0] : value;\r\n      if (firstDate && firstDate.trim()) {\r\n        return parseDate(firstDate);\r\n      }\r\n    }\r\n    return new Date();\r\n  };\r\n\r\n  const [viewDate, setViewDate] = useState(getInitialViewDate);\r\n  \r\n  // Clamp monthsToShow between 1 and 3\r\n  const safeMonthsToShow = Math.max(1, Math.min(3, monthsToShow));\r\n\r\n  // Update viewDate when value prop changes to a different month\r\n  useEffect(() => {\r\n    if (value) {\r\n      const firstDate = Array.isArray(value) ? value[0] : value;\r\n      if (firstDate && firstDate.trim()) {\r\n        const selectedDate = parseDate(firstDate);\r\n        // Only update if the selected date is in a different month than current view\r\n        if (selectedDate.getFullYear() !== viewDate.getFullYear() ||\r\n            selectedDate.getMonth() !== viewDate.getMonth()) {\r\n          setViewDate(selectedDate);\r\n        }\r\n      }\r\n    }\r\n  }, [value]); // Only depend on value, not viewDate to avoid loops\r\n\r\n  const selectedDates = useMemo(() => {\r\n    if (!value) return [];\r\n    const dates = Array.isArray(value) ? value : [value];\r\n    // Filter out empty strings before parsing\r\n    return dates.filter(d => d && d.trim()).map(parseDate);\r\n  }, [value]);\r\n\r\n  const disabledDatesSet = useMemo(() => {\r\n    return new Set(disabledDates);\r\n  }, [disabledDates]);\r\n\r\n  const markersByDate = useMemo(() => {\r\n    const map = new Map<string, AvakioCalendarMarker[]>();\r\n    markers.forEach(marker => {\r\n      // Ensure we always use YYYY-MM-DD format (remove time if present)\r\n      const key = marker.date.includes('T') ? marker.date.split('T')[0] : marker.date;\r\n      if (!map.has(key)) map.set(key, []);\r\n      map.get(key)!.push(marker);\r\n    });\r\n    return map;\r\n  }, [markers]);\r\n\r\n  const monthNames = [\r\n    'January', 'February', 'March', 'April', 'May', 'June',\r\n    'July', 'August', 'September', 'October', 'November', 'December'\r\n  ];\r\n\r\n  const weekDays = weekStart === 0\r\n    ? ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat']\r\n    : ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];\r\n\r\n  const getMonthGrid = (baseDate: Date) => {\r\n    const year = baseDate.getFullYear();\r\n    const month = baseDate.getMonth();\r\n    \r\n    const firstDay = new Date(year, month, 1);\r\n    const lastDay = new Date(year, month + 1, 0);\r\n    \r\n    let startDay = firstDay.getDay();\r\n    if (weekStart === 1) {\r\n      startDay = startDay === 0 ? 6 : startDay - 1;\r\n    }\r\n    \r\n    const daysInMonth = lastDay.getDate();\r\n    const daysInPrevMonth = new Date(year, month, 0).getDate();\r\n    \r\n    const days: Array<{\r\n      date: Date;\r\n      isCurrentMonth: boolean;\r\n      weekNumber?: number;\r\n    }> = [];\r\n    \r\n    // Previous month days\r\n    for (let i = startDay - 1; i >= 0; i--) {\r\n      days.push({\r\n        date: new Date(year, month - 1, daysInPrevMonth - i),\r\n        isCurrentMonth: false,\r\n      });\r\n    }\r\n    \r\n    // Current month days\r\n    for (let i = 1; i <= daysInMonth; i++) {\r\n      const date = new Date(year, month, i);\r\n      days.push({\r\n        date,\r\n        isCurrentMonth: true,\r\n        weekNumber: showWeekNumbers ? getWeekNumber(date) : undefined,\r\n      });\r\n    }\r\n    \r\n    // Next month days to fill grid\r\n    const remainingDays = 42 - days.length;\r\n    for (let i = 1; i <= remainingDays; i++) {\r\n      days.push({\r\n        date: new Date(year, month + 1, i),\r\n        isCurrentMonth: false,\r\n      });\r\n    }\r\n    \r\n    return days;\r\n  };\r\n\r\n  const getWeekNumber = (date: Date): number => {\r\n    const d = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()));\r\n    const dayNum = d.getUTCDay() || 7;\r\n    d.setUTCDate(d.getUTCDate() + 4 - dayNum);\r\n    const yearStart = new Date(Date.UTC(d.getUTCFullYear(), 0, 1));\r\n    return Math.ceil((((d.getTime() - yearStart.getTime()) / 86400000) + 1) / 7);\r\n  };\r\n\r\n  const isDateDisabled = (date: Date): boolean => {\r\n    const key = formatDateKey(date);\r\n    if (disabledDatesSet.has(key)) return true;\r\n    \r\n    // Compare dates only (ignore time)\r\n    if (minDate) {\r\n      const min = parseDate(minDate);\r\n      if (date.getFullYear() < min.getFullYear() ||\r\n          (date.getFullYear() === min.getFullYear() && date.getMonth() < min.getMonth()) ||\r\n          (date.getFullYear() === min.getFullYear() && date.getMonth() === min.getMonth() && date.getDate() < min.getDate())) {\r\n        return true;\r\n      }\r\n    }\r\n    \r\n    if (maxDate) {\r\n      const max = parseDate(maxDate);\r\n      if (date.getFullYear() > max.getFullYear() ||\r\n          (date.getFullYear() === max.getFullYear() && date.getMonth() > max.getMonth()) ||\r\n          (date.getFullYear() === max.getFullYear() && date.getMonth() === max.getMonth() && date.getDate() > max.getDate())) {\r\n        return true;\r\n      }\r\n    }\r\n    \r\n    return false;\r\n  };\r\n\r\n  const isDateSelected = (date: Date): boolean => {\r\n    return selectedDates.some(selected => isSameDay(selected, date));\r\n  };\r\n\r\n  const isDateInRange = (date: Date): boolean => {\r\n    if (mode !== 'range' || selectedDates.length !== 2) return false;\r\n    const [start, end] = selectedDates.sort((a, b) => a.getTime() - b.getTime());\r\n    return date > start && date < end;\r\n  };\r\n\r\n  const handleDateClick = (date: Date) => {\r\n    if (isDateDisabled(date)) return;\r\n\r\n    const dateKey = formatDateKey(date);\r\n\r\n    if (mode === 'single') {\r\n      // Allow deselecting by clicking the same date\r\n      const currentValue = typeof value === 'string' ? value : '';\r\n      onChange?.(currentValue === dateKey ? '' : dateKey);\r\n    } else if (mode === 'multiple') {\r\n      const currentDates = Array.isArray(value) ? value : value ? [value] : [];\r\n      const exists = currentDates.includes(dateKey);\r\n      const newDates = exists\r\n        ? currentDates.filter(d => d !== dateKey)\r\n        : [...currentDates, dateKey];\r\n      onChange?.(newDates);\r\n    } else if (mode === 'range') {\r\n      // Normalize current range to an array for safety\r\n      const currentRange = Array.isArray(value) ? value : value ? [value] : [];\r\n\r\n      if (currentRange.length === 0 || currentRange.length === 2) {\r\n        // Start new range\r\n        onChange?.([dateKey]);\r\n      } else if (currentRange.length === 1) {\r\n        // Complete range - if same date clicked, clear selection\r\n        if (currentRange[0] === dateKey) {\r\n          onChange?.([]);\r\n        } else {\r\n          const sorted = [currentRange[0], dateKey].sort();\r\n          onChange?.(sorted);\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  const handlePrevMonth = () => {\r\n    const newDate = new Date(viewDate.getFullYear(), viewDate.getMonth() - 1, 1);\r\n    setViewDate(newDate);\r\n    onMonthChange?.(newDate);\r\n  };\r\n\r\n  const handleNextMonth = () => {\r\n    const newDate = new Date(viewDate.getFullYear(), viewDate.getMonth() + 1, 1);\r\n    setViewDate(newDate);\r\n    onMonthChange?.(newDate);\r\n  };\r\n\r\n  const handleToday = () => {\r\n    const today = new Date();\r\n    setViewDate(today);\r\n    onMonthChange?.(today);\r\n    \r\n    // Also select today's date\r\n    const todayKey = formatDateKey(today);\r\n    if (mode === 'single') {\r\n      onChange?.(todayKey);\r\n    } else if (mode === 'multiple') {\r\n      const currentDates = Array.isArray(value) ? value : value ? [value] : [];\r\n      if (!currentDates.includes(todayKey)) {\r\n        onChange?.([...currentDates, todayKey]);\r\n      }\r\n    } else if (mode === 'range') {\r\n      onChange?.([todayKey]);\r\n    }\r\n  };\r\n\r\n  const renderMonth = (monthOffset: number) => {\r\n    const displayDate = new Date(viewDate.getFullYear(), viewDate.getMonth() + monthOffset, 1);\r\n    const days = getMonthGrid(displayDate);\r\n    const today = new Date();\r\n\r\n    return (\r\n      <div key={monthOffset} className=\"avakio-cal-month\">\r\n        <div className=\"avakio-cal-header\">\r\n          {monthOffset === 0 && safeMonthsToShow === 1 && (\r\n            <button\r\n              type=\"button\"\r\n              className=\"avakio-cal-nav-btn\"\r\n              onClick={handlePrevMonth}\r\n            >\r\n              <ChevronLeft className=\"h-4 w-4\" />\r\n            </button>\r\n          )}\r\n          <div className=\"avakio-cal-title\">\r\n            {monthNames[displayDate.getMonth()]} {displayDate.getFullYear()}\r\n          </div>\r\n          {monthOffset === monthsToShow - 1 && safeMonthsToShow === 1 && (\r\n            <button\r\n              type=\"button\"\r\n              className=\"avakio-cal-nav-btn\"\r\n              onClick={handleNextMonth}\r\n            >\r\n              <ChevronRight className=\"h-4 w-4\" />\r\n            </button>\r\n          )}\r\n        </div>\r\n\r\n        <div className={`avakio-cal-weekdays ${showWeekNumbers ? 'avakio-cal-with-week-nums' : ''}`}>\r\n          {showWeekNumbers && <div className=\"avakio-cal-weekday avakio-cal-week-num-header\">#</div>}\r\n          {weekDays.map(day => (\r\n            <div key={day} className=\"avakio-cal-weekday\">\r\n              {day}\r\n            </div>\r\n          ))}\r\n        </div>\r\n\r\n        <div className={`avakio-cal-grid ${showWeekNumbers ? 'avakio-cal-with-week-nums' : ''}`}>\r\n          {days.map((dayInfo, index) => {\r\n            const isSelected = isDateSelected(dayInfo.date);\r\n            const isToday = isSameDay(dayInfo.date, today);\r\n            const isDisabled = isDateDisabled(dayInfo.date);\r\n            const isInRange = isDateInRange(dayInfo.date);\r\n            const dateKey = formatDateKey(dayInfo.date);\r\n            const dayMarkers = markersByDate.get(dateKey) || [];\r\n            const showWeekNum = showWeekNumbers && index % 7 === 0;\r\n            const uniqueKey = `${dateKey}-${index}`;\r\n            const displayWeekNumber = showWeekNum\r\n              ? (dayInfo.weekNumber ?? getWeekNumber(dayInfo.date))\r\n              : undefined;\r\n\r\n            return (\r\n              <React.Fragment key={uniqueKey}>\r\n                {showWeekNum && (\r\n                  <div className=\"avakio-cal-week-num\">\r\n                    {displayWeekNumber}\r\n                  </div>\r\n                )}\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => handleDateClick(dayInfo.date)}\r\n                  disabled={isDisabled}\r\n                  className={`avakio-cal-day ${\r\n                    !dayInfo.isCurrentMonth ? 'avakio-cal-day-outside' : ''\r\n                  } ${isSelected ? 'avakio-cal-day-selected' : ''} ${\r\n                    isToday ? 'avakio-cal-day-today' : ''\r\n                  } ${isDisabled ? 'avakio-cal-day-disabled' : ''} ${\r\n                    isInRange ? 'avakio-cal-day-in-range' : ''\r\n                  }`}\r\n                >\r\n                  <span className=\"avakio-cal-day-number\">{dayInfo.date.getDate()}</span>\r\n                  {dayMarkers.length > 0 && (\r\n                    <div className=\"avakio-cal-markers\">\r\n                      {dayMarkers.slice(0, 3).map((marker, idx) => (\r\n                        <span\r\n                          key={`marker-${uniqueKey}-${idx}`}\r\n                          className=\"avakio-cal-marker\"\r\n                          style={{ backgroundColor: marker.color || '#3b82f6' }}\r\n                          title={marker.text}\r\n                        />\r\n                      ))}\r\n                    </div>\r\n                  )}\r\n                </button>\r\n              </React.Fragment>\r\n            );\r\n          })}\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div id={id} data-testid={testId} className={`avakio-calendar ${className}`}>\r\n      {safeMonthsToShow > 1 && (\r\n        <div className=\"avakio-cal-multi-nav\">\r\n          <button\r\n            type=\"button\"\r\n            className=\"avakio-cal-nav-btn\"\r\n            onClick={handlePrevMonth}\r\n          >\r\n            <ChevronLeft className=\"h-4 w-4\" />\r\n          </button>\r\n          <button\r\n            type=\"button\"\r\n            className=\"avakio-cal-today-btn\"\r\n            onClick={handleToday}\r\n          >\r\n            Today\r\n          </button>\r\n          <button\r\n            type=\"button\"\r\n            className=\"avakio-cal-nav-btn\"\r\n            onClick={handleNextMonth}\r\n          >\r\n            <ChevronRight className=\"h-4 w-4\" />\r\n          </button>\r\n        </div>\r\n      )}\r\n      \r\n      <div className={`avakio-cal-months avakio-cal-months-${safeMonthsToShow}`}>\r\n        {Array.from({ length: safeMonthsToShow }, (_, i) => renderMonth(i))}\r\n      </div>\r\n\r\n      {safeMonthsToShow === 1 && (\r\n        <div className=\"avakio-cal-footer\">\r\n          <button\r\n            type=\"button\"\r\n            className=\"avakio-cal-today-btn\"\r\n            onClick={handleToday}\r\n          >\r\n            Today\r\n          </button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useEffect, useMemo, useState } from \"react\";\r\nimport \"./avakio-scheduler.css\";\r\nimport { AvakioPopup } from \"../avakio-popup/avakio-popup\";\r\nimport \"../avakio-popup/avakio-popup.css\";\r\nimport { AvakioCalendar, AvakioCalendarMarker } from \"../ui-controls/avakio-calendar/avakio-calendar\";\r\n\r\nfunction startOfWeek(date: Date) {\r\n  const d = new Date(date);\r\n  const day = (d.getDay() + 6) % 7; // Monday as start\r\n  d.setDate(d.getDate() - day);\r\n  d.setHours(0, 0, 0, 0);\r\n  return d;\r\n}\r\n\r\nfunction addDays(date: Date, days: number) {\r\n  const d = new Date(date);\r\n  d.setDate(d.getDate() + days);\r\n  return d;\r\n}\r\n\r\nfunction formatDateKey(date: Date) {\r\n  const year = date.getFullYear();\r\n  const month = String(date.getMonth() + 1).padStart(2, \"0\");\r\n  const day = String(date.getDate()).padStart(2, \"0\");\r\n  return `${year}-${month}-${day}`;\r\n}\r\n\r\nfunction parseDateKey(key: string) {\r\n  const [y, m, d] = key.split(\"-\").map(Number);\r\n  return new Date(y, m - 1, d);\r\n}\r\n\r\nfunction formatTime(date: Date) {\r\n  return date.toLocaleTimeString(undefined, { hour: \"2-digit\", minute: \"2-digit\" });\r\n}\r\n\r\nfunction formatDay(date: Date) {\r\n  return date.toLocaleDateString(undefined, { weekday: \"short\", month: \"short\", day: \"numeric\" });\r\n}\r\n\r\nexport type AvakioEvent = {\r\n  id: string;\r\n  title: string;\r\n  start: string; // ISO string\r\n  end: string;   // ISO string\r\n  color?: string;\r\n};\r\n\r\nexport type AvakioSchedulerView = \"month\" | \"week\" | \"day\";\r\n\r\nexport interface AvakioSchedulerProps {\r\n  events?: AvakioEvent[];\r\n  defaultView?: AvakioSchedulerView;\r\n  defaultDate?: string; // ISO date to anchor the view\r\n  theme?: string; // optional theme token forwarded to popup overlays\r\n  userId?: string; // user ID to fetch calendar events for\r\n  dataUrl?: string; // deprecated alias for eventsUrl\r\n  eventsUrl?: string; // optional remote source for fetching events\r\n  loadRemoteOnNavigate?: boolean; // refetch when view/anchor changes\r\n  fetchOptions?: RequestInit; // custom fetch options\r\n  transformEvent?: (raw: any) => AvakioEvent; // adapter for remote payload\r\n  buildEventsQuery?: (range: { start: Date; end: Date; view: AvakioSchedulerView; userId?: string }) => string; // build query string\r\n  mutationUrl?: string; // fixed endpoint for creating/updating events (POST by default)\r\n  buildMutationUrl?: (event: AvakioEvent, action: \"create\" | \"update\") => string; // override mutation target\r\n  mutationMethod?: \"post\" | \"put\" | \"patch\"; // HTTP verb for create/update\r\n  onNavigate?: (date: string, view: AvakioSchedulerView) => void;\r\n  onViewChange?: (view: AvakioSchedulerView) => void;\r\n  onEventClick?: (event: AvakioEvent) => void;\r\n  onEventCreate?: (event: AvakioEvent) => void;\r\n  className?: string;\r\n  /** ID of the component */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n}\r\nexport function AvakioScheduler({\r\n  events = [],\r\n  defaultView = \"month\",\r\n  defaultDate,\r\n  theme,\r\n  userId,\r\n  dataUrl,\r\n  eventsUrl,\r\n  loadRemoteOnNavigate,\r\n  fetchOptions,\r\n  transformEvent,\r\n  buildEventsQuery,\r\n  mutationUrl,\r\n  buildMutationUrl,\r\n  mutationMethod = \"post\",\r\n  onNavigate,\r\n  onViewChange,\r\n  onEventClick,\r\n  onEventCreate,\r\n  className,\r\n  id,\r\n  testId,\r\n}: AvakioSchedulerProps) {\r\n  const [view, setView] = useState<AvakioSchedulerView>(defaultView);\r\n  const [anchor, setAnchor] = useState<Date>(\r\n    defaultDate ? new Date(defaultDate) : new Date(2020, 9, 1)\r\n  );\r\n  const [selectedDateKey, setSelectedDateKey] = useState<string>(formatDateKey(defaultDate ? new Date(defaultDate) : new Date()));\r\n  const [isMobile, setIsMobile] = useState(false);\r\n  const [remoteEvents, setRemoteEvents] = useState<AvakioEvent[]>([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [hasFetchedOnce, setHasFetchedOnce] = useState(false);\r\n  const [morePopup, setMorePopup] = useState<{ dateKey: string; anchorRect: DOMRect | null } | null>(null);\r\n\r\n  const eventsEndpoint = eventsUrl || dataUrl;\r\n\r\n  const rangeForView = (currentView: AvakioSchedulerView, currentAnchor: Date) => {\r\n    if (currentView === \"month\") {\r\n      const start = startOfWeek(new Date(currentAnchor.getFullYear(), currentAnchor.getMonth(), 1));\r\n      const end = addDays(start, 42);\r\n      return { start, end };\r\n    }\r\n    if (currentView === \"week\") {\r\n      const start = startOfWeek(currentAnchor);\r\n      const end = addDays(start, 7);\r\n      return { start, end };\r\n    }\r\n    const start = new Date(currentAnchor);\r\n    start.setHours(0, 0, 0, 0);\r\n    const end = addDays(start, 1);\r\n    return { start, end };\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (!eventsEndpoint) return;\r\n    if (!loadRemoteOnNavigate && hasFetchedOnce) return;\r\n    let cancelled = false;\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    const { start, end } = rangeForView(view, anchor);\r\n    const query = buildEventsQuery\r\n      ? buildEventsQuery({ start, end, view, userId })\r\n      : `?start=${start.toISOString()}&end=${end.toISOString()}${userId ? `&userId=${userId}` : ''}`;\r\n    const url = eventsEndpoint + query;\r\n\r\n    const mapEvent = (raw: any): AvakioEvent => {\r\n      if (transformEvent) return transformEvent(raw);\r\n      const hasLegacyShape = raw.start_date && raw.end_date;\r\n      const start = hasLegacyShape ? new Date(raw.start_date) : new Date(raw.start || raw.startDate || raw.date);\r\n      const end = hasLegacyShape ? new Date(raw.end_date) : new Date(raw.end || raw.endDate || raw.finish || raw.finishDate || start);\r\n      return {\r\n        id: String(raw.id ?? raw._id ?? `${start?.toISOString() || \"evt\"}-${Math.random()}`),\r\n        title: raw.title || raw.text || \"Event\",\r\n        start: start?.toISOString(),\r\n        end: end?.toISOString(),\r\n        color: raw.color,\r\n      };\r\n    };\r\n\r\n    fetch(url, fetchOptions)\r\n      .then(async (res) => {\r\n        if (!res.ok) throw new Error(`Request failed: ${res.status}`);\r\n        const json = await res.json();\r\n        const payload = Array.isArray(json)\r\n          ? json\r\n          : Array.isArray((json as any).data)\r\n            ? (json as any).data\r\n            : Array.isArray((json as any).events)\r\n              ? (json as any).events\r\n              : [];\r\n        const mapped = payload.map(mapEvent).filter((e: AvakioEvent) => e.start && e.end);\r\n        if (!cancelled) {\r\n          setRemoteEvents(mapped);\r\n          setHasFetchedOnce(true);\r\n        }\r\n      })\r\n      .catch((err: Error) => {\r\n        if (!cancelled) setError(err.message);\r\n      })\r\n      .finally(() => {\r\n        if (!cancelled) setLoading(false);\r\n      });\r\n\r\n    return () => {\r\n      cancelled = true;\r\n    };\r\n  }, [eventsEndpoint, loadRemoteOnNavigate, view, anchor, userId, fetchOptions, transformEvent, buildEventsQuery, hasFetchedOnce]);\r\n\r\n  // Track mobile viewport\r\n  useEffect(() => {\r\n    const detect = () => {\r\n      if (typeof window === \"undefined\") return false;\r\n      return window.innerWidth <= 768;\r\n    };\r\n    setIsMobile(detect());\r\n    const onResize = () => setIsMobile(detect());\r\n    window.addEventListener(\"resize\", onResize);\r\n    return () => window.removeEventListener(\"resize\", onResize);\r\n  }, []);\r\n\r\n  // Keep selected date aligned with anchor changes\r\n  useEffect(() => {\r\n    setSelectedDateKey(formatDateKey(anchor));\r\n  }, [anchor]);\r\n\r\n  const monthGrid = useMemo(() => {\r\n    const first = new Date(anchor.getFullYear(), anchor.getMonth(), 1);\r\n    const start = startOfWeek(first);\r\n    const cells: Date[] = [];\r\n    for (let i = 0; i < 42; i++) cells.push(addDays(start, i));\r\n    return cells;\r\n  }, [anchor]);\r\n\r\n  const weekGrid = useMemo(() => {\r\n    const start = startOfWeek(anchor);\r\n    return Array.from({ length: 7 }, (_, i) => addDays(start, i));\r\n  }, [anchor]);\r\n\r\n  const dayGrid = useMemo(() => [anchor], [anchor]);\r\n\r\n  const filteredEvents = useMemo(() => {\r\n    const merged = [...remoteEvents, ...events];\r\n    return merged.map((e) => ({ ...e, _start: new Date(e.start), _end: new Date(e.end) }));\r\n  }, [events, remoteEvents]);\r\n\r\n  const selectedDate = useMemo(() => parseDateKey(selectedDateKey), [selectedDateKey]);\r\n\r\n  const monthAgenda = useMemo(() => {\r\n    if (view !== \"month\") return [] as typeof filteredEvents;\r\n    return [...filteredEvents]\r\n      .filter((e) => e._start.getMonth() === anchor.getMonth() && e._start.getFullYear() === anchor.getFullYear())\r\n      .sort((a, b) => a._start.getTime() - b._start.getTime());\r\n  }, [view, filteredEvents, anchor]);\r\n\r\n  const visibleEvents = useMemo(() => {\r\n    if (view === \"month\") {\r\n      const start = monthGrid[0];\r\n      const end = addDays(monthGrid[monthGrid.length - 1], 1);\r\n      return filteredEvents.filter((e) => e._start < end && e._end >= start);\r\n    }\r\n    if (view === \"week\") {\r\n      const start = weekGrid[0];\r\n      const end = addDays(weekGrid[weekGrid.length - 1], 1);\r\n      return filteredEvents.filter((e) => e._start < end && e._end >= start);\r\n    }\r\n    return filteredEvents.filter((e) => {\r\n      const d = dayGrid[0];\r\n      return e._start.toDateString() === d.toDateString();\r\n    });\r\n  }, [view, monthGrid, weekGrid, dayGrid, filteredEvents]);\r\n\r\n  const go = (delta: number) => {\r\n    let next = new Date(anchor);\r\n    if (view === \"month\") next = new Date(anchor.getFullYear(), anchor.getMonth() + delta, 1);\r\n    if (view === \"week\") next = addDays(anchor, delta * 7);\r\n    if (view === \"day\") next = addDays(anchor, delta);\r\n    setAnchor(next);\r\n    onNavigate?.(next.toISOString(), view);\r\n  };\r\n\r\n  const changeView = (next: AvakioSchedulerView) => {\r\n    setView(next);\r\n    onViewChange?.(next);\r\n  };\r\n\r\n  const createEvent = () => {\r\n    const start = new Date(anchor);\r\n    const end = addDays(start, 0);\r\n    start.setHours(9, 0, 0, 0);\r\n    end.setHours(10, 0, 0, 0);\r\n    const evt: AvakioEvent = {\r\n      id: `${Date.now()}`,\r\n      title: \"New event\",\r\n      start: start.toISOString(),\r\n      end: end.toISOString(),\r\n    };\r\n\r\n    const maybePersist = async () => {\r\n      if (!mutationUrl) return onEventCreate?.(evt);\r\n      const target = buildMutationUrl ? buildMutationUrl(evt, \"create\") : mutationUrl;\r\n      try {\r\n        setLoading(true);\r\n        setError(null);\r\n        const res = await fetch(target, {\r\n          method: mutationMethod,\r\n          headers: { \"Content-Type\": \"application/json\" },\r\n          body: JSON.stringify(evt),\r\n        });\r\n        if (!res.ok) throw new Error(`Failed to save event: ${res.status}`);\r\n        const saved = await res.json();\r\n        const mapped = transformEvent ? transformEvent(saved) : saved;\r\n        setRemoteEvents((prev) => [...prev, mapped]);\r\n        onEventCreate?.(mapped);\r\n      } catch (err: any) {\r\n        setError(err.message || \"Failed to save event\");\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    void maybePersist();\r\n  };\r\n\r\n  const eventsForDay = (date: Date) => visibleEvents.filter((e) => e._start.toDateString() === date.toDateString());\r\n  const eventsForDayKey = (dateKey: string) => visibleEvents.filter((e) => e._start.toDateString() === dateKey);\r\n  const eventsForDateKey = (dateKey: string) => visibleEvents.filter((e) => formatDateKey(e._start) === dateKey);\r\n\r\n  const mobileMarkers: AvakioCalendarMarker[] = useMemo(\r\n    () =>\r\n      visibleEvents.map((e) => ({\r\n        date: formatDateKey(e._start),\r\n        color: e.color,\r\n        text: e.title,\r\n      })),\r\n    [visibleEvents]\r\n  );\r\n\r\n  const selectedDateEvents = useMemo(() => eventsForDateKey(selectedDateKey), [selectedDateKey, visibleEvents]);\r\n\r\n  const renderEventPill = (e: any) => (\r\n    <div\r\n      key={e.id}\r\n      className=\"avakio-sch-event\"\r\n      style={{ background: e.color || \"var(--sch-primary)\" }}\r\n      onClick={() => onEventClick?.(e)}\r\n    >\r\n      <div className=\"avakio-sch-event-title\">{e.title}</div>\r\n      <div className=\"avakio-sch-event-time\">\r\n        {formatTime(e._start)} â€“ {formatTime(e._end)}\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  const renderEventsForDay = (date: Date) => {\r\n    const events = eventsForDay(date).sort((a, b) => a._start.getTime() - b._start.getTime());\r\n    if (!events.length) return <div className=\"avakio-sch-mobile-empty\">No events</div>;\r\n    return events.map((evt) => renderEventPill(evt));\r\n  };\r\n\r\n  return (\r\n    <div id={id} data-testid={testId} className={[\"avakio-scheduler\", className || \"\"].join(\" \")}>\r\n      <div className=\"avakio-sch-toolbar\">\r\n        <div className=\"avakio-sch-nav\">\r\n          <button onClick={() => go(-1)} className=\"avakio-sch-btn\">Prev</button>\r\n          <button onClick={() => setAnchor(new Date())} className=\"avakio-sch-btn\">Today</button>\r\n          <button onClick={() => go(1)} className=\"avakio-sch-btn\">Next</button>\r\n        </div>\r\n        <div className=\"avakio-sch-title\">\r\n          {anchor.toLocaleString(undefined, { month: \"long\", year: \"numeric\", day: view === \"day\" ? \"numeric\" : undefined })}\r\n        </div>\r\n        <div className=\"avakio-sch-views\">\r\n          <button onClick={() => changeView(\"month\")} className={`avakio-sch-btn ${view === \"month\" ? \"is-active\" : \"\"}`}>Month</button>\r\n          <button onClick={() => changeView(\"week\")} className={`avakio-sch-btn ${view === \"week\" ? \"is-active\" : \"\"}`}>Week</button>\r\n          <button onClick={() => changeView(\"day\")} className={`avakio-sch-btn ${view === \"day\" ? \"is-active\" : \"\"}`}>Day</button>\r\n          <button onClick={createEvent} className=\"avakio-sch-btn\">New</button>\r\n        </div>\r\n        {loading && <div className=\"avakio-sch-status\">Loading remote eventsâ€¦</div>}\r\n        {error && <div className=\"avakio-sch-status is-error\">{error}</div>}\r\n      </div>\r\n\r\n      {view === \"month\" && isMobile && (\r\n        <div className=\"avakio-sch-month-mobile\">\r\n          <AvakioCalendar\r\n            value={selectedDateKey}\r\n            onChange={(val) => {\r\n              const nextKey = Array.isArray(val) ? val[0] : val;\r\n              if (!nextKey) return;\r\n              setSelectedDateKey(nextKey);\r\n              setAnchor(parseDateKey(nextKey));\r\n            }}\r\n            onMonthChange={(date) => setAnchor(date)}\r\n            markers={mobileMarkers}\r\n            weekStart={1}\r\n          />\r\n\r\n          <div className=\"avakio-sch-mobile-events\">\r\n            <div className=\"avakio-sch-mobile-events-header\">\r\n              {formatDay(selectedDate)} â€” {selectedDateEvents.length} event{selectedDateEvents.length === 1 ? \"\" : \"s\"}\r\n            </div>\r\n            <div className=\"avakio-sch-mobile-list\">\r\n              {selectedDateEvents.length === 0 && <div className=\"avakio-sch-mobile-empty\">No events for this date.</div>}\r\n              {selectedDateEvents\r\n                .slice()\r\n                .sort((a, b) => a._start.getTime() - b._start.getTime())\r\n                .map((evt) => (\r\n                  <div\r\n                    key={evt.id}\r\n                    className=\"avakio-sch-mobile-item\"\r\n                    onClick={() => onEventClick?.(evt)}\r\n                  >\r\n                    <span className=\"avakio-sch-dot\" style={{ background: evt.color || \"var(--sch-primary)\" }} />\r\n                    <div className=\"avakio-sch-mobile-meta\">\r\n                      <div className=\"avakio-sch-mobile-title\">{evt.title}</div>\r\n                      <div className=\"avakio-sch-mobile-time\">\r\n                        {formatTime(evt._start)} â€“ {formatTime(evt._end)}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {view === \"month\" && !isMobile && (\r\n        <div className=\"avakio-sch-month\">\r\n          <div className=\"avakio-sch-weekdays\">\r\n            {[\"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\", \"Sun\"].map((d) => (\r\n              <div key={d} className=\"avakio-sch-weekday\">{d}</div>\r\n            ))}\r\n          </div>\r\n          <div className=\"avakio-sch-grid\">\r\n            {monthGrid.map((d) => (\r\n              <div key={d.toISOString()} className={`avakio-sch-cell ${d.getMonth() === anchor.getMonth() ? \"\" : \"is-out\"}`}>\r\n                <div className=\"avakio-sch-cell-date\">\r\n                  <span>{d.getDate()}</span>\r\n                  {eventsForDay(d).length > 1 && (\r\n                    <button\r\n                      className=\"avakio-sch-more-btn\"\r\n                      onClick={(e) =>\r\n                        setMorePopup({\r\n                          dateKey: d.toDateString(),\r\n                          anchorRect: (e.currentTarget as HTMLButtonElement).getBoundingClientRect(),\r\n                        })\r\n                      }\r\n                      title={`${eventsForDay(d).length - 1} more`}\r\n                    >\r\n                      {eventsForDay(d).length - 1} more\r\n                    </button>\r\n                  )}\r\n                </div>\r\n                <div className=\"avakio-sch-cell-events\">\r\n                  {eventsForDay(d)\r\n                    .slice(0, 1)\r\n                    .map((evt) => renderEventPill(evt))}\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {view === \"month\" && !isMobile && monthAgenda.length > 0 && (\r\n        <div className=\"avakio-sch-month-agenda\">\r\n          {monthAgenda.map((evt) => (\r\n            <div\r\n              key={evt.id}\r\n              className=\"avakio-sch-agenda-item\"\r\n              onClick={() => onEventClick?.(evt)}\r\n            >\r\n              <div className=\"avakio-sch-agenda-time\">\r\n                <div>{formatTime(evt._start)}</div>\r\n                <div className=\"avakio-sch-agenda-time-end\">{formatTime(evt._end)}</div>\r\n              </div>\r\n              <span className=\"avakio-sch-dot\" style={{ background: evt.color || \"var(--sch-primary)\" }} />\r\n              <div className=\"avakio-sch-agenda-meta\">\r\n                <div className=\"avakio-sch-agenda-title\">{evt.title}</div>\r\n                <div className=\"avakio-sch-agenda-date\">\r\n                  {evt._start.toLocaleDateString(undefined, { weekday: \"short\", month: \"short\", day: \"numeric\" })}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n\r\n      {morePopup && (\r\n        <AvakioPopup\r\n          open\r\n          anchorRect={morePopup.anchorRect || undefined}\r\n          offset={{ y: 6 }}\r\n          theme={theme}\r\n          closeOnOutside\r\n          closeOnEsc\r\n          onClose={() => setMorePopup(null)}\r\n        >\r\n          <h4>Other events</h4>\r\n          <div className=\"avakio-sch-more-list\">\r\n            {eventsForDayKey(morePopup.dateKey)\r\n              .slice(1)\r\n              .map((evt) => (\r\n                <div\r\n                  key={evt.id}\r\n                  className=\"avakio-sch-more-item\"\r\n                  onClick={() => onEventClick?.(evt)}\r\n                >\r\n                  <span className=\"avakio-sch-dot\" style={{ background: evt.color || \"var(--sch-primary)\" }} />\r\n                  <div className=\"avakio-sch-more-meta\">\r\n                    <div className=\"avakio-sch-more-title\">{evt.title}</div>\r\n                    <div className=\"avakio-sch-more-time\">\r\n                      {formatTime(evt._start)} â€“ {formatTime(evt._end)}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n          </div>\r\n        </AvakioPopup>\r\n      )}\r\n\r\n      {view === \"week\" && (\r\n        <div className=\"avakio-sch-week\">\r\n          <div className=\"avakio-sch-week-row\">\r\n            {weekGrid.map((d) => (\r\n              <div key={d.toISOString()} className=\"avakio-sch-daycol\">\r\n                <div className=\"avakio-sch-day-header\">{formatDay(d)}</div>\r\n                <div className=\"avakio-sch-day-events\">{renderEventsForDay(d)}</div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {view === \"day\" && (\r\n        <div className=\"avakio-sch-day\">\r\n          <div className=\"avakio-sch-day-header\">{formatDay(dayGrid[0])}</div>\r\n          <div className=\"avakio-sch-day-events\">{renderEventsForDay(dayGrid[0])}</div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useState, useCallback, useMemo } from 'react';\r\nimport './avakio-sidebar.css';\r\n\r\nexport interface SidebarItem {\r\n  id: string;\r\n  value: string;\r\n  icon?: React.ReactNode;\r\n  data?: SidebarItem[];\r\n  [key: string]: any;\r\n}\r\n\r\nexport type SidebarPosition = 'left' | 'right';\r\n\r\nexport interface AvakioSidebarProps {\r\n  data: SidebarItem[];\r\n  collapsed?: boolean;\r\n  position?: SidebarPosition;\r\n  collapsedWidth?: number;\r\n  width?: number;\r\n  activeTitle?: boolean;\r\n  titleHeight?: number;\r\n  multipleOpen?: boolean;\r\n  onSelect?: (item: SidebarItem) => void;\r\n  onToggle?: (collapsed: boolean) => void;\r\n  className?: string;\r\n  mobileBreakpoint?: number;\r\n  tabletBreakpoint?: number;\r\n  autoCloseMobile?: boolean;\r\n  showOverlay?: boolean;\r\n  onOverlayClick?: () => void;\r\n  showMobileDongle?: boolean;\r\n  dongleIcon?: React.ReactNode;\r\n  /** ID of the component */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n}\r\n\r\ninterface ItemState {\r\n  [key: string]: boolean;\r\n}\r\n\r\nexport function AvakioSidebar({\r\n  data,\r\n  collapsed = false,\r\n  position = 'left',\r\n  collapsedWidth = 41,\r\n  width = 250,\r\n  activeTitle = true,\r\n  titleHeight = 40,\r\n  multipleOpen = false,\r\n  onSelect,\r\n  onToggle,\r\n  className = '',\r\n  mobileBreakpoint = 768,\r\n  tabletBreakpoint = 1024,\r\n  autoCloseMobile = true,\r\n  showOverlay = true,\r\n  onOverlayClick,\r\n  showMobileDongle = true,\r\n  dongleIcon,\r\n  id,\r\n  testId,\r\n}: AvakioSidebarProps) {\r\n  const [isCollapsed, setIsCollapsed] = useState(collapsed);\r\n  const [openItems, setOpenItems] = useState<ItemState>({});\r\n  const [hoveredItem, setHoveredItem] = useState<string | null>(null);\r\n  const [selectedItem, setSelectedItem] = useState<string | null>(null);\r\n  const [isMobile, setIsMobile] = useState(false);\r\n  const [isTablet, setIsTablet] = useState(false);\r\n\r\n  // Detect screen size: mobile (dongle), tablet (collapsed), desktop (expanded)\r\n  React.useEffect(() => {\r\n    const checkScreenSize = () => {\r\n      const width = window.innerWidth;\r\n      const isMobileScreen = width < mobileBreakpoint;\r\n      const isTabletScreen = width >= mobileBreakpoint && width < tabletBreakpoint;\r\n      \r\n      setIsMobile(isMobileScreen);\r\n      setIsTablet(isTabletScreen);\r\n      \r\n      // Mobile: hide sidebar (show dongle only)\r\n      // Tablet: show collapsed sidebar\r\n      // Desktop: show expanded sidebar\r\n      if (isMobileScreen || isTabletScreen) {\r\n        setIsCollapsed(true);\r\n      } else {\r\n        setIsCollapsed(false);\r\n      }\r\n    };\r\n    \r\n    checkScreenSize();\r\n    window.addEventListener('resize', checkScreenSize);\r\n    return () => window.removeEventListener('resize', checkScreenSize);\r\n  }, [mobileBreakpoint, tabletBreakpoint]);\r\n\r\n  // Sync internal state with external collapsed prop\r\n  React.useEffect(() => {\r\n    setIsCollapsed(collapsed);\r\n  }, [collapsed]);\r\n\r\n  // Prevent body scroll when sidebar is open on mobile\r\n  React.useEffect(() => {\r\n    if (isMobile && !isCollapsed) {\r\n      document.body.style.overflow = 'hidden';\r\n    } else {\r\n      document.body.style.overflow = '';\r\n    }\r\n    return () => {\r\n      document.body.style.overflow = '';\r\n    };\r\n  }, [isMobile, isCollapsed]);\r\n\r\n  const toggleCollapse = useCallback(() => {\r\n    const newCollapsed = !isCollapsed;\r\n    setIsCollapsed(newCollapsed);\r\n    if (onToggle) {\r\n      onToggle(newCollapsed);\r\n    }\r\n  }, [isCollapsed, onToggle]);\r\n\r\n  const toggleItem = useCallback(\r\n    (itemId: string, hasChildren: boolean) => {\r\n      if (!hasChildren || !activeTitle) return;\r\n\r\n      setOpenItems((prev) => {\r\n        if (multipleOpen) {\r\n          return { ...prev, [itemId]: !prev[itemId] };\r\n        } else {\r\n          return { [itemId]: !prev[itemId] };\r\n        }\r\n      });\r\n    },\r\n    [multipleOpen, activeTitle]\r\n  );\r\n\r\n  const handleItemClick = useCallback(\r\n    (item: SidebarItem, hasChildren: boolean, level: number = 0, parentId?: string) => {\r\n      // If collapsed and has children, expand the sidebar instead of toggling children\r\n      if (isCollapsed && hasChildren) {\r\n        setIsCollapsed(false);\r\n        return;\r\n      }\r\n      \r\n      // Always set the selected item and call onSelect\r\n      setSelectedItem(item.id);\r\n      if (onSelect) {\r\n        onSelect(item);\r\n      }\r\n      \r\n      // Auto-close/collapse sidebar on mobile and tablet:\r\n      // - Mobile: Close if it's a child item (level > 0) or parent without children\r\n      // - Tablet: Same behavior - collapse to show icons only, but select parent\r\n      // - Desktop: Don't auto-close, just toggle children\r\n      const shouldCollapseOnMobileOrTablet = (isMobile || isTablet) && autoCloseMobile && (level > 0 || !hasChildren);\r\n      \r\n      if (shouldCollapseOnMobileOrTablet) {\r\n        // On tablet, when collapsing after selecting a child, keep the parent selected\r\n        if (isTablet && level > 0 && parentId) {\r\n          setSelectedItem(parentId);\r\n        }\r\n        setIsCollapsed(true);\r\n      } else {\r\n        // Toggle children expansion when sidebar is not collapsed and not closing\r\n        if (hasChildren && !isCollapsed) {\r\n          toggleItem(item.id, hasChildren);\r\n        }\r\n      }\r\n    },\r\n    [toggleItem, onSelect, isMobile, isTablet, autoCloseMobile, isCollapsed]\r\n  );\r\n\r\n  const handleOverlayClick = useCallback(() => {\r\n    if (onOverlayClick) {\r\n      onOverlayClick();\r\n    } else {\r\n      setIsCollapsed(true);\r\n    }\r\n  }, [onOverlayClick]);\r\n\r\n  const renderIcon = (icon?: React.ReactNode) => {\r\n    if (!icon) return null;\r\n    return <span className=\"avakio-sidebar-icon\">{icon}</span>;\r\n  };\r\n\r\n  const renderArrow = (hasChildren: boolean, isOpen: boolean, level: number) => {\r\n    if (!hasChildren || level === 0) return null;\r\n    return (\r\n      <span className={`avakio-sidebar-arrow ${isOpen ? 'open' : ''}`}>\r\n        <svg width=\"12\" height=\"12\" viewBox=\"0 0 12 12\" fill=\"currentColor\">\r\n          <path d=\"M4 3l4 3-4 3V3z\" />\r\n        </svg>\r\n      </span>\r\n    );\r\n  };\r\n\r\n  const renderItem = (item: SidebarItem, level: number = 0, parentId?: string): React.ReactNode => {\r\n    const hasChildren = !!(item.data && item.data.length > 0);\r\n    const isOpen = openItems[item.id] || false;\r\n    const isSelected = selectedItem === item.id;\r\n    const isHovered = hoveredItem === item.id;\r\n\r\n    return (\r\n      <div key={item.id} className=\"avakio-sidebar-item-wrapper\">\r\n        <div\r\n          className={[\r\n            'avakio-sidebar-item',\r\n            `level-${level}`,\r\n            isSelected ? 'selected' : '',\r\n            hasChildren ? 'has-children' : '',\r\n          ]\r\n            .filter(Boolean)\r\n            .join(' ')}\r\n          onClick={() => handleItemClick(item, hasChildren, level, parentId)}\r\n          onMouseEnter={() => setHoveredItem(item.id)}\r\n          onMouseLeave={() => setHoveredItem(null)}\r\n          style={{\r\n            paddingLeft: level === 0 ? undefined : `${16 + level * 20}px`,\r\n            minHeight: level === 0 ? `${titleHeight}px` : undefined,\r\n          }}\r\n        >\r\n          {renderArrow(hasChildren, isOpen, level)}\r\n          {renderIcon(item.icon)}\r\n          {!isCollapsed && <span className=\"avakio-sidebar-value\">{item.value}</span>}\r\n        </div>\r\n\r\n        {/* Popup for collapsed mode */}\r\n        {isCollapsed && isHovered && level === 0 && (\r\n          <div\r\n            className={`avakio-sidebar-popup ${position === 'right' ? 'popup-left' : 'popup-right'}`}\r\n            style={{ minHeight: `${titleHeight}px` }}\r\n          >\r\n            <div className=\"avakio-sidebar-popup-title\">{item.value}</div>\r\n            {hasChildren && (\r\n              <div className=\"avakio-sidebar-popup-children\">\r\n                {item.data?.map((child) => (\r\n                  <div\r\n                    key={child.id}\r\n                    className={`avakio-sidebar-popup-item ${selectedItem === child.id ? 'selected' : ''}`}\r\n                    onClick={(e) => {\r\n                      e.stopPropagation();\r\n                      handleItemClick(child, false, 1, item.id);\r\n                    }}\r\n                  >\r\n                    {renderIcon(child.icon)}\r\n                    <span className=\"avakio-sidebar-value\">{child.value}</span>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/* Expanded children */}\r\n        {!isCollapsed && hasChildren && isOpen && (\r\n          <div className=\"avakio-sidebar-children\">\r\n            {item.data?.map((child) => renderItem(child, level + 1, level === 0 ? item.id : parentId))}\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {/* Mobile overlay */}\r\n      {isMobile && !isCollapsed && showOverlay && (\r\n        <div\r\n          className=\"avakio-sidebar-overlay\"\r\n          onClick={handleOverlayClick}\r\n          aria-hidden=\"true\"\r\n        />\r\n      )}\r\n\r\n      {/* Mobile dongle/toggle button */}\r\n      {isMobile && isCollapsed && showMobileDongle && (\r\n        <button\r\n          type=\"button\"\r\n          className={`avakio-sidebar-mobile-dongle position-${position}`}\r\n          onClick={() => setIsCollapsed(false)}\r\n          aria-label=\"Open sidebar\"\r\n        >\r\n          {dongleIcon || (\r\n            <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n              <path d=\"M2 4h16v2H2V4zm0 5h16v2H2V9zm0 5h16v2H2v-2z\" />\r\n            </svg>\r\n          )}\r\n        </button>\r\n      )}\r\n\r\n      <div\r\n        id={id}\r\n        data-testid={testId}\r\n        className={[\r\n          'avakio-sidebar',\r\n          isCollapsed ? 'collapsed' : 'expanded',\r\n          `position-${position}`,\r\n          isMobile ? 'mobile' : 'desktop',\r\n          className,\r\n        ]\r\n          .filter(Boolean)\r\n          .join(' ')}\r\n        style={{\r\n          width: isCollapsed ? `${collapsedWidth}px` : `${width}px`,\r\n        }}\r\n      >\r\n        <div className=\"avakio-sidebar-content\">{data.map((item) => renderItem(item))}</div>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n\r\n// Export toggle function component for external use\r\nexport interface AvakioSidebarToggleButtonProps {\r\n  onClick?: () => void;\r\n  className?: string;\r\n  icon?: React.ReactNode;\r\n  isCollapsed?: boolean;\r\n}\r\n\r\nexport function AvakioSidebarToggleButton({\r\n  onClick,\r\n  className = '',\r\n  icon,\r\n  isCollapsed = false,\r\n}: AvakioSidebarToggleButtonProps) {\r\n  return (\r\n    <button\r\n      type=\"button\"\r\n      className={`avakio-sidebar-toggle-button ${isCollapsed ? 'collapsed' : 'expanded'} ${className}`}\r\n      onClick={onClick}\r\n      aria-label={isCollapsed ? \"Expand sidebar\" : \"Collapse sidebar\"}\r\n    >\r\n      {icon || (\r\n        <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n          <path d=\"M2 4h16v2H2V4zm0 5h16v2H2V9zm0 5h16v2H2v-2z\" />\r\n        </svg>\r\n      )}\r\n    </button>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { forwardRef, useImperativeHandle, useRef, useState, useEffect, ReactNode, useMemo, useCallback } from 'react';\r\nimport { MoreVertical, Send, Edit2, Trash2, X, Check } from 'lucide-react';\r\nimport './avakio-comment.css';\r\n\r\nexport type AvakioCommentTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\nexport type UserStatus = 'active' | 'away' | 'busy' | 'none';\r\nexport type CommentMode = 'default' | 'chat';\r\nexport type SendAction = 'enter' | 'shift+enter';\r\n\r\nexport interface CommentUser {\r\n  id: string | number;\r\n  value: string;\r\n  image?: string;\r\n  status?: UserStatus;\r\n}\r\n\r\nexport interface CommentItem {\r\n  id: string | number;\r\n  user_id?: string | number;\r\n  date: Date | string;\r\n  text: string;\r\n}\r\n\r\nexport interface AvakioCommentProps {\r\n  /** Unique identifier */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n  /** Theme variant */\r\n  theme?: AvakioCommentTheme;\r\n  /** Array of comments */\r\n  data?: CommentItem[];\r\n  /** Array of users who can comment */\r\n  users?: CommentUser[];\r\n  /** Current user ID - their comments can be edited/deleted */\r\n  currentUser?: string | number;\r\n  /** Display mode - default shows oldest first, chat shows newest first */\r\n  mode?: CommentMode;\r\n  /** Read-only mode - hides input and disables editing */\r\n  readonly?: boolean;\r\n  /** Key combination to send comment */\r\n  sendAction?: SendAction;\r\n  /** Placeholder text for the input */\r\n  placeholder?: string;\r\n  /** Label for the \"More comments\" button */\r\n  moreButtonLabel?: string;\r\n  /** Show more button if there are more comments */\r\n  hasMore?: boolean;\r\n  /** Enable mentions functionality */\r\n  mentions?: boolean;\r\n  /** Keep send button always visible */\r\n  keepButtonVisible?: boolean;\r\n  /** Border-less mode */\r\n  borderless?: boolean;\r\n  /** Custom CSS styles */\r\n  css?: React.CSSProperties;\r\n  /** Additional CSS class name */\r\n  className?: string;\r\n  /** Width of the component */\r\n  width?: number | string;\r\n  /** Height of the component */\r\n  height?: number | string;\r\n  /** Disabled state */\r\n  disabled?: boolean;\r\n  /** Callback when a comment is added */\r\n  onAdd?: (comment: CommentItem) => void;\r\n  /** Callback when a comment is deleted */\r\n  onDelete?: (commentId: string | number) => void;\r\n  /** Callback when a comment is edited */\r\n  onEdit?: (comment: CommentItem) => void;\r\n  /** Callback when more comments are requested */\r\n  onLoadMore?: () => void;\r\n  /** Callback when a user is mentioned */\r\n  onUserMentioned?: (userId: string | number, comment: CommentItem) => void;\r\n  /** Custom date formatter */\r\n  dateFormatter?: (date: Date | string) => string;\r\n  /** Custom avatar renderer */\r\n  renderAvatar?: (user?: CommentUser) => ReactNode;\r\n}\r\n\r\nexport interface AvakioCommentRef {\r\n  /** Get the component DOM node */\r\n  getNode: () => HTMLDivElement | null;\r\n  /** Get all comments */\r\n  getComments: () => CommentItem[];\r\n  /** Add a new comment */\r\n  add: (comment: Omit<CommentItem, 'id'>) => void;\r\n  /** Remove a comment by ID */\r\n  remove: (commentId: string | number) => void;\r\n  /** Edit a comment */\r\n  edit: (commentId: string | number) => void;\r\n  /** Get users data */\r\n  getUsers: () => CommentUser[];\r\n  /** Set current user */\r\n  setCurrentUser: (userId: string | number) => void;\r\n  /** Focus the input area */\r\n  focus: () => void;\r\n  /** Check if enabled */\r\n  isEnabled: () => boolean;\r\n  /** Enable the component */\r\n  enable: () => void;\r\n  /** Disable the component */\r\n  disable: () => void;\r\n  /** Clear all comments */\r\n  clear: () => void;\r\n}\r\n\r\n// Default date formatter\r\nconst defaultDateFormatter = (date: Date | string): string => {\r\n  const d = typeof date === 'string' ? new Date(date) : date;\r\n  const now = new Date();\r\n  const diff = now.getTime() - d.getTime();\r\n  const minutes = Math.floor(diff / 60000);\r\n  const hours = Math.floor(diff / 3600000);\r\n  const days = Math.floor(diff / 86400000);\r\n\r\n  if (minutes < 1) return 'Just now';\r\n  if (minutes < 60) return `${minutes}m ago`;\r\n  if (hours < 24) return `${hours}h ago`;\r\n  if (days < 7) return `${days}d ago`;\r\n  \r\n  return d.toLocaleDateString(undefined, { \r\n    month: 'short', \r\n    day: 'numeric',\r\n    year: d.getFullYear() !== now.getFullYear() ? 'numeric' : undefined\r\n  });\r\n};\r\n\r\n// Generate unique ID\r\nconst generateId = () => `comment-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\r\n\r\nexport const AvakioComment = forwardRef<AvakioCommentRef, AvakioCommentProps>(\r\n  (\r\n    {\r\n      id,\r\n      testId,\r\n      theme,\r\n      data: initialData = [],\r\n      users = [],\r\n      currentUser,\r\n      mode = 'default',\r\n      readonly = false,\r\n      sendAction = 'enter',\r\n      placeholder = 'Write a comment...',\r\n      moreButtonLabel = 'Load more comments',\r\n      hasMore = false,\r\n      mentions = false,\r\n      keepButtonVisible = false,\r\n      borderless = false,\r\n      css,\r\n      className = '',\r\n      width,\r\n      height,\r\n      disabled: disabledProp = false,\r\n      onAdd,\r\n      onDelete,\r\n      onEdit,\r\n      onLoadMore,\r\n      onUserMentioned,\r\n      dateFormatter = defaultDateFormatter,\r\n      renderAvatar,\r\n    },\r\n    ref\r\n  ) => {\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n    const inputRef = useRef<HTMLTextAreaElement>(null);\r\n    const listRef = useRef<HTMLDivElement>(null);\r\n    \r\n    const [comments, setComments] = useState<CommentItem[]>(initialData);\r\n    const [disabled, setDisabled] = useState(disabledProp);\r\n    const [inputValue, setInputValue] = useState('');\r\n    const [editingId, setEditingId] = useState<string | number | null>(null);\r\n    const [editValue, setEditValue] = useState('');\r\n    const [activeMenuId, setActiveMenuId] = useState<string | number | null>(null);\r\n    const [showMentions, setShowMentions] = useState(false);\r\n    const [mentionSearch, setMentionSearch] = useState('');\r\n    const [currentUserId, setCurrentUserId] = useState<string | number | undefined>(currentUser);\r\n\r\n    // Sync with props\r\n    useEffect(() => {\r\n      setComments(initialData);\r\n    }, [initialData]);\r\n\r\n    useEffect(() => {\r\n      setDisabled(disabledProp);\r\n    }, [disabledProp]);\r\n\r\n    useEffect(() => {\r\n      setCurrentUserId(currentUser);\r\n    }, [currentUser]);\r\n\r\n    // Sort comments based on mode\r\n    const sortedComments = useMemo(() => {\r\n      const sorted = [...comments].sort((a, b) => {\r\n        const dateA = new Date(a.date).getTime();\r\n        const dateB = new Date(b.date).getTime();\r\n        return mode === 'chat' ? dateB - dateA : dateA - dateB;\r\n      });\r\n      return mode === 'chat' ? sorted.reverse() : sorted;\r\n    }, [comments, mode]);\r\n\r\n    // Get user by ID\r\n    const getUserById = useCallback((userId?: string | number): CommentUser | undefined => {\r\n      if (!userId) return undefined;\r\n      return users.find(u => u.id === userId);\r\n    }, [users]);\r\n\r\n    // Filter users for mentions\r\n    const filteredMentionUsers = useMemo(() => {\r\n      if (!mentionSearch) return users;\r\n      const search = mentionSearch.toLowerCase();\r\n      return users.filter(u => u.value.toLowerCase().includes(search));\r\n    }, [users, mentionSearch]);\r\n\r\n    // Handle sending a comment\r\n    const handleSend = useCallback(() => {\r\n      if (!inputValue.trim() || disabled || readonly) return;\r\n\r\n      const newComment: CommentItem = {\r\n        id: generateId(),\r\n        user_id: currentUserId,\r\n        date: new Date(),\r\n        text: inputValue.trim(),\r\n      };\r\n\r\n      setComments(prev => [...prev, newComment]);\r\n      setInputValue('');\r\n      onAdd?.(newComment);\r\n\r\n      // Check for mentions\r\n      if (mentions) {\r\n        const mentionRegex = /@\"([^\"]+)\"/g;\r\n        let match: RegExpExecArray | null;\r\n        while ((match = mentionRegex.exec(newComment.text)) !== null) {\r\n          const mentionedUser = users.find(u => u.value === match![1]);\r\n          if (mentionedUser) {\r\n            onUserMentioned?.(mentionedUser.id, newComment);\r\n          }\r\n        }\r\n      }\r\n\r\n      // Scroll to bottom/top based on mode\r\n      setTimeout(() => {\r\n        if (listRef.current) {\r\n          if (mode === 'chat') {\r\n            listRef.current.scrollTop = listRef.current.scrollHeight;\r\n          } else {\r\n            listRef.current.scrollTop = listRef.current.scrollHeight;\r\n          }\r\n        }\r\n      }, 100);\r\n    }, [inputValue, disabled, readonly, currentUserId, mentions, users, mode, onAdd, onUserMentioned]);\r\n\r\n    // Handle key press in input\r\n    const handleKeyDown = (e: React.KeyboardEvent<HTMLTextAreaElement>) => {\r\n      if (sendAction === 'enter' && e.key === 'Enter' && !e.shiftKey) {\r\n        e.preventDefault();\r\n        handleSend();\r\n      } else if (sendAction === 'shift+enter' && e.key === 'Enter' && e.shiftKey) {\r\n        e.preventDefault();\r\n        handleSend();\r\n      }\r\n\r\n      // Handle mentions\r\n      if (mentions && e.key === '@') {\r\n        setShowMentions(true);\r\n        setMentionSearch('');\r\n      }\r\n    };\r\n\r\n    // Handle input change\r\n    const handleInputChange = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\r\n      const value = e.target.value;\r\n      setInputValue(value);\r\n\r\n      // Handle mention search\r\n      if (mentions && showMentions) {\r\n        const atIndex = value.lastIndexOf('@');\r\n        if (atIndex !== -1) {\r\n          setMentionSearch(value.slice(atIndex + 1));\r\n        }\r\n      }\r\n    };\r\n\r\n    // Insert mention\r\n    const insertMention = (user: CommentUser) => {\r\n      const atIndex = inputValue.lastIndexOf('@');\r\n      if (atIndex !== -1) {\r\n        const newValue = inputValue.slice(0, atIndex) + `@\"${user.value}\" `;\r\n        setInputValue(newValue);\r\n      }\r\n      setShowMentions(false);\r\n      setMentionSearch('');\r\n      inputRef.current?.focus();\r\n    };\r\n\r\n    // Handle delete\r\n    const handleDelete = (commentId: string | number) => {\r\n      setComments(prev => prev.filter(c => c.id !== commentId));\r\n      setActiveMenuId(null);\r\n      onDelete?.(commentId);\r\n    };\r\n\r\n    // Handle edit start\r\n    const handleEditStart = (comment: CommentItem) => {\r\n      setEditingId(comment.id);\r\n      setEditValue(comment.text);\r\n      setActiveMenuId(null);\r\n    };\r\n\r\n    // Handle edit save\r\n    const handleEditSave = (commentId: string | number) => {\r\n      if (!editValue.trim()) return;\r\n      \r\n      setComments(prev => prev.map(c => \r\n        c.id === commentId ? { ...c, text: editValue.trim() } : c\r\n      ));\r\n      \r\n      const updatedComment = comments.find(c => c.id === commentId);\r\n      if (updatedComment) {\r\n        onEdit?.({ ...updatedComment, text: editValue.trim() });\r\n      }\r\n      \r\n      setEditingId(null);\r\n      setEditValue('');\r\n    };\r\n\r\n    // Handle edit cancel\r\n    const handleEditCancel = () => {\r\n      setEditingId(null);\r\n      setEditValue('');\r\n    };\r\n\r\n    // Default avatar renderer\r\n    const defaultRenderAvatar = (user?: CommentUser): ReactNode => {\r\n      if (user?.image) {\r\n        return <img src={user.image} alt={user.value} className=\"avakio-comment-avatar-img\" />;\r\n      }\r\n      \r\n      const initials = user?.value\r\n        ? user.value.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2)\r\n        : '?';\r\n      \r\n      return <span className=\"avakio-comment-avatar-initials\">{initials}</span>;\r\n    };\r\n\r\n    // Render text with mentions highlighted\r\n    const renderText = (text: string): ReactNode => {\r\n      if (!mentions) return text;\r\n      \r\n      const parts = text.split(/(@\"[^\"]+\")/).filter(Boolean);\r\n      return parts.map((part, i) => {\r\n        if (part.startsWith('@\"') && part.endsWith('\"')) {\r\n          const name = part.slice(2, -1);\r\n          return (\r\n            <span key={i} className=\"avakio-comment-mention\">\r\n              @{name}\r\n            </span>\r\n          );\r\n        }\r\n        return part;\r\n      });\r\n    };\r\n\r\n    // Expose imperative methods\r\n    useImperativeHandle(ref, () => ({\r\n      getNode: () => containerRef.current,\r\n      getComments: () => comments,\r\n      add: (comment) => {\r\n        const newComment: CommentItem = {\r\n          ...comment,\r\n          id: generateId(),\r\n        };\r\n        setComments(prev => [...prev, newComment]);\r\n        onAdd?.(newComment);\r\n      },\r\n      remove: (commentId) => {\r\n        setComments(prev => prev.filter(c => c.id !== commentId));\r\n        onDelete?.(commentId);\r\n      },\r\n      edit: (commentId) => {\r\n        const comment = comments.find(c => c.id === commentId);\r\n        if (comment) {\r\n          handleEditStart(comment);\r\n        }\r\n      },\r\n      getUsers: () => users,\r\n      setCurrentUser: (userId) => setCurrentUserId(userId),\r\n      focus: () => inputRef.current?.focus(),\r\n      isEnabled: () => !disabled,\r\n      enable: () => setDisabled(false),\r\n      disable: () => setDisabled(true),\r\n      clear: () => setComments([]),\r\n    }), [comments, users, disabled, onAdd, onDelete]);\r\n\r\n    // Build class names\r\n    const containerClassNames = [\r\n      'avakio-comment',\r\n      theme && `avakio-comment-theme-${theme}`,\r\n      mode === 'chat' && 'avakio-comment-mode-chat',\r\n      borderless && 'avakio-comment-borderless',\r\n      disabled && 'avakio-comment-disabled',\r\n      readonly && 'avakio-comment-readonly',\r\n      className,\r\n    ].filter(Boolean).join(' ');\r\n\r\n    // Build styles\r\n    const containerStyles: React.CSSProperties = {\r\n      ...(css && typeof css === 'object' && !Array.isArray(css) ? css : {}),\r\n      width: typeof width === 'number' ? `${width}px` : width,\r\n      height: typeof height === 'number' ? `${height}px` : height,\r\n    };\r\n\r\n    return (\r\n      <div\r\n        ref={containerRef}\r\n        id={id}\r\n        data-testid={testId}\r\n        data-admin-theme={theme}\r\n        className={containerClassNames}\r\n        style={containerStyles}\r\n      >\r\n        {/* Comment List */}\r\n        <div ref={listRef} className=\"avakio-comment-list\">\r\n          {/* More button at top for chat mode */}\r\n          {mode === 'chat' && hasMore && (\r\n            <button \r\n              className=\"avakio-comment-more-btn\"\r\n              onClick={onLoadMore}\r\n              disabled={disabled}\r\n            >\r\n              {moreButtonLabel}\r\n            </button>\r\n          )}\r\n\r\n          {sortedComments.map((comment) => {\r\n            const user = getUserById(comment.user_id);\r\n            const isOwner = currentUserId !== undefined && comment.user_id === currentUserId;\r\n            const isEditing = editingId === comment.id;\r\n\r\n            return (\r\n              <div key={comment.id} className=\"avakio-comment-item\">\r\n                {/* Avatar */}\r\n                <div className=\"avakio-comment-avatar\">\r\n                  {renderAvatar ? renderAvatar(user) : defaultRenderAvatar(user)}\r\n                  {user?.status && user.status !== 'none' && (\r\n                    <span className={`avakio-comment-status avakio-comment-status-${user.status}`} />\r\n                  )}\r\n                </div>\r\n\r\n                {/* Content */}\r\n                <div className=\"avakio-comment-content\">\r\n                  <div className=\"avakio-comment-header\">\r\n                    <span className=\"avakio-comment-author\">\r\n                      {user?.value || 'Anonymous'}\r\n                    </span>\r\n                    <span className=\"avakio-comment-date\">\r\n                      {dateFormatter(comment.date)}\r\n                    </span>\r\n                    \r\n                    {/* Menu for owner */}\r\n                    {isOwner && !readonly && !isEditing && (\r\n                      <div className=\"avakio-comment-menu-wrapper\">\r\n                        <button\r\n                          className=\"avakio-comment-menu-btn\"\r\n                          onClick={() => setActiveMenuId(activeMenuId === comment.id ? null : comment.id)}\r\n                        >\r\n                          <MoreVertical size={16} />\r\n                        </button>\r\n                        {activeMenuId === comment.id && (\r\n                          <div className=\"avakio-comment-menu\">\r\n                            <button onClick={() => handleEditStart(comment)}>\r\n                              <Edit2 size={14} />\r\n                              Edit\r\n                            </button>\r\n                            <button onClick={() => handleDelete(comment.id)}>\r\n                              <Trash2 size={14} />\r\n                              Delete\r\n                            </button>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n\r\n                  {/* Comment text or edit mode */}\r\n                  {isEditing ? (\r\n                    <div className=\"avakio-comment-edit\">\r\n                      <textarea\r\n                        value={editValue}\r\n                        onChange={(e) => setEditValue(e.target.value)}\r\n                        className=\"avakio-comment-edit-input\"\r\n                        autoFocus\r\n                      />\r\n                      <div className=\"avakio-comment-edit-actions\">\r\n                        <button \r\n                          className=\"avakio-comment-edit-save\"\r\n                          onClick={() => handleEditSave(comment.id)}\r\n                        >\r\n                          <Check size={14} />\r\n                        </button>\r\n                        <button \r\n                          className=\"avakio-comment-edit-cancel\"\r\n                          onClick={handleEditCancel}\r\n                        >\r\n                          <X size={14} />\r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n                  ) : (\r\n                    <div className=\"avakio-comment-text\">\r\n                      {renderText(comment.text)}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            );\r\n          })}\r\n\r\n          {/* More button at bottom for default mode */}\r\n          {mode === 'default' && hasMore && (\r\n            <button \r\n              className=\"avakio-comment-more-btn\"\r\n              onClick={onLoadMore}\r\n              disabled={disabled}\r\n            >\r\n              {moreButtonLabel}\r\n            </button>\r\n          )}\r\n\r\n          {/* Empty state */}\r\n          {sortedComments.length === 0 && (\r\n            <div className=\"avakio-comment-empty\">\r\n              No comments yet. Be the first to comment!\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Input area */}\r\n        {!readonly && (\r\n          <div className=\"avakio-comment-input-area\">\r\n            <div className=\"avakio-comment-input-wrapper\">\r\n              <textarea\r\n                ref={inputRef}\r\n                value={inputValue}\r\n                onChange={handleInputChange}\r\n                onKeyDown={handleKeyDown}\r\n                placeholder={placeholder}\r\n                className=\"avakio-comment-input\"\r\n                disabled={disabled}\r\n                rows={1}\r\n              />\r\n              \r\n              {/* Mentions dropdown */}\r\n              {showMentions && filteredMentionUsers.length > 0 && (\r\n                <div className=\"avakio-comment-mentions\">\r\n                  {filteredMentionUsers.map(user => (\r\n                    <button\r\n                      key={user.id}\r\n                      className=\"avakio-comment-mention-item\"\r\n                      onClick={() => insertMention(user)}\r\n                    >\r\n                      <div className=\"avakio-comment-mention-avatar\">\r\n                        {defaultRenderAvatar(user)}\r\n                      </div>\r\n                      <span>{user.value}</span>\r\n                    </button>\r\n                  ))}\r\n                </div>\r\n              )}\r\n            </div>\r\n            \r\n            {(keepButtonVisible || inputValue.trim()) && (\r\n              <button\r\n                className=\"avakio-comment-send-btn\"\r\n                onClick={handleSend}\r\n                disabled={disabled || !inputValue.trim()}\r\n              >\r\n                <Send size={18} />\r\n              </button>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nAvakioComment.displayName = 'AvakioComment';\r\n\r\nexport default AvakioComment;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useState, useRef, useEffect } from 'react';\r\n\r\ninterface SelectProps {\r\n  value?: string;\r\n  defaultValue?: string;\r\n  onValueChange?: (value: string) => void;\r\n  children: React.ReactNode;\r\n  disabled?: boolean;\r\n}\r\n\r\ninterface SelectContextType {\r\n  value: string;\r\n  onValueChange: (value: string) => void;\r\n  open: boolean;\r\n  setOpen: (open: boolean) => void;\r\n}\r\n\r\nconst SelectContext = React.createContext<SelectContextType | null>(null);\r\n\r\nexport const Select = ({ children, value, defaultValue, onValueChange, disabled }: SelectProps) => {\r\n  const [internalValue, setInternalValue] = useState(defaultValue || '');\r\n  const [open, setOpen] = useState(false);\r\n  \r\n  const currentValue = value !== undefined ? value : internalValue;\r\n  \r\n  const handleValueChange = (newValue: string) => {\r\n    if (value === undefined) {\r\n      setInternalValue(newValue);\r\n    }\r\n    onValueChange?.(newValue);\r\n    setOpen(false);\r\n  };\r\n\r\n  return (\r\n    <SelectContext.Provider value={{ value: currentValue, onValueChange: handleValueChange, open, setOpen }}>\r\n      <div style={{ position: 'relative', display: 'inline-block' }}>\r\n        {children}\r\n      </div>\r\n    </SelectContext.Provider>\r\n  );\r\n};\r\n\r\nexport const SelectTrigger = ({ children, className, ...props }: any) => {\r\n  const context = React.useContext(SelectContext);\r\n  if (!context) throw new Error('SelectTrigger must be used within Select');\r\n  \r\n  return (\r\n    <button\r\n      type=\"button\"\r\n      className={className}\r\n      onClick={() => context.setOpen(!context.open)}\r\n      {...props}\r\n    >\r\n      {children}\r\n    </button>\r\n  );\r\n};\r\n\r\nexport const SelectValue = ({ placeholder, ...props }: any) => {\r\n  const context = React.useContext(SelectContext);\r\n  if (!context) throw new Error('SelectValue must be used within Select');\r\n  \r\n  return <span {...props}>{context.value || placeholder}</span>;\r\n};\r\n\r\nexport const SelectContent = ({ children, className, ...props }: any) => {\r\n  const context = React.useContext(SelectContext);\r\n  const ref = useRef<HTMLDivElement>(null);\r\n  \r\n  if (!context) throw new Error('SelectContent must be used within Select');\r\n\r\n  useEffect(() => {\r\n    const handleClickOutside = (event: MouseEvent) => {\r\n      if (ref.current && !ref.current.contains(event.target as Node)) {\r\n        context.setOpen(false);\r\n      }\r\n    };\r\n    \r\n    if (context.open) {\r\n      document.addEventListener('mousedown', handleClickOutside);\r\n    }\r\n    \r\n    return () => document.removeEventListener('mousedown', handleClickOutside);\r\n  }, [context.open]);\r\n\r\n  if (!context.open) return null;\r\n\r\n  return (\r\n    <div\r\n      ref={ref}\r\n      className={className}\r\n      style={{\r\n        position: 'absolute',\r\n        top: '100%',\r\n        left: 0,\r\n        right: 0,\r\n        zIndex: 50,\r\n        minWidth: '8rem',\r\n        background: 'var(--view-background-color, white)',\r\n        border: '1px solid var(--view-border-color, #e5e7eb)',\r\n        borderRadius: '6px',\r\n        boxShadow: '0 4px 6px -1px rgba(0, 0, 0, 0.1)',\r\n        marginTop: '4px',\r\n        overflow: 'hidden'\r\n      }}\r\n      {...props}\r\n    >\r\n      {children}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport const SelectItem = ({ children, value, className, ...props }: any) => {\r\n  const context = React.useContext(SelectContext);\r\n  if (!context) throw new Error('SelectItem must be used within Select');\r\n  \r\n  const isSelected = context.value === value;\r\n\r\n  return (\r\n    <div\r\n      className={className}\r\n      style={{\r\n        padding: '8px 12px',\r\n        cursor: 'pointer',\r\n        background: isSelected ? 'var(--view-hover-color, #f3f4f6)' : 'transparent',\r\n        fontSize: '14px'\r\n      }}\r\n      onClick={() => context.onValueChange(value)}\r\n      onMouseEnter={(e) => {\r\n        (e.target as HTMLElement).style.background = 'var(--view-hover-color, #f3f4f6)';\r\n      }}\r\n      onMouseLeave={(e) => {\r\n        (e.target as HTMLElement).style.background = isSelected ? 'var(--view-hover-color, #f3f4f6)' : 'transparent';\r\n      }}\r\n      {...props}\r\n    >\r\n      {children}\r\n    </div>\r\n  );\r\n};\r\n","import React, { useState, useMemo, useCallback, useEffect } from 'react';\r\nimport { ChevronUp, ChevronDown, ChevronsUpDown, ChevronLeft, ChevronRight, Search, X } from 'lucide-react';\r\nimport { Input } from '../../../ui/input';\r\n// Button component not available\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '../../../ui/select';\r\nimport './avakio-datatable.css';\r\nimport { Button } from '../../../ui/button';\r\n\r\nexport interface AvakioColumn<T = any> {\r\n  id: string;\r\n  header: string;\r\n  width?: number | string;\r\n  minWidth?: number;\r\n  maxWidth?: number;\r\n  sort?: 'asc' | 'desc' | boolean;\r\n  filterable?: boolean;\r\n  filterComponent?: (value: any, onChange: (value: any) => void) => React.ReactNode;\r\n  filterType?: 'text' | 'date' | 'number' | 'multicombo' | 'combo';\r\n  hidden?: boolean;\r\n  resizable?: boolean;\r\n  template?: (row: T) => React.ReactNode;\r\n  cssClass?: string;\r\n  headerCssClass?: string;\r\n  align?: 'left' | 'center' | 'right';\r\n  format?: (value: any) => string;\r\n}\r\n\r\nexport type AvakioSpan = [\r\n  rowId: string | number,\r\n  columnId: string,\r\n  colspan: number,\r\n  rowspan: number,\r\n  value?: any,\r\n  cssClass?: string\r\n];\r\n\r\nexport interface AvakioDataTableProps<T = any> {\r\n  id?: string;\r\n  data: T[];\r\n  spans?: AvakioSpan[];\r\n  columns: AvakioColumn<T>[];\r\n  height?: number | string;\r\n  width?: number | string;\r\n  select?: boolean | 'row' | 'cell' | 'column';\r\n  multiselect?: boolean;\r\n  rowHeight?: number;\r\n  headerHeight?: number;\r\n  fixedRowNumber?: number;\r\n  hover?: boolean;\r\n  resizable?: boolean;\r\n  sortable?: boolean;\r\n  filterable?: boolean;\r\n  paging?: boolean;\r\n  pageSize?: number;\r\n  autoConfig?: boolean;\r\n  scroll?: boolean | 'x' | 'y' | 'xy';\r\n  css?: string;\r\n  serverSide?: boolean;\r\n  onRowClick?: (row: T, index: number) => void;\r\n  onRowDoubleClick?: (row: T, index: number) => void;\r\n  onSelectChange?: (selected: T[]) => void;\r\n  onSort?: (columnId: string, direction: 'asc' | 'desc') => void;\r\n  onFilter?: (filters: Record<string, string>) => void;\r\n  loading?: boolean;\r\n  emptyText?: string;\r\n  totalCount?: number;\r\n  currentPage?: number;\r\n  onPageChange?: (page: number) => void;\r\n  onPageSizeChange?: (pageSize: number) => void;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n}\r\n\r\nexport function AvakioDataTable<T extends Record<string, any>>({\r\n  id = 'avakio-datatable',\r\n  data,\r\n  spans,\r\n  columns,\r\n  height = 'auto',\r\n  width = '100%',\r\n  select = false,\r\n  multiselect = false,\r\n  rowHeight = 40,\r\n  headerHeight = 44,\r\n  fixedRowNumber = 0,\r\n  hover = true,\r\n  resizable = true,\r\n  sortable = true,\r\n  filterable = true,\r\n  paging = false,\r\n  pageSize = 20,\r\n  autoConfig = false,\r\n  scroll = 'xy',\r\n  css = '',\r\n  serverSide = false,\r\n  onRowClick,\r\n  onRowDoubleClick,\r\n  onSelectChange,\r\n  onSort,\r\n  onFilter,\r\n  loading = false,\r\n  emptyText = 'No data available',\r\n  totalCount,\r\n  currentPage = 1,\r\n  onPageChange,\r\n  onPageSizeChange,\r\n  testId,\r\n}: AvakioDataTableProps<T>) {\r\n  const [selectedRows, setSelectedRows] = useState<Set<number>>(new Set());\r\n  const [sortColumn, setSortColumn] = useState<string | null>(null);\r\n  const [sortDirection, setSortDirection] = useState<'asc' | 'desc'>('asc');\r\n\r\n  // Process spans to create a map of cells to skip\r\n  const spanMap = useMemo(() => {\r\n    const map = new Map<string, { skip: boolean; colspan?: number; rowspan?: number; value?: any; cssClass?: string }>();\r\n    \r\n    if (!spans || spans.length === 0) return map;\r\n    \r\n    spans.forEach(([rowId, columnId, colspan, rowspan, value, cssClass]) => {\r\n      const rowKey = String(rowId);\r\n      const cellKey = `${rowKey}-${columnId}`;\r\n      \r\n      // Mark the origin cell with span properties\r\n      map.set(cellKey, { skip: false, colspan, rowspan, value, cssClass });\r\n      \r\n      // Mark cells to skip due to colspan\r\n      const colIndex = columns.findIndex(col => col.id === columnId);\r\n      if (colIndex !== -1) {\r\n        for (let c = 1; c < colspan; c++) {\r\n          const nextCol = columns[colIndex + c];\r\n          if (nextCol) {\r\n            map.set(`${rowKey}-${nextCol.id}`, { skip: true });\r\n          }\r\n        }\r\n      }\r\n      \r\n      // Mark cells to skip due to rowspan\r\n      // Use row IDs directly from the span configuration to find consecutive rows\r\n      const allRowIds = data.map((row: any) => String(row.id || row.Id));\r\n      const rowIndex = allRowIds.indexOf(rowKey);\r\n      \r\n      if (rowIndex !== -1) {\r\n        for (let r = 1; r < rowspan; r++) {\r\n          const nextRowIndex = rowIndex + r;\r\n          if (nextRowIndex < allRowIds.length) {\r\n            const nextRowKey = allRowIds[nextRowIndex];\r\n            map.set(`${nextRowKey}-${columnId}`, { skip: true });\r\n            \r\n            // Also skip cells affected by both rowspan and colspan\r\n            for (let c = 1; c < colspan; c++) {\r\n              const nextCol = columns[colIndex + c];\r\n              if (nextCol) {\r\n                map.set(`${nextRowKey}-${nextCol.id}`, { skip: true });\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    });\r\n    \r\n    return map;\r\n  }, [spans, columns, data]);\r\n  const [filters, setFilters] = useState<Record<string, string>>({});\r\n  const [columnWidths, setColumnWidths] = useState<Record<string, number>>({});\r\n  const [page, setPage] = useState(currentPage);\r\n  const [localPageSize, setLocalPageSize] = useState(pageSize);\r\n  const [resizingColumn, setResizingColumn] = useState<string | null>(null);\r\n  const [resizeStartX, setResizeStartX] = useState(0);\r\n  const [resizeStartWidth, setResizeStartWidth] = useState(0);\r\n\r\n  useEffect(() => {\r\n    setPage(currentPage);\r\n  }, [currentPage]);\r\n\r\n  // Filter data (skip if server-side)\r\n  const filteredData = useMemo(() => {\r\n    if (serverSide) return data;\r\n    \r\n    let result = [...data];\r\n\r\n    // Apply filters\r\n    Object.entries(filters).forEach(([columnId, filterValue]) => {\r\n      // Skip empty filters\r\n      if (!filterValue) return;\r\n      \r\n      // Handle multicombo filters (array values)\r\n      if (Array.isArray(filterValue) && filterValue.length === 0) return;\r\n      \r\n      const column = columns.find(col => col.id === columnId);\r\n      \r\n      result = result.filter((row) => {\r\n        const value = row[columnId];\r\n        \r\n        // Handle multicombo filtering (array of selected values)\r\n        if (column?.filterType === 'multicombo' && Array.isArray(filterValue) && filterValue.length > 0) {\r\n          const stringValue = String(value || '').toLowerCase();\r\n          return filterValue.some(fv => stringValue.includes(fv.toLowerCase()));\r\n        }\r\n        \r\n        // Handle combo filtering (single selected value)\r\n        if (column?.filterType === 'combo' && filterValue) {\r\n          const stringValue = String(value || '').toLowerCase();\r\n          const filterStringValue = String(filterValue).toLowerCase();\r\n          return stringValue.includes(filterStringValue);\r\n        }\r\n        \r\n        // Handle date filtering\r\n        if (column?.filterType === 'date' && value) {\r\n          const rowDate = String(value).split('T')[0]; // Get YYYY-MM-DD part\r\n          const filterDate = String(filterValue).split('T')[0];\r\n          return rowDate === filterDate;\r\n        }\r\n        \r\n        // Handle text filtering (default)\r\n        if (typeof filterValue === 'string' && filterValue.trim()) {\r\n          const stringValue = String(value || '').toLowerCase();\r\n          return stringValue.includes(filterValue.toLowerCase());\r\n        }\r\n        \r\n        return true;\r\n      });\r\n    });\r\n\r\n    return result;\r\n  }, [data, filters, columns, serverSide]);\r\n\r\n  // Sort data (skip if server-side)\r\n  const sortedData = useMemo(() => {\r\n    if (serverSide) return filteredData;\r\n    if (!sortColumn) return filteredData;\r\n\r\n    return [...filteredData].sort((a, b) => {\r\n      const aVal = a[sortColumn];\r\n      const bVal = b[sortColumn];\r\n\r\n      if (aVal === null || aVal === undefined) return 1;\r\n      if (bVal === null || bVal === undefined) return -1;\r\n\r\n      let comparison = 0;\r\n      if (typeof aVal === 'number' && typeof bVal === 'number') {\r\n        comparison = aVal - bVal;\r\n      } else {\r\n        comparison = String(aVal).localeCompare(String(bVal));\r\n      }\r\n\r\n      return sortDirection === 'asc' ? comparison : -comparison;\r\n    });\r\n  }, [filteredData, sortColumn, sortDirection, serverSide]);\r\n\r\n  // Paginate data (skip if server-side)\r\n  const paginatedData = useMemo(() => {\r\n    if (serverSide) return data; // In server-side mode, data is already paginated\r\n    if (!paging) return sortedData;\r\n    const startIndex = (page - 1) * localPageSize;\r\n    return sortedData.slice(startIndex, startIndex + localPageSize);\r\n  }, [sortedData, paging, page, localPageSize, serverSide, data]);\r\n\r\n  const totalPages = Math.ceil((totalCount || sortedData.length) / localPageSize);\r\n\r\n  // Handle sort\r\n  const handleSort = useCallback((columnId: string) => {\r\n    if (!sortable) return;\r\n\r\n    const newDirection = sortColumn === columnId && sortDirection === 'asc' ? 'desc' : 'asc';\r\n    setSortColumn(columnId);\r\n    setSortDirection(newDirection);\r\n\r\n    if (onSort) {\r\n      onSort(columnId, newDirection);\r\n    }\r\n  }, [sortable, sortColumn, sortDirection, onSort]);\r\n\r\n  // Handle filter\r\n  const handleFilter = useCallback((columnId: string, value: string) => {\r\n    const newFilters = { ...filters, [columnId]: value };\r\n    setFilters(newFilters);\r\n    setPage(1); // Reset to first page on filter\r\n\r\n    if (onFilter) {\r\n      onFilter(newFilters);\r\n    }\r\n  }, [filters, onFilter]);\r\n\r\n  // Handle row selection\r\n  const handleRowClick = useCallback((row: T, index: number, event: React.MouseEvent) => {\r\n    if (select) {\r\n      if (multiselect && (event.ctrlKey || event.metaKey)) {\r\n        setSelectedRows((prev) => {\r\n          const newSet = new Set(prev);\r\n          if (newSet.has(index)) {\r\n            newSet.delete(index);\r\n          } else {\r\n            newSet.add(index);\r\n          }\r\n          return newSet;\r\n        });\r\n      } else {\r\n        setSelectedRows(new Set([index]));\r\n      }\r\n    }\r\n\r\n    if (onRowClick) {\r\n      onRowClick(row, index);\r\n    }\r\n  }, [select, multiselect, onRowClick]);\r\n\r\n  // Handle row double click\r\n  const handleRowDoubleClick = useCallback((row: T, index: number) => {\r\n    if (onRowDoubleClick) {\r\n      onRowDoubleClick(row, index);\r\n    }\r\n  }, [onRowDoubleClick]);\r\n\r\n  // Handle column resize\r\n  const handleResizeStart = useCallback((columnId: string, event: React.MouseEvent) => {\r\n    if (!resizable) return;\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    const column = columns.find(c => c.id === columnId);\r\n    const currentWidth = columnWidths[columnId] || (typeof column?.width === 'number' ? column.width : 150);\r\n\r\n    setResizingColumn(columnId);\r\n    setResizeStartX(event.clientX);\r\n    setResizeStartWidth(currentWidth);\r\n  }, [resizable, columns, columnWidths]);\r\n\r\n  useEffect(() => {\r\n    if (!resizingColumn) return;\r\n\r\n    const handleMouseMove = (event: MouseEvent) => {\r\n      const diff = event.clientX - resizeStartX;\r\n      const newWidth = Math.max(50, resizeStartWidth + diff);\r\n      setColumnWidths(prev => ({ ...prev, [resizingColumn]: newWidth }));\r\n    };\r\n\r\n    const handleMouseUp = () => {\r\n      setResizingColumn(null);\r\n    };\r\n\r\n    document.addEventListener('mousemove', handleMouseMove);\r\n    document.addEventListener('mouseup', handleMouseUp);\r\n\r\n    return () => {\r\n      document.removeEventListener('mousemove', handleMouseMove);\r\n      document.removeEventListener('mouseup', handleMouseUp);\r\n    };\r\n  }, [resizingColumn, resizeStartX, resizeStartWidth]);\r\n\r\n  // Notify selection changes\r\n  useEffect(() => {\r\n    if (onSelectChange) {\r\n      const selected = Array.from(selectedRows).map(index => paginatedData[index]).filter(Boolean);\r\n      onSelectChange(selected);\r\n    }\r\n  }, [selectedRows, paginatedData, onSelectChange]);\r\n\r\n  // Get column width\r\n  const getColumnWidth = (column: AvakioColumn<T>) => {\r\n    const customWidth = columnWidths[column.id];\r\n    if (customWidth) return `${customWidth}px`;\r\n    if (column.width) return typeof column.width === 'number' ? `${column.width}px` : column.width;\r\n    return 'auto';\r\n  };\r\n\r\n  // Render cell content\r\n  const renderCell = (column: AvakioColumn<T>, row: T) => {\r\n    if (column.template) {\r\n      return column.template(row);\r\n    }\r\n    \r\n    const value = row[column.id];\r\n    if (column.format) {\r\n      return column.format(value);\r\n    }\r\n    \r\n    return value !== null && value !== undefined ? String(value) : '';\r\n  };\r\n\r\n  const visibleColumns = columns.filter(col => !col.hidden);\r\n\r\n  return (\r\n    <div\r\n      id={id}\r\n      data-testid={testId}\r\n      className={`avakio-datatable ${css}`}\r\n      style={{\r\n        height: typeof height === 'number' ? `${height}px` : height,\r\n        width: typeof width === 'number' ? `${width}px` : width,\r\n      }}\r\n    >\r\n      {/* Header */}\r\n      <div className=\"avakio-datatable-header\" style={{ minHeight: `${headerHeight}px` }}>\r\n        <div className=\"avakio-datatable-header-row\">\r\n          {visibleColumns.map((column) => (\r\n            <div\r\n              key={column.id}\r\n              className={`avakio-datatable-header-cell ${column.headerCssClass || ''} ${\r\n                sortColumn === column.id ? 'sorted' : ''\r\n              }`}\r\n              style={{\r\n                width: getColumnWidth(column),\r\n                minWidth: column.minWidth ? `${column.minWidth}px` : undefined,\r\n                maxWidth: column.maxWidth ? `${column.maxWidth}px` : undefined,\r\n                textAlign: column.align || 'left',\r\n              }}\r\n            >\r\n              <div\r\n                className=\"avakio-datatable-header-content\"\r\n                onClick={() => sortable && column.sort !== false && handleSort(column.id)}\r\n              >\r\n                <span className=\"avakio-datatable-header-text\">{column.header}</span>\r\n                {sortable && column.sort !== false && (\r\n                  <span className=\"avakio-datatable-sort-icon\">\r\n                    {sortColumn === column.id ? (\r\n                      sortDirection === 'asc' ? (\r\n                        <ChevronUp className=\"h-4 w-4\" />\r\n                      ) : (\r\n                        <ChevronDown className=\"h-4 w-4\" />\r\n                      )\r\n                    ) : (\r\n                      <ChevronsUpDown className=\"h-4 w-4 opacity-40\" />\r\n                    )}\r\n                  </span>\r\n                )}\r\n              </div>\r\n              {resizable && column.resizable !== false && (\r\n                <div\r\n                  className=\"avakio-datatable-resize-handle\"\r\n                  onMouseDown={(e) => handleResizeStart(column.id, e)}\r\n                />\r\n              )}\r\n            </div>\r\n          ))}\r\n        </div>\r\n\r\n        {/* Filter Row */}\r\n        {filterable && (\r\n          <div className=\"avakio-datatable-filter-row\">\r\n            {visibleColumns.map((column) => (\r\n              <div\r\n                key={column.id}\r\n                className=\"avakio-datatable-filter-cell\"\r\n                style={{\r\n                  width: getColumnWidth(column),\r\n                  minWidth: column.minWidth ? `${column.minWidth}px` : undefined,\r\n                  maxWidth: column.maxWidth ? `${column.maxWidth}px` : undefined,\r\n                }}\r\n              >\r\n                {column.filterable !== false && (\r\n                  <>\r\n                    {column.filterComponent ? (\r\n                      column.filterComponent(filters[column.id], (value) => handleFilter(column.id, value))\r\n                    ) : (\r\n                      <div className=\"avakio-datatable-filter-input-wrapper\">\r\n                        <Search className=\"h-3 w-3 text-muted-foreground\" />\r\n                        <input\r\n                          type=\"text\"\r\n                          className=\"avakio-datatable-filter-input\"\r\n                          placeholder=\"Filter...\"\r\n                          value={filters[column.id] || ''}\r\n                          onChange={(e) => handleFilter(column.id, e.target.value)}\r\n                        />\r\n                        {filters[column.id] && (\r\n                          <button\r\n                            className=\"avakio-datatable-filter-clear\"\r\n                            onClick={() => handleFilter(column.id, '')}\r\n                          >\r\n                            <X className=\"h-3 w-3\" />\r\n                          </button>\r\n                        )}\r\n                      </div>\r\n                    )}\r\n                  </>\r\n                )}\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Body */}\r\n      <div\r\n        className={`avakio-datatable-body ${scroll ? `scroll-${scroll}` : ''} scrollbar-visible`}\r\n        style={{\r\n          height: typeof height === 'number' ? `${height - headerHeight - (paging ? 50 : 0)}px` : 'auto',\r\n        }}\r\n      >\r\n        {loading ? (\r\n          <div className=\"avakio-datatable-loading\">\r\n            <div className=\"avakio-datatable-spinner\" />\r\n            <p>Loading data...</p>\r\n          </div>\r\n        ) : paginatedData.length === 0 ? (\r\n          <div className=\"avakio-datatable-empty\">\r\n            <p>{emptyText}</p>\r\n          </div>\r\n        ) : (\r\n          <div className=\"avakio-datatable-rows\">\r\n            {paginatedData.map((row, rowIndex) => {\r\n              // Use a unique identifier from the row if available, otherwise fall back to rowIndex\r\n              const rowKey = row.id !== undefined ? `row-${row.id}` : rowIndex;\r\n              const rowId = String(row.id || row.Id);\r\n              \r\n              return (\r\n              <div\r\n                key={rowKey}\r\n                className={`avakio-datatable-row ${\r\n                  selectedRows.has(rowIndex) ? 'selected' : ''\r\n                } ${hover ? 'hover' : ''}`}\r\n                style={{ height: `${rowHeight}px` }}\r\n                onClick={(e) => handleRowClick(row, rowIndex, e)}\r\n                onDoubleClick={() => handleRowDoubleClick(row, rowIndex)}\r\n              >\r\n                {visibleColumns.map((column) => {\r\n                  const cellKey = `${rowId}-${column.id}`;\r\n                  const spanInfo = spanMap.get(cellKey);\r\n                  \r\n                  // Skip cells that are covered by a span\r\n                  if (spanInfo && spanInfo.skip) {\r\n                    return null;\r\n                  }\r\n                  \r\n                  const cellClasses = [\r\n                    'avakio-datatable-cell',\r\n                    column.cssClass || '',\r\n                    spanInfo?.cssClass || ''\r\n                  ].filter(Boolean).join(' ');\r\n                  \r\n                  return (\r\n                    <div\r\n                      key={column.id}\r\n                      className={cellClasses}\r\n                      style={{\r\n                        width: getColumnWidth(column),\r\n                        minWidth: column.minWidth ? `${column.minWidth}px` : undefined,\r\n                        maxWidth: column.maxWidth ? `${column.maxWidth}px` : undefined,\r\n                        textAlign: column.align || 'left',\r\n                      }}\r\n                      {...(spanInfo?.colspan && spanInfo.colspan > 1 ? { 'data-colspan': spanInfo.colspan } : {})}\r\n                      {...(spanInfo?.rowspan && spanInfo.rowspan > 1 ? { 'data-rowspan': spanInfo.rowspan } : {})}\r\n                    >\r\n                      {spanInfo?.value !== undefined ? spanInfo.value : renderCell(column, row)}\r\n                    </div>\r\n                  );\r\n                })}\r\n              </div>\r\n              );\r\n            })}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Footer with Pagination */}\r\n      {paging && !loading && paginatedData.length > 0 && (\r\n        <div className=\"avakio-datatable-footer\">\r\n          <div className=\"avakio-datatable-footer-info\">\r\n            Showing {(page - 1) * localPageSize + 1} to{' '}\r\n            {Math.min(page * localPageSize, totalCount || sortedData.length)} of{' '}\r\n            {totalCount || sortedData.length} records\r\n          </div>\r\n          <div className=\"avakio-datatable-pagination\">\r\n            <Select\r\n              value={String(localPageSize)}\r\n              onValueChange={(value) => {\r\n                const newPageSize = Number(value);\r\n                setLocalPageSize(newPageSize);\r\n                setPage(1);\r\n                if (serverSide && onPageSizeChange) {\r\n                  onPageSizeChange(newPageSize);\r\n                }\r\n              }}\r\n            >\r\n              <SelectTrigger className=\"avakio-datatable-page-size-select\">\r\n                <SelectValue />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                <SelectItem value=\"10\">10 / page</SelectItem>\r\n                <SelectItem value=\"20\">20 / page</SelectItem>\r\n                <SelectItem value=\"50\">50 / page</SelectItem>\r\n                <SelectItem value=\"100\">100 / page</SelectItem>\r\n              </SelectContent>\r\n            </Select>\r\n\r\n            <div className=\"avakio-datatable-pagination-controls\">\r\n              <Button\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                onClick={() => {\r\n                  const newPage = Math.max(1, page - 1);\r\n                  setPage(newPage);\r\n                  onPageChange?.(newPage);\r\n                }}\r\n                disabled={page === 1}\r\n              >\r\n                <ChevronLeft className=\"h-4 w-4\" />\r\n              </Button>\r\n\r\n              <span className=\"avakio-datatable-page-info\">\r\n                Page {page} of {totalPages}\r\n              </span>\r\n\r\n              <Button\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                onClick={() => {\r\n                  const newPage = Math.min(totalPages, page + 1);\r\n                  setPage(newPage);\r\n                  onPageChange?.(newPage);\r\n                }}\r\n                disabled={page === totalPages}\r\n              >\r\n                <ChevronRight className=\"h-4 w-4\" />\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default AvakioDataTable;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React from \"react\";\r\nimport \"./avakio-timeline.css\";\r\n\r\nexport type AvakioTimelineItem = {\r\n  id: string | number;\r\n  title: string;\r\n  subtitle?: string;\r\n  description?: string;\r\n  meta?: string;\r\n  date?: string;\r\n  time?: string;\r\n  status?: \"success\" | \"warning\" | \"danger\" | \"info\" | \"neutral\" | string;\r\n  color?: string;\r\n};\r\n\r\nexport type AvakioTimelineProps = {\r\n  items: AvakioTimelineItem[];\r\n  theme?: string;\r\n  onItemClick?: (item: AvakioTimelineItem) => void;\r\n  className?: string;\r\n  style?: React.CSSProperties;\r\n  dense?: boolean;\r\n  orientation?: \"vertical\" | \"horizontal\";\r\n  variant?: \"default\" | \"split\" | \"colorband\";\r\n};\r\n\r\nexport function AvakioTimeline({\r\n  items,\r\n  theme,\r\n  onItemClick,\r\n  className,\r\n  style,\r\n  dense,\r\n  orientation = \"vertical\",\r\n  variant = \"default\",\r\n}: AvakioTimelineProps) {\r\n  const rootClasses = [\"avakio-timeline\", dense ? \"is-dense\" : \"\", className || \"\"].filter(Boolean);\r\n  if (orientation === \"horizontal\") rootClasses.push(\"is-horizontal\");\r\n  if (orientation === \"vertical\" && variant === \"split\") rootClasses.push(\"is-vertical-split\");\r\n  if (orientation === \"horizontal\" && variant === \"colorband\") rootClasses.push(\"is-horizontal-colorband\");\r\n\r\n  const vertical = (\r\n    <div\r\n      className={rootClasses.join(\" \").trim()}\r\n      data-admin-theme={theme}\r\n      style={style}\r\n    >\r\n      {items.map((item, idx) => {\r\n        const isLast = idx === items.length - 1;\r\n        const dotClass = item.status ? `av-tl-dot-${item.status}` : \"\";\r\n        const showDateInCard = variant === \"split\";\r\n        const leftLabel = showDateInCard ? undefined : item.date || item.meta || item.time;\r\n        const showConnector = true;\r\n        const clickable = Boolean(onItemClick);\r\n        const handleClick = () => onItemClick?.(item);\r\n        const handleKey = (e: React.KeyboardEvent<HTMLDivElement>) => {\r\n          if (!onItemClick) return;\r\n          if (e.key === \"Enter\" || e.key === \" \") {\r\n            e.preventDefault();\r\n            onItemClick(item);\r\n          }\r\n        };\r\n        return (\r\n          <div\r\n            key={item.id}\r\n            className={[\"av-tl-row\", clickable ? \"is-clickable\" : \"\"].join(\" \").trim()}\r\n            onClick={handleClick}\r\n            role={clickable ? \"button\" : undefined}\r\n            tabIndex={clickable ? 0 : undefined}\r\n            onKeyDown={handleKey}\r\n          >\r\n            <div className=\"av-tl-date\">{leftLabel}</div>\r\n            <div className={[\"av-tl-marker\", isLast ? \"is-last\" : \"\"].join(\" \").trim()}>\r\n              <span\r\n                className={[\"av-tl-dot\", dotClass].join(\" \").trim()}\r\n                style={item.color ? { background: item.color, boxShadow: `0 0 0 3px ${item.color}1a` } : undefined}\r\n              >\r\n                {variant === \"split\" ? item.id : undefined}\r\n              </span>\r\n              {!isLast && showConnector && <span className=\"av-tl-line\" />}\r\n            </div>\r\n            <div className=\"av-tl-card\">\r\n              <div className=\"av-tl-card-head\">\r\n                {showDateInCard && item.date && <div className=\"av-tl-date-inline\">{item.date}</div>}\r\n                <div className=\"av-tl-title\">{item.title}</div>\r\n              </div>\r\n              {item.subtitle && <div className=\"av-tl-subtitle\">{item.subtitle}</div>}\r\n              {item.description && <div className=\"av-tl-desc\">{item.description}</div>}\r\n            </div>\r\n          </div>\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n\r\n  const horizontal = (\r\n    <div\r\n      className={rootClasses.join(\" \").trim()}\r\n      data-admin-theme={theme}\r\n      style={style}\r\n    >\r\n      <div className=\"av-tl-h-track\">\r\n        {items.map((item, idx) => {\r\n          const isFirst = idx === 0;\r\n          const isLast = idx === items.length - 1;\r\n          const dotClass = item.status ? `av-tl-dot-${item.status}` : \"\";\r\n          const isColorBand = variant === \"colorband\";\r\n          const topLabel = isColorBand ? undefined : item.date || item.meta || item.time;\r\n          const clickable = Boolean(onItemClick);\r\n          const handleClick = () => onItemClick?.(item);\r\n          const handleKey = (e: React.KeyboardEvent<HTMLDivElement>) => {\r\n            if (!onItemClick) return;\r\n            if (e.key === \"Enter\" || e.key === \" \") {\r\n              e.preventDefault();\r\n              onItemClick(item);\r\n            }\r\n          };\r\n          const positionClass = isColorBand ? (idx % 2 === 0 ? \"is-top\" : \"is-bottom\") : \"\";\r\n          return (\r\n            <div\r\n              key={item.id}\r\n              className={[\"av-tl-h-item\", isFirst ? \"is-first\" : \"\", isLast ? \"is-last\" : \"\", clickable ? \"is-clickable\" : \"\", positionClass].join(\" \").trim()}\r\n              onClick={handleClick}\r\n              role={clickable ? \"button\" : undefined}\r\n              tabIndex={clickable ? 0 : undefined}\r\n              onKeyDown={handleKey}\r\n            >\r\n              {!isColorBand && <div className=\"av-tl-h-date\">{topLabel}</div>}\r\n              <div className={[\"av-tl-h-dotwrap\", isFirst ? \"is-first\" : \"\", isLast ? \"is-last\" : \"\"].join(\" \").trim()}>\r\n                <span className={[\"av-tl-dot\", dotClass].join(\" \").trim()} style={item.color ? { background: item.color, boxShadow: `0 0 0 3px ${item.color}1a` } : undefined} />\r\n              </div>\r\n              <div className=\"av-tl-h-card\">\r\n                {isColorBand && item.date && <div className=\"av-tl-h-date-inline\">{item.date}</div>}\r\n                <div className=\"av-tl-h-title\">{item.title}</div>\r\n                {item.description && <div className=\"av-tl-h-desc\">{item.description}</div>}\r\n              </div>\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  return orientation === \"horizontal\" ? horizontal : vertical;\r\n}\r\n\r\nexport default AvakioTimeline;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { forwardRef, useImperativeHandle, useState, useRef, useEffect, useCallback, useId } from 'react';\r\nimport './avakio-tree.css';\r\nimport { ChevronRight, ChevronDown, Folder, FolderOpen, File, Check, Minus } from 'lucide-react';\r\n\r\nexport type AvakioTreeTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\n\r\nexport interface AvakioTreeNode {\r\n  /** Unique identifier for the node */\r\n  id: string | number;\r\n  /** Display value/label for the node */\r\n  value: string;\r\n  /** Optional icon for the node */\r\n  icon?: React.ReactNode;\r\n  /** Optional icon when node is open (for branches) */\r\n  openIcon?: React.ReactNode;\r\n  /** Children nodes (makes this a branch) */\r\n  data?: AvakioTreeNode[];\r\n  /** Whether the branch is initially open */\r\n  open?: boolean;\r\n  /** Whether this node is disabled */\r\n  disabled?: boolean;\r\n  /** Whether this node has checkbox checked (for three-state checkbox) */\r\n  checked?: boolean | 'indeterminate';\r\n  /** Custom CSS class for this node */\r\n  css?: string;\r\n  /** Tooltip for this node */\r\n  tooltip?: string;\r\n  /** Any additional custom data */\r\n  [key: string]: any;\r\n}\r\n\r\nexport interface AvakioTreeProps {\r\n  /** Unique identifier */\r\n  id?: string;\r\n  /** Test ID for testing */\r\n  testId?: string;\r\n  /** Tree data */\r\n  data: AvakioTreeNode[];\r\n  /** Enable selection */\r\n  select?: boolean | 'multi';\r\n  /** Enable checkboxes */\r\n  checkbox?: boolean;\r\n  /** Enable three-state checkboxes (parent reflects children state) */\r\n  threeState?: boolean;\r\n  /** Show folder/file icons */\r\n  showIcons?: boolean;\r\n  /** Show branch toggle icons */\r\n  showToggle?: boolean;\r\n  /** Show connecting lines between nodes */\r\n  showLines?: boolean;\r\n  /** Enable keyboard navigation */\r\n  navigation?: boolean;\r\n  /** Enable drag and drop */\r\n  drag?: boolean;\r\n  /** Allow editing node values inline */\r\n  editable?: boolean;\r\n  /** Theme */\r\n  theme?: AvakioTreeTheme;\r\n  /** Filter function */\r\n  filterMode?: {\r\n    showSubItems?: boolean;\r\n    openParents?: boolean;\r\n    level?: number;\r\n  };\r\n  /** Height of each tree item */\r\n  itemHeight?: number;\r\n  /** Width */\r\n  width?: number | string;\r\n  /** Height */\r\n  height?: number | string;\r\n  /** CSS class */\r\n  className?: string;\r\n  /** Inline styles */\r\n  style?: React.CSSProperties;\r\n  /** Callback when node is selected */\r\n  onSelect?: (id: string | number, node: AvakioTreeNode) => void;\r\n  /** Callback when selection changes (for multi-select) */\r\n  onSelectChange?: (ids: (string | number)[]) => void;\r\n  /** Callback when node is clicked */\r\n  onClick?: (id: string | number, node: AvakioTreeNode, e: React.MouseEvent) => void;\r\n  /** Callback when node is double-clicked */\r\n  onDblClick?: (id: string | number, node: AvakioTreeNode, e: React.MouseEvent) => void;\r\n  /** Callback when branch opens */\r\n  onOpen?: (id: string | number, node: AvakioTreeNode) => void;\r\n  /** Callback when branch closes */\r\n  onClose?: (id: string | number, node: AvakioTreeNode) => void;\r\n  /** Callback when checkbox state changes */\r\n  onCheck?: (id: string | number, checked: boolean | 'indeterminate', node: AvakioTreeNode) => void;\r\n  /** Callback when node is edited */\r\n  onEdit?: (id: string | number, newValue: string, node: AvakioTreeNode) => void;\r\n  /** Callback on context menu */\r\n  onContext?: (id: string | number, node: AvakioTreeNode, e: React.MouseEvent) => void;\r\n}\r\n\r\nexport interface AvakioTreeRef {\r\n  /** Get the selected node ID */\r\n  getSelectedId: () => string | number | null;\r\n  /** Get multiple selected IDs */\r\n  getSelectedIds: () => (string | number)[];\r\n  /** Select a node by ID */\r\n  select: (id: string | number) => void;\r\n  /** Unselect a node */\r\n  unselect: (id?: string | number) => void;\r\n  /** Open a branch */\r\n  open: (id: string | number) => void;\r\n  /** Close a branch */\r\n  close: (id: string | number) => void;\r\n  /** Open all branches */\r\n  openAll: () => void;\r\n  /** Close all branches */\r\n  closeAll: () => void;\r\n  /** Check a node */\r\n  checkItem: (id: string | number) => void;\r\n  /** Uncheck a node */\r\n  uncheckItem: (id: string | number) => void;\r\n  /** Check all items */\r\n  checkAll: () => void;\r\n  /** Uncheck all items */\r\n  uncheckAll: () => void;\r\n  /** Get checked item IDs */\r\n  getChecked: () => (string | number)[];\r\n  /** Is node checked */\r\n  isChecked: (id: string | number) => boolean | 'indeterminate';\r\n  /** Is branch open */\r\n  isBranchOpen: (id: string | number) => boolean;\r\n  /** Check if node is a branch */\r\n  isBranch: (id: string | number) => boolean;\r\n  /** Get node by ID */\r\n  getItem: (id: string | number) => AvakioTreeNode | undefined;\r\n  /** Get parent ID */\r\n  getParentId: (id: string | number) => string | number | null;\r\n  /** Filter tree */\r\n  filter: (fn: (node: AvakioTreeNode) => boolean) => void;\r\n  /** Clear filter */\r\n  clearFilter: () => void;\r\n  /** Refresh the tree */\r\n  refresh: () => void;\r\n  /** Focus the tree */\r\n  focus: () => void;\r\n  /** Get the HTML container */\r\n  getNode: () => HTMLDivElement | null;\r\n  /** Scroll to make an item visible */\r\n  showItem: (id: string | number) => void;\r\n}\r\n\r\n// Build a flat lookup map from the tree data\r\nfunction buildNodeMap(\r\n  nodes: AvakioTreeNode[],\r\n  map: Map<string | number, { node: AvakioTreeNode; parentId: string | number | null; depth: number }>,\r\n  parentId: string | number | null = null,\r\n  depth: number = 0\r\n) {\r\n  nodes.forEach((node) => {\r\n    map.set(node.id, { node, parentId, depth });\r\n    if (node.data && node.data.length > 0) {\r\n      buildNodeMap(node.data, map, node.id, depth + 1);\r\n    }\r\n  });\r\n}\r\n\r\n// Get all descendant IDs of a node\r\nfunction getDescendantIds(node: AvakioTreeNode): (string | number)[] {\r\n  const ids: (string | number)[] = [];\r\n  if (node.data) {\r\n    node.data.forEach((child) => {\r\n      ids.push(child.id);\r\n      ids.push(...getDescendantIds(child));\r\n    });\r\n  }\r\n  return ids;\r\n}\r\n\r\n// Get all node IDs\r\nfunction getAllNodeIds(nodes: AvakioTreeNode[]): (string | number)[] {\r\n  const ids: (string | number)[] = [];\r\n  nodes.forEach((node) => {\r\n    ids.push(node.id);\r\n    if (node.data) {\r\n      ids.push(...getAllNodeIds(node.data));\r\n    }\r\n  });\r\n  return ids;\r\n}\r\n\r\nexport const AvakioTree = forwardRef<AvakioTreeRef, AvakioTreeProps>(\r\n  (\r\n    {\r\n      id,\r\n      testId,\r\n      data,\r\n      select = true,\r\n      checkbox = false,\r\n      threeState = false,\r\n      showIcons = true,\r\n      showToggle = true,\r\n      showLines = false,\r\n      navigation = true,\r\n      drag = false,\r\n      editable = false,\r\n      theme,\r\n      filterMode,\r\n      itemHeight = 32,\r\n      width,\r\n      height,\r\n      className = '',\r\n      style,\r\n      onSelect,\r\n      onSelectChange,\r\n      onClick,\r\n      onDblClick,\r\n      onOpen,\r\n      onClose,\r\n      onCheck,\r\n      onEdit,\r\n      onContext,\r\n    },\r\n    ref\r\n  ) => {\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n    const autoId = useId();\r\n    const treeId = id || `avakio-tree-${autoId}`;\r\n\r\n    // State\r\n    const [selectedIds, setSelectedIds] = useState<Set<string | number>>(new Set());\r\n    const [openIds, setOpenIds] = useState<Set<string | number>>(() => {\r\n      // Initialize with initially open nodes\r\n      const initialOpen = new Set<string | number>();\r\n      const collectOpen = (nodes: AvakioTreeNode[]) => {\r\n        nodes.forEach((node) => {\r\n          if (node.open) {\r\n            initialOpen.add(node.id);\r\n          }\r\n          if (node.data) {\r\n            collectOpen(node.data);\r\n          }\r\n        });\r\n      };\r\n      collectOpen(data);\r\n      return initialOpen;\r\n    });\r\n    const [checkedIds, setCheckedIds] = useState<Set<string | number>>(() => {\r\n      // Initialize with initially checked nodes\r\n      const initialChecked = new Set<string | number>();\r\n      const collectChecked = (nodes: AvakioTreeNode[]) => {\r\n        nodes.forEach((node) => {\r\n          if (node.checked === true) {\r\n            initialChecked.add(node.id);\r\n          }\r\n          if (node.data) {\r\n            collectChecked(node.data);\r\n          }\r\n        });\r\n      };\r\n      collectChecked(data);\r\n      return initialChecked;\r\n    });\r\n    const [focusedId, setFocusedId] = useState<string | number | null>(null);\r\n    const [editingId, setEditingId] = useState<string | number | null>(null);\r\n    const [editValue, setEditValue] = useState<string>('');\r\n    const [filterFn, setFilterFn] = useState<((node: AvakioTreeNode) => boolean) | null>(null);\r\n    const [, forceUpdate] = useState({});\r\n\r\n    // Build node lookup map\r\n    const nodeMap = useRef(new Map<string | number, { node: AvakioTreeNode; parentId: string | number | null; depth: number }>());\r\n    useEffect(() => {\r\n      nodeMap.current.clear();\r\n      buildNodeMap(data, nodeMap.current);\r\n    }, [data]);\r\n\r\n    // Compute three-state checkbox status\r\n    const getCheckState = useCallback(\r\n      (nodeId: string | number): boolean | 'indeterminate' => {\r\n        if (!threeState) {\r\n          return checkedIds.has(nodeId);\r\n        }\r\n        \r\n        const entry = nodeMap.current.get(nodeId);\r\n        if (!entry) return false;\r\n        \r\n        const { node } = entry;\r\n        if (!node.data || node.data.length === 0) {\r\n          return checkedIds.has(nodeId);\r\n        }\r\n        \r\n        // Check children recursively\r\n        const descendantIds = getDescendantIds(node);\r\n        const checkedCount = descendantIds.filter((id) => checkedIds.has(id)).length;\r\n        \r\n        if (checkedCount === 0) return false;\r\n        if (checkedCount === descendantIds.length) return true;\r\n        return 'indeterminate';\r\n      },\r\n      [checkedIds, threeState]\r\n    );\r\n\r\n    // Handle checkbox toggle with three-state propagation\r\n    const handleCheckToggle = useCallback(\r\n      (nodeId: string | number) => {\r\n        const entry = nodeMap.current.get(nodeId);\r\n        if (!entry) return;\r\n        \r\n        const currentState = getCheckState(nodeId);\r\n        const newChecked = currentState !== true;\r\n        \r\n        setCheckedIds((prev) => {\r\n          const next = new Set(prev);\r\n          \r\n          if (threeState) {\r\n            // Update this node and all descendants\r\n            const { node } = entry;\r\n            const descendantIds = getDescendantIds(node);\r\n            \r\n            if (newChecked) {\r\n              next.add(nodeId);\r\n              descendantIds.forEach((id) => next.add(id));\r\n            } else {\r\n              next.delete(nodeId);\r\n              descendantIds.forEach((id) => next.delete(id));\r\n            }\r\n            \r\n            // Update ancestors\r\n            let parentId = entry.parentId;\r\n            while (parentId !== null) {\r\n              const parentEntry = nodeMap.current.get(parentId);\r\n              if (!parentEntry) break;\r\n              \r\n              const parentNode = parentEntry.node;\r\n              if (parentNode.data) {\r\n                const childIds = parentNode.data.map((c) => c.id);\r\n                const allChecked = childIds.every((id) => next.has(id));\r\n                const anyChecked = childIds.some((id) => next.has(id));\r\n                \r\n                if (allChecked) {\r\n                  next.add(parentId);\r\n                } else {\r\n                  next.delete(parentId);\r\n                }\r\n              }\r\n              \r\n              parentId = parentEntry.parentId;\r\n            }\r\n          } else {\r\n            if (newChecked) {\r\n              next.add(nodeId);\r\n            } else {\r\n              next.delete(nodeId);\r\n            }\r\n          }\r\n          \r\n          return next;\r\n        });\r\n        \r\n        onCheck?.(nodeId, newChecked, entry.node);\r\n      },\r\n      [threeState, getCheckState, onCheck]\r\n    );\r\n\r\n    // Handle selection\r\n    const handleSelect = useCallback(\r\n      (nodeId: string | number, e?: React.MouseEvent) => {\r\n        const entry = nodeMap.current.get(nodeId);\r\n        if (!entry || entry.node.disabled) return;\r\n        \r\n        if (select === 'multi' && e?.ctrlKey) {\r\n          setSelectedIds((prev) => {\r\n            const next = new Set(prev);\r\n            if (next.has(nodeId)) {\r\n              next.delete(nodeId);\r\n            } else {\r\n              next.add(nodeId);\r\n            }\r\n            onSelectChange?.(Array.from(next));\r\n            return next;\r\n          });\r\n        } else if (select) {\r\n          setSelectedIds(new Set([nodeId]));\r\n          onSelect?.(nodeId, entry.node);\r\n          onSelectChange?.([nodeId]);\r\n        }\r\n        \r\n        setFocusedId(nodeId);\r\n      },\r\n      [select, onSelect, onSelectChange]\r\n    );\r\n\r\n    // Handle toggle branch\r\n    const handleToggle = useCallback(\r\n      (nodeId: string | number, e?: React.MouseEvent) => {\r\n        e?.stopPropagation();\r\n        const entry = nodeMap.current.get(nodeId);\r\n        if (!entry || !entry.node.data) return;\r\n        \r\n        setOpenIds((prev) => {\r\n          const next = new Set(prev);\r\n          if (next.has(nodeId)) {\r\n            next.delete(nodeId);\r\n            onClose?.(nodeId, entry.node);\r\n          } else {\r\n            next.add(nodeId);\r\n            onOpen?.(nodeId, entry.node);\r\n          }\r\n          return next;\r\n        });\r\n      },\r\n      [onOpen, onClose]\r\n    );\r\n\r\n    // Handle node click\r\n    const handleNodeClick = useCallback(\r\n      (nodeId: string | number, e: React.MouseEvent) => {\r\n        const entry = nodeMap.current.get(nodeId);\r\n        if (!entry) return;\r\n        \r\n        handleSelect(nodeId, e);\r\n        onClick?.(nodeId, entry.node, e);\r\n      },\r\n      [handleSelect, onClick]\r\n    );\r\n\r\n    // Handle double click\r\n    const handleNodeDblClick = useCallback(\r\n      (nodeId: string | number, e: React.MouseEvent) => {\r\n        const entry = nodeMap.current.get(nodeId);\r\n        if (!entry) return;\r\n        \r\n        if (editable && !entry.node.disabled) {\r\n          setEditingId(nodeId);\r\n          setEditValue(entry.node.value);\r\n        } else if (entry.node.data) {\r\n          handleToggle(nodeId, e);\r\n        }\r\n        \r\n        onDblClick?.(nodeId, entry.node, e);\r\n      },\r\n      [editable, handleToggle, onDblClick]\r\n    );\r\n\r\n    // Handle edit submit\r\n    const handleEditSubmit = useCallback(\r\n      (nodeId: string | number) => {\r\n        const entry = nodeMap.current.get(nodeId);\r\n        if (entry && editValue !== entry.node.value) {\r\n          onEdit?.(nodeId, editValue, entry.node);\r\n        }\r\n        setEditingId(null);\r\n        setEditValue('');\r\n      },\r\n      [editValue, onEdit]\r\n    );\r\n\r\n    // Handle context menu\r\n    const handleContextMenu = useCallback(\r\n      (nodeId: string | number, e: React.MouseEvent) => {\r\n        const entry = nodeMap.current.get(nodeId);\r\n        if (entry && onContext) {\r\n          e.preventDefault();\r\n          onContext(nodeId, entry.node, e);\r\n        }\r\n      },\r\n      [onContext]\r\n    );\r\n\r\n    // Keyboard navigation\r\n    const handleKeyDown = useCallback(\r\n      (e: React.KeyboardEvent) => {\r\n        if (!navigation || focusedId === null) return;\r\n        \r\n        const allIds = getAllNodeIds(data);\r\n        const visibleIds = allIds.filter((nodeId) => {\r\n          const entry = nodeMap.current.get(nodeId);\r\n          if (!entry) return false;\r\n          \r\n          // Check if all ancestors are open\r\n          let parentId = entry.parentId;\r\n          while (parentId !== null) {\r\n            if (!openIds.has(parentId)) return false;\r\n            const parentEntry = nodeMap.current.get(parentId);\r\n            if (!parentEntry) return false;\r\n            parentId = parentEntry.parentId;\r\n          }\r\n          return true;\r\n        });\r\n        \r\n        const currentIndex = visibleIds.indexOf(focusedId);\r\n        \r\n        switch (e.key) {\r\n          case 'ArrowDown':\r\n            e.preventDefault();\r\n            if (currentIndex < visibleIds.length - 1) {\r\n              setFocusedId(visibleIds[currentIndex + 1]);\r\n            }\r\n            break;\r\n          case 'ArrowUp':\r\n            e.preventDefault();\r\n            if (currentIndex > 0) {\r\n              setFocusedId(visibleIds[currentIndex - 1]);\r\n            }\r\n            break;\r\n          case 'ArrowRight': {\r\n            e.preventDefault();\r\n            const entry = nodeMap.current.get(focusedId);\r\n            if (entry?.node.data) {\r\n              if (!openIds.has(focusedId)) {\r\n                handleToggle(focusedId);\r\n              } else if (entry.node.data.length > 0) {\r\n                setFocusedId(entry.node.data[0].id);\r\n              }\r\n            }\r\n            break;\r\n          }\r\n          case 'ArrowLeft': {\r\n            e.preventDefault();\r\n            const entry = nodeMap.current.get(focusedId);\r\n            if (entry) {\r\n              if (openIds.has(focusedId) && entry.node.data) {\r\n                handleToggle(focusedId);\r\n              } else if (entry.parentId !== null) {\r\n                setFocusedId(entry.parentId);\r\n              }\r\n            }\r\n            break;\r\n          }\r\n          case 'Enter':\r\n          case ' ':\r\n            e.preventDefault();\r\n            if (checkbox) {\r\n              handleCheckToggle(focusedId);\r\n            } else {\r\n              handleSelect(focusedId);\r\n            }\r\n            break;\r\n          case 'Home':\r\n            e.preventDefault();\r\n            if (visibleIds.length > 0) {\r\n              setFocusedId(visibleIds[0]);\r\n            }\r\n            break;\r\n          case 'End':\r\n            e.preventDefault();\r\n            if (visibleIds.length > 0) {\r\n              setFocusedId(visibleIds[visibleIds.length - 1]);\r\n            }\r\n            break;\r\n        }\r\n      },\r\n      [navigation, focusedId, data, openIds, checkbox, handleToggle, handleCheckToggle, handleSelect]\r\n    );\r\n\r\n    // Imperative handle\r\n    useImperativeHandle(ref, () => ({\r\n      getSelectedId: () => (selectedIds.size > 0 ? Array.from(selectedIds)[0] : null),\r\n      getSelectedIds: () => Array.from(selectedIds),\r\n      select: (nodeId) => handleSelect(nodeId),\r\n      unselect: (nodeId) => {\r\n        if (nodeId) {\r\n          setSelectedIds((prev) => {\r\n            const next = new Set(prev);\r\n            next.delete(nodeId);\r\n            return next;\r\n          });\r\n        } else {\r\n          setSelectedIds(new Set());\r\n        }\r\n      },\r\n      open: (nodeId) => {\r\n        setOpenIds((prev) => new Set(prev).add(nodeId));\r\n        const entry = nodeMap.current.get(nodeId);\r\n        if (entry) onOpen?.(nodeId, entry.node);\r\n      },\r\n      close: (nodeId) => {\r\n        setOpenIds((prev) => {\r\n          const next = new Set(prev);\r\n          next.delete(nodeId);\r\n          return next;\r\n        });\r\n        const entry = nodeMap.current.get(nodeId);\r\n        if (entry) onClose?.(nodeId, entry.node);\r\n      },\r\n      openAll: () => {\r\n        const allBranchIds = getAllNodeIds(data).filter((nodeId) => {\r\n          const entry = nodeMap.current.get(nodeId);\r\n          return entry?.node.data && entry.node.data.length > 0;\r\n        });\r\n        setOpenIds(new Set(allBranchIds));\r\n      },\r\n      closeAll: () => setOpenIds(new Set()),\r\n      checkItem: (nodeId) => {\r\n        if (!checkedIds.has(nodeId)) {\r\n          handleCheckToggle(nodeId);\r\n        }\r\n      },\r\n      uncheckItem: (nodeId) => {\r\n        if (checkedIds.has(nodeId)) {\r\n          handleCheckToggle(nodeId);\r\n        }\r\n      },\r\n      checkAll: () => {\r\n        const allIds = getAllNodeIds(data);\r\n        setCheckedIds(new Set(allIds));\r\n      },\r\n      uncheckAll: () => setCheckedIds(new Set()),\r\n      getChecked: () => Array.from(checkedIds),\r\n      isChecked: (nodeId) => getCheckState(nodeId),\r\n      isBranchOpen: (nodeId) => openIds.has(nodeId),\r\n      isBranch: (nodeId) => {\r\n        const entry = nodeMap.current.get(nodeId);\r\n        return entry?.node.data !== undefined && entry.node.data.length > 0;\r\n      },\r\n      getItem: (nodeId) => nodeMap.current.get(nodeId)?.node,\r\n      getParentId: (nodeId) => nodeMap.current.get(nodeId)?.parentId ?? null,\r\n      filter: (fn) => setFilterFn(() => fn),\r\n      clearFilter: () => setFilterFn(null),\r\n      refresh: () => forceUpdate({}),\r\n      focus: () => containerRef.current?.focus(),\r\n      getNode: () => containerRef.current,\r\n      showItem: (nodeId) => {\r\n        // Open all ancestors\r\n        let parentId = nodeMap.current.get(nodeId)?.parentId ?? null;\r\n        const toOpen: (string | number)[] = [];\r\n        while (parentId !== null) {\r\n          toOpen.push(parentId);\r\n          parentId = nodeMap.current.get(parentId)?.parentId ?? null;\r\n        }\r\n        setOpenIds((prev) => {\r\n          const next = new Set(prev);\r\n          toOpen.forEach((id) => next.add(id));\r\n          return next;\r\n        });\r\n        \r\n        // Scroll into view after state update\r\n        setTimeout(() => {\r\n          const element = containerRef.current?.querySelector(`[data-node-id=\"${nodeId}\"]`);\r\n          element?.scrollIntoView({ behavior: 'smooth', block: 'nearest' });\r\n        }, 50);\r\n      },\r\n    }));\r\n\r\n    // Render a tree node recursively\r\n    const renderNode = (node: AvakioTreeNode, depth: number = 0): React.ReactNode => {\r\n      const isBranch = node.data && node.data.length > 0;\r\n      const isOpen = openIds.has(node.id);\r\n      const isSelected = selectedIds.has(node.id);\r\n      const isFocused = focusedId === node.id;\r\n      const isEditing = editingId === node.id;\r\n      const checkState = checkbox ? getCheckState(node.id) : false;\r\n      \r\n      // Apply filter\r\n      if (filterFn && !filterFn(node)) {\r\n        // Check if any descendants match\r\n        if (!node.data?.some((child) => filterFn(child) || getDescendantIds(child).some((id) => {\r\n          const entry = nodeMap.current.get(id);\r\n          return entry && filterFn(entry.node);\r\n        }))) {\r\n          return null;\r\n        }\r\n      }\r\n\r\n      const nodeClasses = [\r\n        'avakio-tree-node',\r\n        isSelected && 'avakio-tree-node--selected',\r\n        isFocused && 'avakio-tree-node--focused',\r\n        node.disabled && 'avakio-tree-node--disabled',\r\n        isBranch && 'avakio-tree-node--branch',\r\n        node.css,\r\n      ].filter(Boolean).join(' ');\r\n\r\n      const indent = depth * 20;\r\n\r\n      return (\r\n        <div key={node.id} className=\"avakio-tree-node-wrapper\">\r\n          <div\r\n            className={nodeClasses}\r\n            data-node-id={node.id}\r\n            style={{ \r\n              paddingLeft: indent + 8,\r\n              height: itemHeight,\r\n            }}\r\n            onClick={(e) => handleNodeClick(node.id, e)}\r\n            onDoubleClick={(e) => handleNodeDblClick(node.id, e)}\r\n            onContextMenu={(e) => handleContextMenu(node.id, e)}\r\n            title={node.tooltip}\r\n            role=\"treeitem\"\r\n            aria-selected={isSelected}\r\n            aria-expanded={isBranch ? isOpen : undefined}\r\n            tabIndex={isFocused ? 0 : -1}\r\n          >\r\n            {/* Toggle icon */}\r\n            {showToggle && (\r\n              <span\r\n                className={`avakio-tree-toggle ${isBranch ? 'avakio-tree-toggle--visible' : ''}`}\r\n                onClick={(e) => isBranch && handleToggle(node.id, e)}\r\n              >\r\n                {isBranch ? (\r\n                  isOpen ? <ChevronDown size={16} /> : <ChevronRight size={16} />\r\n                ) : null}\r\n              </span>\r\n            )}\r\n\r\n            {/* Checkbox */}\r\n            {checkbox && (\r\n              <span\r\n                className={`avakio-tree-checkbox ${checkState === true ? 'avakio-tree-checkbox--checked' : ''} ${checkState === 'indeterminate' ? 'avakio-tree-checkbox--indeterminate' : ''}`}\r\n                onClick={(e) => {\r\n                  e.stopPropagation();\r\n                  if (!node.disabled) handleCheckToggle(node.id);\r\n                }}\r\n              >\r\n                {checkState === true && <Check size={12} />}\r\n                {checkState === 'indeterminate' && <Minus size={12} />}\r\n              </span>\r\n            )}\r\n\r\n            {/* Icon */}\r\n            {showIcons && (\r\n              <span className=\"avakio-tree-icon\">\r\n                {node.icon ? (\r\n                  isOpen && node.openIcon ? node.openIcon : node.icon\r\n                ) : isBranch ? (\r\n                  isOpen ? <FolderOpen size={16} /> : <Folder size={16} />\r\n                ) : (\r\n                  <File size={16} />\r\n                )}\r\n              </span>\r\n            )}\r\n\r\n            {/* Label */}\r\n            {isEditing ? (\r\n              <input\r\n                type=\"text\"\r\n                className=\"avakio-tree-edit-input\"\r\n                value={editValue}\r\n                onChange={(e) => setEditValue(e.target.value)}\r\n                onBlur={() => handleEditSubmit(node.id)}\r\n                onKeyDown={(e) => {\r\n                  if (e.key === 'Enter') handleEditSubmit(node.id);\r\n                  if (e.key === 'Escape') {\r\n                    setEditingId(null);\r\n                    setEditValue('');\r\n                  }\r\n                }}\r\n                autoFocus\r\n                onClick={(e) => e.stopPropagation()}\r\n              />\r\n            ) : (\r\n              <span className=\"avakio-tree-label\">{node.value}</span>\r\n            )}\r\n          </div>\r\n\r\n          {/* Children */}\r\n          {isBranch && isOpen && (\r\n            <div className={`avakio-tree-children ${showLines ? 'avakio-tree-children--lines' : ''}`}>\r\n              {node.data!.map((child) => renderNode(child, depth + 1))}\r\n            </div>\r\n          )}\r\n        </div>\r\n      );\r\n    };\r\n\r\n    // Detect theme from parent if not provided\r\n    const [detectedTheme, setDetectedTheme] = useState<string>(theme || 'material');\r\n    useEffect(() => {\r\n      if (!theme) {\r\n        const globalTheme = document.documentElement.getAttribute('data-admin-theme');\r\n        if (globalTheme) setDetectedTheme(globalTheme);\r\n\r\n        const observer = new MutationObserver(() => {\r\n          const newTheme = document.documentElement.getAttribute('data-admin-theme');\r\n          if (newTheme) setDetectedTheme(newTheme);\r\n        });\r\n        observer.observe(document.documentElement, {\r\n          attributes: true,\r\n          attributeFilter: ['data-admin-theme'],\r\n        });\r\n        return () => observer.disconnect();\r\n      }\r\n    }, [theme]);\r\n\r\n    const effectiveTheme = theme || detectedTheme;\r\n\r\n    const containerClasses = [\r\n      'avakio-tree',\r\n      `avakio-tree--${effectiveTheme}`,\r\n      showLines && 'avakio-tree--lines',\r\n      className,\r\n    ].filter(Boolean).join(' ');\r\n\r\n    return (\r\n      <div\r\n        ref={containerRef}\r\n        id={treeId}\r\n        data-testid={testId}\r\n        className={containerClasses}\r\n        style={{\r\n          width,\r\n          height,\r\n          ...style,\r\n        }}\r\n        role=\"tree\"\r\n        tabIndex={0}\r\n        onKeyDown={handleKeyDown}\r\n        onFocus={() => {\r\n          if (focusedId === null && data.length > 0) {\r\n            setFocusedId(data[0].id);\r\n          }\r\n        }}\r\n      >\r\n        {data.map((node) => renderNode(node, 0))}\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nAvakioTree.displayName = 'AvakioTree';\r\n\r\nexport default AvakioTree;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { forwardRef, useImperativeHandle, useRef, useState, useCallback, useEffect } from 'react';\r\nimport './avakio-absolute-layout.css';\r\n\r\nexport type AvakioAbsoluteLayoutTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\n\r\n/**\r\n * Cell configuration for AbsoluteLayout\r\n * Each cell can be positioned absolutely using top/left/bottom/right\r\n * or relatively using the relative flag\r\n */\r\nexport interface AvakioAbsoluteLayoutCell {\r\n  /** Unique identifier for the cell */\r\n  id?: string;\r\n  /** The content to render in this cell */\r\n  content: React.ReactNode;\r\n  /** Distance from top of container (px or %) */\r\n  top?: number | string;\r\n  /** Distance from left of container (px or %) */\r\n  left?: number | string;\r\n  /** Distance from bottom of container (px or %) */\r\n  bottom?: number | string;\r\n  /** Distance from right of container (px or %) */\r\n  right?: number | string;\r\n  /** Width of the cell (px or %) */\r\n  width?: number | string;\r\n  /** Height of the cell (px or %) */\r\n  height?: number | string;\r\n  /** Minimum width */\r\n  minWidth?: number | string;\r\n  /** Minimum height */\r\n  minHeight?: number | string;\r\n  /** Maximum width */\r\n  maxWidth?: number | string;\r\n  /** Maximum height */\r\n  maxHeight?: number | string;\r\n  /** If true, the cell takes all available space (like position: relative) */\r\n  relative?: boolean;\r\n  /** CSS class for this cell */\r\n  css?: string;\r\n  /** Z-index for stacking order */\r\n  zIndex?: number;\r\n  /** Whether this cell is hidden */\r\n  hidden?: boolean;\r\n  /** Whether this cell is disabled */\r\n  disabled?: boolean;\r\n  /** Batch name for showing/hiding groups of cells */\r\n  batch?: string;\r\n}\r\n\r\nexport interface AvakioAbsoluteLayoutProps {\r\n  /** Unique identifier */\r\n  id?: string;\r\n  /** Test ID for testing */\r\n  testId?: string;\r\n  /** Theme to apply */\r\n  theme?: AvakioAbsoluteLayoutTheme;\r\n  /** Array of cells with absolute positioning configuration */\r\n  cells: AvakioAbsoluteLayoutCell[];\r\n  /** Width of the layout container */\r\n  width?: number | string;\r\n  /** Height of the layout container */\r\n  height?: number | string;\r\n  /** Minimum width */\r\n  minWidth?: number | string;\r\n  /** Minimum height */\r\n  minHeight?: number | string;\r\n  /** Maximum width */\r\n  maxWidth?: number | string;\r\n  /** Maximum height */\r\n  maxHeight?: number | string;\r\n  /** Whether to remove borders */\r\n  borderless?: boolean;\r\n  /** Custom CSS class */\r\n  css?: string;\r\n  /** Whether the layout is initially hidden */\r\n  hidden?: boolean;\r\n  /** Whether the layout is disabled */\r\n  disabled?: boolean;\r\n  /** Initial visible batch */\r\n  visibleBatch?: string;\r\n  /** Background color */\r\n  background?: string;\r\n  /** Padding inside the container */\r\n  padding?: number | string;\r\n  /** Callback when a cell is clicked */\r\n  onCellClick?: (cellId: string | undefined, cell: AvakioAbsoluteLayoutCell) => void;\r\n  /** Callback when the layout is resized */\r\n  onResize?: (width: number, height: number) => void;\r\n}\r\n\r\nexport interface AvakioAbsoluteLayoutRef {\r\n  /** Add a new cell to the layout */\r\n  addView: (cell: AvakioAbsoluteLayoutCell, index?: number) => void;\r\n  /** Remove a cell by id or index */\r\n  removeView: (idOrIndex: string | number) => void;\r\n  /** Get all child cells */\r\n  getChildViews: () => AvakioAbsoluteLayoutCell[];\r\n  /** Get the DOM node */\r\n  getNode: () => HTMLDivElement | null;\r\n  /** Show the layout */\r\n  show: () => void;\r\n  /** Hide the layout */\r\n  hide: () => void;\r\n  /** Check if visible */\r\n  isVisible: () => boolean;\r\n  /** Enable the layout */\r\n  enable: () => void;\r\n  /** Disable the layout */\r\n  disable: () => void;\r\n  /** Check if enabled */\r\n  isEnabled: () => boolean;\r\n  /** Resize the layout */\r\n  resize: () => void;\r\n  /** Show cells by batch name */\r\n  showBatch: (batchName: string) => void;\r\n  /** Get index of a cell by id */\r\n  index: (cellId: string) => number;\r\n  /** Reconstruct the layout with new cells */\r\n  reconstruct: (cells: AvakioAbsoluteLayoutCell[]) => void;\r\n}\r\n\r\n// Helper to convert number/string to CSS value\r\nconst toCssValue = (value: number | string | undefined): string | undefined => {\r\n  if (value === undefined) return undefined;\r\n  if (typeof value === 'number') return `${value}px`;\r\n  return value;\r\n};\r\n\r\nexport const AvakioAbsoluteLayout = forwardRef<AvakioAbsoluteLayoutRef, AvakioAbsoluteLayoutProps>((props, ref) => {\r\n  const {\r\n    id,\r\n    testId,\r\n    theme = 'material',\r\n    cells: initialCells,\r\n    width,\r\n    height,\r\n    minWidth,\r\n    minHeight,\r\n    maxWidth,\r\n    maxHeight,\r\n    borderless = false,\r\n    css,\r\n    hidden: initialHidden = false,\r\n    disabled: initialDisabled = false,\r\n    visibleBatch: initialVisibleBatch,\r\n    background,\r\n    padding,\r\n    onCellClick,\r\n    onResize,\r\n  } = props;\r\n\r\n  // State\r\n  const [cells, setCells] = useState<AvakioAbsoluteLayoutCell[]>(initialCells);\r\n  const [isHidden, setIsHidden] = useState(initialHidden);\r\n  const [isDisabled, setIsDisabled] = useState(initialDisabled);\r\n  const [visibleBatch, setVisibleBatch] = useState<string | undefined>(initialVisibleBatch);\r\n  \r\n  // Refs\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n  const resizeObserverRef = useRef<ResizeObserver | null>(null);\r\n\r\n  // Update cells when props change\r\n  useEffect(() => {\r\n    setCells(initialCells);\r\n  }, [initialCells]);\r\n\r\n  // Setup resize observer\r\n  useEffect(() => {\r\n    if (!containerRef.current || !onResize) return;\r\n\r\n    resizeObserverRef.current = new ResizeObserver((entries) => {\r\n      for (const entry of entries) {\r\n        const { width, height } = entry.contentRect;\r\n        onResize(width, height);\r\n      }\r\n    });\r\n\r\n    resizeObserverRef.current.observe(containerRef.current);\r\n\r\n    return () => {\r\n      resizeObserverRef.current?.disconnect();\r\n    };\r\n  }, [onResize]);\r\n\r\n  // Handle cell click\r\n  const handleCellClick = useCallback((cell: AvakioAbsoluteLayoutCell) => {\r\n    if (isDisabled || cell.disabled) return;\r\n    onCellClick?.(cell.id, cell);\r\n  }, [isDisabled, onCellClick]);\r\n\r\n  // Check if cell should be visible based on batch\r\n  const isCellVisible = useCallback((cell: AvakioAbsoluteLayoutCell): boolean => {\r\n    if (cell.hidden) return false;\r\n    if (!visibleBatch) return true;\r\n    if (!cell.batch) return true;\r\n    return cell.batch === visibleBatch;\r\n  }, [visibleBatch]);\r\n\r\n  // Imperative handle\r\n  useImperativeHandle(ref, () => ({\r\n    addView: (cell: AvakioAbsoluteLayoutCell, index?: number) => {\r\n      setCells(prev => {\r\n        if (index !== undefined && index >= 0 && index <= prev.length) {\r\n          const newCells = [...prev];\r\n          newCells.splice(index, 0, cell);\r\n          return newCells;\r\n        }\r\n        return [...prev, cell];\r\n      });\r\n    },\r\n    removeView: (idOrIndex: string | number) => {\r\n      setCells(prev => {\r\n        if (typeof idOrIndex === 'number') {\r\n          return prev.filter((_, i) => i !== idOrIndex);\r\n        }\r\n        return prev.filter(c => c.id !== idOrIndex);\r\n      });\r\n    },\r\n    getChildViews: () => cells,\r\n    getNode: () => containerRef.current,\r\n    show: () => setIsHidden(false),\r\n    hide: () => setIsHidden(true),\r\n    isVisible: () => !isHidden,\r\n    enable: () => setIsDisabled(false),\r\n    disable: () => setIsDisabled(true),\r\n    isEnabled: () => !isDisabled,\r\n    resize: () => {\r\n      if (containerRef.current && onResize) {\r\n        const { width, height } = containerRef.current.getBoundingClientRect();\r\n        onResize(width, height);\r\n      }\r\n    },\r\n    showBatch: (batchName: string) => setVisibleBatch(batchName),\r\n    index: (cellId: string) => cells.findIndex(c => c.id === cellId),\r\n    reconstruct: (newCells: AvakioAbsoluteLayoutCell[]) => setCells(newCells),\r\n  }), [cells, isHidden, isDisabled, onResize]);\r\n\r\n  // Container styles\r\n  const containerStyle: React.CSSProperties = {\r\n    width: toCssValue(width),\r\n    height: toCssValue(height),\r\n    minWidth: toCssValue(minWidth),\r\n    minHeight: toCssValue(minHeight),\r\n    maxWidth: toCssValue(maxWidth),\r\n    maxHeight: toCssValue(maxHeight),\r\n    background,\r\n    padding: toCssValue(padding),\r\n  };\r\n\r\n  if (isHidden) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div\r\n      ref={containerRef}\r\n      id={id}\r\n      data-testid={testId}\r\n      className={`avakio-absolute-layout avakio-absolute-layout-theme-${theme} ${borderless ? 'borderless' : ''} ${isDisabled ? 'disabled' : ''} ${css || ''}`}\r\n      style={containerStyle}\r\n    >\r\n      {cells.map((cell, index) => {\r\n        if (!isCellVisible(cell)) return null;\r\n\r\n        const cellStyle: React.CSSProperties = cell.relative\r\n          ? {\r\n              position: 'relative',\r\n              width: toCssValue(cell.width) || '100%',\r\n              height: toCssValue(cell.height) || '100%',\r\n              minWidth: toCssValue(cell.minWidth),\r\n              minHeight: toCssValue(cell.minHeight),\r\n              maxWidth: toCssValue(cell.maxWidth),\r\n              maxHeight: toCssValue(cell.maxHeight),\r\n              zIndex: cell.zIndex,\r\n            }\r\n          : {\r\n              position: 'absolute',\r\n              top: toCssValue(cell.top),\r\n              left: toCssValue(cell.left),\r\n              bottom: toCssValue(cell.bottom),\r\n              right: toCssValue(cell.right),\r\n              width: toCssValue(cell.width),\r\n              height: toCssValue(cell.height),\r\n              minWidth: toCssValue(cell.minWidth),\r\n              minHeight: toCssValue(cell.minHeight),\r\n              maxWidth: toCssValue(cell.maxWidth),\r\n              maxHeight: toCssValue(cell.maxHeight),\r\n              zIndex: cell.zIndex,\r\n            };\r\n\r\n        return (\r\n          <div\r\n            key={cell.id || index}\r\n            className={`avakio-absolute-layout-cell ${cell.relative ? 'relative' : 'absolute'} ${cell.disabled ? 'disabled' : ''} ${cell.css || ''}`}\r\n            style={cellStyle}\r\n            onClick={() => handleCellClick(cell)}\r\n            data-cell-id={cell.id}\r\n            data-batch={cell.batch}\r\n          >\r\n            {cell.content}\r\n          </div>\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n});\r\n\r\nAvakioAbsoluteLayout.displayName = 'AvakioAbsoluteLayout';\r\n\r\nexport default AvakioAbsoluteLayout;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { forwardRef, useImperativeHandle, useState, useRef, useEffect, useMemo, useCallback } from 'react';\r\nimport './avakio-grid.css';\r\n\r\nexport type AvakioGridTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\n\r\n/**\r\n * Cell configuration for AvakioGrid\r\n * x, y: Grid position (0-indexed)\r\n * dx, dy: Cell span (width/height in grid units)\r\n */\r\nexport interface AvakioGridCell {\r\n  /** Unique identifier for the cell */\r\n  id: string;\r\n  /** Whether this cell can be dragged when grid dragging is enabled */\r\n  draggable?: boolean;\r\n  /** Content to display in the cell */\r\n  content?: React.ReactNode;\r\n  /** Template string or function */\r\n  template?: string | ((cell: AvakioGridCell) => React.ReactNode);\r\n  /** X position in grid (0-indexed) */\r\n  x: number;\r\n  /** Y position in grid (0-indexed) */\r\n  y: number;\r\n  /** Width in grid units (default: 1) */\r\n  dx?: number;\r\n  /** Height in grid units (default: 1) */\r\n  dy?: number;\r\n  /** Fixed height for this cell in pixels (overrides grid calculation) */\r\n  height?: number;\r\n  /** Custom CSS class for the cell */\r\n  cssClass?: string;\r\n  /** Custom inline styles */\r\n  css?: React.CSSProperties;\r\n  /** Whether the cell is hidden */\r\n  hidden?: boolean;\r\n  /** Whether the cell is disabled */\r\n  disabled?: boolean;\r\n  /** Additional data attached to cell */\r\n  data?: Record<string, any>;\r\n}\r\n\r\nexport interface AvakioGridProps {\r\n  /** Unique identifier */\r\n  id?: string;\r\n  /** Test ID for testing */\r\n  testId?: string;\r\n  /** Number of columns in the grid */\r\n  gridColumns?: number;\r\n  /** Number of rows in the grid */\r\n  gridRows?: number;\r\n  /** Fixed cell width in pixels (auto-calculated if not set) */\r\n  cellWidth?: number;\r\n  /** Fixed cell height in pixels (auto-calculated if not set) */\r\n  cellHeight?: number;\r\n  /** Array of cell configurations */\r\n  cells: AvakioGridCell[];\r\n  /** Theme to apply */\r\n  theme?: AvakioGridTheme;\r\n  /** Margin between cells in pixels */\r\n  cellMargin?: number;\r\n  /** Margin around the grid container in pixels */\r\n  margin?: number;\r\n  /** Padding around the grid - can be a number (all sides) or array [top, right, bottom, left] */\r\n  padding?: number | [number, number, number, number];\r\n  /** Horizontal padding */\r\n  paddingX?: number;\r\n  /** Vertical padding */\r\n  paddingY?: number;\r\n  /** Width of the grid container */\r\n  width?: number | string;\r\n  /** Height of the grid container */\r\n  height?: number | string;\r\n  /** Minimum width */\r\n  minWidth?: number | string;\r\n  /** Minimum height */\r\n  minHeight?: number | string;\r\n  /** Remove container/view borders */\r\n  borderless?: boolean;\r\n  /** Remove cell borders */\r\n  cellBorderless?: boolean;\r\n  /** Custom CSS class */\r\n  className?: string;\r\n  /** Custom inline styles */\r\n  css?: React.CSSProperties;\r\n  /** Whether the grid is hidden */\r\n  hidden?: boolean;\r\n  /** Whether the grid is disabled */\r\n  disabled?: boolean;\r\n  /** Auto-place new views vertically */\r\n  autoplace?: boolean;\r\n  /** Factory function to create cell content */\r\n  factory?: (cell: AvakioGridCell) => React.ReactNode;\r\n  /** Callback when cells change */\r\n  onChange?: (cells: AvakioGridCell[]) => void;\r\n  /** Callback when a cell is clicked */\r\n  onCellClick?: (cell: AvakioGridCell) => void;\r\n  /** Enable drag and drop functionality for cells */\r\n  isDraggable?: boolean;\r\n  /** Callback when drag starts */\r\n  onDragStart?: (cell: AvakioGridCell) => void;\r\n  /** Callback when drag ends */\r\n  onDragEnd?: (cell: AvakioGridCell, newPosition: { x: number; y: number }) => void;\r\n}\r\n\r\nexport interface AvakioGridRef {\r\n  /** Add a new cell to the grid */\r\n  addView: (cell: AvakioGridCell, index?: number) => void;\r\n  /** Remove a cell by ID */\r\n  removeView: (id: string) => void;\r\n  /** Move/resize a cell */\r\n  moveView: (id: string, position: { x?: number; y?: number; dx?: number; dy?: number }) => void;\r\n  /** Clear all cells */\r\n  clearAll: () => void;\r\n  /** Get all cells */\r\n  getCells: () => AvakioGridCell[];\r\n  /** Get a cell by ID */\r\n  getCell: (id: string) => AvakioGridCell | undefined;\r\n  /** Serialize the grid state */\r\n  serialize: () => AvakioGridCell[];\r\n  /** Restore grid state */\r\n  restore: (cells: AvakioGridCell[]) => void;\r\n  /** Rebuild the grid */\r\n  reconstruct: () => void;\r\n  /** Show the grid */\r\n  show: () => void;\r\n  /** Hide the grid */\r\n  hide: () => void;\r\n  /** Get the DOM node */\r\n  getNode: () => HTMLDivElement | null;\r\n}\r\n\r\nexport const AvakioGrid = forwardRef<AvakioGridRef, AvakioGridProps>(\r\n  (\r\n    {\r\n      id,\r\n      testId,\r\n      gridColumns = 2,\r\n      gridRows = 2,\r\n      cellWidth,\r\n      cellHeight,\r\n      cells: initialCells = [],\r\n      theme = 'material',\r\n      cellMargin = 10,\r\n      margin,\r\n      padding = 10,\r\n      paddingX,\r\n      paddingY,\r\n      width,\r\n      height,\r\n      minWidth,\r\n      minHeight,\r\n      borderless = false,\r\n      cellBorderless = false,\r\n      className = '',\r\n      css,\r\n      hidden = false,\r\n      disabled = false,\r\n      autoplace = false,\r\n      factory,\r\n      onChange,\r\n      onCellClick,\r\n      isDraggable = false,\r\n      onDragStart,\r\n      onDragEnd,\r\n    },\r\n    ref\r\n  ) => {\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n    const [cells, setCells] = useState<AvakioGridCell[]>(initialCells);\r\n    const [isHidden, setIsHidden] = useState(hidden);\r\n    const [containerSize, setContainerSize] = useState({ width: 0, height: 0 });\r\n    const cellsRef = useRef(cells);\r\n    \r\n    // Drag state\r\n    const [draggingCell, setDraggingCell] = useState<string | null>(null);\r\n    const [dragOffset, setDragOffset] = useState({ x: 0, y: 0 });\r\n    const [dragPosition, setDragPosition] = useState({ x: 0, y: 0 });\r\n\r\n    // Keep cellsRef in sync\r\n    useEffect(() => {\r\n      cellsRef.current = cells;\r\n    }, [cells]);\r\n\r\n    // Update cells when prop changes\r\n    useEffect(() => {\r\n      setCells(initialCells);\r\n    }, [initialCells]);\r\n\r\n    // Observe container size for responsive cell sizing\r\n    useEffect(() => {\r\n      if (!containerRef.current) return;\r\n\r\n      // Get initial size immediately using clientWidth/clientHeight (content + padding, excludes border)\r\n      const initialWidth = containerRef.current.clientWidth;\r\n      const initialHeight = containerRef.current.clientHeight;\r\n      if (initialWidth > 0 || initialHeight > 0) {\r\n        setContainerSize({ width: initialWidth, height: initialHeight });\r\n      }\r\n\r\n      let rafId: number | null = null;\r\n      let pendingSize: { width: number; height: number } | null = null;\r\n\r\n      const resizeObserver = new ResizeObserver((entries) => {\r\n        for (const entry of entries) {\r\n          const target = entry.target as HTMLElement;\r\n          pendingSize = { width: target.clientWidth, height: target.clientHeight };\r\n          \r\n          // Use requestAnimationFrame to throttle updates for smooth resizing\r\n          if (rafId === null) {\r\n            rafId = requestAnimationFrame(() => {\r\n              if (pendingSize) {\r\n                setContainerSize(pendingSize);\r\n                pendingSize = null;\r\n              }\r\n              rafId = null;\r\n            });\r\n          }\r\n        }\r\n      });\r\n\r\n      resizeObserver.observe(containerRef.current);\r\n      return () => {\r\n        resizeObserver.disconnect();\r\n        if (rafId !== null) {\r\n          cancelAnimationFrame(rafId);\r\n        }\r\n      };\r\n    }, []);\r\n\r\n    // Calculate actual cell dimensions\r\n    const calculatedCellWidth = useMemo(() => {\r\n      if (cellWidth) return cellWidth;\r\n      const basePadding = Array.isArray(padding) ? padding : [padding, padding, padding, padding];\r\n      const px = paddingX !== undefined ? paddingX : basePadding[1];\r\n      const paddingHorizontal = px * 2;\r\n      const totalMargin = cellMargin * (gridColumns - 1);\r\n      const availableWidth = containerSize.width - paddingHorizontal - totalMargin;\r\n      return Math.max(availableWidth / gridColumns, 50);\r\n    }, [cellWidth, containerSize.width, gridColumns, cellMargin, padding, paddingX]);\r\n\r\n    // Calculate heights for cells, accounting for fixed-height cells\r\n    const cellHeights = useMemo(() => {\r\n      // If cellHeight is explicitly set, use it for all cells\r\n      if (cellHeight) {\r\n        return cells.reduce((acc, cell) => {\r\n          acc[cell.id] = cell.height || cellHeight;\r\n          return acc;\r\n        }, {} as Record<string, number>);\r\n      }\r\n\r\n      const basePadding = Array.isArray(padding) ? padding : [padding, padding, padding, padding];\r\n      const py = paddingY !== undefined ? paddingY : basePadding[0];\r\n      const paddingVertical = py * 2;\r\n      const totalMargin = cellMargin * (gridRows - 1);\r\n      const availableHeight = containerSize.height - paddingVertical - totalMargin;\r\n\r\n      // Calculate fixed heights and count flexible cells\r\n      let fixedHeightTotal = 0;\r\n      let flexibleRowCount = 0;\r\n      const rowHeights: Record<number, number | 'flex'> = {};\r\n\r\n      // Group cells by row and determine which rows have fixed heights\r\n      for (let row = 0; row < gridRows; row++) {\r\n        const cellsInRow = cells.filter(c => c.y === row && !c.hidden);\r\n        const fixedHeightCell = cellsInRow.find(c => c.height !== undefined);\r\n        \r\n        if (fixedHeightCell && fixedHeightCell.height) {\r\n          rowHeights[row] = fixedHeightCell.height;\r\n          fixedHeightTotal += fixedHeightCell.height;\r\n        } else {\r\n          rowHeights[row] = 'flex';\r\n          flexibleRowCount++;\r\n        }\r\n      }\r\n\r\n      // Calculate height for flexible rows\r\n      const remainingHeight = availableHeight - fixedHeightTotal;\r\n      const flexRowHeight = flexibleRowCount > 0 \r\n        ? Math.max(remainingHeight / flexibleRowCount, 50) \r\n        : 50;\r\n\r\n      // Build heights map for each cell\r\n      const heights: Record<string, number> = {};\r\n      cells.forEach(cell => {\r\n        if (cell.height) {\r\n          heights[cell.id] = cell.height;\r\n        } else {\r\n          const dy = cell.dy || 1;\r\n          let totalHeight = 0;\r\n          for (let i = 0; i < dy; i++) {\r\n            const rowH = rowHeights[cell.y + i];\r\n            totalHeight += rowH === 'flex' ? flexRowHeight : rowH;\r\n            if (i > 0) totalHeight += cellMargin;\r\n          }\r\n          heights[cell.id] = totalHeight;\r\n        }\r\n      });\r\n\r\n      return heights;\r\n    }, [cells, cellHeight, containerSize.height, gridRows, cellMargin, padding, paddingY]);\r\n\r\n    // Calculate row top positions (accounting for variable heights)\r\n    const rowPositions = useMemo(() => {\r\n      const basePadding = Array.isArray(padding) ? padding : [padding, padding, padding, padding];\r\n      const py = paddingY !== undefined ? paddingY : basePadding[0];\r\n      const paddingVertical = py * 2;\r\n      const availableHeight = containerSize.height - paddingVertical - (cellMargin * (gridRows - 1));\r\n      \r\n      // Calculate fixed heights and flexible row count\r\n      let fixedHeightTotal = 0;\r\n      let flexibleRowCount = 0;\r\n      const rowHeights: (number | 'flex')[] = [];\r\n\r\n      for (let row = 0; row < gridRows; row++) {\r\n        const cellsInRow = cells.filter(c => c.y === row && !c.hidden);\r\n        const fixedHeightCell = cellsInRow.find(c => c.height !== undefined);\r\n        \r\n        if (fixedHeightCell && fixedHeightCell.height) {\r\n          rowHeights[row] = fixedHeightCell.height;\r\n          fixedHeightTotal += fixedHeightCell.height;\r\n        } else if (cellHeight) {\r\n          rowHeights[row] = cellHeight;\r\n        } else {\r\n          rowHeights[row] = 'flex';\r\n          flexibleRowCount++;\r\n        }\r\n      }\r\n\r\n      const remainingHeight = availableHeight - fixedHeightTotal;\r\n      const flexRowHeight = flexibleRowCount > 0 \r\n        ? Math.max(remainingHeight / flexibleRowCount, 50) \r\n        : (cellHeight || 50);\r\n\r\n      // Calculate cumulative positions\r\n      const positions: number[] = [0];\r\n      for (let row = 0; row < gridRows; row++) {\r\n        const h = rowHeights[row] === 'flex' ? flexRowHeight : (rowHeights[row] as number);\r\n        positions[row + 1] = positions[row] + h + cellMargin;\r\n      }\r\n\r\n      return positions;\r\n    }, [cells, cellHeight, containerSize.height, gridRows, cellMargin, padding, paddingY]);\r\n\r\n    // Calculate cell position and size\r\n    const getCellStyle = useCallback((cell: AvakioGridCell): React.CSSProperties => {\r\n      const dx = cell.dx || 1;\r\n      const basePadding = Array.isArray(padding) ? padding : [padding, padding, padding, padding];\r\n      const px = paddingX !== undefined ? paddingX : basePadding[1];\r\n      const py = paddingY !== undefined ? paddingY : basePadding[0];\r\n\r\n      const left = px + cell.x * (calculatedCellWidth + cellMargin);\r\n      const top = py + rowPositions[cell.y];\r\n      const width = dx * calculatedCellWidth + (dx - 1) * cellMargin;\r\n      const height = cellHeights[cell.id] || 50;\r\n\r\n      return {\r\n        position: 'absolute',\r\n        left: `${left}px`,\r\n        top: `${top}px`,\r\n        width: `${width}px`,\r\n        height: `${height}px`,\r\n        ...cell.css,\r\n      };\r\n    }, [calculatedCellWidth, cellHeights, rowPositions, cellMargin, padding, paddingX, paddingY]);\r\n\r\n    // Render cell content\r\n    const renderCellContent = useCallback((cell: AvakioGridCell): React.ReactNode => {\r\n      if (factory) {\r\n        return factory(cell);\r\n      }\r\n      if (cell.content) {\r\n        return cell.content;\r\n      }\r\n      if (typeof cell.template === 'function') {\r\n        return cell.template(cell);\r\n      }\r\n      if (typeof cell.template === 'string') {\r\n        // Simple template replacement\r\n        let result = cell.template;\r\n        if (cell.data) {\r\n          Object.entries(cell.data).forEach(([key, value]) => {\r\n            result = result.replace(new RegExp(`#${key}#`, 'g'), String(value));\r\n          });\r\n        }\r\n        return <div dangerouslySetInnerHTML={{ __html: result }} />;\r\n      }\r\n      return null;\r\n    }, [factory]);\r\n\r\n    // Calculate grid position from pixel coordinates\r\n    const getGridPositionFromPixels = useCallback((pixelX: number, pixelY: number): { x: number; y: number } => {\r\n      const basePadding = Array.isArray(padding) ? padding : [padding, padding, padding, padding];\r\n      const px = paddingX !== undefined ? paddingX : basePadding[1];\r\n      const py = paddingY !== undefined ? paddingY : basePadding[0];\r\n      \r\n      // Calculate x position\r\n      const adjustedX = pixelX - px;\r\n      const colWidth = calculatedCellWidth + cellMargin;\r\n      let gridX = Math.round(adjustedX / colWidth);\r\n      gridX = Math.max(0, Math.min(gridX, gridColumns - 1));\r\n      \r\n      // Calculate y position based on row positions\r\n      const adjustedY = pixelY - py;\r\n      let gridY = 0;\r\n      for (let i = 0; i < rowPositions.length - 1; i++) {\r\n        const rowMid = rowPositions[i] + (rowPositions[i + 1] - rowPositions[i] - cellMargin) / 2;\r\n        if (adjustedY > rowMid) {\r\n          gridY = i + 1;\r\n        }\r\n      }\r\n      gridY = Math.max(0, Math.min(gridY, gridRows - 1));\r\n      \r\n      return { x: gridX, y: gridY };\r\n    }, [calculatedCellWidth, cellMargin, gridColumns, gridRows, padding, paddingX, paddingY, rowPositions]);\r\n\r\n    // Check if a position is occupied by another cell\r\n    const isPositionOccupied = useCallback((gridX: number, gridY: number, excludeCellId?: string): boolean => {\r\n      return cellsRef.current.some(cell => {\r\n        if (cell.id === excludeCellId) return false;\r\n        const dx = cell.dx || 1;\r\n        const dy = cell.dy || 1;\r\n        return gridX >= cell.x && gridX < cell.x + dx && gridY >= cell.y && gridY < cell.y + dy;\r\n      });\r\n    }, []);\r\n\r\n    // Handle drag start\r\n    const handleDragStart = useCallback((e: React.MouseEvent | React.TouchEvent, cell: AvakioGridCell) => {\r\n      if (!isDraggable || disabled || cell.disabled || cell.draggable === false) return;\r\n      \r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n      \r\n      const clientX = 'touches' in e ? e.touches[0].clientX : e.clientX;\r\n      const clientY = 'touches' in e ? e.touches[0].clientY : e.clientY;\r\n      \r\n      const rect = containerRef.current?.getBoundingClientRect();\r\n      if (!rect) return;\r\n      \r\n      const cellStyle = getCellStyle(cell);\r\n      const cellLeft = parseFloat(String(cellStyle.left));\r\n      const cellTop = parseFloat(String(cellStyle.top));\r\n      \r\n      setDragOffset({\r\n        x: clientX - rect.left - cellLeft,\r\n        y: clientY - rect.top - cellTop,\r\n      });\r\n      setDragPosition({\r\n        x: clientX - rect.left - (clientX - rect.left - cellLeft),\r\n        y: clientY - rect.top - (clientY - rect.top - cellTop),\r\n      });\r\n      setDraggingCell(cell.id);\r\n      onDragStart?.(cell);\r\n    }, [isDraggable, disabled, getCellStyle, onDragStart]);\r\n\r\n    // Handle drag move\r\n    const handleDragMove = useCallback((e: MouseEvent | TouchEvent) => {\r\n      if (!draggingCell || !containerRef.current) return;\r\n      \r\n      const clientX = 'touches' in e ? e.touches[0].clientX : e.clientX;\r\n      const clientY = 'touches' in e ? e.touches[0].clientY : e.clientY;\r\n      \r\n      const rect = containerRef.current.getBoundingClientRect();\r\n      \r\n      setDragPosition({\r\n        x: clientX - rect.left - dragOffset.x,\r\n        y: clientY - rect.top - dragOffset.y,\r\n      });\r\n    }, [draggingCell, dragOffset]);\r\n\r\n    // Handle drag end\r\n    const handleDragEnd = useCallback(() => {\r\n      if (!draggingCell) return;\r\n      \r\n      const cell = cellsRef.current.find(c => c.id === draggingCell);\r\n      if (!cell) {\r\n        setDraggingCell(null);\r\n        return;\r\n      }\r\n      \r\n      // Calculate new grid position\r\n      const newGridPos = getGridPositionFromPixels(dragPosition.x, dragPosition.y);\r\n      \r\n      // Check if the position is within bounds\r\n      const dx = cell.dx || 1;\r\n      const dy = cell.dy || 1;\r\n      \r\n      let canPlace = true;\r\n      for (let i = 0; i < dx && canPlace; i++) {\r\n        for (let j = 0; j < dy && canPlace; j++) {\r\n          const checkX = newGridPos.x + i;\r\n          const checkY = newGridPos.y + j;\r\n          if (checkX >= gridColumns || checkY >= gridRows) {\r\n            canPlace = false;\r\n          }\r\n        }\r\n      }\r\n      \r\n      // Check if position actually changed\r\n      const positionChanged = newGridPos.x !== cell.x || newGridPos.y !== cell.y;\r\n      \r\n      if (canPlace && positionChanged) {\r\n        // For single-column grids with 1x1 cells, use shift reordering\r\n        const isSingleColumn = gridColumns === 1;\r\n        const allCellsSimple = cellsRef.current.every(c => (c.dx || 1) === 1 && (c.dy || 1) === 1);\r\n        \r\n        if (isSingleColumn && allCellsSimple) {\r\n          // Shift-based reordering for single-column lists\r\n          const oldY = cell.y;\r\n          const newY = newGridPos.y;\r\n          \r\n          setCells(prev => {\r\n            const updated = prev.map(c => {\r\n              if (c.id === draggingCell) {\r\n                return { ...c, y: newY };\r\n              }\r\n              \r\n              if (oldY < newY) {\r\n                if (c.y > oldY && c.y <= newY) {\r\n                  return { ...c, y: c.y - 1 };\r\n                }\r\n              } else {\r\n                if (c.y >= newY && c.y < oldY) {\r\n                  return { ...c, y: c.y + 1 };\r\n                }\r\n              }\r\n              return c;\r\n            });\r\n            onChange?.(updated);\r\n            return updated;\r\n          });\r\n        } else {\r\n          // Swap-based approach for multi-column grids or complex cells\r\n          // Find if there's a cell at the target position\r\n          const targetCell = cellsRef.current.find(c => {\r\n            if (c.id === draggingCell) return false;\r\n            const cDx = c.dx || 1;\r\n            const cDy = c.dy || 1;\r\n            // Check if new position overlaps with this cell\r\n            return newGridPos.x >= c.x && newGridPos.x < c.x + cDx &&\r\n                   newGridPos.y >= c.y && newGridPos.y < c.y + cDy;\r\n          });\r\n          \r\n          setCells(prev => {\r\n            const updated = prev.map(c => {\r\n              if (c.id === draggingCell) {\r\n                // Move dragged cell to new position\r\n                return { ...c, x: newGridPos.x, y: newGridPos.y };\r\n              }\r\n              if (targetCell && c.id === targetCell.id) {\r\n                // Swap: move target cell to dragged cell's old position\r\n                return { ...c, x: cell.x, y: cell.y };\r\n              }\r\n              return c;\r\n            });\r\n            onChange?.(updated);\r\n            return updated;\r\n          });\r\n        }\r\n        onDragEnd?.(cell, newGridPos);\r\n      }\r\n      \r\n      setDraggingCell(null);\r\n    }, [draggingCell, dragPosition, getGridPositionFromPixels, gridColumns, gridRows, onChange, onDragEnd]);\r\n\r\n    // Add global mouse/touch event listeners for drag\r\n    useEffect(() => {\r\n      if (!isDraggable || !draggingCell) return;\r\n      \r\n      const handleMove = (e: MouseEvent | TouchEvent) => handleDragMove(e);\r\n      const handleUp = () => handleDragEnd();\r\n      \r\n      document.addEventListener('mousemove', handleMove);\r\n      document.addEventListener('mouseup', handleUp);\r\n      document.addEventListener('touchmove', handleMove, { passive: false });\r\n      document.addEventListener('touchend', handleUp);\r\n      \r\n      return () => {\r\n        document.removeEventListener('mousemove', handleMove);\r\n        document.removeEventListener('mouseup', handleUp);\r\n        document.removeEventListener('touchmove', handleMove);\r\n        document.removeEventListener('touchend', handleUp);\r\n      };\r\n    }, [isDraggable, draggingCell, handleDragMove, handleDragEnd]);\r\n\r\n    // Find next available position for autoplace\r\n    const findNextPosition = useCallback((): { x: number; y: number } => {\r\n      const occupied = new Set<string>();\r\n      cellsRef.current.forEach(cell => {\r\n        const dx = cell.dx || 1;\r\n        const dy = cell.dy || 1;\r\n        for (let i = 0; i < dx; i++) {\r\n          for (let j = 0; j < dy; j++) {\r\n            occupied.add(`${cell.x + i},${cell.y + j}`);\r\n          }\r\n        }\r\n      });\r\n\r\n      for (let y = 0; y < gridRows; y++) {\r\n        for (let x = 0; x < gridColumns; x++) {\r\n          if (!occupied.has(`${x},${y}`)) {\r\n            return { x, y };\r\n          }\r\n        }\r\n      }\r\n      return { x: 0, y: gridRows }; // Add below existing rows\r\n    }, [gridColumns, gridRows]);\r\n\r\n    // Imperative methods\r\n    useImperativeHandle(ref, () => ({\r\n      addView: (cell: AvakioGridCell, index?: number) => {\r\n        const newCell = autoplace && (cell.x === undefined || cell.y === undefined)\r\n          ? { ...cell, ...findNextPosition() }\r\n          : cell;\r\n        \r\n        setCells(prev => {\r\n          const updated = index !== undefined\r\n            ? [...prev.slice(0, index), newCell, ...prev.slice(index)]\r\n            : [...prev, newCell];\r\n          onChange?.(updated);\r\n          return updated;\r\n        });\r\n      },\r\n\r\n      removeView: (cellId: string) => {\r\n        setCells(prev => {\r\n          const updated = prev.filter(c => c.id !== cellId);\r\n          onChange?.(updated);\r\n          return updated;\r\n        });\r\n      },\r\n\r\n      moveView: (cellId: string, position: { x?: number; y?: number; dx?: number; dy?: number }) => {\r\n        setCells(prev => {\r\n          const updated = prev.map(c => {\r\n            if (c.id === cellId) {\r\n              return {\r\n                ...c,\r\n                x: position.x ?? c.x,\r\n                y: position.y ?? c.y,\r\n                dx: position.dx ?? c.dx,\r\n                dy: position.dy ?? c.dy,\r\n              };\r\n            }\r\n            return c;\r\n          });\r\n          onChange?.(updated);\r\n          return updated;\r\n        });\r\n      },\r\n\r\n      clearAll: () => {\r\n        setCells([]);\r\n        onChange?.([]);\r\n      },\r\n\r\n      getCells: () => cellsRef.current,\r\n\r\n      getCell: (cellId: string) => cellsRef.current.find(c => c.id === cellId),\r\n\r\n      serialize: () => cellsRef.current.map(({ id, x, y, dx, dy, data }) => ({ \r\n        id, x, y, dx: dx || 1, dy: dy || 1, data \r\n      })),\r\n\r\n      restore: (newCells: AvakioGridCell[]) => {\r\n        setCells(newCells);\r\n        onChange?.(newCells);\r\n      },\r\n\r\n      reconstruct: () => {\r\n        setCells([...cellsRef.current]);\r\n      },\r\n\r\n      show: () => setIsHidden(false),\r\n\r\n      hide: () => setIsHidden(true),\r\n\r\n      getNode: () => containerRef.current,\r\n    }));\r\n\r\n    // Build class names\r\n    const containerClasses = [\r\n      'avakio-grid',\r\n      `avakio-grid-theme-${theme}`,\r\n      borderless ? 'avakio-grid-borderless' : '',\r\n      cellBorderless ? 'avakio-grid-cell-borderless' : '',\r\n      isHidden ? 'avakio-grid-hidden' : '',\r\n      disabled ? 'avakio-grid-disabled' : '',\r\n      isDraggable ? 'avakio-grid-draggable' : '',\r\n      draggingCell ? 'avakio-grid-dragging' : '',\r\n      className,\r\n    ].filter(Boolean).join(' ');\r\n\r\n    // Calculate width accounting for margin\r\n    const calculateWidth = () => {\r\n      if (width === undefined) return undefined;\r\n      if (typeof width === 'number') return `${width}px`;\r\n      // If width is '100%' and margin is set, use calc to subtract margin\r\n      if (width === '100%' && margin !== undefined) {\r\n        const marginValue = typeof margin === 'number' ? margin * 2 : 0;\r\n        return marginValue > 0 ? `calc(100% - ${marginValue}px)` : '100%';\r\n      }\r\n      return width;\r\n    };\r\n\r\n    // Build container styles\r\n    const containerStyles: React.CSSProperties = {\r\n      position: 'relative',\r\n      width: calculateWidth(),\r\n      height: typeof height === 'number' ? `${height}px` : height,\r\n      minWidth: typeof minWidth === 'number' ? `${minWidth}px` : minWidth,\r\n      minHeight: typeof minHeight === 'number' ? `${minHeight}px` : minHeight,\r\n      margin: margin !== undefined ? (typeof margin === 'number' ? `${margin}px` : margin) : undefined,\r\n      ...(css && typeof css === 'object' && !Array.isArray(css) ? css : {}),\r\n    };\r\n\r\n    return (\r\n      <div\r\n        ref={containerRef}\r\n        id={id}\r\n        data-testid={testId}\r\n        className={containerClasses}\r\n        style={containerStyles}\r\n      >\r\n        {cells.map(cell => {\r\n          if (cell.hidden) return null;\r\n\r\n          const isDragging = draggingCell === cell.id;\r\n          const cellClasses = [\r\n            'avakio-grid-cell',\r\n            cell.cssClass || '',\r\n            cell.disabled ? 'avakio-grid-cell-disabled' : '',\r\n            isDraggable && !cell.disabled && cell.draggable !== false ? 'avakio-grid-cell-draggable' : '',\r\n            isDragging ? 'avakio-grid-cell-dragging' : '',\r\n          ].filter(Boolean).join(' ');\r\n\r\n          // Use drag position if this cell is being dragged\r\n          const cellStyle = isDragging\r\n            ? { ...getCellStyle(cell), left: `${dragPosition.x}px`, top: `${dragPosition.y}px`, zIndex: 1000 }\r\n            : getCellStyle(cell);\r\n\r\n          return (\r\n            <div\r\n              key={cell.id}\r\n              id={cell.id}\r\n              className={cellClasses}\r\n              style={cellStyle}\r\n              onClick={() => !isDragging && onCellClick?.(cell)}\r\n              onMouseDown={(e) => handleDragStart(e, cell)}\r\n              onTouchStart={(e) => handleDragStart(e, cell)}\r\n              data-cell-id={cell.id}\r\n            >\r\n              <div className=\"avakio-grid-cell-content\">\r\n                {renderCellContent(cell)}\r\n              </div>\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nAvakioGrid.displayName = 'AvakioGrid';\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useRef, useEffect, useState, useCallback } from 'react';\r\nimport './avakio-layout.css';\r\n\r\nexport type AvakioLayoutType = 'space' | 'wide' | 'clean' | 'line' | 'head' | 'material';\r\n\r\nexport interface AvakioLayoutProps {\r\n  /** Array of child views arranged vertically */\r\n  rows?: React.ReactNode[];\r\n  \r\n  /** Array of child views arranged horizontally */\r\n  cols?: React.ReactNode[];\r\n  \r\n  /** Direct children (alternative to rows/cols) */\r\n  children?: React.ReactNode;\r\n  \r\n  /** Theme to apply */\r\n  theme?: 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\n  \r\n  /** Custom CSS class name */\r\n  className?: string;\r\n  \r\n  /** Custom CSS styles object */\r\n  css?: React.CSSProperties;\r\n  \r\n  /** Width of the layout */\r\n  width?: number | string;\r\n  \r\n  /** Height of the layout */\r\n  height?: number | string;\r\n  \r\n  /** Minimum width */\r\n  minWidth?: number | string;\r\n  \r\n  /** Minimum height */\r\n  minHeight?: number | string;\r\n  \r\n  /** Maximum width */\r\n  maxWidth?: number | string;\r\n  \r\n  /** Maximum height */\r\n  maxHeight?: number | string;\r\n  \r\n  /** Whether to remove borders */\r\n  borderless?: boolean;\r\n  \r\n  /** Layout type (defines border style) */\r\n  type?: AvakioLayoutType;\r\n  \r\n  /** Padding around content - can be a number (all sides), string, or array [top, right, bottom, left] */\r\n  padding?: number | string | [number, number, number, number];\r\n  \r\n  /** Padding on X axis (left and right) */\r\n  paddingX?: number | string;\r\n  \r\n  /** Padding on Y axis (top and bottom) */\r\n  paddingY?: number | string;\r\n  \r\n  /** Margin around layout */\r\n  margin?: number | string;\r\n  \r\n  /** Layout gravity for flexible sizing */\r\n  gravity?: number;\r\n  \r\n  /** Whether the layout is initially hidden */\r\n  hidden?: boolean;\r\n  \r\n  /** Whether the layout is disabled */\r\n  disabled?: boolean;\r\n  \r\n  /** Enable responsive behavior */\r\n  responsive?: boolean | string;\r\n  \r\n  /** ID of the layout */\r\n  id?: string;\r\n  \r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n  \r\n  /** Gap between items (CSS gap property) */\r\n  gap?: number | string;\r\n  \r\n  /** Alignment of items */\r\n  align?: 'start' | 'center' | 'end' | 'stretch';\r\n  \r\n  /** Justify content */\r\n  justify?: 'start' | 'center' | 'end' | 'space-between' | 'space-around' | 'space-evenly';\r\n  \r\n  /** Callback when window is resized (for responsive layouts) */\r\n  onResize?: () => void;\r\n  \r\n  /** Enable auto-resize observer */\r\n  autoResize?: boolean;\r\n}\r\n\r\nexport function AvakioLayout({\r\n  rows,\r\n  cols,\r\n  children,\r\n  theme = 'material',\r\n  className = '',\r\n  css,\r\n  width,\r\n  height,\r\n  minWidth,\r\n  minHeight,\r\n  maxWidth,\r\n  maxHeight,\r\n  borderless = false,\r\n  type = 'space',\r\n  padding,\r\n  paddingX,\r\n  paddingY,\r\n  margin,\r\n  gravity,\r\n  hidden = false,\r\n  disabled = false,\r\n  responsive = false,\r\n  id,\r\n  testId,\r\n  gap,\r\n  align = 'stretch',\r\n  justify = 'start',\r\n  onResize,\r\n  autoResize = false,\r\n}: AvakioLayoutProps) {\r\n  const layoutRef = useRef<HTMLDivElement>(null);\r\n  const [responsiveMode, setResponsiveMode] = useState(false);\r\n  \r\n  const isRows = !!rows || (!cols && !rows);\r\n  const items = rows || cols || [];\r\n\r\n  // Handle responsive behavior\r\n  const checkResponsive = useCallback(() => {\r\n    if (!responsive || !layoutRef.current) return;\r\n    \r\n    const container = layoutRef.current;\r\n    const containerWidth = container.offsetWidth;\r\n    \r\n    // Switch to vertical layout if width is less than 768px\r\n    if (containerWidth < 768 && !isRows) {\r\n      setResponsiveMode(true);\r\n    } else {\r\n      setResponsiveMode(false);\r\n    }\r\n    \r\n    if (onResize) {\r\n      onResize();\r\n    }\r\n  }, [responsive, isRows, onResize]);\r\n\r\n  // Window resize observer\r\n  useEffect(() => {\r\n    if (!responsive && !autoResize) return;\r\n\r\n    checkResponsive();\r\n    \r\n    const handleResize = () => {\r\n      checkResponsive();\r\n    };\r\n\r\n    window.addEventListener('resize', handleResize);\r\n    \r\n    return () => {\r\n      window.removeEventListener('resize', handleResize);\r\n    };\r\n  }, [responsive, autoResize, checkResponsive]);\r\n\r\n  // ResizeObserver for container size changes\r\n  useEffect(() => {\r\n    if (!autoResize || !layoutRef.current) return;\r\n\r\n    const resizeObserver = new ResizeObserver(() => {\r\n      checkResponsive();\r\n    });\r\n\r\n    resizeObserver.observe(layoutRef.current);\r\n\r\n    return () => {\r\n      resizeObserver.disconnect();\r\n    };\r\n  }, [autoResize, checkResponsive]);\r\n  \r\n  const layoutClasses = [\r\n    'avakio-layout',\r\n    `avakio-layout-theme-${theme}`,\r\n    `avakio-layout-type-${type}`,\r\n    (isRows || responsiveMode) ? 'avakio-layout-rows' : 'avakio-layout-cols',\r\n    borderless ? 'avakio-layout-borderless' : '',\r\n    disabled ? 'avakio-layout-disabled' : '',\r\n    hidden ? 'avakio-layout-hidden' : '',\r\n    responsive ? 'avakio-layout-responsive' : '',\r\n    responsiveMode ? 'avakio-layout-responsive-active' : '',\r\n    className,\r\n  ].filter(Boolean).join(' ');\r\n\r\n  const layoutStyles: React.CSSProperties = {\r\n    width: typeof width === 'number' ? `${width}px` : width,\r\n    height: typeof height === 'number' ? `${height}px` : height,\r\n    minWidth: typeof minWidth === 'number' ? `${minWidth}px` : minWidth,\r\n    minHeight: typeof minHeight === 'number' ? `${minHeight}px` : minHeight,\r\n    maxWidth: typeof maxWidth === 'number' ? `${maxWidth}px` : maxWidth,\r\n    maxHeight: typeof maxHeight === 'number' ? `${maxHeight}px` : maxHeight,\r\n    margin: typeof margin === 'number' ? `${margin}px` : margin,\r\n    gap: typeof gap === 'number' ? `${gap}px` : gap,\r\n    alignItems: align,\r\n    justifyContent: justify,\r\n    flex: gravity,\r\n    ...(css && typeof css === 'object' && !Array.isArray(css) ? css : {}),\r\n  };\r\n\r\n  // Handle padding\r\n  if (padding !== undefined) {\r\n    layoutStyles.padding = Array.isArray(padding) \r\n      ? `${padding[0]}px ${padding[1]}px ${padding[2]}px ${padding[3]}px`\r\n      : typeof padding === 'number' ? `${padding}px` : padding;\r\n  } else {\r\n    if (paddingX !== undefined) {\r\n      layoutStyles.paddingLeft = typeof paddingX === 'number' ? `${paddingX}px` : paddingX;\r\n      layoutStyles.paddingRight = typeof paddingX === 'number' ? `${paddingX}px` : paddingX;\r\n    }\r\n    if (paddingY !== undefined) {\r\n      layoutStyles.paddingTop = typeof paddingY === 'number' ? `${paddingY}px` : paddingY;\r\n      layoutStyles.paddingBottom = typeof paddingY === 'number' ? `${paddingY}px` : paddingY;\r\n    }\r\n  }\r\n\r\n  // Helper to check if a child element should flex\r\n  const shouldItemFlex = (item: React.ReactNode): boolean => {\r\n    if (!React.isValidElement(item)) return false;\r\n    const props = item.props as Record<string, unknown>;\r\n    // Check for flex in css prop or gravity prop\r\n    if (props.gravity) return true;\r\n    if (props.css && typeof props.css === 'object') {\r\n      const css = props.css as Record<string, unknown>;\r\n      if (css.flex === 1 || css.flex === '1') return true;\r\n    }\r\n    return false;\r\n  };\r\n\r\n  return (\r\n    <div\r\n      ref={layoutRef}\r\n      id={id}\r\n      data-testid={testId}\r\n      className={layoutClasses}\r\n      style={layoutStyles}\r\n    >\r\n      {items.length > 0\r\n        ? items.map((item, index) => {\r\n            const itemClasses = ['avakio-layout-item'];\r\n            if (shouldItemFlex(item)) {\r\n              itemClasses.push('avakio-layout-item-flex');\r\n            }\r\n            return (\r\n              <div key={index} className={itemClasses.join(' ')}>\r\n                {item}\r\n              </div>\r\n            );\r\n          })\r\n        : children}\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useRef, useState, useEffect } from 'react';\r\nimport './avakio-resizer.css';\r\n\r\nexport interface AvakioResizerProps {\r\n  /** Direction of the resizer: horizontal for row separation, vertical for column separation */\r\n  direction: 'horizontal' | 'vertical';\r\n  /** Theme to apply */\r\n  theme?: 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\n  /** Callback when resize starts */\r\n  onResizeStart?: () => void;\r\n  /** Callback during resize with delta value */\r\n  onResize?: (delta: number) => void;\r\n  /** Callback when resize ends */\r\n  onResizeEnd?: () => void;\r\n  /** Additional CSS classes */\r\n  className?: string;\r\n  /** Inline styles */\r\n  css?: React.CSSProperties;\r\n  /** ID of the component */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n}\r\n\r\n/**\r\n * AvakioResizer - A draggable resizer component for adjusting panel sizes\r\n * \r\n * Place between layout items to create resizable panels:\r\n * - Use direction=\"vertical\" between columns (horizontal drag)\r\n * - Use direction=\"horizontal\" between rows (vertical drag)\r\n * \r\n * @example\r\n * ```tsx\r\n * <AvakioLayout cols={[\r\n *   <div style={{ width: `${width}px` }}>Panel 1</div>,\r\n *   <AvakioResizer \r\n *     direction=\"vertical\" \r\n *     onResize={(delta) => setWidth(prev => prev + delta)} \r\n *   />,\r\n *   <div style={{ flex: 1 }}>Panel 2</div>\r\n * ]} />\r\n * ```\r\n */\r\nexport function AvakioResizer({\r\n  direction,\r\n  theme = 'material',\r\n  onResizeStart,\r\n  onResize,\r\n  onResizeEnd,\r\n  className = '',\r\n  css,\r\n  id,\r\n  testId,\r\n}: AvakioResizerProps) {\r\n  const resizerRef = useRef<HTMLDivElement>(null);\r\n  const startPosRef = useRef<number>(0);\r\n  const [isDragging, setIsDragging] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (!isDragging) return;\r\n\r\n    const handleMouseMove = (e: MouseEvent) => {\r\n      e.preventDefault();\r\n      \r\n      // Calculate delta based on direction\r\n      const currentPos = direction === 'horizontal' ? e.clientY : e.clientX;\r\n      const delta = currentPos - startPosRef.current;\r\n      \r\n      if (onResize) {\r\n        onResize(delta);\r\n      }\r\n      \r\n      // Update start position for next delta calculation\r\n      startPosRef.current = currentPos;\r\n    };\r\n\r\n    const handleMouseUp = () => {\r\n      setIsDragging(false);\r\n      document.body.style.cursor = '';\r\n      document.body.style.userSelect = '';\r\n      \r\n      if (onResizeEnd) {\r\n        onResizeEnd();\r\n      }\r\n    };\r\n\r\n    document.addEventListener('mousemove', handleMouseMove);\r\n    document.addEventListener('mouseup', handleMouseUp);\r\n\r\n    return () => {\r\n      document.removeEventListener('mousemove', handleMouseMove);\r\n      document.removeEventListener('mouseup', handleMouseUp);\r\n    };\r\n  }, [isDragging, direction, onResize, onResizeEnd]);\r\n\r\n  const handleMouseDown = (e: React.MouseEvent) => {\r\n    e.preventDefault();\r\n    \r\n    // Set initial position\r\n    startPosRef.current = direction === 'horizontal' ? e.clientY : e.clientX;\r\n    setIsDragging(true);\r\n    \r\n    // Set cursor for the entire document\r\n    document.body.style.cursor = direction === 'horizontal' ? 'row-resize' : 'col-resize';\r\n    document.body.style.userSelect = 'none';\r\n    \r\n    if (onResizeStart) {\r\n      onResizeStart();\r\n    }\r\n  };\r\n\r\n  const classes = [\r\n    'avakio-resizer',\r\n    `avakio-resizer-${direction}`,\r\n    `avakio-resizer-theme-${theme}`,\r\n    isDragging ? 'avakio-resizer-dragging' : '',\r\n    className,\r\n  ]\r\n    .filter(Boolean)\r\n    .join(' ');\r\n\r\n  return (\r\n    <div\r\n      ref={resizerRef}\r\n      id={id}\r\n      data-testid={testId}\r\n      className={classes}\r\n      data-admin-theme={theme}\r\n      onMouseDown={handleMouseDown}\r\n      style={css}\r\n      role=\"separator\"\r\n      aria-orientation={direction === 'horizontal' ? 'horizontal' : 'vertical'}\r\n      aria-label=\"Resizer\"\r\n    >\r\n      <div className=\"avakio-resizer-handle\" />\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useState, useRef, useCallback, useMemo } from 'react';\r\nimport { ChevronRight, ChevronLeft, ChevronsRight, ChevronsLeft, Search, GripVertical } from 'lucide-react';\r\nimport { cn } from '@/lib/utils';\r\nimport './avakio-doublelist.css';\r\n\r\nexport interface AvakioDoubleListItem {\r\n  id: string;\r\n  value: string;\r\n  disabled?: boolean;\r\n}\r\n\r\nexport interface AvakioDoubleListProps {\r\n  /** Array of all available items */\r\n  data: AvakioDoubleListItem[];\r\n  /** Array of selected item IDs (items in the right list) */\r\n  value: string[];\r\n  /** Callback when selection changes */\r\n  onChange: (selectedIds: string[]) => void;\r\n  /** Label for the left list */\r\n  labelLeft?: string;\r\n  /** Label for the right list */\r\n  labelRight?: string;\r\n  /** Label at the bottom of the left list */\r\n  labelBottomLeft?: string;\r\n  /** Label at the bottom of the right list */\r\n  labelBottomRight?: string;\r\n  /** Whether to show the control buttons between lists */\r\n  showButtons?: boolean;\r\n  /** Whether to enable search/filter in lists */\r\n  searchable?: boolean;\r\n  /** Whether to enable drag and drop */\r\n  draggable?: boolean;\r\n  /** Whether the component is disabled */\r\n  disabled?: boolean;\r\n  /** Custom height for the lists */\r\n  listHeight?: number | string;\r\n  /** Unique ID for the component */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n  /** Custom class name */\r\n  className?: string;\r\n}\r\n\r\nexport function AvakioDoubleList({\r\n  data,\r\n  value = [],\r\n  onChange,\r\n  labelLeft = \"Available\",\r\n  labelRight = \"Selected\",\r\n  labelBottomLeft,\r\n  labelBottomRight,\r\n  showButtons = true,\r\n  searchable = true,\r\n  draggable = true,\r\n  disabled = false,\r\n  listHeight = 300,\r\n  id,\r\n  testId,\r\n  className,\r\n}: AvakioDoubleListProps) {\r\n  const [leftSearch, setLeftSearch] = useState('');\r\n  const [rightSearch, setRightSearch] = useState('');\r\n  const [leftSelection, setLeftSelection] = useState<string[]>([]);\r\n  const [rightSelection, setRightSelection] = useState<string[]>([]);\r\n  const [draggedItem, setDraggedItem] = useState<string | null>(null);\r\n  const [dragOverSide, setDragOverSide] = useState<'left' | 'right' | null>(null);\r\n\r\n  const leftListRef = useRef<HTMLDivElement>(null);\r\n  const rightListRef = useRef<HTMLDivElement>(null);\r\n\r\n  // Compute left and right lists\r\n  const selectedSet = useMemo(() => new Set(value), [value]);\r\n  \r\n  const leftItems = useMemo(() => \r\n    data.filter(item => !selectedSet.has(item.id)),\r\n    [data, selectedSet]\r\n  );\r\n  \r\n  const rightItems = useMemo(() => \r\n    data.filter(item => selectedSet.has(item.id)),\r\n    [data, selectedSet]\r\n  );\r\n\r\n  // Filter items based on search\r\n  const filteredLeftItems = useMemo(() => {\r\n    if (!leftSearch.trim()) return leftItems;\r\n    const search = leftSearch.toLowerCase();\r\n    return leftItems.filter(item => item.value.toLowerCase().includes(search));\r\n  }, [leftItems, leftSearch]);\r\n\r\n  const filteredRightItems = useMemo(() => {\r\n    if (!rightSearch.trim()) return rightItems;\r\n    const search = rightSearch.toLowerCase();\r\n    return rightItems.filter(item => item.value.toLowerCase().includes(search));\r\n  }, [rightItems, rightSearch]);\r\n\r\n  // Move items to right (select)\r\n  const moveToRight = useCallback((ids: string[]) => {\r\n    const validIds = ids.filter(id => {\r\n      const item = data.find(d => d.id === id);\r\n      return item && !item.disabled && !selectedSet.has(id);\r\n    });\r\n    if (validIds.length > 0) {\r\n      onChange([...value, ...validIds]);\r\n      setLeftSelection([]);\r\n    }\r\n  }, [data, selectedSet, value, onChange]);\r\n\r\n  // Move items to left (deselect)\r\n  const moveToLeft = useCallback((ids: string[]) => {\r\n    const idsToRemove = new Set(ids.filter(id => {\r\n      const item = data.find(d => d.id === id);\r\n      return item && !item.disabled;\r\n    }));\r\n    if (idsToRemove.size > 0) {\r\n      onChange(value.filter(id => !idsToRemove.has(id)));\r\n      setRightSelection([]);\r\n    }\r\n  }, [data, value, onChange]);\r\n\r\n  // Move all to right\r\n  const moveAllToRight = useCallback(() => {\r\n    const newIds = leftItems\r\n      .filter(item => !item.disabled)\r\n      .map(item => item.id);\r\n    onChange([...value, ...newIds]);\r\n    setLeftSelection([]);\r\n  }, [leftItems, value, onChange]);\r\n\r\n  // Move all to left\r\n  const moveAllToLeft = useCallback(() => {\r\n    const disabledIds = rightItems\r\n      .filter(item => item.disabled)\r\n      .map(item => item.id);\r\n    onChange(disabledIds);\r\n    setRightSelection([]);\r\n  }, [rightItems, onChange]);\r\n\r\n  // Handle item click with multi-select support\r\n  const handleItemClick = useCallback((\r\n    itemId: string,\r\n    side: 'left' | 'right',\r\n    event: React.MouseEvent\r\n  ) => {\r\n    const item = data.find(d => d.id === itemId);\r\n    if (!item || item.disabled || disabled) return;\r\n\r\n    const setSelection = side === 'left' ? setLeftSelection : setRightSelection;\r\n    const selection = side === 'left' ? leftSelection : rightSelection;\r\n\r\n    if (event.ctrlKey || event.metaKey) {\r\n      // Toggle single item\r\n      setSelection(prev =>\r\n        prev.includes(itemId)\r\n          ? prev.filter(id => id !== itemId)\r\n          : [...prev, itemId]\r\n      );\r\n    } else if (event.shiftKey && selection.length > 0) {\r\n      // Range selection\r\n      const items = side === 'left' ? filteredLeftItems : filteredRightItems;\r\n      const lastSelected = selection[selection.length - 1];\r\n      const lastIndex = items.findIndex(i => i.id === lastSelected);\r\n      const currentIndex = items.findIndex(i => i.id === itemId);\r\n      \r\n      if (lastIndex !== -1 && currentIndex !== -1) {\r\n        const start = Math.min(lastIndex, currentIndex);\r\n        const end = Math.max(lastIndex, currentIndex);\r\n        const rangeIds = items\r\n          .slice(start, end + 1)\r\n          .filter(i => !i.disabled)\r\n          .map(i => i.id);\r\n        setSelection(rangeIds);\r\n      }\r\n    } else {\r\n      // Single selection\r\n      setSelection([itemId]);\r\n    }\r\n  }, [data, disabled, leftSelection, rightSelection, filteredLeftItems, filteredRightItems]);\r\n\r\n  // Handle double-click to move item\r\n  const handleItemDoubleClick = useCallback((itemId: string, side: 'left' | 'right') => {\r\n    if (disabled) return;\r\n    if (side === 'left') {\r\n      moveToRight([itemId]);\r\n    } else {\r\n      moveToLeft([itemId]);\r\n    }\r\n  }, [disabled, moveToRight, moveToLeft]);\r\n\r\n  // Drag and drop handlers\r\n  const handleDragStart = useCallback((e: React.DragEvent, itemId: string) => {\r\n    if (!draggable || disabled) return;\r\n    e.dataTransfer.setData('text/plain', itemId);\r\n    e.dataTransfer.effectAllowed = 'move';\r\n    setDraggedItem(itemId);\r\n  }, [draggable, disabled]);\r\n\r\n  const handleDragEnd = useCallback(() => {\r\n    setDraggedItem(null);\r\n    setDragOverSide(null);\r\n  }, []);\r\n\r\n  const handleDragOver = useCallback((e: React.DragEvent, side: 'left' | 'right') => {\r\n    if (!draggable || disabled) return;\r\n    e.preventDefault();\r\n    e.dataTransfer.dropEffect = 'move';\r\n    setDragOverSide(side);\r\n  }, [draggable, disabled]);\r\n\r\n  const handleDragLeave = useCallback(() => {\r\n    setDragOverSide(null);\r\n  }, []);\r\n\r\n  const handleDrop = useCallback((e: React.DragEvent, side: 'left' | 'right') => {\r\n    if (!draggable || disabled) return;\r\n    e.preventDefault();\r\n    const itemId = e.dataTransfer.getData('text/plain');\r\n    \r\n    if (itemId) {\r\n      const isCurrentlySelected = selectedSet.has(itemId);\r\n      \r\n      if (side === 'right' && !isCurrentlySelected) {\r\n        moveToRight([itemId]);\r\n      } else if (side === 'left' && isCurrentlySelected) {\r\n        moveToLeft([itemId]);\r\n      }\r\n    }\r\n    \r\n    setDraggedItem(null);\r\n    setDragOverSide(null);\r\n  }, [draggable, disabled, selectedSet, moveToRight, moveToLeft]);\r\n\r\n  // Render list item\r\n  const renderItem = (item: AvakioDoubleListItem, side: 'left' | 'right') => {\r\n    const selection = side === 'left' ? leftSelection : rightSelection;\r\n    const isSelected = selection.includes(item.id);\r\n    const isDragging = draggedItem === item.id;\r\n\r\n    return (\r\n      <div\r\n        key={item.id}\r\n        className={cn(\r\n          'avakio-doublelist-item',\r\n          isSelected && 'avakio-doublelist-item-selected',\r\n          item.disabled && 'avakio-doublelist-item-disabled',\r\n          isDragging && 'avakio-doublelist-item-dragging'\r\n        )}\r\n        onClick={(e) => handleItemClick(item.id, side, e)}\r\n        onDoubleClick={() => handleItemDoubleClick(item.id, side)}\r\n        draggable={draggable && !item.disabled && !disabled}\r\n        onDragStart={(e) => handleDragStart(e, item.id)}\r\n        onDragEnd={handleDragEnd}\r\n        data-item-id={item.id}\r\n      >\r\n        {draggable && !item.disabled && !disabled && (\r\n          <GripVertical size={14} className=\"avakio-doublelist-drag-handle\" />\r\n        )}\r\n        <span className=\"avakio-doublelist-item-text\">{item.value}</span>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const listStyle = { height: typeof listHeight === 'number' ? `${listHeight}px` : listHeight };\r\n\r\n  return (\r\n    <div\r\n      id={id}\r\n      data-testid={testId}\r\n      className={cn(\r\n        'avakio-doublelist',\r\n        disabled && 'avakio-doublelist-disabled',\r\n        className\r\n      )}\r\n    >\r\n      {/* Left Panel */}\r\n      <div className=\"avakio-doublelist-panel\">\r\n        {labelLeft && (\r\n          <div className=\"avakio-doublelist-label avakio-doublelist-label-top\">\r\n            {labelLeft}\r\n            <span className=\"avakio-doublelist-count\">({filteredLeftItems.length})</span>\r\n          </div>\r\n        )}\r\n        \r\n        {searchable && (\r\n          <div className=\"avakio-doublelist-search\">\r\n            <Search size={14} className=\"avakio-doublelist-search-icon\" />\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Search...\"\r\n              value={leftSearch}\r\n              onChange={(e) => setLeftSearch(e.target.value)}\r\n              disabled={disabled}\r\n              className=\"avakio-doublelist-search-input\"\r\n            />\r\n          </div>\r\n        )}\r\n        \r\n        <div\r\n          ref={leftListRef}\r\n          className={cn(\r\n            'avakio-doublelist-list',\r\n            dragOverSide === 'left' && 'avakio-doublelist-list-dragover'\r\n          )}\r\n          style={listStyle}\r\n          onDragOver={(e) => handleDragOver(e, 'left')}\r\n          onDragLeave={handleDragLeave}\r\n          onDrop={(e) => handleDrop(e, 'left')}\r\n        >\r\n          {filteredLeftItems.length === 0 ? (\r\n            <div className=\"avakio-doublelist-empty\">\r\n              {leftSearch ? 'No matches found' : 'No items available'}\r\n            </div>\r\n          ) : (\r\n            filteredLeftItems.map(item => renderItem(item, 'left'))\r\n          )}\r\n        </div>\r\n        \r\n        {labelBottomLeft && (\r\n          <div className=\"avakio-doublelist-label avakio-doublelist-label-bottom\">\r\n            {labelBottomLeft}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Buttons */}\r\n      {showButtons && (\r\n        <div className=\"avakio-doublelist-buttons\">\r\n          <button\r\n            type=\"button\"\r\n            className=\"avakio-doublelist-btn\"\r\n            onClick={() => moveToRight(leftSelection)}\r\n            disabled={disabled || leftSelection.length === 0}\r\n            title=\"Move selected to right\"\r\n          >\r\n            <ChevronRight size={18} />\r\n          </button>\r\n          <button\r\n            type=\"button\"\r\n            className=\"avakio-doublelist-btn\"\r\n            onClick={moveAllToRight}\r\n            disabled={disabled || leftItems.filter(i => !i.disabled).length === 0}\r\n            title=\"Move all to right\"\r\n          >\r\n            <ChevronsRight size={18} />\r\n          </button>\r\n          <button\r\n            type=\"button\"\r\n            className=\"avakio-doublelist-btn\"\r\n            onClick={() => moveToLeft(rightSelection)}\r\n            disabled={disabled || rightSelection.length === 0}\r\n            title=\"Move selected to left\"\r\n          >\r\n            <ChevronLeft size={18} />\r\n          </button>\r\n          <button\r\n            type=\"button\"\r\n            className=\"avakio-doublelist-btn\"\r\n            onClick={moveAllToLeft}\r\n            disabled={disabled || rightItems.filter(i => !i.disabled).length === 0}\r\n            title=\"Move all to left\"\r\n          >\r\n            <ChevronsLeft size={18} />\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {/* Right Panel */}\r\n      <div className=\"avakio-doublelist-panel\">\r\n        {labelRight && (\r\n          <div className=\"avakio-doublelist-label avakio-doublelist-label-top\">\r\n            {labelRight}\r\n            <span className=\"avakio-doublelist-count\">({filteredRightItems.length})</span>\r\n          </div>\r\n        )}\r\n        \r\n        {searchable && (\r\n          <div className=\"avakio-doublelist-search\">\r\n            <Search size={14} className=\"avakio-doublelist-search-icon\" />\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Search...\"\r\n              value={rightSearch}\r\n              onChange={(e) => setRightSearch(e.target.value)}\r\n              disabled={disabled}\r\n              className=\"avakio-doublelist-search-input\"\r\n            />\r\n          </div>\r\n        )}\r\n        \r\n        <div\r\n          ref={rightListRef}\r\n          className={cn(\r\n            'avakio-doublelist-list',\r\n            dragOverSide === 'right' && 'avakio-doublelist-list-dragover'\r\n          )}\r\n          style={listStyle}\r\n          onDragOver={(e) => handleDragOver(e, 'right')}\r\n          onDragLeave={handleDragLeave}\r\n          onDrop={(e) => handleDrop(e, 'right')}\r\n        >\r\n          {filteredRightItems.length === 0 ? (\r\n            <div className=\"avakio-doublelist-empty\">\r\n              {rightSearch ? 'No matches found' : 'No items selected'}\r\n            </div>\r\n          ) : (\r\n            filteredRightItems.map(item => renderItem(item, 'right'))\r\n          )}\r\n        </div>\r\n        \r\n        {labelBottomRight && (\r\n          <div className=\"avakio-doublelist-label avakio-doublelist-label-bottom\">\r\n            {labelBottomRight}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default AvakioDoubleList;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { forwardRef, useImperativeHandle, useRef, useState, useEffect, ReactNode } from 'react';\r\nimport './avakio-fieldset.css';\r\n\r\nexport type AvakioFieldsetTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\n\r\nexport interface AvakioFieldsetProps {\r\n  /** Unique identifier */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n  /** Legend/label text for the fieldset */\r\n  label?: string;\r\n  /** Body content of the fieldset */\r\n  children?: ReactNode;\r\n  /** Whether to hide borders */\r\n  borderless?: boolean;\r\n  /** Theme variant */\r\n  theme?: AvakioFieldsetTheme;\r\n  /** Disabled state - dims the fieldset */\r\n  disabled?: boolean;\r\n  /** Width of the fieldset */\r\n  width?: number | string;\r\n  /** Height of the fieldset */\r\n  height?: number | string;\r\n  /** Horizontal padding (left and right) */\r\n  paddingX?: number;\r\n  /** Vertical padding (top and bottom) */\r\n  paddingY?: number;\r\n  /** Custom CSS styles */\r\n  css?: React.CSSProperties;\r\n  /** Additional CSS class name */\r\n  className?: string;\r\n  /** Whether the fieldset is collapsible */\r\n  collapsible?: boolean;\r\n  /** Default collapsed state (only if collapsible) */\r\n  defaultCollapsed?: boolean;\r\n  /** Controlled collapsed state */\r\n  collapsed?: boolean;\r\n  /** Callback when collapsed state changes */\r\n  onCollapse?: (collapsed: boolean) => void;\r\n  /** Icon to display before the label */\r\n  icon?: ReactNode;\r\n}\r\n\r\nexport interface AvakioFieldsetRef {\r\n  /** Get the fieldset DOM node */\r\n  getNode: () => HTMLFieldSetElement | null;\r\n  /** Get the body container */\r\n  getBody: () => HTMLDivElement | null;\r\n  /** Check if fieldset is enabled */\r\n  isEnabled: () => boolean;\r\n  /** Enable the fieldset */\r\n  enable: () => void;\r\n  /** Disable the fieldset */\r\n  disable: () => void;\r\n  /** Collapse the fieldset (if collapsible) */\r\n  collapse: () => void;\r\n  /** Expand the fieldset (if collapsible) */\r\n  expand: () => void;\r\n  /** Check if collapsed */\r\n  isCollapsed: () => boolean;\r\n  /** Toggle collapsed state */\r\n  toggle: () => void;\r\n}\r\n\r\nexport const AvakioFieldset = forwardRef<AvakioFieldsetRef, AvakioFieldsetProps>(\r\n  (\r\n    {\r\n      id,\r\n      testId,\r\n      label,\r\n      children,\r\n      borderless = false,\r\n      theme,\r\n      disabled: disabledProp = false,\r\n      width,\r\n      height,\r\n      paddingX = 18,\r\n      paddingY = 16,\r\n      css,\r\n      className = '',\r\n      collapsible = false,\r\n      defaultCollapsed = false,\r\n      collapsed: collapsedProp,\r\n      onCollapse,\r\n      icon,\r\n    },\r\n    ref\r\n  ) => {\r\n    const fieldsetRef = useRef<HTMLFieldSetElement>(null);\r\n    const bodyRef = useRef<HTMLDivElement>(null);\r\n    \r\n    const [disabled, setDisabled] = useState(disabledProp);\r\n    const isControlledCollapse = collapsedProp !== undefined;\r\n    const [internalCollapsed, setInternalCollapsed] = useState(defaultCollapsed);\r\n    \r\n    const isCollapsed = isControlledCollapse ? collapsedProp : internalCollapsed;\r\n\r\n    // Sync disabled prop\r\n    useEffect(() => {\r\n      setDisabled(disabledProp);\r\n    }, [disabledProp]);\r\n\r\n    // Handle collapse toggle\r\n    const handleCollapseToggle = () => {\r\n      if (!collapsible) return;\r\n      \r\n      const newCollapsed = !isCollapsed;\r\n      if (!isControlledCollapse) {\r\n        setInternalCollapsed(newCollapsed);\r\n      }\r\n      onCollapse?.(newCollapsed);\r\n    };\r\n\r\n    // Expose imperative methods\r\n    useImperativeHandle(ref, () => ({\r\n      getNode: () => fieldsetRef.current,\r\n      getBody: () => bodyRef.current,\r\n      isEnabled: () => !disabled,\r\n      enable: () => setDisabled(false),\r\n      disable: () => setDisabled(true),\r\n      collapse: () => {\r\n        if (!collapsible) return;\r\n        if (!isControlledCollapse) {\r\n          setInternalCollapsed(true);\r\n        }\r\n        onCollapse?.(true);\r\n      },\r\n      expand: () => {\r\n        if (!collapsible) return;\r\n        if (!isControlledCollapse) {\r\n          setInternalCollapsed(false);\r\n        }\r\n        onCollapse?.(false);\r\n      },\r\n      isCollapsed: () => isCollapsed,\r\n      toggle: () => handleCollapseToggle(),\r\n    }), [disabled, isCollapsed, isControlledCollapse, collapsible, onCollapse]);\r\n\r\n    // Build class names\r\n    const containerClassNames = [\r\n      'avakio-fieldset',\r\n      theme && `avakio-fieldset-theme-${theme}`,\r\n      borderless && 'avakio-fieldset-borderless',\r\n      disabled && 'avakio-fieldset-disabled',\r\n      collapsible && 'avakio-fieldset-collapsible',\r\n      isCollapsed && 'avakio-fieldset-collapsed',\r\n      className,\r\n    ]\r\n      .filter(Boolean)\r\n      .join(' ');\r\n\r\n    // Build styles\r\n    const containerStyles: React.CSSProperties = {\r\n      ...(css && typeof css === 'object' && !Array.isArray(css) ? css : {}),\r\n      width: typeof width === 'number' ? `${width}px` : width,\r\n      height: typeof height === 'number' ? `${height}px` : height,\r\n    };\r\n\r\n    const bodyStyles: React.CSSProperties = {\r\n      paddingLeft: `${paddingX}px`,\r\n      paddingRight: `${paddingX}px`,\r\n      paddingTop: `${paddingY}px`,\r\n      paddingBottom: `${paddingY}px`,\r\n    };\r\n\r\n    return (\r\n      <fieldset\r\n        ref={fieldsetRef}\r\n        id={id}\r\n        data-testid={testId}\r\n        data-admin-theme={theme}\r\n        className={containerClassNames}\r\n        style={containerStyles}\r\n        disabled={disabled}\r\n      >\r\n        {label && (\r\n          <legend \r\n            className={`avakio-fieldset-legend ${collapsible ? 'avakio-fieldset-legend-clickable' : ''}`}\r\n            onClick={collapsible ? handleCollapseToggle : undefined}\r\n          >\r\n            {collapsible && (\r\n              <span className=\"avakio-fieldset-collapse-icon\">\r\n                <svg \r\n                  width=\"12\" \r\n                  height=\"12\" \r\n                  viewBox=\"0 0 12 12\" \r\n                  fill=\"none\" \r\n                  xmlns=\"http://www.w3.org/2000/svg\"\r\n                  className={`avakio-fieldset-chevron ${isCollapsed ? 'avakio-fieldset-chevron-collapsed' : ''}`}\r\n                >\r\n                  <path \r\n                    d=\"M3 4.5L6 7.5L9 4.5\" \r\n                    stroke=\"currentColor\" \r\n                    strokeWidth=\"1.5\" \r\n                    strokeLinecap=\"round\" \r\n                    strokeLinejoin=\"round\"\r\n                  />\r\n                </svg>\r\n              </span>\r\n            )}\r\n            {icon && <span className=\"avakio-fieldset-icon\">{icon}</span>}\r\n            <span className=\"avakio-fieldset-label-text\">{label}</span>\r\n          </legend>\r\n        )}\r\n        <div \r\n          ref={bodyRef}\r\n          className=\"avakio-fieldset-body\"\r\n          style={bodyStyles}\r\n        >\r\n          {children}\r\n        </div>\r\n      </fieldset>\r\n    );\r\n  }\r\n);\r\n\r\nAvakioFieldset.displayName = 'AvakioFieldset';\r\n\r\nexport default AvakioFieldset;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { forwardRef, useImperativeHandle, useRef, CSSProperties } from 'react';\r\nimport './avakio-label.css';\r\n\r\nexport interface AvakioLabelProps {\r\n  /** Unique identifier for the label */\r\n  id?: string;\r\n  /** Test identifier for testing */\r\n  testId?: string;\r\n  /** The text content of the label */\r\n  label?: string;\r\n  /** Custom HTML content (overrides label if provided) */\r\n  html?: string;\r\n  /** Alignment of the label (left, center, right) */\r\n  align?: 'left' | 'center' | 'right';\r\n  /** Width of the label */\r\n  width?: number | string;\r\n  /** Height of the label */\r\n  height?: number | string;\r\n  /** Theme variant */\r\n  theme?: 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\n  /** CSS class name */\r\n  className?: string;\r\n  /** Custom CSS styles */\r\n  css?: CSSProperties;\r\n  /** Tooltip text */\r\n  tooltip?: string;\r\n  /** Disabled state */\r\n  disabled?: boolean;\r\n  /** Hidden state */\r\n  hidden?: boolean;\r\n  /** Click handler */\r\n  onClick?: (e: React.MouseEvent<HTMLDivElement>) => void;\r\n  /** Whether to auto-adjust width based on content */\r\n  autowidth?: boolean;\r\n  /** Font size */\r\n  fontSize?: number | string;\r\n  /** Font weight */\r\n  fontWeight?: 'normal' | 'bold' | '100' | '200' | '300' | '400' | '500' | '600' | '700' | '800' | '900';\r\n  /** Text color */\r\n  color?: string;\r\n  /** Background color */\r\n  backgroundColor?: string;\r\n  /** Padding - can be a number (all sides), string, or array [top, right, bottom, left] */\r\n  padding?: string | number | [number, number, number, number];\r\n  /** Margin - can be a number (all sides), string, or array [top, right, bottom, left] */\r\n  margin?: string | number | [number, number, number, number];\r\n  /** Border */\r\n  border?: string;\r\n  /** Border radius */\r\n  borderRadius?: string | number;\r\n}\r\n\r\nexport interface AvakioLabelRef {\r\n  /** Get the label text content */\r\n  getValue: () => string;\r\n  /** Set the label text content */\r\n  setValue: (value: string) => void;\r\n  /** Set HTML content */\r\n  setHTML: (html: string) => void;\r\n  /** Get the DOM element */\r\n  getNode: () => HTMLDivElement | null;\r\n  /** Hide the label */\r\n  hide: () => void;\r\n  /** Show the label */\r\n  show: () => void;\r\n  /** Check if label is visible */\r\n  isVisible: () => boolean;\r\n  /** Disable the label */\r\n  disable: () => void;\r\n  /** Enable the label */\r\n  enable: () => void;\r\n  /** Check if label is enabled */\r\n  isEnabled: () => boolean;\r\n}\r\n\r\nexport const AvakioLabel = forwardRef<AvakioLabelRef, AvakioLabelProps>(\r\n  (\r\n    {\r\n      id,\r\n      testId,\r\n      label = '',\r\n      html,\r\n      align = 'left',\r\n      width,\r\n      height,\r\n      theme = 'material',\r\n      className = '',\r\n      css = {},\r\n      tooltip,\r\n      disabled = false,\r\n      hidden = false,\r\n      onClick,\r\n      autowidth = false,\r\n      fontSize,\r\n      fontWeight,\r\n      color,\r\n      backgroundColor,\r\n      padding,\r\n      margin,\r\n      border,\r\n      borderRadius,\r\n    },\r\n    ref\r\n  ) => {\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n    const [currentLabel, setCurrentLabel] = React.useState(label);\r\n    const [currentHtml, setCurrentHtml] = React.useState(html);\r\n    const [isVisible, setIsVisible] = React.useState(!hidden);\r\n    const [isDisabled, setIsDisabled] = React.useState(disabled);\r\n\r\n    // Expose ref methods\r\n    useImperativeHandle(ref, () => ({\r\n      getValue: () => currentLabel,\r\n      setValue: (value: string) => {\r\n        setCurrentLabel(value);\r\n        setCurrentHtml(undefined);\r\n      },\r\n      setHTML: (htmlContent: string) => {\r\n        setCurrentHtml(htmlContent);\r\n      },\r\n      getNode: () => containerRef.current,\r\n      hide: () => setIsVisible(false),\r\n      show: () => setIsVisible(true),\r\n      isVisible: () => isVisible,\r\n      disable: () => setIsDisabled(true),\r\n      enable: () => setIsDisabled(false),\r\n      isEnabled: () => !isDisabled,\r\n    }));\r\n\r\n    // Build CSS classes\r\n    const classes = [\r\n      'avakio-label',\r\n      `avakio-label-theme-${theme}`,\r\n      `avakio-label-align-${align}`,\r\n      isDisabled && 'avakio-label-disabled',\r\n      autowidth && 'avakio-label-autowidth',\r\n      className,\r\n    ]\r\n      .filter(Boolean)\r\n      .join(' ');\r\n\r\n    // Build inline styles\r\n    const inlineStyles: CSSProperties = {\r\n      ...(css && typeof css === 'object' && !Array.isArray(css) ? css : {}),\r\n      width: autowidth ? 'auto' : width,\r\n      height,\r\n      fontSize,\r\n      fontWeight,\r\n      color,\r\n      backgroundColor,\r\n      padding: Array.isArray(padding) \r\n        ? `${padding[0]}px ${padding[1]}px ${padding[2]}px ${padding[3]}px`\r\n        : typeof padding === 'number' ? `${padding}px` : padding,\r\n      margin: Array.isArray(margin) \r\n        ? `${margin[0]}px ${margin[1]}px ${margin[2]}px ${margin[3]}px`\r\n        : typeof margin === 'number' ? `${margin}px` : margin,\r\n      border,\r\n      borderRadius,\r\n      display: isVisible ? undefined : 'none',\r\n    };\r\n\r\n    // Handle click\r\n    const handleClick = (e: React.MouseEvent<HTMLDivElement>) => {\r\n      if (!isDisabled && onClick) {\r\n        onClick(e);\r\n      }\r\n    };\r\n\r\n    return (\r\n      <div\r\n        ref={containerRef}\r\n        id={id}\r\n        data-testid={testId}\r\n        className={classes}\r\n        style={inlineStyles}\r\n        title={tooltip}\r\n        onClick={handleClick}\r\n      >\r\n        {currentHtml ? (\r\n          <div dangerouslySetInnerHTML={{ __html: currentHtml }} />\r\n        ) : (\r\n          <span>{currentLabel}</span>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nAvakioLabel.displayName = 'AvakioLabel';\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { forwardRef, useImperativeHandle, useState, useRef, useEffect, useCallback } from 'react';\r\nimport { Plus, X } from 'lucide-react';\r\nimport './avakio-multitext.css';\r\n\r\nexport type AvakioMultitextTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\nexport type AvakioMultitextLabelPosition = 'left' | 'top';\r\n\r\nexport interface AvakioMultitextField {\r\n  /** Unique identifier for the field */\r\n  id: string;\r\n  /** Current value of the field */\r\n  value: string;\r\n  /** Whether this is the primary (non-removable) field */\r\n  isPrimary?: boolean;\r\n  /** Whether this field is disabled */\r\n  disabled?: boolean;\r\n}\r\n\r\nexport interface AvakioMultitextSubConfig {\r\n  /** Placeholder for additional fields */\r\n  placeholder?: string;\r\n  /** Max length for additional fields */\r\n  maxLength?: number;\r\n  /** Pattern for additional fields */\r\n  pattern?: string;\r\n  /** Disabled state for additional fields */\r\n  disabled?: boolean;\r\n}\r\n\r\nexport interface AvakioMultitextProps {\r\n  /** Unique identifier */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n  /** Name for form submission */\r\n  name?: string;\r\n  /** Current value (comma-separated string or array) */\r\n  value?: string | string[];\r\n  /** Default value */\r\n  defaultValue?: string | string[];\r\n  /** Label text */\r\n  label?: string;\r\n  /** Label width */\r\n  labelWidth?: number;\r\n  /** Label alignment */\r\n  labelAlign?: 'left' | 'right';\r\n  /** Label position */\r\n  labelPosition?: AvakioMultitextLabelPosition;\r\n  /** Placeholder for the primary field */\r\n  placeholder?: string;\r\n  /** Mark as required */\r\n  required?: boolean;\r\n  /** Error message */\r\n  error?: string;\r\n  /** Invalid message (shown on validation) */\r\n  invalidMessage?: string;\r\n  /** Bottom label text */\r\n  bottomLabel?: string;\r\n  /** Theme variant */\r\n  theme?: AvakioMultitextTheme;\r\n  /** Disabled state */\r\n  disabled?: boolean;\r\n  /** Readonly state */\r\n  readonly?: boolean;\r\n  /** CSS class name */\r\n  className?: string;\r\n  /** Inline styles */\r\n  css?: React.CSSProperties;\r\n  /** Width */\r\n  width?: number | string;\r\n  /** Height */\r\n  height?: number | string;\r\n  /** Minimum width */\r\n  minWidth?: number | string;\r\n  /** Maximum width */\r\n  maxWidth?: number | string;\r\n  /** Input alignment */\r\n  inputAlign?: 'left' | 'center' | 'right';\r\n  /** Input width */\r\n  inputWidth?: number;\r\n  /** Icon for add button */\r\n  icon?: React.ReactNode;\r\n  /** Icon width */\r\n  iconWidth?: number;\r\n  /** Maximum number of fields allowed */\r\n  maxFields?: number;\r\n  /** Separator for combined value string */\r\n  separator?: string;\r\n  /** Configuration for additional fields */\r\n  subConfig?: AvakioMultitextSubConfig;\r\n  /** Show line numbers */\r\n  showNumbers?: boolean;\r\n  /** Custom add button label */\r\n  addButtonLabel?: string;\r\n  /** Custom add button tooltip */\r\n  addButtonTooltip?: string;\r\n  /** Validate function */\r\n  validate?: (value: string[]) => boolean | string;\r\n  /** Validate event */\r\n  validateEvent?: 'change' | 'blur';\r\n  /** Max length per field */\r\n  maxLength?: number;\r\n  /** Pattern for HTML5 validation */\r\n  pattern?: string;\r\n  /** Autocomplete attribute */\r\n  autoComplete?: string;\r\n  /** Callback when value changes */\r\n  onChange?: (value: string[], combinedValue: string) => void;\r\n  /** Callback when a section is added */\r\n  onSectionAdd?: (fieldId: string, index: number) => void;\r\n  /** Callback when a section is removed */\r\n  onSectionRemove?: (fieldId: string, value: string) => void;\r\n  /** Callback when a field gains focus */\r\n  onFocus?: (fieldId: string, event: React.FocusEvent) => void;\r\n  /** Callback when a field loses focus */\r\n  onBlur?: (fieldId: string, event: React.FocusEvent) => void;\r\n  /** Callback on Enter key */\r\n  onEnter?: (fieldId: string, value: string) => void;\r\n}\r\n\r\nexport interface AvakioMultitextRef {\r\n  /** Get the combined value string */\r\n  getValue: () => string;\r\n  /** Get all values as an array */\r\n  getValues: () => string[];\r\n  /** Set the combined value string */\r\n  setValue: (value: string | string[]) => void;\r\n  /** Get the value of the primary (first) field only */\r\n  getValueHere: () => string;\r\n  /** Set the value of the primary (first) field only */\r\n  setValueHere: (value: string) => void;\r\n  /** Add a new empty field */\r\n  addSection: (value?: string) => string;\r\n  /** Remove a field by ID (cannot remove primary) */\r\n  removeSection: (fieldId?: string) => void;\r\n  /** Get all field IDs */\r\n  getFieldIds: () => string[];\r\n  /** Get a specific field by ID */\r\n  getField: (fieldId: string) => AvakioMultitextField | undefined;\r\n  /** Get the number of fields */\r\n  getFieldCount: () => number;\r\n  /** Clear all additional fields (keep primary) */\r\n  clearAdditional: () => void;\r\n  /** Clear all fields including primary value */\r\n  clear: () => void;\r\n  /** Focus the primary field */\r\n  focus: () => void;\r\n  /** Focus a specific field */\r\n  focusField: (fieldId: string) => void;\r\n  /** Blur all fields */\r\n  blur: () => void;\r\n  /** Refresh the component */\r\n  refresh: () => void;\r\n  /** Enable the component */\r\n  enable: () => void;\r\n  /** Disable the component */\r\n  disable: () => void;\r\n  /** Check if enabled */\r\n  isEnabled: () => boolean;\r\n  /** Hide the component */\r\n  hide: () => void;\r\n  /** Show the component */\r\n  show: () => void;\r\n  /** Check if visible */\r\n  isVisible: () => boolean;\r\n  /** Validate the control */\r\n  validate: () => boolean;\r\n  /** Get the HTML element */\r\n  getNode: () => HTMLDivElement | null;\r\n}\r\n\r\n// Generate unique ID for fields\r\nlet fieldIdCounter = 0;\r\nconst generateFieldId = () => `multitext-field-${++fieldIdCounter}`;\r\n\r\nexport const AvakioMultitext = forwardRef<AvakioMultitextRef, AvakioMultitextProps>(\r\n  (\r\n    {\r\n      id,\r\n      testId,\r\n      name,\r\n      value,\r\n      defaultValue,\r\n      label,\r\n      labelWidth = 100,\r\n      labelAlign = 'left',\r\n      labelPosition = 'left',\r\n      placeholder,\r\n      required = false,\r\n      error,\r\n      invalidMessage,\r\n      bottomLabel,\r\n      theme = 'material',\r\n      disabled = false,\r\n      readonly = false,\r\n      className = '',\r\n      css,\r\n      width,\r\n      height,\r\n      minWidth,\r\n      maxWidth,\r\n      inputAlign = 'left',\r\n      inputWidth,\r\n      icon,\r\n      iconWidth = 28,\r\n      maxFields,\r\n      separator = ', ',\r\n      subConfig,\r\n      showNumbers = false,\r\n      addButtonLabel,\r\n      addButtonTooltip = 'Add field',\r\n      validate,\r\n      validateEvent = 'blur',\r\n      maxLength,\r\n      pattern,\r\n      autoComplete,\r\n      onChange,\r\n      onSectionAdd,\r\n      onSectionRemove,\r\n      onFocus,\r\n      onBlur,\r\n      onEnter,\r\n    },\r\n    ref\r\n  ) => {\r\n    // Parse initial value\r\n    const parseValue = useCallback((val: string | string[] | undefined): AvakioMultitextField[] => {\r\n      if (!val) {\r\n        return [{ id: generateFieldId(), value: '', isPrimary: true }];\r\n      }\r\n      \r\n      const values = Array.isArray(val) \r\n        ? val \r\n        : val.split(separator).map(v => v.trim()).filter(v => v);\r\n      \r\n      if (values.length === 0) {\r\n        return [{ id: generateFieldId(), value: '', isPrimary: true }];\r\n      }\r\n      \r\n      return values.map((v, index) => ({\r\n        id: generateFieldId(),\r\n        value: v,\r\n        isPrimary: index === 0,\r\n      }));\r\n    }, [separator]);\r\n\r\n    const [fields, setFields] = useState<AvakioMultitextField[]>(() => \r\n      parseValue(value ?? defaultValue)\r\n    );\r\n    const [isDisabled, setIsDisabled] = useState(disabled);\r\n    const [isVisible, setIsVisible] = useState(true);\r\n    const [isInvalid, setIsInvalid] = useState(false);\r\n    const [validationMessage, setValidationMessage] = useState(error || invalidMessage || '');\r\n    const [refreshKey, setRefreshKey] = useState(0);\r\n\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n    const inputRefs = useRef<Map<string, HTMLInputElement>>(new Map());\r\n\r\n    // Sync with external value changes\r\n    useEffect(() => {\r\n      if (value !== undefined) {\r\n        setFields(parseValue(value));\r\n      }\r\n    }, [value, parseValue]);\r\n\r\n    // Sync disabled state\r\n    useEffect(() => {\r\n      setIsDisabled(disabled);\r\n    }, [disabled]);\r\n\r\n    // Sync error state\r\n    useEffect(() => {\r\n      if (error) {\r\n        setIsInvalid(true);\r\n        setValidationMessage(error);\r\n      } else if (invalidMessage) {\r\n        setValidationMessage(invalidMessage);\r\n      }\r\n    }, [error, invalidMessage]);\r\n\r\n    // Get combined value string\r\n    const getCombinedValue = useCallback(() => {\r\n      return fields.map(f => f.value).filter(v => v).join(separator);\r\n    }, [fields, separator]);\r\n\r\n    // Get values array\r\n    const getValuesArray = useCallback(() => {\r\n      return fields.map(f => f.value);\r\n    }, [fields]);\r\n\r\n    // Validate fields\r\n    const validateFields = useCallback(() => {\r\n      if (required && fields.every(f => !f.value.trim())) {\r\n        setIsInvalid(true);\r\n        setValidationMessage(invalidMessage || 'This field is required');\r\n        return false;\r\n      }\r\n\r\n      if (validate) {\r\n        const values = fields.map(f => f.value);\r\n        const result = validate(values);\r\n        if (typeof result === 'string') {\r\n          setIsInvalid(true);\r\n          setValidationMessage(result);\r\n          return false;\r\n        } else if (result === false) {\r\n          setIsInvalid(true);\r\n          setValidationMessage(invalidMessage || 'Invalid value');\r\n          return false;\r\n        }\r\n      }\r\n\r\n      setIsInvalid(false);\r\n      setValidationMessage('');\r\n      return true;\r\n    }, [fields, required, validate, invalidMessage]);\r\n\r\n    // Handle field value change\r\n    const handleFieldChange = useCallback((fieldId: string, newValue: string) => {\r\n      setFields(prev => {\r\n        const updated = prev.map(f => \r\n          f.id === fieldId ? { ...f, value: newValue } : f\r\n        );\r\n        \r\n        // Trigger onChange callback\r\n        setTimeout(() => {\r\n          const values = updated.map(f => f.value);\r\n          const combined = values.filter(v => v).join(separator);\r\n          onChange?.(values, combined);\r\n          \r\n          if (validateEvent === 'change') {\r\n            validateFields();\r\n          }\r\n        }, 0);\r\n        \r\n        return updated;\r\n      });\r\n    }, [separator, onChange, validateEvent, validateFields]);\r\n\r\n    // Handle add section\r\n    const handleAddSection = useCallback((initialValue: string = '') => {\r\n      if (maxFields && fields.length >= maxFields) {\r\n        return '';\r\n      }\r\n\r\n      const newFieldId = generateFieldId();\r\n      const newField: AvakioMultitextField = {\r\n        id: newFieldId,\r\n        value: initialValue,\r\n        isPrimary: false,\r\n      };\r\n\r\n      setFields(prev => [...prev, newField]);\r\n      \r\n      // Focus the new field after render\r\n      setTimeout(() => {\r\n        inputRefs.current.get(newFieldId)?.focus();\r\n      }, 50);\r\n\r\n      onSectionAdd?.(newFieldId, fields.length);\r\n      \r\n      // Trigger onChange\r\n      setTimeout(() => {\r\n        const values = [...fields.map(f => f.value), initialValue];\r\n        const combined = values.filter(v => v).join(separator);\r\n        onChange?.(values, combined);\r\n      }, 0);\r\n\r\n      return newFieldId;\r\n    }, [fields, maxFields, separator, onChange, onSectionAdd]);\r\n\r\n    // Handle remove section\r\n    const handleRemoveSection = useCallback((fieldId?: string) => {\r\n      setFields(prev => {\r\n        // If no fieldId, remove the last non-primary field\r\n        const targetId = fieldId || prev.filter(f => !f.isPrimary).pop()?.id;\r\n        if (!targetId) return prev;\r\n\r\n        const fieldToRemove = prev.find(f => f.id === targetId);\r\n        if (!fieldToRemove || fieldToRemove.isPrimary) return prev;\r\n\r\n        const updated = prev.filter(f => f.id !== targetId);\r\n        \r\n        onSectionRemove?.(targetId, fieldToRemove.value);\r\n        \r\n        // Trigger onChange\r\n        setTimeout(() => {\r\n          const values = updated.map(f => f.value);\r\n          const combined = values.filter(v => v).join(separator);\r\n          onChange?.(values, combined);\r\n        }, 0);\r\n\r\n        return updated;\r\n      });\r\n    }, [separator, onChange, onSectionRemove]);\r\n\r\n    // Handle key press\r\n    const handleKeyPress = useCallback((fieldId: string, e: React.KeyboardEvent<HTMLInputElement>) => {\r\n      if (e.key === 'Enter') {\r\n        const field = fields.find(f => f.id === fieldId);\r\n        if (field) {\r\n          onEnter?.(fieldId, field.value);\r\n        }\r\n      }\r\n    }, [fields, onEnter]);\r\n\r\n    // Handle focus\r\n    const handleFocus = useCallback((fieldId: string, e: React.FocusEvent<HTMLInputElement>) => {\r\n      onFocus?.(fieldId, e);\r\n    }, [onFocus]);\r\n\r\n    // Handle blur\r\n    const handleBlur = useCallback((fieldId: string, e: React.FocusEvent<HTMLInputElement>) => {\r\n      onBlur?.(fieldId, e);\r\n      \r\n      if (validateEvent === 'blur') {\r\n        validateFields();\r\n      }\r\n    }, [onBlur, validateEvent, validateFields]);\r\n\r\n    // Expose imperative methods\r\n    useImperativeHandle(ref, () => ({\r\n      getValue: () => getCombinedValue(),\r\n      getValues: () => getValuesArray(),\r\n      setValue: (val: string | string[]) => {\r\n        setFields(parseValue(val));\r\n      },\r\n      getValueHere: () => fields[0]?.value || '',\r\n      setValueHere: (val: string) => {\r\n        setFields(prev => {\r\n          const updated = [...prev];\r\n          if (updated[0]) {\r\n            updated[0] = { ...updated[0], value: val };\r\n          }\r\n          return updated;\r\n        });\r\n      },\r\n      addSection: (val?: string) => handleAddSection(val || ''),\r\n      removeSection: (fieldId?: string) => handleRemoveSection(fieldId),\r\n      getFieldIds: () => fields.map(f => f.id),\r\n      getField: (fieldId: string) => fields.find(f => f.id === fieldId),\r\n      getFieldCount: () => fields.length,\r\n      clearAdditional: () => {\r\n        setFields(prev => {\r\n          const primary = prev.find(f => f.isPrimary);\r\n          return primary ? [primary] : [{ id: generateFieldId(), value: '', isPrimary: true }];\r\n        });\r\n      },\r\n      clear: () => {\r\n        setFields([{ id: generateFieldId(), value: '', isPrimary: true }]);\r\n      },\r\n      focus: () => {\r\n        const primaryField = fields.find(f => f.isPrimary);\r\n        if (primaryField) {\r\n          inputRefs.current.get(primaryField.id)?.focus();\r\n        }\r\n      },\r\n      focusField: (fieldId: string) => {\r\n        inputRefs.current.get(fieldId)?.focus();\r\n      },\r\n      blur: () => {\r\n        inputRefs.current.forEach(input => input.blur());\r\n      },\r\n      refresh: () => setRefreshKey(k => k + 1),\r\n      enable: () => setIsDisabled(false),\r\n      disable: () => setIsDisabled(true),\r\n      isEnabled: () => !isDisabled,\r\n      hide: () => setIsVisible(false),\r\n      show: () => setIsVisible(true),\r\n      isVisible: () => isVisible,\r\n      validate: () => validateFields(),\r\n      getNode: () => containerRef.current,\r\n    }), [fields, getCombinedValue, getValuesArray, parseValue, handleAddSection, handleRemoveSection, isDisabled, isVisible, validateFields]);\r\n\r\n    // Build class names\r\n    const containerClasses = [\r\n      'avakio-multitext',\r\n      `avakio-multitext--${theme}`,\r\n      `avakio-multitext--label-${labelPosition}`,\r\n      isDisabled && 'avakio-multitext--disabled',\r\n      readonly && 'avakio-multitext--readonly',\r\n      isInvalid && 'avakio-multitext--invalid',\r\n      !isVisible && 'avakio-multitext--hidden',\r\n      className,\r\n    ].filter(Boolean).join(' ');\r\n\r\n    // Build container styles\r\n    const containerStyles: React.CSSProperties = {\r\n      ...(css && typeof css === 'object' && !Array.isArray(css) ? css : {}),\r\n      width: width ? (typeof width === 'number' ? `${width}px` : width) : undefined,\r\n      height: height ? (typeof height === 'number' ? `${height}px` : height) : undefined,\r\n      minWidth: minWidth ? (typeof minWidth === 'number' ? `${minWidth}px` : minWidth) : undefined,\r\n      maxWidth: maxWidth ? (typeof maxWidth === 'number' ? `${maxWidth}px` : maxWidth) : undefined,\r\n    };\r\n\r\n    const canAddMore = !maxFields || fields.length < maxFields;\r\n\r\n    if (!isVisible) {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <div\r\n        ref={containerRef}\r\n        id={id}\r\n        data-testid={testId}\r\n        className={containerClasses}\r\n        style={containerStyles}\r\n        data-admin-theme={theme}\r\n        key={refreshKey}\r\n      >\r\n        {/* Label */}\r\n        {label && (\r\n          <label \r\n            className=\"avakio-multitext__label\"\r\n            style={{ \r\n              width: labelPosition === 'left' ? `${labelWidth}px` : undefined,\r\n              textAlign: labelAlign,\r\n            }}\r\n          >\r\n            {label}\r\n            {required && <span className=\"avakio-multitext__required\">*</span>}\r\n          </label>\r\n        )}\r\n\r\n        {/* Fields container */}\r\n        <div className=\"avakio-multitext__fields\">\r\n          {fields.map((field, index) => (\r\n            <div key={field.id} className=\"avakio-multitext__field-row\">\r\n              {/* Line number */}\r\n              {showNumbers && (\r\n                <span className=\"avakio-multitext__field-number\">{index + 1}.</span>\r\n              )}\r\n\r\n              {/* Input */}\r\n              <div className=\"avakio-multitext__input-wrapper\">\r\n                <input\r\n                  ref={(el) => {\r\n                    if (el) {\r\n                      inputRefs.current.set(field.id, el);\r\n                    } else {\r\n                      inputRefs.current.delete(field.id);\r\n                    }\r\n                  }}\r\n                  type=\"text\"\r\n                  name={name ? `${name}[${index}]` : undefined}\r\n                  value={field.value}\r\n                  placeholder={field.isPrimary ? placeholder : (subConfig?.placeholder || placeholder)}\r\n                  disabled={isDisabled || field.disabled || (field.isPrimary ? false : subConfig?.disabled)}\r\n                  readOnly={readonly}\r\n                  maxLength={field.isPrimary ? maxLength : (subConfig?.maxLength || maxLength)}\r\n                  pattern={field.isPrimary ? pattern : (subConfig?.pattern || pattern)}\r\n                  autoComplete={autoComplete}\r\n                  className=\"avakio-multitext__input\"\r\n                  style={{ \r\n                    textAlign: inputAlign,\r\n                    width: inputWidth ? `${inputWidth}px` : undefined,\r\n                  }}\r\n                  onChange={(e) => handleFieldChange(field.id, e.target.value)}\r\n                  onKeyPress={(e) => handleKeyPress(field.id, e)}\r\n                  onFocus={(e) => handleFocus(field.id, e)}\r\n                  onBlur={(e) => handleBlur(field.id, e)}\r\n                  aria-invalid={isInvalid}\r\n                  aria-describedby={isInvalid ? `${id}-error` : undefined}\r\n                />\r\n\r\n                {/* Add button (only on primary) */}\r\n                {field.isPrimary && !readonly && canAddMore && (\r\n                  <button\r\n                    type=\"button\"\r\n                    className=\"avakio-multitext__add-btn\"\r\n                    onClick={() => handleAddSection()}\r\n                    disabled={isDisabled}\r\n                    title={addButtonTooltip}\r\n                    style={{ width: iconWidth ? `${iconWidth}px` : undefined }}\r\n                    aria-label={addButtonLabel || 'Add field'}\r\n                  >\r\n                    {icon || <Plus size={16} />}\r\n                    {addButtonLabel && (\r\n                      <span className=\"avakio-multitext__add-btn-label\">{addButtonLabel}</span>\r\n                    )}\r\n                  </button>\r\n                )}\r\n\r\n                {/* Remove button (only on non-primary) */}\r\n                {!field.isPrimary && !readonly && (\r\n                  <button\r\n                    type=\"button\"\r\n                    className=\"avakio-multitext__remove-btn\"\r\n                    onClick={() => handleRemoveSection(field.id)}\r\n                    disabled={isDisabled}\r\n                    title=\"Remove field\"\r\n                    aria-label=\"Remove field\"\r\n                  >\r\n                    <X size={16} />\r\n                  </button>\r\n                )}\r\n              </div>\r\n            </div>\r\n          ))}\r\n\r\n          {/* Bottom label */}\r\n          {bottomLabel && (\r\n            <div className=\"avakio-multitext__bottom-label\">{bottomLabel}</div>\r\n          )}\r\n\r\n          {/* Error message */}\r\n          {isInvalid && validationMessage && (\r\n            <div id={`${id}-error`} className=\"avakio-multitext__error\" role=\"alert\">\r\n              {validationMessage}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nAvakioMultitext.displayName = 'AvakioMultitext';\r\n\r\nexport default AvakioMultitext;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { forwardRef, useImperativeHandle, useState, useRef, useEffect, useId } from 'react';\r\nimport './avakio-radio.css';\r\n\r\nexport type AvakioRadioTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\nexport type AvakioRadioSize = 'sm' | 'md' | 'lg';\r\n\r\nexport interface AvakioRadioOption {\r\n  /** Unique identifier for the option */\r\n  id: string | number;\r\n  /** Display label for the option */\r\n  value: string;\r\n  /** Optional icon */\r\n  icon?: React.ReactNode;\r\n  /** Whether this option is disabled */\r\n  disabled?: boolean;\r\n  /** Whether this option is hidden */\r\n  hidden?: boolean;\r\n  /** Custom CSS class for this option */\r\n  css?: string;\r\n  /** Tooltip for this option */\r\n  tooltip?: string;\r\n}\r\n\r\nexport interface AvakioRadioProps {\r\n  /** Unique identifier */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n  /** Name for form submission */\r\n  name?: string;\r\n  /** Current selected value (controlled) */\r\n  value?: string | number | null;\r\n  /** Default selected value (uncontrolled) */\r\n  defaultValue?: string | number | null;\r\n  /** Array of radio options */\r\n  options: AvakioRadioOption[] | string[];\r\n  /** Label text (displayed to the left or top) */\r\n  label?: string;\r\n  /** Width of the label in pixels */\r\n  labelWidth?: number;\r\n  /** Label alignment ('left' | 'right') */\r\n  labelAlign?: 'left' | 'right';\r\n  /** Label position ('left' | 'top') */\r\n  labelPosition?: 'left' | 'top';\r\n  /** Vertical layout for radio options */\r\n  vertical?: boolean;\r\n  /** Radio button size */\r\n  size?: AvakioRadioSize;\r\n  /** Theme variant */\r\n  theme?: AvakioRadioTheme;\r\n  /** Disabled state for all options */\r\n  disabled?: boolean;\r\n  /** Required field */\r\n  required?: boolean;\r\n  /** Invalid state */\r\n  invalid?: boolean;\r\n  /** Invalid message */\r\n  invalidMessage?: string;\r\n  /** Bottom label text */\r\n  bottomLabel?: string;\r\n  /** Custom radio rendering (false = use native HTML radio) */\r\n  customRadio?: boolean;\r\n  /** Height of each radio option */\r\n  optionHeight?: number;\r\n  /** CSS class name */\r\n  className?: string;\r\n  /** Inline styles */\r\n  css?: React.CSSProperties;\r\n  /** Width */\r\n  width?: number | string;\r\n  /** Height */\r\n  height?: number | string;\r\n  /** Callback when value changes */\r\n  onChange?: (value: string | number) => void;\r\n  /** Callback when an option is clicked */\r\n  onClick?: (e: React.MouseEvent, option: AvakioRadioOption) => void;\r\n  /** Callback when focused */\r\n  onFocus?: (e: React.FocusEvent) => void;\r\n  /** Callback when blurred */\r\n  onBlur?: (e: React.FocusEvent) => void;\r\n}\r\n\r\nexport interface AvakioRadioRef {\r\n  /** Get the current selected value */\r\n  getValue: () => string | number | null;\r\n  /** Set the selected value */\r\n  setValue: (value: string | number | null) => void;\r\n  /** Focus the first non-disabled option */\r\n  focus: () => void;\r\n  /** Blur the control */\r\n  blur: () => void;\r\n  /** Enable the control */\r\n  enable: () => void;\r\n  /** Disable the control */\r\n  disable: () => void;\r\n  /** Enable a specific option */\r\n  enableOption: (id: string | number) => void;\r\n  /** Disable a specific option */\r\n  disableOption: (id: string | number) => void;\r\n  /** Show a hidden option */\r\n  showOption: (id: string | number) => void;\r\n  /** Hide an option */\r\n  hideOption: (id: string | number) => void;\r\n  /** Check if enabled */\r\n  isEnabled: () => boolean;\r\n  /** Get the HTML container element */\r\n  getNode: () => HTMLDivElement | null;\r\n  /** Get the option configuration by id */\r\n  getOption: (id: string | number) => AvakioRadioOption | undefined;\r\n  /** Refresh/repaint the component */\r\n  refresh: () => void;\r\n}\r\n\r\n// Normalize options to consistent format\r\nfunction normalizeOptions(options: AvakioRadioOption[] | string[]): AvakioRadioOption[] {\r\n  return options.map((opt, index) => {\r\n    if (typeof opt === 'string') {\r\n      return { id: opt, value: opt };\r\n    }\r\n    return opt;\r\n  });\r\n}\r\n\r\nexport const AvakioRadio = forwardRef<AvakioRadioRef, AvakioRadioProps>(\r\n  (\r\n    {\r\n      id,\r\n      testId,\r\n      name,\r\n      value,\r\n      defaultValue = null,\r\n      options: optionsProp,\r\n      label,\r\n      labelWidth = 80,\r\n      labelAlign = 'left',\r\n      labelPosition = 'left',\r\n      vertical = false,\r\n      size = 'md',\r\n      theme,\r\n      disabled: disabledProp = false,\r\n      required = false,\r\n      invalid = false,\r\n      invalidMessage,\r\n      bottomLabel,\r\n      customRadio = true,\r\n      optionHeight,\r\n      className = '',\r\n      css,\r\n      width,\r\n      height,\r\n      onChange,\r\n      onClick,\r\n      onFocus,\r\n      onBlur,\r\n    },\r\n    ref\r\n  ) => {\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n    const inputRefs = useRef<Map<string | number, HTMLInputElement>>(new Map());\r\n    const autoId = useId();\r\n    const radioName = name || `avakio-radio-${autoId}`;\r\n    \r\n    const isControlled = value !== undefined;\r\n    const [internalValue, setInternalValue] = useState<string | number | null>(defaultValue);\r\n    const [disabled, setDisabled] = useState<boolean>(disabledProp);\r\n    const [optionStates, setOptionStates] = useState<Map<string | number, { disabled?: boolean; hidden?: boolean }>>(new Map());\r\n    const [, forceUpdate] = useState({});\r\n\r\n    const currentValue = isControlled ? value : internalValue;\r\n    const options = normalizeOptions(optionsProp);\r\n\r\n    // Sync disabled prop\r\n    useEffect(() => {\r\n      setDisabled(disabledProp);\r\n    }, [disabledProp]);\r\n\r\n    // Get effective option state (merged with local overrides)\r\n    const getOptionState = (opt: AvakioRadioOption) => {\r\n      const override = optionStates.get(opt.id);\r\n      return {\r\n        disabled: override?.disabled ?? opt.disabled ?? false,\r\n        hidden: override?.hidden ?? opt.hidden ?? false,\r\n      };\r\n    };\r\n\r\n    // Expose imperative methods\r\n    useImperativeHandle(ref, () => ({\r\n      getValue: () => (isControlled ? value : internalValue) ?? null,\r\n      setValue: (newValue: string | number | null) => {\r\n        if (!isControlled) {\r\n          setInternalValue(newValue);\r\n        }\r\n        if (newValue !== null) {\r\n          onChange?.(newValue);\r\n        }\r\n      },\r\n      focus: () => {\r\n        const firstEnabled = options.find(opt => !getOptionState(opt).disabled && !getOptionState(opt).hidden);\r\n        if (firstEnabled) {\r\n          inputRefs.current.get(firstEnabled.id)?.focus();\r\n        }\r\n      },\r\n      blur: () => {\r\n        if (document.activeElement instanceof HTMLElement) {\r\n          document.activeElement.blur();\r\n        }\r\n      },\r\n      enable: () => setDisabled(false),\r\n      disable: () => setDisabled(true),\r\n      enableOption: (optId: string | number) => {\r\n        setOptionStates(prev => {\r\n          const next = new Map(prev);\r\n          const current = next.get(optId) || {};\r\n          next.set(optId, { ...current, disabled: false });\r\n          return next;\r\n        });\r\n      },\r\n      disableOption: (optId: string | number) => {\r\n        setOptionStates(prev => {\r\n          const next = new Map(prev);\r\n          const current = next.get(optId) || {};\r\n          next.set(optId, { ...current, disabled: true });\r\n          return next;\r\n        });\r\n      },\r\n      showOption: (optId: string | number) => {\r\n        setOptionStates(prev => {\r\n          const next = new Map(prev);\r\n          const current = next.get(optId) || {};\r\n          next.set(optId, { ...current, hidden: false });\r\n          return next;\r\n        });\r\n      },\r\n      hideOption: (optId: string | number) => {\r\n        setOptionStates(prev => {\r\n          const next = new Map(prev);\r\n          const current = next.get(optId) || {};\r\n          next.set(optId, { ...current, hidden: true });\r\n          return next;\r\n        });\r\n      },\r\n      isEnabled: () => !disabled,\r\n      getNode: () => containerRef.current,\r\n      getOption: (optId: string | number) => options.find(opt => opt.id === optId),\r\n      refresh: () => forceUpdate({}),\r\n    }));\r\n\r\n    const handleChange = (optionId: string | number) => {\r\n      if (!isControlled) {\r\n        setInternalValue(optionId);\r\n      }\r\n      onChange?.(optionId);\r\n    };\r\n\r\n    const handleKeyDown = (e: React.KeyboardEvent, currentIndex: number) => {\r\n      const visibleOptions = options.filter(opt => !getOptionState(opt).hidden);\r\n      const currentVisibleIndex = visibleOptions.findIndex(opt => opt.id === options[currentIndex].id);\r\n      \r\n      let nextIndex = -1;\r\n      \r\n      if (e.key === 'ArrowDown' || e.key === 'ArrowRight') {\r\n        e.preventDefault();\r\n        for (let i = 1; i <= visibleOptions.length; i++) {\r\n          const idx = (currentVisibleIndex + i) % visibleOptions.length;\r\n          if (!getOptionState(visibleOptions[idx]).disabled) {\r\n            nextIndex = idx;\r\n            break;\r\n          }\r\n        }\r\n      } else if (e.key === 'ArrowUp' || e.key === 'ArrowLeft') {\r\n        e.preventDefault();\r\n        for (let i = 1; i <= visibleOptions.length; i++) {\r\n          const idx = (currentVisibleIndex - i + visibleOptions.length) % visibleOptions.length;\r\n          if (!getOptionState(visibleOptions[idx]).disabled) {\r\n            nextIndex = idx;\r\n            break;\r\n          }\r\n        }\r\n      }\r\n\r\n      if (nextIndex >= 0) {\r\n        const nextOption = visibleOptions[nextIndex];\r\n        inputRefs.current.get(nextOption.id)?.focus();\r\n        handleChange(nextOption.id);\r\n      }\r\n    };\r\n\r\n    const containerClasses = [\r\n      'avakio-radio-container',\r\n      `avakio-radio-container-${size}`,\r\n      vertical ? 'avakio-radio-vertical' : 'avakio-radio-horizontal',\r\n      labelPosition === 'top' ? 'avakio-radio-label-top' : '',\r\n      disabled ? 'avakio-radio-container-disabled' : '',\r\n      invalid ? 'avakio-radio-container-invalid' : '',\r\n      className,\r\n    ].filter(Boolean).join(' ');\r\n\r\n    const containerStyle: React.CSSProperties = {\r\n      ...(css && typeof css === 'object' && !Array.isArray(css) ? css : {}),\r\n      ...(width ? { width: typeof width === 'number' ? `${width}px` : width } : {}),\r\n      ...(height ? { height: typeof height === 'number' ? `${height}px` : height } : {}),\r\n    };\r\n\r\n    return (\r\n      <div\r\n        ref={containerRef}\r\n        id={id}\r\n        data-testid={testId}\r\n        className={containerClasses}\r\n        style={containerStyle}\r\n        data-admin-theme={theme}\r\n        role=\"radiogroup\"\r\n        aria-labelledby={label ? `${radioName}-label` : undefined}\r\n        aria-required={required}\r\n        aria-invalid={invalid}\r\n      >\r\n        {/* Label */}\r\n        {label && (\r\n          <label\r\n            id={`${radioName}-label`}\r\n            className={`avakio-radio-label avakio-radio-label-${labelAlign}`}\r\n            style={{ width: labelPosition === 'left' ? labelWidth : undefined }}\r\n          >\r\n            {label}\r\n            {required && <span className=\"avakio-radio-required\">*</span>}\r\n          </label>\r\n        )}\r\n\r\n        {/* Options Container */}\r\n        <div className=\"avakio-radio-options\">\r\n          {options.map((option, index) => {\r\n            const optState = getOptionState(option);\r\n            if (optState.hidden) return null;\r\n\r\n            const isChecked = currentValue === option.id;\r\n            const isDisabled = disabled || optState.disabled;\r\n\r\n            const optionClasses = [\r\n              'avakio-radio-option',\r\n              isChecked ? 'avakio-radio-option-checked' : '',\r\n              isDisabled ? 'avakio-radio-option-disabled' : '',\r\n              customRadio ? 'avakio-radio-custom' : 'avakio-radio-native',\r\n              option.css || '',\r\n            ].filter(Boolean).join(' ');\r\n\r\n            const optionStyle: React.CSSProperties = optionHeight\r\n              ? { height: optionHeight }\r\n              : {};\r\n\r\n            return (\r\n              <label\r\n                key={option.id}\r\n                className={optionClasses}\r\n                style={optionStyle}\r\n                title={option.tooltip}\r\n                onClick={(e) => {\r\n                  if (!isDisabled) {\r\n                    onClick?.(e, option);\r\n                  }\r\n                }}\r\n              >\r\n                <input\r\n                  ref={(el) => {\r\n                    if (el) {\r\n                      inputRefs.current.set(option.id, el);\r\n                    } else {\r\n                      inputRefs.current.delete(option.id);\r\n                    }\r\n                  }}\r\n                  type=\"radio\"\r\n                  name={radioName}\r\n                  value={String(option.id)}\r\n                  checked={isChecked}\r\n                  disabled={isDisabled}\r\n                  onChange={() => handleChange(option.id)}\r\n                  onKeyDown={(e) => handleKeyDown(e, index)}\r\n                  onFocus={onFocus}\r\n                  onBlur={onBlur}\r\n                  className=\"avakio-radio-input\"\r\n                  aria-checked={isChecked}\r\n                />\r\n                {customRadio && (\r\n                  <span className=\"avakio-radio-indicator\">\r\n                    <span className=\"avakio-radio-dot\" />\r\n                  </span>\r\n                )}\r\n                {option.icon && (\r\n                  <span className=\"avakio-radio-icon\">{option.icon}</span>\r\n                )}\r\n                <span className=\"avakio-radio-text\">{option.value}</span>\r\n              </label>\r\n            );\r\n          })}\r\n        </div>\r\n\r\n        {/* Bottom Section */}\r\n        {(bottomLabel || (invalid && invalidMessage)) && (\r\n          <div className=\"avakio-radio-bottom\" style={{ paddingLeft: labelPosition === 'left' ? labelWidth + 8 : 0 }}>\r\n            {invalid && invalidMessage ? (\r\n              <span className=\"avakio-radio-invalid-message\">{invalidMessage}</span>\r\n            ) : bottomLabel ? (\r\n              <span className=\"avakio-radio-bottom-label\">{bottomLabel}</span>\r\n            ) : null}\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nAvakioRadio.displayName = 'AvakioRadio';\r\n\r\nexport default AvakioRadio;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { forwardRef, useImperativeHandle, useState, useRef, useEffect, useCallback } from 'react';\r\nimport './avakio-segmented-button.css';\r\n\r\nexport type AvakioSegmentedButtonTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\nexport type AvakioSegmentedButtonSize = 'sm' | 'md' | 'lg';\r\nexport type AvakioSegmentedButtonAlign = 'left' | 'center' | 'right';\r\n\r\nexport interface AvakioSegmentedOption {\r\n  /** Unique identifier for the option */\r\n  id: string | number;\r\n  /** Display label for the segment */\r\n  value: string;\r\n  /** Optional icon to display */\r\n  icon?: React.ReactNode;\r\n  /** Badge content (string or number) */\r\n  badge?: string | number;\r\n  /** Whether this option is disabled */\r\n  disabled?: boolean;\r\n  /** Whether this option is hidden */\r\n  hidden?: boolean;\r\n  /** Tooltip text for this option */\r\n  tooltip?: string;\r\n  /** ARIA controls ID */\r\n  ariaControls?: string;\r\n}\r\n\r\nexport interface AvakioSegmentedButtonProps {\r\n  /** Unique identifier */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n  /** Name for form submission */\r\n  name?: string;\r\n  /** Current selected value (controlled) */\r\n  value?: string | number | null;\r\n  /** Default selected value (uncontrolled) */\r\n  defaultValue?: string | number;\r\n  /** Array of options or simple string array */\r\n  options?: AvakioSegmentedOption[] | string[];\r\n  /** Label text */\r\n  label?: string;\r\n  /** Label width */\r\n  labelWidth?: number;\r\n  /** Label alignment */\r\n  labelAlign?: 'left' | 'right';\r\n  /** Label position */\r\n  labelPosition?: 'left' | 'top';\r\n  /** Mark as required */\r\n  required?: boolean;\r\n  /** Error message */\r\n  error?: string;\r\n  /** Invalid message (shown on validation) */\r\n  invalidMessage?: string;\r\n  /** Bottom label text */\r\n  bottomLabel?: string;\r\n  /** Button size */\r\n  size?: AvakioSegmentedButtonSize;\r\n  /** Content alignment */\r\n  align?: AvakioSegmentedButtonAlign;\r\n  /** Theme variant */\r\n  theme?: AvakioSegmentedButtonTheme;\r\n  /** Whether to fill available width */\r\n  fill?: boolean;\r\n  /** Fixed option width */\r\n  optionWidth?: number;\r\n  /** Disabled state */\r\n  disabled?: boolean;\r\n  /** Borderless style */\r\n  borderless?: boolean;\r\n  /** CSS class name */\r\n  className?: string;\r\n  /** Inline styles */\r\n  css?: React.CSSProperties;\r\n  /** Width */\r\n  width?: number | string;\r\n  /** Height */\r\n  height?: number | string;\r\n  /** Minimum width */\r\n  minWidth?: number | string;\r\n  /** Maximum width */\r\n  maxWidth?: number | string;\r\n  /** Connect to multiview (for switching views) */\r\n  multiview?: boolean;\r\n  /** Tooltip text */\r\n  tooltip?: string;\r\n  /** Input alignment */\r\n  inputAlign?: 'left' | 'center' | 'right';\r\n  /** Input width */\r\n  inputWidth?: number;\r\n  /** Input height */\r\n  inputHeight?: number;\r\n  /** Callback when value changes */\r\n  onChange?: (value: string | number | null, option?: AvakioSegmentedOption | null) => void;\r\n  /** Callback before segment is clicked (return false to cancel) */\r\n  onBeforeTabClick?: (id: string | number) => boolean | void;\r\n  /** Callback after segment is clicked */\r\n  onAfterTabClick?: (id: string | number) => void;\r\n  /** Callback when an option is added */\r\n  onOptionAdd?: (option: AvakioSegmentedOption) => void;\r\n  /** Callback when an option is removed */\r\n  onOptionRemove?: (id: string | number) => void;\r\n}\r\n\r\nexport interface AvakioSegmentedButtonRef {\r\n  /** Get the current selected value */\r\n  getValue: () => string | number | null;\r\n  /** Set the selected value */\r\n  setValue: (value: string | number | null) => void;\r\n  /** Get a specific option by ID */\r\n  getOption: (id: string | number) => AvakioSegmentedOption | undefined;\r\n  /** Get all options */\r\n  getOptions: () => AvakioSegmentedOption[];\r\n  /** Add a new option */\r\n  addOption: (option: AvakioSegmentedOption, index?: number) => void;\r\n  /** Remove an option by ID */\r\n  removeOption: (id: string | number) => void;\r\n  /** Hide an option */\r\n  hideOption: (id: string | number) => void;\r\n  /** Show a hidden option */\r\n  showOption: (id: string | number) => void;\r\n  /** Disable a specific option */\r\n  disableOption: (id: string | number) => void;\r\n  /** Enable a specific option */\r\n  enableOption: (id: string | number) => void;\r\n  /** Get the index of an option */\r\n  optionIndex: (id: string | number) => number;\r\n  /** Refresh the component */\r\n  refresh: () => void;\r\n  /** Focus the component */\r\n  focus: () => void;\r\n  /** Blur the component */\r\n  blur: () => void;\r\n  /** Enable the component */\r\n  enable: () => void;\r\n  /** Disable the component */\r\n  disable: () => void;\r\n  /** Check if enabled */\r\n  isEnabled: () => boolean;\r\n  /** Hide the component */\r\n  hide: () => void;\r\n  /** Show the component */\r\n  show: () => void;\r\n  /** Check if visible */\r\n  isVisible: () => boolean;\r\n  /** Validate the control */\r\n  validate: () => boolean;\r\n  /** Get the HTML element */\r\n  getNode: () => HTMLDivElement | null;\r\n}\r\n\r\n// Normalize options to AvakioSegmentedOption[]\r\nconst normalizeOptions = (options: AvakioSegmentedOption[] | string[]): AvakioSegmentedOption[] => {\r\n  return options.map((opt, index) => {\r\n    if (typeof opt === 'string') {\r\n      return { id: opt, value: opt };\r\n    }\r\n    return opt;\r\n  });\r\n};\r\n\r\nexport const AvakioSegmentedButton = forwardRef<AvakioSegmentedButtonRef, AvakioSegmentedButtonProps>(\r\n  (\r\n    {\r\n      id,\r\n      testId,\r\n      name,\r\n      value,\r\n      defaultValue,\r\n      options: optionsProp = [],\r\n      label,\r\n      labelWidth = 120,\r\n      labelAlign = 'left',\r\n      labelPosition = 'left',\r\n      required = false,\r\n      error,\r\n      invalidMessage,\r\n      bottomLabel,\r\n      size = 'md',\r\n      align = 'left',\r\n      theme,\r\n      fill = false,\r\n      optionWidth,\r\n      disabled: disabledProp = false,\r\n      borderless = false,\r\n      className = '',\r\n      css,\r\n      width,\r\n      height,\r\n      minWidth,\r\n      maxWidth,\r\n      multiview = false,\r\n      tooltip,\r\n      inputAlign,\r\n      inputWidth,\r\n      inputHeight,\r\n      onChange,\r\n      onBeforeTabClick,\r\n      onAfterTabClick,\r\n      onOptionAdd,\r\n      onOptionRemove,\r\n    },\r\n    ref\r\n  ) => {\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n    const segmentRefs = useRef<(HTMLButtonElement | null)[]>([]);\r\n    \r\n    // State\r\n    const [internalOptions, setInternalOptions] = useState<AvakioSegmentedOption[]>(() => \r\n      normalizeOptions(optionsProp)\r\n    );\r\n    const isControlled = value !== undefined;\r\n    const [internalValue, setInternalValue] = useState<string | number | null>(() => {\r\n      if (defaultValue !== undefined) return defaultValue;\r\n      const normalized = normalizeOptions(optionsProp);\r\n      const firstEnabled = normalized.find(opt => !opt.disabled && !opt.hidden);\r\n      return firstEnabled?.id ?? null;\r\n    });\r\n    const [disabled, setDisabled] = useState<boolean>(disabledProp);\r\n    const [visible, setVisible] = useState<boolean>(true);\r\n    const [hiddenOptions, setHiddenOptions] = useState<Set<string | number>>(new Set());\r\n    const [disabledOptions, setDisabledOptions] = useState<Set<string | number>>(new Set());\r\n    const [refreshKey, setRefreshKey] = useState(0);\r\n\r\n    const currentValue = isControlled ? value : internalValue;\r\n\r\n    // Sync options when prop changes\r\n    useEffect(() => {\r\n      setInternalOptions(normalizeOptions(optionsProp));\r\n    }, [optionsProp]);\r\n\r\n    // Sync disabled prop\r\n    useEffect(() => {\r\n      setDisabled(disabledProp);\r\n    }, [disabledProp]);\r\n\r\n    // Ensure value points to valid option\r\n    useEffect(() => {\r\n      if (isControlled) return;\r\n      \r\n      const visibleOptions = internalOptions.filter(\r\n        opt => !opt.hidden && !hiddenOptions.has(opt.id)\r\n      );\r\n      const exists = visibleOptions.some(\r\n        opt => opt.id === internalValue && !opt.disabled && !disabledOptions.has(opt.id)\r\n      );\r\n      \r\n      if (!exists && visibleOptions.length > 0) {\r\n        const fallback = visibleOptions.find(\r\n          opt => !opt.disabled && !disabledOptions.has(opt.id)\r\n        )?.id ?? null;\r\n        setInternalValue(fallback);\r\n      }\r\n    }, [internalOptions, internalValue, isControlled, hiddenOptions, disabledOptions]);\r\n\r\n    // Get visible options\r\n    const visibleOptions = internalOptions.filter(\r\n      opt => !opt.hidden && !hiddenOptions.has(opt.id)\r\n    );\r\n\r\n    // Handle segment click\r\n    const handleSegmentClick = useCallback((optionId: string | number) => {\r\n      if (disabled) return;\r\n      \r\n      const option = internalOptions.find(opt => opt.id === optionId);\r\n      if (!option) return;\r\n      if (option.disabled || disabledOptions.has(optionId)) return;\r\n\r\n      // Check before click callback\r\n      if (onBeforeTabClick) {\r\n        const result = onBeforeTabClick(optionId);\r\n        if (result === false) return;\r\n      }\r\n\r\n      if (!isControlled) {\r\n        setInternalValue(optionId);\r\n      }\r\n\r\n      onChange?.(optionId, option);\r\n      onAfterTabClick?.(optionId);\r\n    }, [disabled, internalOptions, disabledOptions, isControlled, onChange, onBeforeTabClick, onAfterTabClick]);\r\n\r\n    // Handle keyboard navigation\r\n    const handleKeyDown = useCallback((e: React.KeyboardEvent, index: number) => {\r\n      if (disabled) return;\r\n\r\n      let targetIndex = -1;\r\n\r\n      switch (e.key) {\r\n        case 'ArrowLeft':\r\n        case 'ArrowUp':\r\n          e.preventDefault();\r\n          targetIndex = index - 1;\r\n          while (targetIndex >= 0) {\r\n            const opt = visibleOptions[targetIndex];\r\n            if (!opt.disabled && !disabledOptions.has(opt.id)) break;\r\n            targetIndex--;\r\n          }\r\n          break;\r\n        case 'ArrowRight':\r\n        case 'ArrowDown':\r\n          e.preventDefault();\r\n          targetIndex = index + 1;\r\n          while (targetIndex < visibleOptions.length) {\r\n            const opt = visibleOptions[targetIndex];\r\n            if (!opt.disabled && !disabledOptions.has(opt.id)) break;\r\n            targetIndex++;\r\n          }\r\n          break;\r\n        case 'Home':\r\n          e.preventDefault();\r\n          targetIndex = 0;\r\n          while (targetIndex < visibleOptions.length) {\r\n            const opt = visibleOptions[targetIndex];\r\n            if (!opt.disabled && !disabledOptions.has(opt.id)) break;\r\n            targetIndex++;\r\n          }\r\n          break;\r\n        case 'End':\r\n          e.preventDefault();\r\n          targetIndex = visibleOptions.length - 1;\r\n          while (targetIndex >= 0) {\r\n            const opt = visibleOptions[targetIndex];\r\n            if (!opt.disabled && !disabledOptions.has(opt.id)) break;\r\n            targetIndex--;\r\n          }\r\n          break;\r\n        case 'Enter':\r\n        case ' ':\r\n          e.preventDefault();\r\n          handleSegmentClick(visibleOptions[index].id);\r\n          return;\r\n      }\r\n\r\n      if (targetIndex >= 0 && targetIndex < visibleOptions.length) {\r\n        segmentRefs.current[targetIndex]?.focus();\r\n      }\r\n    }, [disabled, visibleOptions, disabledOptions, handleSegmentClick]);\r\n\r\n    // Expose imperative methods\r\n    useImperativeHandle(ref, () => ({\r\n      getValue: () => currentValue,\r\n      setValue: (val: string | number | null) => {\r\n        if (!isControlled) {\r\n          setInternalValue(val);\r\n        }\r\n        const option = internalOptions.find(opt => opt.id === val);\r\n        onChange?.(val, option);\r\n      },\r\n      getOption: (optId: string | number) => internalOptions.find(opt => opt.id === optId),\r\n      getOptions: () => internalOptions,\r\n      addOption: (option: AvakioSegmentedOption, index?: number) => {\r\n        setInternalOptions(prev => {\r\n          const newOptions = [...prev];\r\n          if (index !== undefined && index >= 0 && index <= prev.length) {\r\n            newOptions.splice(index, 0, option);\r\n          } else {\r\n            newOptions.push(option);\r\n          }\r\n          return newOptions;\r\n        });\r\n        onOptionAdd?.(option);\r\n      },\r\n      removeOption: (optId: string | number) => {\r\n        setInternalOptions(prev => prev.filter(opt => opt.id !== optId));\r\n        onOptionRemove?.(optId);\r\n        // If removed option was selected, select first available\r\n        if (currentValue === optId && !isControlled) {\r\n          const remaining = internalOptions.filter(\r\n            opt => opt.id !== optId && !opt.hidden && !hiddenOptions.has(opt.id)\r\n          );\r\n          const fallback = remaining.find(\r\n            opt => !opt.disabled && !disabledOptions.has(opt.id)\r\n          )?.id ?? null;\r\n          setInternalValue(fallback);\r\n        }\r\n      },\r\n      hideOption: (optId: string | number) => {\r\n        setHiddenOptions(prev => {\r\n          const next = new Set(Array.from(prev));\r\n          next.add(optId);\r\n          return next;\r\n        });\r\n      },\r\n      showOption: (optId: string | number) => {\r\n        setHiddenOptions(prev => {\r\n          const next = new Set(prev);\r\n          next.delete(optId);\r\n          return next;\r\n        });\r\n      },\r\n      disableOption: (optId: string | number) => {\r\n        setDisabledOptions(prev => {\r\n          const next = new Set(Array.from(prev));\r\n          next.add(optId);\r\n          return next;\r\n        });\r\n      },\r\n      enableOption: (optId: string | number) => {\r\n        setDisabledOptions(prev => {\r\n          const next = new Set(prev);\r\n          next.delete(optId);\r\n          return next;\r\n        });\r\n      },\r\n      optionIndex: (optId: string | number) => internalOptions.findIndex(opt => opt.id === optId),\r\n      refresh: () => setRefreshKey(k => k + 1),\r\n      focus: () => {\r\n        const currentIndex = visibleOptions.findIndex(opt => opt.id === currentValue);\r\n        const focusIndex = currentIndex >= 0 ? currentIndex : 0;\r\n        segmentRefs.current[focusIndex]?.focus();\r\n      },\r\n      blur: () => {\r\n        segmentRefs.current.forEach(el => el?.blur());\r\n      },\r\n      enable: () => setDisabled(false),\r\n      disable: () => setDisabled(true),\r\n      isEnabled: () => !disabled,\r\n      hide: () => setVisible(false),\r\n      show: () => setVisible(true),\r\n      isVisible: () => visible,\r\n      validate: () => {\r\n        if (required && currentValue === null) {\r\n          return false;\r\n        }\r\n        return true;\r\n      },\r\n      getNode: () => containerRef.current,\r\n    }), [\r\n      currentValue, isControlled, internalOptions, visibleOptions, \r\n      hiddenOptions, disabledOptions, disabled, visible, required, \r\n      onChange, onOptionAdd, onOptionRemove\r\n    ]);\r\n\r\n    // Build container styles\r\n    const containerStyles: React.CSSProperties = {\r\n      ...(css && typeof css === 'object' && !Array.isArray(css) ? css : {}),\r\n      ...(width !== undefined && { width: typeof width === 'number' ? `${width}px` : width }),\r\n      ...(height !== undefined && { height: typeof height === 'number' ? `${height}px` : height }),\r\n      ...(minWidth !== undefined && { minWidth: typeof minWidth === 'number' ? `${minWidth}px` : minWidth }),\r\n      ...(maxWidth !== undefined && { maxWidth: typeof maxWidth === 'number' ? `${maxWidth}px` : maxWidth }),\r\n      ...(visible === false && { display: 'none' }),\r\n    };\r\n\r\n    // Build input container styles\r\n    const inputContainerStyles: React.CSSProperties = {\r\n      ...(inputWidth !== undefined && { width: typeof inputWidth === 'number' ? `${inputWidth}px` : inputWidth }),\r\n      ...(inputHeight !== undefined && { height: typeof inputHeight === 'number' ? `${inputHeight}px` : inputHeight }),\r\n      ...(inputAlign !== undefined && { justifyContent: inputAlign === 'left' ? 'flex-start' : inputAlign === 'right' ? 'flex-end' : 'center' }),\r\n    };\r\n\r\n    const hasError = !!error || !!invalidMessage;\r\n\r\n    return (\r\n      <div\r\n        ref={containerRef}\r\n        id={id}\r\n        data-testid={testId}\r\n        data-admin-theme={theme}\r\n        className={[\r\n          'avakio-segmented',\r\n          `avakio-segmented-size-${size}`,\r\n          `avakio-segmented-align-${align}`,\r\n          fill ? 'avakio-segmented-fill' : '',\r\n          borderless ? 'avakio-segmented-borderless' : '',\r\n          disabled ? 'avakio-segmented-disabled' : '',\r\n          hasError ? 'avakio-segmented-error' : '',\r\n          labelPosition === 'top' ? 'avakio-segmented-label-top' : '',\r\n          className,\r\n        ].filter(Boolean).join(' ')}\r\n        style={containerStyles}\r\n        title={tooltip}\r\n        key={refreshKey}\r\n      >\r\n        {label && (\r\n          <label\r\n            className=\"avakio-segmented-label\"\r\n            style={{\r\n              width: labelPosition === 'left' ? labelWidth : 'auto',\r\n              textAlign: labelAlign,\r\n            }}\r\n          >\r\n            {label}\r\n            {required && <span className=\"avakio-segmented-required\">*</span>}\r\n          </label>\r\n        )}\r\n\r\n        <div className=\"avakio-segmented-wrapper\" style={inputContainerStyles}>\r\n          <div \r\n            className=\"avakio-segmented-track\"\r\n            role=\"tablist\"\r\n            aria-label={label || 'Segmented control'}\r\n          >\r\n            {visibleOptions.map((option, index) => {\r\n              const isActive = option.id === currentValue;\r\n              const isDisabled = disabled || option.disabled || disabledOptions.has(option.id);\r\n\r\n              return (\r\n                <button\r\n                  key={option.id}\r\n                  ref={(el) => { segmentRefs.current[index] = el; }}\r\n                  type=\"button\"\r\n                  role=\"tab\"\r\n                  aria-selected={isActive}\r\n                  aria-disabled={isDisabled}\r\n                  aria-controls={option.ariaControls}\r\n                  tabIndex={isActive ? 0 : -1}\r\n                  className={[\r\n                    'avakio-segmented-segment',\r\n                    isActive ? 'avakio-segmented-segment-active' : '',\r\n                    isDisabled ? 'avakio-segmented-segment-disabled' : '',\r\n                  ].filter(Boolean).join(' ')}\r\n                  style={optionWidth ? { width: optionWidth } : undefined}\r\n                  title={option.tooltip}\r\n                  disabled={isDisabled}\r\n                  onClick={() => handleSegmentClick(option.id)}\r\n                  onKeyDown={(e) => handleKeyDown(e, index)}\r\n                >\r\n                  {option.icon && (\r\n                    <span className=\"avakio-segmented-icon\">{option.icon}</span>\r\n                  )}\r\n                  <span className=\"avakio-segmented-text\">{option.value}</span>\r\n                  {option.badge !== undefined && (\r\n                    <span className=\"avakio-segmented-badge\">{option.badge}</span>\r\n                  )}\r\n                </button>\r\n              );\r\n            })}\r\n          </div>\r\n\r\n          {name && (\r\n            <input\r\n              type=\"hidden\"\r\n              name={name}\r\n              value={currentValue?.toString() ?? ''}\r\n            />\r\n          )}\r\n        </div>\r\n\r\n        {(error || invalidMessage) && (\r\n          <div className=\"avakio-segmented-error-text\">{error || invalidMessage}</div>\r\n        )}\r\n\r\n        {bottomLabel && !hasError && (\r\n          <div className=\"avakio-segmented-bottom-label\">{bottomLabel}</div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nAvakioSegmentedButton.displayName = 'AvakioSegmentedButton';\r\n\r\nexport default AvakioSegmentedButton;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { forwardRef, useImperativeHandle, useState, useRef, useEffect } from 'react';\r\nimport './avakio-switch-button.css';\r\n\r\nexport type AvakioSwitchButtonTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\nexport type AvakioSwitchButtonSize = 'sm' | 'md' | 'lg';\r\n\r\nexport interface AvakioSwitchButtonProps {\r\n  /** Unique identifier */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n  /** Name for form submission */\r\n  name?: string;\r\n  /** Current on/off state (controlled) - 1 for on, 0 for off */\r\n  value?: boolean | number;\r\n  /** Default on/off state (uncontrolled) */\r\n  defaultValue?: boolean | number;\r\n  /** Label text (displayed to the left) */\r\n  label?: string;\r\n  /** Width of the label in pixels */\r\n  labelWidth?: number;\r\n  /** Right-hand label text */\r\n  labelRight?: string;\r\n  /** Text label on the switch when in the \"on\" state */\r\n  onLabel?: string;\r\n  /** Text label on the switch when in the \"off\" state */\r\n  offLabel?: string;\r\n  /** Button size */\r\n  size?: AvakioSwitchButtonSize;\r\n  /** Theme variant */\r\n  theme?: AvakioSwitchButtonTheme;\r\n  /** Disabled state */\r\n  disabled?: boolean;\r\n  /** Required field */\r\n  required?: boolean;\r\n  /** Invalid state */\r\n  invalid?: boolean;\r\n  /** Invalid message */\r\n  invalidMessage?: string;\r\n  /** Bottom label text */\r\n  bottomLabel?: string;\r\n  /** Tooltip text */\r\n  tooltip?: string;\r\n  /** CSS class name */\r\n  className?: string;\r\n  /** Inline styles */\r\n  css?: React.CSSProperties;\r\n  /** Width */\r\n  width?: number | string;\r\n  /** Height */\r\n  height?: number | string;\r\n  /** Callback when value changes */\r\n  onChange?: (value: boolean) => void;\r\n  /** Callback when clicked */\r\n  onClick?: (e: React.MouseEvent<HTMLButtonElement>) => void;\r\n  /** Callback when focused */\r\n  onFocus?: (e: React.FocusEvent<HTMLButtonElement>) => void;\r\n  /** Callback when blurred */\r\n  onBlur?: (e: React.FocusEvent<HTMLButtonElement>) => void;\r\n}\r\n\r\nexport interface AvakioSwitchButtonRef {\r\n  /** Get the current on/off state */\r\n  getValue: () => boolean;\r\n  /** Set the on/off state */\r\n  setValue: (value: boolean) => void;\r\n  /** Toggle the state */\r\n  toggle: () => void;\r\n  /** Focus the switch */\r\n  focus: () => void;\r\n  /** Blur the switch */\r\n  blur: () => void;\r\n  /** Enable the switch */\r\n  enable: () => void;\r\n  /** Disable the switch */\r\n  disable: () => void;\r\n  /** Check if enabled */\r\n  isEnabled: () => boolean;\r\n  /** Get the HTML element */\r\n  getNode: () => HTMLButtonElement | null;\r\n  /** Refresh/repaint the component */\r\n  refresh: () => void;\r\n}\r\n\r\nexport const AvakioSwitchButton = forwardRef<AvakioSwitchButtonRef, AvakioSwitchButtonProps>(\r\n  (\r\n    {\r\n      id,\r\n      testId,\r\n      name,\r\n      value,\r\n      defaultValue = false,\r\n      label,\r\n      labelWidth = 80,\r\n      labelRight,\r\n      onLabel,\r\n      offLabel,\r\n      size = 'md',\r\n      theme,\r\n      disabled: disabledProp = false,\r\n      required = false,\r\n      invalid = false,\r\n      invalidMessage,\r\n      bottomLabel,\r\n      tooltip,\r\n      className = '',\r\n      css,\r\n      width,\r\n      height,\r\n      onChange,\r\n      onClick,\r\n      onFocus,\r\n      onBlur,\r\n    },\r\n    ref\r\n  ) => {\r\n    const switchRef = useRef<HTMLButtonElement>(null);\r\n    const isControlled = value !== undefined;\r\n    const normalizeValue = (val: boolean | number | undefined): boolean => {\r\n      if (val === undefined) return false;\r\n      return val === true || val === 1;\r\n    };\r\n    const [internalValue, setInternalValue] = useState<boolean>(normalizeValue(defaultValue));\r\n    const [disabled, setDisabled] = useState<boolean>(disabledProp);\r\n    const [, forceUpdate] = useState({});\r\n\r\n    const isOn = isControlled ? normalizeValue(value) : internalValue;\r\n\r\n    // Sync disabled prop\r\n    useEffect(() => {\r\n      setDisabled(disabledProp);\r\n    }, [disabledProp]);\r\n\r\n    // Expose imperative methods\r\n    useImperativeHandle(ref, () => ({\r\n      getValue: () => (isControlled ? normalizeValue(value) : internalValue),\r\n      setValue: (newValue: boolean) => {\r\n        if (!isControlled) {\r\n          setInternalValue(newValue);\r\n        }\r\n        onChange?.(newValue);\r\n      },\r\n      toggle: () => {\r\n        const currentValue = isControlled ? normalizeValue(value) : internalValue;\r\n        const newValue = !currentValue;\r\n        if (!isControlled) {\r\n          setInternalValue(newValue);\r\n        }\r\n        onChange?.(newValue);\r\n      },\r\n      focus: () => switchRef.current?.focus(),\r\n      blur: () => switchRef.current?.blur(),\r\n      enable: () => setDisabled(false),\r\n      disable: () => setDisabled(true),\r\n      isEnabled: () => !disabled,\r\n      getNode: () => switchRef.current,\r\n      refresh: () => forceUpdate({}),\r\n    }), [isControlled, value, internalValue, disabled, onChange]);\r\n\r\n    const handleClick = (e: React.MouseEvent<HTMLButtonElement>) => {\r\n      if (disabled) return;\r\n      \r\n      const newValue = !isOn;\r\n      if (!isControlled) {\r\n        setInternalValue(newValue);\r\n      }\r\n      onChange?.(newValue);\r\n      onClick?.(e);\r\n    };\r\n\r\n    // Build class names\r\n    const containerClassNames = [\r\n      'avakio-switch-container',\r\n      `avakio-switch-container-${size}`,\r\n      theme && `avakio-switch-theme-${theme}`,\r\n      disabled && 'avakio-switch-container-disabled',\r\n      invalid && 'avakio-switch-container-invalid',\r\n      className,\r\n    ]\r\n      .filter(Boolean)\r\n      .join(' ');\r\n\r\n    const switchClassNames = [\r\n      'avakio-switch-button',\r\n      `avakio-switch-button-${size}`,\r\n      isOn && 'avakio-switch-button-on',\r\n      disabled && 'avakio-switch-button-disabled',\r\n      (onLabel || offLabel) && 'avakio-switch-button-with-labels',\r\n    ]\r\n      .filter(Boolean)\r\n      .join(' ');\r\n\r\n    // Build styles\r\n    const containerStyles: React.CSSProperties = {\r\n      ...(css && typeof css === 'object' && !Array.isArray(css) ? css : {}),\r\n      width: typeof width === 'number' ? `${width}px` : width,\r\n      height: typeof height === 'number' ? `${height}px` : height,\r\n    };\r\n\r\n    const labelStyles: React.CSSProperties = {\r\n      width: labelWidth > 0 ? `${labelWidth}px` : undefined,\r\n      minWidth: labelWidth > 0 ? `${labelWidth}px` : undefined,\r\n    };\r\n\r\n    // Determine switch inner text\r\n    const switchInnerText = isOn ? onLabel : offLabel;\r\n    const hasInnerLabels = onLabel || offLabel;\r\n\r\n    return (\r\n      <div\r\n        className={containerClassNames}\r\n        style={containerStyles}\r\n        data-admin-theme={theme}\r\n      >\r\n        {/* Left Label */}\r\n        {label && (\r\n          <label \r\n            className=\"avakio-switch-label avakio-switch-label-left\"\r\n            style={labelStyles}\r\n          >\r\n            {label}\r\n            {required && <span className=\"avakio-switch-required\">*</span>}\r\n          </label>\r\n        )}\r\n\r\n        {/* Switch Track */}\r\n        <button\r\n          ref={switchRef}\r\n          id={id}\r\n          data-testid={testId}\r\n          name={name}\r\n          type=\"button\"\r\n          role=\"switch\"\r\n          aria-checked={isOn}\r\n          aria-disabled={disabled}\r\n          aria-label={label || labelRight || 'Switch'}\r\n          className={switchClassNames}\r\n          disabled={disabled}\r\n          title={tooltip}\r\n          onClick={handleClick}\r\n          onFocus={onFocus}\r\n          onBlur={onBlur}\r\n        >\r\n          {/* Track with inner labels */}\r\n          <span className=\"avakio-switch-track\">\r\n            {hasInnerLabels && (\r\n              <>\r\n                <span className=\"avakio-switch-track-on-label\">{onLabel}</span>\r\n                <span className=\"avakio-switch-track-off-label\">{offLabel}</span>\r\n              </>\r\n            )}\r\n            <span className=\"avakio-switch-thumb\" />\r\n          </span>\r\n        </button>\r\n\r\n        {/* Right Label */}\r\n        {labelRight && (\r\n          <label className=\"avakio-switch-label avakio-switch-label-right\">\r\n            {labelRight}\r\n            {required && !label && <span className=\"avakio-switch-required\">*</span>}\r\n          </label>\r\n        )}\r\n\r\n        {/* Bottom Label / Invalid Message */}\r\n        {(bottomLabel || (invalid && invalidMessage)) && (\r\n          <div className=\"avakio-switch-bottom\">\r\n            {invalid && invalidMessage ? (\r\n              <span className=\"avakio-switch-invalid-message\">{invalidMessage}</span>\r\n            ) : (\r\n              <span className=\"avakio-switch-bottom-label\">{bottomLabel}</span>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nAvakioSwitchButton.displayName = 'AvakioSwitchButton';\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\r\nimport { ChevronLeft, ChevronRight, X } from 'lucide-react';\r\nimport './avakio-tabbar.css';\r\n\r\nexport interface AvakioTabBarOption {\r\n  id: string | number;\r\n  label: string;\r\n  icon?: React.ReactNode;\r\n  badge?: string | number;\r\n  close?: boolean;\r\n  disabled?: boolean;\r\n  hidden?: boolean;\r\n  ariaControls?: string;\r\n}\r\n\r\nexport type AvakioTabBarAlign = 'left' | 'center' | 'justify';\r\nexport type AvakioTabBarType = 'top' | 'bottom';\r\nexport type AvakioTabBarSize = 'md' | 'sm';\r\n\r\nexport interface AvakioTabBarProps {\r\n  id?: string;\r\n  value?: string | number | null;\r\n  options?: AvakioTabBarOption[];\r\n  onChange?: (value: string | number | null, option?: AvakioTabBarOption | null) => void;\r\n  onClose?: (value: string | number, option?: AvakioTabBarOption) => void;\r\n  renderTab?: (option: AvakioTabBarOption, isActive: boolean, closeButton: React.ReactNode) => React.ReactNode;\r\n  align?: AvakioTabBarAlign;\r\n  type?: AvakioTabBarType;\r\n  closable?: boolean;\r\n  fill?: boolean;\r\n  size?: AvakioTabBarSize;\r\n  scrollable?: boolean;\r\n  label?: string;\r\n  labelWidth?: number;\r\n  labelAlign?: 'left' | 'right';\r\n  required?: boolean;\r\n  error?: string;\r\n  disabled?: boolean;\r\n  className?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n}\r\n\r\nexport function AvakioTabBar({\r\n  id,\r\n  value,\r\n  options = [],\r\n  onChange,\r\n  onClose,\r\n  renderTab,\r\n  align = 'left',\r\n  type = 'top',\r\n  closable = false,\r\n  fill = false,\r\n  size = 'md',\r\n  scrollable = true,\r\n  label,\r\n  labelWidth = 120,\r\n  labelAlign = 'left',\r\n  required = false,\r\n  error,\r\n  disabled = false,\r\n  className = '',\r\n  testId,\r\n}: AvakioTabBarProps) {\r\n  const [internalValue, setInternalValue] = useState<string | number | null>(value ?? null);\r\n  const [closedIds, setClosedIds] = useState<Set<string | number>>(new Set());\r\n  const [canScrollLeft, setCanScrollLeft] = useState(false);\r\n  const [canScrollRight, setCanScrollRight] = useState(false);\r\n  const tabRefs = useRef<(HTMLButtonElement | null)[]>([]);\r\n  const trackRef = useRef<HTMLDivElement>(null);\r\n\r\n  // Normalize options and filter hidden/closed ones\r\n  const visibleOptions = useMemo(() => {\r\n    return options\r\n      .filter((opt) => !opt.hidden)\r\n      .filter((opt) => !closedIds.has(opt.id));\r\n  }, [options, closedIds]);\r\n\r\n  // Resolve controlled vs uncontrolled value\r\n  const currentValue = value !== undefined ? value : internalValue;\r\n\r\n  // Ensure we always point to an existing tab\r\n  useEffect(() => {\r\n    if (value !== undefined) return;\r\n    const exists = visibleOptions.some((opt) => opt.id === internalValue && !opt.disabled);\r\n    if (!exists) {\r\n      const fallback = visibleOptions.find((opt) => !opt.disabled)?.id ?? null;\r\n      setInternalValue(fallback);\r\n    }\r\n  }, [visibleOptions, internalValue, value]);\r\n\r\n  // Mirror controlled value into internal state for focus management\r\n  useEffect(() => {\r\n    if (value !== undefined) {\r\n      setInternalValue(value ?? null);\r\n    }\r\n  }, [value]);\r\n\r\n  // Check if scroll arrows should be visible\r\n  const checkScrollButtons = useCallback(() => {\r\n    const track = trackRef.current;\r\n    if (!track || !scrollable) {\r\n      setCanScrollLeft(false);\r\n      setCanScrollRight(false);\r\n      return;\r\n    }\r\n    \r\n    const { scrollLeft, scrollWidth, clientWidth } = track;\r\n    setCanScrollLeft(scrollLeft > 0);\r\n    setCanScrollRight(scrollLeft + clientWidth < scrollWidth - 1);\r\n  }, [scrollable]);\r\n\r\n  // Update scroll buttons on mount, resize, and when options change\r\n  useEffect(() => {\r\n    checkScrollButtons();\r\n    \r\n    const track = trackRef.current;\r\n    if (track) {\r\n      track.addEventListener('scroll', checkScrollButtons);\r\n      \r\n      // Use ResizeObserver to detect size changes\r\n      const resizeObserver = new ResizeObserver(checkScrollButtons);\r\n      resizeObserver.observe(track);\r\n      \r\n      return () => {\r\n        track.removeEventListener('scroll', checkScrollButtons);\r\n        resizeObserver.disconnect();\r\n      };\r\n    }\r\n  }, [checkScrollButtons, visibleOptions]);\r\n\r\n  // Scroll handlers\r\n  const scrollLeft = () => {\r\n    const track = trackRef.current;\r\n    if (track) {\r\n      track.scrollBy({ left: -150, behavior: 'smooth' });\r\n    }\r\n  };\r\n\r\n  const scrollRight = () => {\r\n    const track = trackRef.current;\r\n    if (track) {\r\n      track.scrollBy({ left: 150, behavior: 'smooth' });\r\n    }\r\n  };\r\n\r\n  const setTabRef = (index: number, el: HTMLButtonElement | null) => {\r\n    tabRefs.current[index] = el;\r\n  };\r\n\r\n  const focusTabById = (id: string | number | null) => {\r\n    if (id === null || id === undefined) return;\r\n    const idx = visibleOptions.findIndex((opt) => opt.id === id);\r\n    if (idx >= 0) {\r\n      tabRefs.current[idx]?.focus();\r\n    }\r\n  };\r\n\r\n  const selectTab = (option: AvakioTabBarOption | undefined | null) => {\r\n    if (!option || option.disabled || disabled) return;\r\n    if (value === undefined) {\r\n      setInternalValue(option.id);\r\n    }\r\n    onChange?.(option.id, option);\r\n  };\r\n\r\n  const handleClose = (option: AvakioTabBarOption, event?: React.MouseEvent) => {\r\n    if (event) {\r\n      event.stopPropagation();\r\n      event.preventDefault();\r\n    }\r\n    if (option.disabled || disabled) return;\r\n\r\n    setClosedIds((prev) => {\r\n      const next = new Set(prev);\r\n      next.add(option.id);\r\n      return next;\r\n    });\r\n\r\n    onClose?.(option.id, option);\r\n\r\n    // Move selection if we closed the active tab in uncontrolled mode\r\n    if (value === undefined && currentValue === option.id) {\r\n      const remaining = visibleOptions.filter((opt) => opt.id !== option.id && !opt.disabled);\r\n      const nextActive = remaining[0]?.id ?? null;\r\n      setInternalValue(nextActive);\r\n      requestAnimationFrame(() => focusTabById(nextActive));\r\n    }\r\n  };\r\n\r\n  const moveFocus = (direction: 'next' | 'prev' | 'first' | 'last') => {\r\n    if (!visibleOptions.length) return;\r\n    const enabled = visibleOptions.filter((opt) => !opt.disabled);\r\n    if (!enabled.length) return;\r\n\r\n    const currentIdx = enabled.findIndex((opt) => opt.id === currentValue);\r\n    const safeIdx = currentIdx === -1 ? 0 : currentIdx;\r\n\r\n    let target: AvakioTabBarOption;\r\n    switch (direction) {\r\n      case 'next':\r\n        target = enabled[(safeIdx + 1) % enabled.length];\r\n        break;\r\n      case 'prev':\r\n        target = enabled[(safeIdx - 1 + enabled.length) % enabled.length];\r\n        break;\r\n      case 'first':\r\n        target = enabled[0];\r\n        break;\r\n      case 'last':\r\n        target = enabled[enabled.length - 1];\r\n        break;\r\n    }\r\n\r\n    selectTab(target);\r\n    focusTabById(target.id);\r\n  };\r\n\r\n  const handleKeyDown = (e: React.KeyboardEvent<HTMLDivElement>) => {\r\n    switch (e.key) {\r\n      case 'ArrowRight':\r\n      case 'ArrowDown':\r\n        e.preventDefault();\r\n        moveFocus('next');\r\n        break;\r\n      case 'ArrowLeft':\r\n      case 'ArrowUp':\r\n        e.preventDefault();\r\n        moveFocus('prev');\r\n        break;\r\n      case 'Home':\r\n        e.preventDefault();\r\n        moveFocus('first');\r\n        break;\r\n      case 'End':\r\n        e.preventDefault();\r\n        moveFocus('last');\r\n        break;\r\n      case 'Delete':\r\n      case 'Backspace':\r\n        if (closable) {\r\n          const active = visibleOptions.find((opt) => opt.id === currentValue);\r\n          if (active) {\r\n            e.preventDefault();\r\n            handleClose(active);\r\n          }\r\n        }\r\n        break;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div\r\n      id={id}\r\n      data-testid={testId}\r\n      className={`avakio-tabbar ${className}`.trim()}\r\n      data-type={type}\r\n      data-align={align}\r\n      data-size={size}\r\n      data-fill={fill}\r\n      data-disabled={disabled}\r\n      data-error={!!error}\r\n    >\r\n      {label && (\r\n        <div\r\n          className=\"avakio-tabbar-label\"\r\n          style={{ width: labelWidth, textAlign: labelAlign }}\r\n        >\r\n          <span>{label}</span>\r\n          {required && <span className=\"avakio-tabbar-required\">*</span>}\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"avakio-tabbar-wrapper\">\r\n        {/* Left scroll arrow */}\r\n        {scrollable && canScrollLeft && (\r\n          <button\r\n            type=\"button\"\r\n            className=\"avakio-tabbar-scroll-btn avakio-tabbar-scroll-left\"\r\n            onClick={scrollLeft}\r\n            aria-label=\"Scroll tabs left\"\r\n          >\r\n            <ChevronLeft size={16} strokeWidth={2.5} />\r\n          </button>\r\n        )}\r\n\r\n        <div\r\n          ref={trackRef}\r\n          className=\"avakio-tabbar-track\"\r\n          role=\"tablist\"\r\n          aria-label={label || 'Tab Bar'}\r\n          data-scrollable={scrollable}\r\n          data-has-scroll-left={canScrollLeft}\r\n          data-has-scroll-right={canScrollRight}\r\n          onKeyDown={handleKeyDown}\r\n        >\r\n          {visibleOptions.map((option, index) => {\r\n            const isActive = option.id === currentValue;\r\n            const isDisabled = disabled || option.disabled;\r\n            const showClose = (option.close || closable) && !isDisabled;\r\n\r\n            const closeButton = showClose ? (\r\n              <button\r\n                type=\"button\"\r\n                className=\"avakio-tabbar-close\"\r\n                aria-label={`Close ${option.label}`}\r\n                onClick={(e) => handleClose(option, e)}\r\n              >\r\n                <X size={14} strokeWidth={2.5} />\r\n              </button>\r\n            ) : null;\r\n\r\n            const defaultContent = (\r\n              <>\r\n                <span className=\"avakio-tabbar-inner\">\r\n                  {option.icon && <span className=\"avakio-tabbar-icon\">{option.icon}</span>}\r\n                  <span className=\"avakio-tabbar-text\">{option.label}</span>\r\n                  {option.badge !== undefined && (\r\n                    <span className=\"avakio-tabbar-badge\">{option.badge}</span>\r\n                  )}\r\n                </span>\r\n                {closeButton}\r\n              </>\r\n            );\r\n\r\n            const tabContent = renderTab\r\n              ? renderTab(option, isActive, closeButton)\r\n              : defaultContent;\r\n\r\n            return (\r\n              <div\r\n                key={option.id}\r\n                ref={(el) => setTabRef(index, el as unknown as HTMLButtonElement)}\r\n                className={`avakio-tabbar-tab${isActive ? ' active' : ''}`}\r\n                role=\"tab\"\r\n                aria-selected={isActive}\r\n                aria-controls={option.ariaControls}\r\n                tabIndex={isActive && !isDisabled ? 0 : -1}\r\n                onClick={() => selectTab(option)}\r\n                onKeyDown={(e) => {\r\n                  if (e.key === 'Enter' || e.key === ' ') {\r\n                    e.preventDefault();\r\n                    selectTab(option);\r\n                  }\r\n                }}\r\n                aria-disabled={isDisabled}\r\n                data-active={isActive}\r\n                data-disabled={isDisabled}\r\n              >\r\n                {tabContent}\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n\r\n        {/* Right scroll arrow */}\r\n        {scrollable && canScrollRight && (\r\n          <button\r\n            type=\"button\"\r\n            className=\"avakio-tabbar-scroll-btn avakio-tabbar-scroll-right\"\r\n            onClick={scrollRight}\r\n            aria-label=\"Scroll tabs right\"\r\n          >\r\n            <ChevronRight size={16} strokeWidth={2.5} />\r\n          </button>\r\n        )}\r\n\r\n        {error && <div className=\"avakio-tabbar-error\">{error}</div>}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { forwardRef, useState, useEffect, useRef, useImperativeHandle, ChangeEvent, KeyboardEvent, FocusEvent } from 'react';\r\nimport { X, Eye, EyeOff, Copy } from 'lucide-react';\r\nimport './avakio-text.css';\r\n\r\nexport interface AvakioTextProps {\r\n  /** The value of the text input */\r\n  value?: string;\r\n  /** The label text */\r\n  label?: string;\r\n  /** The placeholder text */\r\n  placeholder?: string;\r\n  /** The name attribute */\r\n  name?: string;\r\n  /** The type of input (text, password, email, url, number, tel) */\r\n  type?: 'text' | 'password' | 'email' | 'url' | 'number' | 'tel' | 'search';\r\n  /** Whether the input is disabled */\r\n  disabled?: boolean;\r\n  /** Whether the input is readonly */\r\n  readonly?: boolean;\r\n  /** Whether the input is required */\r\n  required?: boolean;\r\n  /** The theme (material, flat, compact, dark, ocean, sunset) */\r\n  theme?: string;\r\n  /** Custom CSS class */\r\n  className?: string;\r\n  /** Width of the component */\r\n  width?: string | number;\r\n  /** Height of the component */\r\n  height?: string | number;\r\n  /** Label width */\r\n  labelWidth?: number;\r\n  /** Label position (left or top) */\r\n  labelPosition?: 'left' | 'top';\r\n  /** Label alignment (left or right) */\r\n  labelAlign?: 'left' | 'right';\r\n  /** Input alignment (left, center, right) */\r\n  inputAlign?: 'left' | 'center' | 'right';\r\n  /** Bottom label text */\r\n  bottomLabel?: string;\r\n  /** Shows clear button when input has value */\r\n  clear?: boolean;\r\n  /** Enables copy button to copy the input value to clipboard */\r\n  enableValueCopyButton?: boolean;\r\n  /** Enables copy button to copy the placeholder text to clipboard */\r\n  enablePlaceHolderCopyButton?: boolean;\r\n  /** Icon to show in the input */\r\n  icon?: React.ReactNode;\r\n  /** Icon position (left or right) */\r\n  iconPosition?: 'left' | 'right';\r\n  /** Validation rules */\r\n  validate?: (value: string) => boolean | string;\r\n  /** Validation event (change, blur, submit) */\r\n  validateEvent?: 'change' | 'blur' | 'submit';\r\n  /** Invalid state */\r\n  invalid?: boolean;\r\n  /** Invalid message */\r\n  invalidMessage?: string;\r\n  /** Maximum length */\r\n  maxLength?: number;\r\n  /** Pattern for HTML5 validation */\r\n  pattern?: string;\r\n  /** Minimum value (for number type) */\r\n  min?: number;\r\n  /** Maximum value (for number type) */\r\n  max?: number;\r\n  /** Step value (for number type) */\r\n  step?: number;\r\n  /** Autocomplete attribute */\r\n  autoComplete?: string;\r\n  /** Enable multiline mode (renders textarea instead of input) */\r\n  multiline?: boolean;\r\n  /** Number of visible rows (only for multiline) */\r\n  rows?: number;\r\n  /** onChange callback */\r\n  onChange?: (value: string, event: ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => void;\r\n  /** onBlur callback */\r\n  onBlur?: (event: FocusEvent<HTMLInputElement | HTMLTextAreaElement>) => void;\r\n  /** onFocus callback */\r\n  onFocus?: (event: FocusEvent<HTMLInputElement | HTMLTextAreaElement>) => void;\r\n  /** onEnter callback */\r\n  onEnter?: (value: string) => void;\r\n  /** onKeyPress callback */\r\n  onKeyPress?: (event: KeyboardEvent<HTMLInputElement | HTMLTextAreaElement>) => void;\r\n  /** onClick callback for the entire component */\r\n  onClick?: () => void;\r\n  /** Padding (number for all sides, string for CSS, or [top, right, bottom, left]) */\r\n  padding?: string | number | [number, number, number, number];\r\n  /** Margin (number for all sides, string for CSS, or [top, right, bottom, left]) */\r\n  margin?: string | number | [number, number, number, number];\r\n  /** Width of the text input/textarea (e.g., '100%', '200px') */\r\n  textWidth?: string | number;\r\n}\r\n\r\nexport interface AvakioTextRef {\r\n  /** Get the current value */\r\n  getValue: () => string;\r\n  /** Set a new value */\r\n  setValue: (value: string) => void;\r\n  /** Focus the input */\r\n  focus: () => void;\r\n  /** Blur the input */\r\n  blur: () => void;\r\n  /** Validate the input */\r\n  validate: () => boolean;\r\n  /** Get the input element */\r\n  getInputNode: () => HTMLInputElement | HTMLTextAreaElement | null;\r\n  /** Clear the input */\r\n  clear: () => void;\r\n  /** Check if input is enabled */\r\n  isEnabled: () => boolean;\r\n  /** Disable the input */\r\n  disable: () => void;\r\n  /** Enable the input */\r\n  enable: () => void;\r\n}\r\n\r\nexport const AvakioText = forwardRef<AvakioTextRef, AvakioTextProps>(\r\n  (\r\n    {\r\n      value = '',\r\n      label,\r\n      placeholder,\r\n      name,\r\n      type = 'text',\r\n      disabled = false,\r\n      readonly = false,\r\n      required = false,\r\n      theme = 'material',\r\n      className = '',\r\n      width,\r\n      height,\r\n      labelWidth = 100,\r\n      labelPosition = 'left',\r\n      labelAlign = 'left',\r\n      inputAlign = 'left',\r\n      bottomLabel,\r\n      clear = false,\r\n      enableValueCopyButton = false,\r\n      enablePlaceHolderCopyButton = false,\r\n      icon,\r\n      iconPosition = 'left',\r\n      validate,\r\n      validateEvent = 'blur',\r\n      invalid = false,\r\n      invalidMessage,\r\n      maxLength,\r\n      pattern,\r\n      min,\r\n      max,\r\n      step,\r\n      autoComplete,\r\n      multiline = false,\r\n      rows = 4,\r\n      onChange,\r\n      onBlur,\r\n      onFocus,\r\n      onEnter,\r\n      onKeyPress,\r\n      onClick,\r\n      padding,\r\n      margin,\r\n      textWidth,\r\n    },\r\n    ref\r\n  ) => {\r\n    const [currentValue, setCurrentValue] = useState<string>(value);\r\n    const [isInvalid, setIsInvalid] = useState(invalid);\r\n    const [validationMessage, setValidationMessage] = useState(invalidMessage || '');\r\n    const [isFocused, setIsFocused] = useState(false);\r\n    const [isDisabled, setIsDisabled] = useState(disabled);\r\n    const [showPassword, setShowPassword] = useState(false);\r\n    const inputRef = useRef<HTMLInputElement | HTMLTextAreaElement>(null);\r\n\r\n    useEffect(() => {\r\n      setCurrentValue(value);\r\n    }, [value]);\r\n\r\n    useEffect(() => {\r\n      setIsInvalid(invalid);\r\n    }, [invalid]);\r\n\r\n    useEffect(() => {\r\n      setIsDisabled(disabled);\r\n    }, [disabled]);\r\n\r\n    const validateInput = (val: string): boolean => {\r\n      if (validate) {\r\n        const result = validate(val);\r\n        if (typeof result === 'string') {\r\n          setIsInvalid(true);\r\n          setValidationMessage(result);\r\n          return false;\r\n        } else if (result === false) {\r\n          setIsInvalid(true);\r\n          setValidationMessage(invalidMessage || 'Invalid value');\r\n          return false;\r\n        }\r\n      }\r\n\r\n      // HTML5 validation\r\n      if (required && !val.trim()) {\r\n        setIsInvalid(true);\r\n        setValidationMessage('This field is required');\r\n        return false;\r\n      }\r\n\r\n      if (type === 'email' && val && !/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(val)) {\r\n        setIsInvalid(true);\r\n        setValidationMessage('Please enter a valid email address');\r\n        return false;\r\n      }\r\n\r\n      if (type === 'url' && val && !/^https?:\\/\\/.+/.test(val)) {\r\n        setIsInvalid(true);\r\n        setValidationMessage('Please enter a valid URL');\r\n        return false;\r\n      }\r\n\r\n      if (type === 'number' && val) {\r\n        const num = parseFloat(val);\r\n        if (isNaN(num)) {\r\n          setIsInvalid(true);\r\n          setValidationMessage('Please enter a valid number');\r\n          return false;\r\n        }\r\n        if (min !== undefined && num < min) {\r\n          setIsInvalid(true);\r\n          setValidationMessage(`Value must be at least ${min}`);\r\n          return false;\r\n        }\r\n        if (max !== undefined && num > max) {\r\n          setIsInvalid(true);\r\n          setValidationMessage(`Value must be at most ${max}`);\r\n          return false;\r\n        }\r\n      }\r\n\r\n      if (pattern && val && !new RegExp(pattern).test(val)) {\r\n        setIsInvalid(true);\r\n        setValidationMessage(invalidMessage || 'Invalid format');\r\n        return false;\r\n      }\r\n\r\n      if (maxLength && val.length > maxLength) {\r\n        setIsInvalid(true);\r\n        setValidationMessage(`Maximum length is ${maxLength} characters`);\r\n        return false;\r\n      }\r\n\r\n      setIsInvalid(false);\r\n      setValidationMessage('');\r\n      return true;\r\n    };\r\n\r\n    const handleChange = (e: ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\r\n      const newValue = e.target.value;\r\n      setCurrentValue(newValue);\r\n\r\n      if (validateEvent === 'change') {\r\n        validateInput(newValue);\r\n      }\r\n\r\n      if (onChange) {\r\n        onChange(newValue, e);\r\n      }\r\n    };\r\n\r\n    const handleBlur = (e: FocusEvent<HTMLInputElement | HTMLTextAreaElement>) => {\r\n      setIsFocused(false);\r\n\r\n      if (validateEvent === 'blur') {\r\n        validateInput(currentValue);\r\n      }\r\n\r\n      if (onBlur) {\r\n        onBlur(e);\r\n      }\r\n    };\r\n\r\n    const handleFocus = (e: FocusEvent<HTMLInputElement | HTMLTextAreaElement>) => {\r\n      setIsFocused(true);\r\n\r\n      if (onFocus) {\r\n        onFocus(e);\r\n      }\r\n    };\r\n\r\n    const handleKeyPress = (e: KeyboardEvent<HTMLInputElement | HTMLTextAreaElement>) => {\r\n      if (e.key === 'Enter' && !multiline && onEnter) {\r\n        onEnter(currentValue);\r\n      }\r\n\r\n      if (onKeyPress) {\r\n        onKeyPress(e);\r\n      }\r\n    };\r\n\r\n    const handleClear = () => {\r\n      setCurrentValue('');\r\n      setIsInvalid(false);\r\n      setValidationMessage('');\r\n      if (onChange) {\r\n        onChange('', {} as ChangeEvent<HTMLInputElement | HTMLTextAreaElement>);\r\n      }\r\n      inputRef.current?.focus();\r\n    };\r\n\r\n    const togglePasswordVisibility = () => {\r\n      setShowPassword(!showPassword);\r\n    };\r\n\r\n    const handleCopyToClipboard = () => {\r\n      if (currentValue) {\r\n        navigator.clipboard.writeText(currentValue).then(() => {\r\n          // Optional: You could add a toast notification here\r\n        }).catch((err) => {\r\n          console.error('Failed to copy text: ', err);\r\n        });\r\n      }\r\n    };\r\n\r\n    const handleCopyPlaceholder = () => {\r\n      if (placeholder) {\r\n        navigator.clipboard.writeText(placeholder).then(() => {\r\n          // Optional: You could add a toast notification here\r\n        }).catch((err) => {\r\n          console.error('Failed to copy placeholder: ', err);\r\n        });\r\n      }\r\n    };\r\n\r\n    useImperativeHandle(ref, () => ({\r\n      getValue: () => currentValue,\r\n      setValue: (val: string) => {\r\n        setCurrentValue(val);\r\n        if (validateEvent === 'change') {\r\n          validateInput(val);\r\n        }\r\n      },\r\n      focus: () => inputRef.current?.focus(),\r\n      blur: () => inputRef.current?.blur(),\r\n      validate: () => validateInput(currentValue),\r\n      getInputNode: () => inputRef.current,\r\n      clear: handleClear,\r\n      isEnabled: () => !isDisabled,\r\n      disable: () => setIsDisabled(true),\r\n      enable: () => setIsDisabled(false),\r\n    }));\r\n\r\n    const labelStyle: React.CSSProperties = {\r\n      width: labelPosition === 'left' ? labelWidth : undefined,\r\n      textAlign: labelAlign,\r\n    };\r\n\r\n    const inputType = type === 'password' && showPassword ? 'text' : type;\r\n\r\n    // Handle padding\r\n    const paddingStyle = padding\r\n      ? typeof padding === 'number'\r\n        ? `${padding}px`\r\n        : Array.isArray(padding)\r\n        ? `${padding[0]}px ${padding[1]}px ${padding[2]}px ${padding[3]}px`\r\n        : padding\r\n      : undefined;\r\n\r\n    // Handle margin\r\n    const marginStyle = margin\r\n      ? typeof margin === 'number'\r\n        ? `${margin}px`\r\n        : Array.isArray(margin)\r\n        ? `${margin[0]}px ${margin[1]}px ${margin[2]}px ${margin[3]}px`\r\n        : margin\r\n      : undefined;\r\n\r\n    const containerStyle: React.CSSProperties = {\r\n      width: typeof width === 'number' ? `${width}px` : width,\r\n      height: typeof height === 'number' ? `${height}px` : height,\r\n      ...(paddingStyle && { padding: paddingStyle }),\r\n      ...(marginStyle && { margin: marginStyle }),\r\n    };\r\n\r\n    const containerClasses = [\r\n      'avakio-text',\r\n      `avakio-text-theme-${theme}`,\r\n      labelPosition === 'top' ? 'avakio-text-label-top' : 'avakio-text-label-left',\r\n      isInvalid ? 'avakio-text-invalid' : '',\r\n      isDisabled ? 'avakio-text-disabled' : '',\r\n      isFocused ? 'avakio-text-focused' : '',\r\n      readonly ? 'avakio-text-readonly' : '',\r\n      className,\r\n    ]\r\n      .filter(Boolean)\r\n      .join(' ');\r\n\r\n    const hasActionButton = (clear && currentValue) || type === 'password' || (enableValueCopyButton && currentValue) || (enablePlaceHolderCopyButton && placeholder);\r\n    \r\n    const inputClasses = [\r\n      'avakio-text-input',\r\n      `avakio-text-input-align-${inputAlign}`,\r\n      icon && iconPosition === 'left' ? 'avakio-text-input-with-icon-left' : '',\r\n      icon && iconPosition === 'right' && !hasActionButton ? 'avakio-text-input-with-icon-right' : '',\r\n      hasActionButton ? 'avakio-text-input-with-action' : '',\r\n    ]\r\n      .filter(Boolean)\r\n      .join(' ');\r\n\r\n    const wrapperStyle: React.CSSProperties = textWidth\r\n      ? { width: typeof textWidth === 'number' ? `${textWidth}px` : textWidth }\r\n      : {};\r\n\r\n    return (\r\n      <div className={containerClasses} style={containerStyle} onClick={onClick}>\r\n        {label && (\r\n          <label className=\"avakio-text-label\" style={labelStyle}>\r\n            {label}\r\n            {required && <span className=\"avakio-text-required\">*</span>}\r\n          </label>\r\n        )}\r\n        <div className=\"avakio-text-content\">\r\n          <div className=\"avakio-text-input-wrapper\" style={wrapperStyle}>\r\n            {icon && iconPosition === 'left' && (\r\n              <span className=\"avakio-text-icon avakio-text-icon-left\">{icon}</span>\r\n            )}\r\n            {multiline ? (\r\n              <textarea\r\n                ref={inputRef as React.RefObject<HTMLTextAreaElement>}\r\n                className={inputClasses}\r\n                value={currentValue}\r\n                placeholder={placeholder}\r\n                name={name}\r\n                disabled={isDisabled}\r\n                readOnly={readonly}\r\n                required={required}\r\n                maxLength={maxLength}\r\n                rows={rows}\r\n                onChange={handleChange as any}\r\n                onBlur={handleBlur as any}\r\n                onFocus={handleFocus as any}\r\n                onKeyPress={handleKeyPress as any}\r\n              />\r\n            ) : (\r\n              <input\r\n                ref={inputRef as React.RefObject<HTMLInputElement>}\r\n                type={inputType}\r\n                className={inputClasses}\r\n                value={currentValue}\r\n                placeholder={placeholder}\r\n                name={name}\r\n                disabled={isDisabled}\r\n                readOnly={readonly}\r\n                required={required}\r\n                maxLength={maxLength}\r\n                pattern={pattern}\r\n                min={min}\r\n                max={max}\r\n                step={step}\r\n                autoComplete={autoComplete}\r\n                onChange={handleChange as any}\r\n                onBlur={handleBlur as any}\r\n                onFocus={handleFocus as any}\r\n                onKeyPress={handleKeyPress as any}\r\n              />\r\n            )}\r\n            {icon && iconPosition === 'right' && !hasActionButton && (\r\n              <span className=\"avakio-text-icon avakio-text-icon-right\">{icon}</span>\r\n            )}\r\n            {type === 'password' && (\r\n              <button\r\n                type=\"button\"\r\n                className=\"avakio-text-action\"\r\n                onClick={togglePasswordVisibility}\r\n                disabled={isDisabled}\r\n                tabIndex={-1}\r\n              >\r\n                {showPassword ? <EyeOff size={16} /> : <Eye size={16} />}\r\n              </button>\r\n            )}\r\n            {clear && currentValue && type !== 'password' && (\r\n              <button\r\n                type=\"button\"\r\n                className=\"avakio-text-action avakio-text-clear\"\r\n                onClick={handleClear}\r\n                disabled={isDisabled || readonly}\r\n                tabIndex={-1}\r\n              >\r\n                <X size={16} />\r\n              </button>\r\n            )}\r\n            {enableValueCopyButton && currentValue && type !== 'password' && (\r\n              <button\r\n                type=\"button\"\r\n                className=\"avakio-text-action avakio-text-copy\"\r\n                onClick={handleCopyToClipboard}\r\n                disabled={isDisabled}\r\n                tabIndex={-1}\r\n                title=\"Copy value to clipboard\"\r\n              >\r\n                <Copy size={16} />\r\n              </button>\r\n            )}\r\n            {enablePlaceHolderCopyButton && placeholder && type !== 'password' && !enableValueCopyButton && (\r\n              <button\r\n                type=\"button\"\r\n                className=\"avakio-text-action avakio-text-copy\"\r\n                onClick={handleCopyPlaceholder}\r\n                disabled={isDisabled}\r\n                tabIndex={-1}\r\n                title=\"Copy placeholder to clipboard\"\r\n              >\r\n                <Copy size={16} />\r\n              </button>\r\n            )}\r\n          </div>\r\n          {bottomLabel && <div className=\"avakio-text-bottom-label\">{bottomLabel}</div>}\r\n          {isInvalid && validationMessage && (\r\n            <div className=\"avakio-text-error-message\">{validationMessage}</div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nAvakioText.displayName = 'AvakioText';\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { forwardRef, useImperativeHandle, useState, useRef, useEffect, useCallback } from 'react';\r\nimport './avakio-toggle-button.css';\r\n\r\nexport type AvakioToggleButtonTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\nexport type AvakioToggleButtonSize = 'sm' | 'md' | 'lg';\r\nexport type AvakioToggleButtonType = 'default' | 'icon' | 'iconTop' | 'image' | 'imageTop';\r\n\r\nexport interface AvakioToggleButtonProps {\r\n  /** Unique identifier */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n  /** Name for form submission */\r\n  name?: string;\r\n  /** Current pressed state (controlled) */\r\n  value?: boolean;\r\n  /** Default pressed state (uncontrolled) */\r\n  defaultValue?: boolean;\r\n  /** Label text (same for both states) */\r\n  label?: string;\r\n  /** Label when pressed/on */\r\n  onLabel?: string;\r\n  /** Label when unpressed/off */\r\n  offLabel?: string;\r\n  /** Icon (same for both states) */\r\n  icon?: React.ReactNode;\r\n  /** Icon when pressed/on */\r\n  onIcon?: React.ReactNode;\r\n  /** Icon when unpressed/off */\r\n  offIcon?: React.ReactNode;\r\n  /** Image URL (same for both states) */\r\n  image?: string;\r\n  /** Image URL when pressed/on */\r\n  onImage?: string;\r\n  /** Image URL when unpressed/off */\r\n  offImage?: string;\r\n  /** Button type/layout */\r\n  type?: AvakioToggleButtonType;\r\n  /** Button size */\r\n  size?: AvakioToggleButtonSize;\r\n  /** Theme variant */\r\n  theme?: AvakioToggleButtonTheme;\r\n  /** Disabled state */\r\n  disabled?: boolean;\r\n  /** Auto-adjust width to content */\r\n  autowidth?: boolean;\r\n  /** Full width button */\r\n  block?: boolean;\r\n  /** Tooltip text */\r\n  tooltip?: string;\r\n  /** Keyboard hotkey (e.g., 'ctrl+t') */\r\n  hotkey?: string;\r\n  /** CSS class name */\r\n  className?: string;\r\n  /** Inline styles */\r\n  css?: React.CSSProperties;\r\n  /** Width */\r\n  width?: number | string;\r\n  /** Height */\r\n  height?: number | string;\r\n  /** Padding (number for all sides, string for CSS, or [top, right, bottom, left]) */\r\n  padding?: string | number | [number, number, number, number];\r\n  /** Margin (number for all sides, string for CSS, or [top, right, bottom, left]) */\r\n  margin?: string | number | [number, number, number, number];\r\n  /** Callback when value changes */\r\n  onChange?: (value: boolean) => void;\r\n  /** Callback when clicked */\r\n  onClick?: (e: React.MouseEvent<HTMLButtonElement>) => void;\r\n  /** Callback when focused */\r\n  onFocus?: (e: React.FocusEvent<HTMLButtonElement>) => void;\r\n  /** Callback when blurred */\r\n  onBlur?: (e: React.FocusEvent<HTMLButtonElement>) => void;\r\n}\r\n\r\nexport interface AvakioToggleButtonRef {\r\n  /** Get the current pressed state */\r\n  getValue: () => boolean;\r\n  /** Set the pressed state */\r\n  setValue: (value: boolean) => void;\r\n  /** Toggle the state */\r\n  toggle: () => void;\r\n  /** Focus the button */\r\n  focus: () => void;\r\n  /** Blur the button */\r\n  blur: () => void;\r\n  /** Enable the button */\r\n  enable: () => void;\r\n  /** Disable the button */\r\n  disable: () => void;\r\n  /** Check if enabled */\r\n  isEnabled: () => boolean;\r\n  /** Get the HTML element */\r\n  getNode: () => HTMLButtonElement | null;\r\n}\r\n\r\nexport const AvakioToggleButton = forwardRef<AvakioToggleButtonRef, AvakioToggleButtonProps>(\r\n  (\r\n    {\r\n      id,\r\n      testId,\r\n      name,\r\n      value,\r\n      defaultValue = false,\r\n      label,\r\n      onLabel,\r\n      offLabel,\r\n      icon,\r\n      onIcon,\r\n      offIcon,\r\n      image,\r\n      onImage,\r\n      offImage,\r\n      type = 'default',\r\n      size = 'md',\r\n      theme,\r\n      disabled: disabledProp = false,\r\n      autowidth = false,\r\n      block = false,\r\n      tooltip,\r\n      hotkey,\r\n      className = '',\r\n      css,\r\n      width,\r\n      height,\r\n      padding,\r\n      margin,\r\n      onChange,\r\n      onClick,\r\n      onFocus,\r\n      onBlur,\r\n    },\r\n    ref\r\n  ) => {\r\n    const buttonRef = useRef<HTMLButtonElement>(null);\r\n    const isControlled = value !== undefined;\r\n    const [internalValue, setInternalValue] = useState<boolean>(defaultValue);\r\n    const [disabled, setDisabled] = useState<boolean>(disabledProp);\r\n\r\n    const isPressed = isControlled ? value : internalValue;\r\n\r\n    // Sync disabled prop\r\n    useEffect(() => {\r\n      setDisabled(disabledProp);\r\n    }, [disabledProp]);\r\n\r\n    // Handle hotkey\r\n    useEffect(() => {\r\n      if (!hotkey || disabled) return;\r\n\r\n      const handleKeyDown = (e: KeyboardEvent) => {\r\n        const keys = hotkey.toLowerCase().split('+');\r\n        const ctrl = keys.includes('ctrl') || keys.includes('control');\r\n        const shift = keys.includes('shift');\r\n        const alt = keys.includes('alt');\r\n        const key = keys[keys.length - 1];\r\n\r\n        if (\r\n          (ctrl === (e.ctrlKey || e.metaKey)) &&\r\n          shift === e.shiftKey &&\r\n          alt === e.altKey &&\r\n          e.key.toLowerCase() === key\r\n        ) {\r\n          e.preventDefault();\r\n          handleToggle();\r\n        }\r\n      };\r\n\r\n      document.addEventListener('keydown', handleKeyDown);\r\n      return () => document.removeEventListener('keydown', handleKeyDown);\r\n    }, [hotkey, disabled]);\r\n\r\n    const handleToggle = useCallback(() => {\r\n      if (disabled) return;\r\n\r\n      const newValue = !isPressed;\r\n      \r\n      if (!isControlled) {\r\n        setInternalValue(newValue);\r\n      }\r\n      \r\n      onChange?.(newValue);\r\n    }, [disabled, isPressed, isControlled, onChange]);\r\n\r\n    const handleClick = (e: React.MouseEvent<HTMLButtonElement>) => {\r\n      handleToggle();\r\n      onClick?.(e);\r\n    };\r\n\r\n    // Expose imperative methods\r\n    useImperativeHandle(ref, () => ({\r\n      getValue: () => isPressed,\r\n      setValue: (val: boolean) => {\r\n        if (!isControlled) {\r\n          setInternalValue(val);\r\n        }\r\n        onChange?.(val);\r\n      },\r\n      toggle: handleToggle,\r\n      focus: () => buttonRef.current?.focus(),\r\n      blur: () => buttonRef.current?.blur(),\r\n      enable: () => setDisabled(false),\r\n      disable: () => setDisabled(true),\r\n      isEnabled: () => !disabled,\r\n      getNode: () => buttonRef.current,\r\n    }), [isPressed, isControlled, disabled, onChange, handleToggle]);\r\n\r\n    // Determine current label\r\n    const currentLabel = isPressed\r\n      ? (onLabel ?? label)\r\n      : (offLabel ?? label);\r\n\r\n    // Determine current icon\r\n    const currentIcon = isPressed\r\n      ? (onIcon ?? icon)\r\n      : (offIcon ?? icon);\r\n\r\n    // Determine current image\r\n    const currentImage = isPressed\r\n      ? (onImage ?? image)\r\n      : (offImage ?? image);\r\n\r\n    // Build style object\r\n    const paddingStyle = padding\r\n      ? typeof padding === 'number'\r\n        ? `${padding}px`\r\n        : Array.isArray(padding)\r\n        ? `${padding[0]}px ${padding[1]}px ${padding[2]}px ${padding[3]}px`\r\n        : padding\r\n      : undefined;\r\n\r\n    const marginStyle = margin\r\n      ? typeof margin === 'number'\r\n        ? `${margin}px`\r\n        : Array.isArray(margin)\r\n        ? `${margin[0]}px ${margin[1]}px ${margin[2]}px ${margin[3]}px`\r\n        : margin\r\n      : undefined;\r\n\r\n    const style: React.CSSProperties = {\r\n      ...(css && typeof css === 'object' && !Array.isArray(css) ? css : {}),\r\n      width: typeof width === 'number' ? `${width}px` : width,\r\n      height: typeof height === 'number' ? `${height}px` : height,\r\n      padding: paddingStyle,\r\n      margin: marginStyle,\r\n    };\r\n\r\n    // Build class names\r\n    const buttonTypeClass = type === 'icon' ? 'icon' : type === 'iconTop' ? 'icon-top' : type === 'image' ? 'image' : type === 'imageTop' ? 'image-top' : 'default';\r\n\r\n    const classes = [\r\n      'avakio-toggle-button',\r\n      `avakio-toggle-button-${size}`,\r\n      `avakio-toggle-button-type-${buttonTypeClass}`,\r\n      isPressed && 'avakio-toggle-button-pressed',\r\n      disabled && 'avakio-toggle-button-disabled',\r\n      block && 'avakio-toggle-button-block',\r\n      autowidth && 'avakio-toggle-button-autowidth',\r\n      className,\r\n    ]\r\n      .filter(Boolean)\r\n      .join(' ');\r\n\r\n    return (\r\n      <button\r\n        ref={buttonRef}\r\n        id={id}\r\n        data-testid={testId}\r\n        data-admin-theme={theme}\r\n        name={name}\r\n        type=\"button\"\r\n        className={classes}\r\n        style={style}\r\n        disabled={disabled}\r\n        title={tooltip}\r\n        aria-pressed={isPressed}\r\n        onClick={handleClick}\r\n        onFocus={onFocus}\r\n        onBlur={onBlur}\r\n      >\r\n        <span className=\"avakio-toggle-button-inner\">\r\n          {currentImage && (\r\n            <img\r\n              src={currentImage}\r\n              alt=\"\"\r\n              className=\"avakio-toggle-button-image\"\r\n            />\r\n          )}\r\n          {currentIcon && (\r\n            <span className=\"avakio-toggle-button-icon\">{currentIcon}</span>\r\n          )}\r\n          {currentLabel && (\r\n            <span className=\"avakio-toggle-button-label\">{currentLabel}</span>\r\n          )}\r\n          {hotkey && (\r\n            <span className=\"avakio-toggle-button-hotkey\">{hotkey}</span>\r\n          )}\r\n        </span>\r\n      </button>\r\n    );\r\n  }\r\n);\r\n\r\nAvakioToggleButton.displayName = 'AvakioToggleButton';\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { forwardRef, useImperativeHandle, useState, useRef, useEffect, useCallback, useId } from 'react';\r\nimport './avakio-accordion.css';\r\nimport { ChevronRight, ChevronDown } from 'lucide-react';\r\n\r\nexport type AvakioAccordionTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\n\r\nexport type AvakioAccordionMultiMode = boolean | 'mixed';\r\n\r\nexport interface AvakioAccordionItem {\r\n  /** Unique identifier for the item */\r\n  id: string | number;\r\n  /** Header text or element */\r\n  header: React.ReactNode;\r\n  /** Body content */\r\n  body: React.ReactNode;\r\n  /** Whether this item is initially collapsed */\r\n  collapsed?: boolean;\r\n  /** Whether this item is disabled */\r\n  disabled?: boolean;\r\n  /** Custom icon for the header */\r\n  icon?: React.ReactNode;\r\n  /** CSS class for this item */\r\n  css?: string;\r\n  /** Whether this item header is visible */\r\n  headerVisible?: boolean;\r\n}\r\n\r\nexport interface AvakioAccordionProps {\r\n  /** Unique identifier */\r\n  id?: string;\r\n  /** Test ID for testing */\r\n  testId?: string;\r\n  /** Accordion items */\r\n  items: AvakioAccordionItem[];\r\n  /** \r\n   * Multi-expand mode:\r\n   * - true: all panels can be expanded/collapsed at a time\r\n   * - false: only one panel can be visible at a time (default)\r\n   * - 'mixed': all panels can be expanded at a time, but one must remain visible\r\n   */\r\n  multi?: AvakioAccordionMultiMode;\r\n  /** Layout type (horizontal or vertical) */\r\n  type?: 'rows' | 'cols';\r\n  /** Theme */\r\n  theme?: AvakioAccordionTheme;\r\n  /** Show icons on headers */\r\n  showIcons?: boolean;\r\n  /** Custom toggle icon for collapsed state */\r\n  collapseIcon?: React.ReactNode;\r\n  /** Custom toggle icon for expanded state */\r\n  expandIcon?: React.ReactNode;\r\n  /** Enable animation */\r\n  animate?: boolean;\r\n  /** Width */\r\n  width?: number | string;\r\n  /** Height */\r\n  height?: number | string;\r\n  /** CSS class */\r\n  className?: string;\r\n  /** Inline styles */\r\n  style?: React.CSSProperties;\r\n  /** Callback when an item is expanded */\r\n  onExpand?: (id: string | number) => void;\r\n  /** Callback when an item is collapsed */\r\n  onCollapse?: (id: string | number) => void;\r\n  /** Callback when state changes */\r\n  onChange?: (expandedIds: (string | number)[]) => void;\r\n}\r\n\r\nexport interface AvakioAccordionRef {\r\n  /** Get IDs of expanded items */\r\n  getExpandedIds: () => (string | number)[];\r\n  /** Expand an item by ID */\r\n  expand: (id: string | number) => void;\r\n  /** Collapse an item by ID */\r\n  collapse: (id: string | number) => void;\r\n  /** Toggle an item by ID */\r\n  toggle: (id: string | number) => void;\r\n  /** Expand all items */\r\n  expandAll: () => void;\r\n  /** Collapse all items */\r\n  collapseAll: () => void;\r\n  /** Check if an item is expanded */\r\n  isExpanded: (id: string | number) => boolean;\r\n  /** Check if an item is disabled */\r\n  isDisabled: (id: string | number) => boolean;\r\n  /** Enable an item */\r\n  enable: (id: string | number) => void;\r\n  /** Disable an item */\r\n  disable: (id: string | number) => void;\r\n}\r\n\r\nexport const AvakioAccordion = forwardRef<AvakioAccordionRef, AvakioAccordionProps>(\r\n  (props, ref) => {\r\n    const {\r\n      id,\r\n      testId,\r\n      items,\r\n      multi = false,\r\n      type = 'rows',\r\n      theme = 'material',\r\n      showIcons = true,\r\n      collapseIcon,\r\n      expandIcon,\r\n      animate = true,\r\n      width,\r\n      height,\r\n      className = '',\r\n      style,\r\n      onExpand,\r\n      onCollapse,\r\n      onChange,\r\n    } = props;\r\n\r\n    const generatedId = useId();\r\n    const accordionId = id || generatedId;\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n    const contentRefs = useRef<Map<string | number, HTMLDivElement>>(new Map());\r\n\r\n    // Initialize expanded state based on items' collapsed property\r\n    const getInitialExpandedIds = useCallback(() => {\r\n      const expanded: (string | number)[] = [];\r\n      items.forEach((item) => {\r\n        if (!item.collapsed && item.headerVisible !== false) {\r\n          expanded.push(item.id);\r\n        }\r\n      });\r\n      // If multi is false and no items are expanded, expand the first non-disabled item\r\n      if (expanded.length === 0 && multi === false) {\r\n        const firstEnabled = items.find((item) => !item.disabled && item.headerVisible !== false);\r\n        if (firstEnabled) {\r\n          expanded.push(firstEnabled.id);\r\n        }\r\n      }\r\n      return expanded;\r\n    }, [items, multi]);\r\n\r\n    const [expandedIds, setExpandedIds] = useState<(string | number)[]>(getInitialExpandedIds);\r\n    const [disabledIds, setDisabledIds] = useState<Set<string | number>>(() => {\r\n      return new Set(items.filter((item) => item.disabled).map((item) => item.id));\r\n    });\r\n\r\n    // Update state when items change\r\n    useEffect(() => {\r\n      setExpandedIds(getInitialExpandedIds());\r\n      setDisabledIds(new Set(items.filter((item) => item.disabled).map((item) => item.id)));\r\n    }, [items, getInitialExpandedIds]);\r\n\r\n    // Handle item toggle\r\n    const handleToggle = useCallback(\r\n      (itemId: string | number) => {\r\n        if (disabledIds.has(itemId)) return;\r\n\r\n        setExpandedIds((prev) => {\r\n          const isCurrentlyExpanded = prev.includes(itemId);\r\n          let newExpandedIds: (string | number)[];\r\n\r\n          if (isCurrentlyExpanded) {\r\n            // Collapsing\r\n            if (multi === false) {\r\n              // In single mode, always keep one item open\r\n              // Find another non-disabled item to expand\r\n              const otherItem = items.find(\r\n                (item) => item.id !== itemId && !disabledIds.has(item.id) && item.headerVisible !== false\r\n              );\r\n              newExpandedIds = otherItem ? [otherItem.id] : prev;\r\n            } else if (multi === 'mixed') {\r\n              // In mixed mode, prevent closing the last item\r\n              if (prev.length <= 1) {\r\n                return prev;\r\n              }\r\n              newExpandedIds = prev.filter((id) => id !== itemId);\r\n            } else {\r\n              // In multi mode, allow collapsing\r\n              newExpandedIds = prev.filter((id) => id !== itemId);\r\n            }\r\n            if (newExpandedIds !== prev) {\r\n              onCollapse?.(itemId);\r\n            }\r\n          } else {\r\n            // Expanding\r\n            if (multi === false) {\r\n              // In single mode, collapse others\r\n              prev.forEach((id) => {\r\n                if (id !== itemId) {\r\n                  onCollapse?.(id);\r\n                }\r\n              });\r\n              newExpandedIds = [itemId];\r\n            } else {\r\n              // In multi or mixed mode, add to expanded\r\n              newExpandedIds = [...prev, itemId];\r\n            }\r\n            onExpand?.(itemId);\r\n          }\r\n\r\n          if (newExpandedIds !== prev) {\r\n            onChange?.(newExpandedIds);\r\n          }\r\n          return newExpandedIds;\r\n        });\r\n      },\r\n      [multi, items, disabledIds, onExpand, onCollapse, onChange]\r\n    );\r\n\r\n    // Handle keyboard navigation\r\n    const handleKeyDown = useCallback(\r\n      (e: React.KeyboardEvent, itemId: string | number, index: number) => {\r\n        const enabledItems = items.filter(\r\n          (item) => !disabledIds.has(item.id) && item.headerVisible !== false\r\n        );\r\n        const currentIndex = enabledItems.findIndex((item) => item.id === itemId);\r\n\r\n        switch (e.key) {\r\n          case 'Enter':\r\n          case ' ':\r\n            e.preventDefault();\r\n            handleToggle(itemId);\r\n            break;\r\n          case 'ArrowDown':\r\n          case 'ArrowRight':\r\n            e.preventDefault();\r\n            if (currentIndex < enabledItems.length - 1) {\r\n              const nextItem = enabledItems[currentIndex + 1];\r\n              const nextHeader = containerRef.current?.querySelector(\r\n                `[data-item-id=\"${nextItem.id}\"] .avakio-accordion-header`\r\n              ) as HTMLElement;\r\n              nextHeader?.focus();\r\n            }\r\n            break;\r\n          case 'ArrowUp':\r\n          case 'ArrowLeft':\r\n            e.preventDefault();\r\n            if (currentIndex > 0) {\r\n              const prevItem = enabledItems[currentIndex - 1];\r\n              const prevHeader = containerRef.current?.querySelector(\r\n                `[data-item-id=\"${prevItem.id}\"] .avakio-accordion-header`\r\n              ) as HTMLElement;\r\n              prevHeader?.focus();\r\n            }\r\n            break;\r\n          case 'Home':\r\n            e.preventDefault();\r\n            if (enabledItems.length > 0) {\r\n              const firstItem = enabledItems[0];\r\n              const firstHeader = containerRef.current?.querySelector(\r\n                `[data-item-id=\"${firstItem.id}\"] .avakio-accordion-header`\r\n              ) as HTMLElement;\r\n              firstHeader?.focus();\r\n            }\r\n            break;\r\n          case 'End':\r\n            e.preventDefault();\r\n            if (enabledItems.length > 0) {\r\n              const lastItem = enabledItems[enabledItems.length - 1];\r\n              const lastHeader = containerRef.current?.querySelector(\r\n                `[data-item-id=\"${lastItem.id}\"] .avakio-accordion-header`\r\n              ) as HTMLElement;\r\n              lastHeader?.focus();\r\n            }\r\n            break;\r\n        }\r\n      },\r\n      [items, disabledIds, handleToggle]\r\n    );\r\n\r\n    // Imperative handle\r\n    useImperativeHandle(ref, () => ({\r\n      getExpandedIds: () => expandedIds,\r\n      expand: (itemId: string | number) => {\r\n        if (!expandedIds.includes(itemId) && !disabledIds.has(itemId)) {\r\n          handleToggle(itemId);\r\n        }\r\n      },\r\n      collapse: (itemId: string | number) => {\r\n        if (expandedIds.includes(itemId)) {\r\n          handleToggle(itemId);\r\n        }\r\n      },\r\n      toggle: (itemId: string | number) => {\r\n        if (!disabledIds.has(itemId)) {\r\n          handleToggle(itemId);\r\n        }\r\n      },\r\n      expandAll: () => {\r\n        if (multi === true) {\r\n          const allIds = items\r\n            .filter((item) => !disabledIds.has(item.id) && item.headerVisible !== false)\r\n            .map((item) => item.id);\r\n          setExpandedIds(allIds);\r\n          allIds.forEach((id) => {\r\n            if (!expandedIds.includes(id)) {\r\n              onExpand?.(id);\r\n            }\r\n          });\r\n          onChange?.(allIds);\r\n        }\r\n      },\r\n      collapseAll: () => {\r\n        if (multi === true) {\r\n          expandedIds.forEach((id) => onCollapse?.(id));\r\n          setExpandedIds([]);\r\n          onChange?.([]);\r\n        } else if (multi === 'mixed') {\r\n          // Keep only the first expanded item\r\n          const firstExpanded = expandedIds[0];\r\n          if (firstExpanded) {\r\n            expandedIds.slice(1).forEach((id) => onCollapse?.(id));\r\n            setExpandedIds([firstExpanded]);\r\n            onChange?.([firstExpanded]);\r\n          }\r\n        }\r\n      },\r\n      isExpanded: (itemId: string | number) => expandedIds.includes(itemId),\r\n      isDisabled: (itemId: string | number) => disabledIds.has(itemId),\r\n      enable: (itemId: string | number) => {\r\n        setDisabledIds((prev) => {\r\n          const newSet = new Set(prev);\r\n          newSet.delete(itemId);\r\n          return newSet;\r\n        });\r\n      },\r\n      disable: (itemId: string | number) => {\r\n        setDisabledIds((prev) => new Set(prev).add(itemId));\r\n      },\r\n    }), [expandedIds, disabledIds, items, multi, handleToggle, onExpand, onCollapse, onChange]);\r\n\r\n    // Render toggle icon\r\n    const renderToggleIcon = (isExpanded: boolean) => {\r\n      if (!showIcons) return null;\r\n\r\n      if (isExpanded) {\r\n        return expandIcon || <ChevronDown size={18} />;\r\n      }\r\n      return collapseIcon || <ChevronRight size={18} />;\r\n    };\r\n\r\n    // Build class names\r\n    const containerClasses = [\r\n      'avakio-accordion',\r\n      `avakio-accordion--${theme}`,\r\n      `avakio-accordion--${type}`,\r\n      animate && 'avakio-accordion--animated',\r\n      className,\r\n    ]\r\n      .filter(Boolean)\r\n      .join(' ');\r\n\r\n    // Build style\r\n    const containerStyle: React.CSSProperties = {\r\n      width: typeof width === 'number' ? `${width}px` : width,\r\n      height: typeof height === 'number' ? `${height}px` : height,\r\n      ...style,\r\n    };\r\n\r\n    return (\r\n      <div\r\n        ref={containerRef}\r\n        id={accordionId}\r\n        data-testid={testId}\r\n        className={containerClasses}\r\n        style={containerStyle}\r\n        role=\"presentation\"\r\n      >\r\n        {items.map((item, index) => {\r\n          const isExpanded = expandedIds.includes(item.id);\r\n          const isDisabled = disabledIds.has(item.id);\r\n          const headerVisible = item.headerVisible !== false;\r\n\r\n          const itemClasses = [\r\n            'avakio-accordion-item',\r\n            isExpanded && 'avakio-accordion-item--expanded',\r\n            isDisabled && 'avakio-accordion-item--disabled',\r\n            !headerVisible && 'avakio-accordion-item--no-header',\r\n            item.css,\r\n          ]\r\n            .filter(Boolean)\r\n            .join(' ');\r\n\r\n          const headerId = `${accordionId}-header-${item.id}`;\r\n          const panelId = `${accordionId}-panel-${item.id}`;\r\n\r\n          return (\r\n            <div\r\n              key={item.id}\r\n              className={itemClasses}\r\n              data-item-id={item.id}\r\n            >\r\n              {headerVisible && (\r\n                <div\r\n                  id={headerId}\r\n                  className=\"avakio-accordion-header\"\r\n                  role=\"button\"\r\n                  tabIndex={isDisabled ? -1 : 0}\r\n                  aria-expanded={isExpanded}\r\n                  aria-controls={panelId}\r\n                  aria-disabled={isDisabled}\r\n                  onClick={() => handleToggle(item.id)}\r\n                  onKeyDown={(e) => handleKeyDown(e, item.id, index)}\r\n                >\r\n                  <span className=\"avakio-accordion-toggle\">\r\n                    {renderToggleIcon(isExpanded)}\r\n                  </span>\r\n                  {item.icon && (\r\n                    <span className=\"avakio-accordion-icon\">{item.icon}</span>\r\n                  )}\r\n                  <span className=\"avakio-accordion-header-text\">{item.header}</span>\r\n                </div>\r\n              )}\r\n              <div\r\n                id={panelId}\r\n                ref={(el) => {\r\n                  if (el) {\r\n                    contentRefs.current.set(item.id, el);\r\n                  } else {\r\n                    contentRefs.current.delete(item.id);\r\n                  }\r\n                }}\r\n                className=\"avakio-accordion-content\"\r\n                role=\"region\"\r\n                aria-labelledby={headerId}\r\n                aria-hidden={!isExpanded}\r\n                style={{\r\n                  maxHeight: isExpanded ? undefined : 0,\r\n                  overflow: isExpanded ? 'visible' : 'hidden',\r\n                }}\r\n              >\r\n                <div className=\"avakio-accordion-body\">{item.body}</div>\r\n              </div>\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nAvakioAccordion.displayName = 'AvakioAccordion';\r\n\r\nexport default AvakioAccordion;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useMemo, useEffect, useState, useRef } from 'react';\r\nimport { cn } from '@/lib/utils';\r\nimport './avakio-bullet-graph.css';\r\n\r\nexport interface AvakioBulletGraphBand {\r\n  /** The end value of this band (bands are rendered from highest to lowest) */\r\n  value: number;\r\n  /** The color of this band */\r\n  color: string;\r\n}\r\n\r\nexport interface AvakioBulletGraphScale {\r\n  /** Step interval for scale ticks */\r\n  step?: number;\r\n  /** Template for scale labels. Use #value# as placeholder */\r\n  template?: string | ((value: number) => string);\r\n}\r\n\r\nexport interface AvakioBulletGraphProps {\r\n  /** Current value to display */\r\n  value: number;\r\n  /** Minimum range value */\r\n  minRange?: number;\r\n  /** Maximum range value */\r\n  maxRange?: number;\r\n  /** Target marker position (vertical line). Set to false to hide */\r\n  marker?: number | false;\r\n  /** Color of the marker */\r\n  markerColor?: string;\r\n  /** Color of the value bar. Can be a string or function that receives value */\r\n  color?: string | ((value: number) => string);\r\n  /** Performance bands (qualitative ranges) */\r\n  bands?: AvakioBulletGraphBand[];\r\n  /** Label text */\r\n  label?: string;\r\n  /** Additional description. Use #value# as placeholder for current value */\r\n  placeholder?: string;\r\n  /** Width of the value bar in pixels */\r\n  stroke?: number;\r\n  /** Scale configuration */\r\n  scale?: AvakioBulletGraphScale;\r\n  /** Length of scale ticks in pixels */\r\n  tickSize?: number;\r\n  /** Animation duration in milliseconds */\r\n  flowTime?: number;\r\n  /** Enable smooth animation */\r\n  smoothFlow?: boolean;\r\n  /** Layout orientation */\r\n  layout?: 'horizontal' | 'vertical';\r\n  /** Width of the label area (horizontal layout) */\r\n  labelWidth?: number;\r\n  /** Height of the label area (vertical layout) */\r\n  labelHeight?: number;\r\n  /** Show/hide the label */\r\n  showLabel?: boolean;\r\n  /** Show/hide the scale */\r\n  showScale?: boolean;\r\n  /** Whether the component is disabled */\r\n  disabled?: boolean;\r\n  /** Unique ID */\r\n  id?: string;\r\n  /** Test ID for testing */\r\n  testId?: string;\r\n  /** Additional CSS class */\r\n  className?: string;\r\n}\r\n\r\nconst DEFAULT_BANDS: AvakioBulletGraphBand[] = [\r\n  { value: 100, color: '#5be5d6' },\r\n  { value: 80, color: '#fff07e' },\r\n  { value: 60, color: '#fd8b8c' },\r\n];\r\n\r\nexport function AvakioBulletGraph({\r\n  value,\r\n  minRange = 0,\r\n  maxRange = 100,\r\n  marker = false,\r\n  markerColor,\r\n  color = 'var(--bg-primary)',\r\n  bands = DEFAULT_BANDS,\r\n  label,\r\n  placeholder,\r\n  stroke = 8,\r\n  scale,\r\n  tickSize = 10,\r\n  flowTime = 500,\r\n  smoothFlow = true,\r\n  layout = 'horizontal',\r\n  labelWidth = 120,\r\n  labelHeight = 40,\r\n  showLabel = true,\r\n  showScale = true,\r\n  disabled = false,\r\n  id,\r\n  testId,\r\n  className,\r\n}: AvakioBulletGraphProps) {\r\n  const [animatedValue, setAnimatedValue] = useState(minRange);\r\n  const animationRef = useRef<number | null>(null);\r\n  const prevValueRef = useRef(minRange);\r\n\r\n  // Clamp value to range\r\n  const clampedValue = useMemo(() => {\r\n    return Math.max(minRange, Math.min(maxRange, value));\r\n  }, [value, minRange, maxRange]);\r\n\r\n  // Animate value changes\r\n  useEffect(() => {\r\n    if (!smoothFlow || flowTime === 0) {\r\n      setAnimatedValue(clampedValue);\r\n      return;\r\n    }\r\n\r\n    const startValue = prevValueRef.current;\r\n    const endValue = clampedValue;\r\n    const startTime = performance.now();\r\n\r\n    const animate = (currentTime: number) => {\r\n      const elapsed = currentTime - startTime;\r\n      const progress = Math.min(elapsed / flowTime, 1);\r\n      \r\n      // Ease out cubic\r\n      const easeProgress = 1 - Math.pow(1 - progress, 3);\r\n      const currentValue = startValue + (endValue - startValue) * easeProgress;\r\n      \r\n      setAnimatedValue(currentValue);\r\n\r\n      if (progress < 1) {\r\n        animationRef.current = requestAnimationFrame(animate);\r\n      } else {\r\n        prevValueRef.current = endValue;\r\n      }\r\n    };\r\n\r\n    if (animationRef.current) {\r\n      cancelAnimationFrame(animationRef.current);\r\n    }\r\n    animationRef.current = requestAnimationFrame(animate);\r\n\r\n    return () => {\r\n      if (animationRef.current) {\r\n        cancelAnimationFrame(animationRef.current);\r\n      }\r\n    };\r\n  }, [clampedValue, flowTime, smoothFlow]);\r\n\r\n  // Calculate percentage position\r\n  const getPercentage = (val: number) => {\r\n    const range = maxRange - minRange;\r\n    if (range === 0) return 0;\r\n    return ((val - minRange) / range) * 100;\r\n  };\r\n\r\n  // Get bar color\r\n  const barColor = useMemo(() => {\r\n    if (typeof color === 'function') {\r\n      return color(clampedValue);\r\n    }\r\n    return color;\r\n  }, [color, clampedValue]);\r\n\r\n  // Generate scale ticks\r\n  const scaleTicks = useMemo(() => {\r\n    if (!showScale || !scale) return [];\r\n    \r\n    const step = scale.step || 10;\r\n    const ticks: { value: number; label: string; position: number }[] = [];\r\n    \r\n    for (let v = minRange; v <= maxRange; v += step) {\r\n      let label = String(v);\r\n      if (scale.template) {\r\n        if (typeof scale.template === 'function') {\r\n          label = scale.template(v);\r\n        } else {\r\n          label = scale.template.replace('#value#', String(v));\r\n        }\r\n      }\r\n      ticks.push({\r\n        value: v,\r\n        label,\r\n        position: getPercentage(v),\r\n      });\r\n    }\r\n    \r\n    return ticks;\r\n  }, [showScale, scale, minRange, maxRange]);\r\n\r\n  // Sort bands by value descending (render highest first as background)\r\n  const sortedBands = useMemo(() => {\r\n    return [...bands].sort((a, b) => b.value - a.value);\r\n  }, [bands]);\r\n\r\n  // Format placeholder text\r\n  const formattedPlaceholder = useMemo(() => {\r\n    if (!placeholder) return null;\r\n    return placeholder.replace('#value#', String(Math.round(clampedValue)));\r\n  }, [placeholder, clampedValue]);\r\n\r\n  const isVertical = layout === 'vertical';\r\n\r\n  return (\r\n    <div\r\n      id={id}\r\n      data-testid={testId}\r\n      className={cn(\r\n        'avakio-bullet-graph',\r\n        isVertical && 'avakio-bullet-graph-vertical',\r\n        disabled && 'avakio-bullet-graph-disabled',\r\n        className\r\n      )}\r\n      style={{\r\n        '--bg-label-width': `${labelWidth}px`,\r\n        '--bg-label-height': `${labelHeight}px`,\r\n      } as React.CSSProperties}\r\n    >\r\n      {/* Label Section */}\r\n      {showLabel && label && (\r\n        <div className=\"avakio-bullet-graph-label\">\r\n          <span className=\"avakio-bullet-graph-label-text\">{label}</span>\r\n          {formattedPlaceholder && (\r\n            <span className=\"avakio-bullet-graph-placeholder\">{formattedPlaceholder}</span>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {/* Graph Section */}\r\n      <div className=\"avakio-bullet-graph-container\">\r\n        <div className=\"avakio-bullet-graph-track\">\r\n          {/* Performance Bands */}\r\n          {sortedBands.map((band, index) => (\r\n            <div\r\n              key={index}\r\n              className=\"avakio-bullet-graph-band\"\r\n              style={{\r\n                [isVertical ? 'height' : 'width']: `${getPercentage(band.value)}%`,\r\n                backgroundColor: band.color,\r\n              }}\r\n            />\r\n          ))}\r\n\r\n          {/* Value Bar */}\r\n          <div\r\n            className=\"avakio-bullet-graph-bar\"\r\n            style={{\r\n              [isVertical ? 'height' : 'width']: `${getPercentage(animatedValue)}%`,\r\n              [isVertical ? 'width' : 'height']: `${stroke}px`,\r\n              backgroundColor: barColor,\r\n              transition: smoothFlow ? `all ${flowTime}ms ease-out` : 'none',\r\n            }}\r\n          />\r\n\r\n          {/* Target Marker */}\r\n          {marker !== false && (\r\n            <div\r\n              className=\"avakio-bullet-graph-marker\"\r\n              style={{\r\n                [isVertical ? 'bottom' : 'left']: `${getPercentage(marker)}%`,\r\n                backgroundColor: markerColor || 'var(--bg-marker)',\r\n              }}\r\n            />\r\n          )}\r\n        </div>\r\n\r\n        {/* Scale */}\r\n        {showScale && scaleTicks.length > 0 && (\r\n          <div className=\"avakio-bullet-graph-scale\">\r\n            {scaleTicks.map((tick, index) => (\r\n              <div\r\n                key={index}\r\n                className=\"avakio-bullet-graph-tick\"\r\n                style={{\r\n                  [isVertical ? 'bottom' : 'left']: `${tick.position}%`,\r\n                }}\r\n              >\r\n                <div\r\n                  className=\"avakio-bullet-graph-tick-line\"\r\n                  style={{\r\n                    [isVertical ? 'width' : 'height']: `${tickSize}px`,\r\n                  }}\r\n                />\r\n                <span className=\"avakio-bullet-graph-tick-label\">{tick.label}</span>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default AvakioBulletGraph;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { forwardRef, useEffect, useImperativeHandle, useRef, useState, useCallback, ReactNode } from 'react';\r\nimport { ChevronLeft, ChevronRight } from 'lucide-react';\r\nimport './avakio-carousel.css';\r\n\r\nexport type AvakioCarouselTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\nexport type NavigationType = 'side' | 'bottom';\r\nexport type NavigationPosition = 'left' | 'right' | 'center';\r\n\r\nexport interface AvakioCarouselSlide {\r\n  id: string;\r\n  content: ReactNode;\r\n}\r\n\r\nexport interface AvakioCarouselNavigation {\r\n  type?: NavigationType;\r\n  items?: boolean;\r\n  buttons?: boolean;\r\n  position?: NavigationPosition;\r\n}\r\n\r\nexport interface AvakioCarouselProps {\r\n  id?: string;\r\n  testId?: string;\r\n  slides: AvakioCarouselSlide[];\r\n  theme?: AvakioCarouselTheme;\r\n  navigation?: AvakioCarouselNavigation;\r\n  autoplay?: boolean;\r\n  autoplayDelay?: number;\r\n  scrollSpeed?: number;\r\n  loop?: boolean;\r\n  activeIndex?: number;\r\n  width?: number | string;\r\n  height?: number | string;\r\n  css?: React.CSSProperties;\r\n  onShow?: (id: string, index: number) => void;\r\n  onSlideChange?: (id: string, index: number) => void;\r\n}\r\n\r\nexport interface AvakioCarouselRef {\r\n  showNext: () => void;\r\n  showPrev: () => void;\r\n  setActive: (id: string) => void;\r\n  setActiveIndex: (index: number) => void;\r\n  getActiveId: () => string;\r\n  getActiveIndex: () => number;\r\n  addView: (slide: AvakioCarouselSlide, position?: number) => void;\r\n  removeView: (id: string) => void;\r\n}\r\n\r\nexport const AvakioCarousel = forwardRef<AvakioCarouselRef, AvakioCarouselProps>(\r\n  (\r\n    {\r\n      id,\r\n      testId,\r\n      slides,\r\n      theme = 'material',\r\n      navigation = { type: 'bottom', items: true, buttons: true, position: 'center' },\r\n      autoplay = false,\r\n      autoplayDelay = 3000,\r\n      scrollSpeed = 300,\r\n      loop = true,\r\n      activeIndex = 0,\r\n      width,\r\n      height = 400,\r\n      css,\r\n      onShow,\r\n      onSlideChange,\r\n    },\r\n    ref\r\n  ) => {\r\n    const [currentIndex, setCurrentIndex] = useState(activeIndex);\r\n    const [slidesList, setSlidesList] = useState<AvakioCarouselSlide[]>(slides);\r\n    const [isTransitioning, setIsTransitioning] = useState(false);\r\n    const [touchStart, setTouchStart] = useState<number | null>(null);\r\n    const [touchEnd, setTouchEnd] = useState<number | null>(null);\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n    const autoplayTimerRef = useRef<NodeJS.Timeout | null>(null);\r\n\r\n    // Min swipe distance (in px)\r\n    const minSwipeDistance = 50;\r\n\r\n    useEffect(() => {\r\n      setSlidesList(slides);\r\n    }, [slides]);\r\n\r\n    const goToSlide = useCallback(\r\n      (index: number, skipTransition = false) => {\r\n        if (isTransitioning && !skipTransition) return;\r\n        \r\n        const targetIndex = Math.max(0, Math.min(index, slidesList.length - 1));\r\n        \r\n        if (!skipTransition) {\r\n          setIsTransitioning(true);\r\n          setTimeout(() => setIsTransitioning(false), scrollSpeed);\r\n        }\r\n        \r\n        setCurrentIndex(targetIndex);\r\n        \r\n        const slide = slidesList[targetIndex];\r\n        if (slide) {\r\n          onShow?.(slide.id, targetIndex);\r\n          onSlideChange?.(slide.id, targetIndex);\r\n        }\r\n      },\r\n      [isTransitioning, slidesList, scrollSpeed, onShow, onSlideChange]\r\n    );\r\n\r\n    const showNext = useCallback(() => {\r\n      if (currentIndex < slidesList.length - 1) {\r\n        goToSlide(currentIndex + 1);\r\n      } else if (loop) {\r\n        goToSlide(0);\r\n      }\r\n    }, [currentIndex, slidesList.length, loop, goToSlide]);\r\n\r\n    const showPrev = useCallback(() => {\r\n      if (currentIndex > 0) {\r\n        goToSlide(currentIndex - 1);\r\n      } else if (loop) {\r\n        goToSlide(slidesList.length - 1);\r\n      }\r\n    }, [currentIndex, slidesList.length, loop, goToSlide]);\r\n\r\n    const setActive = useCallback(\r\n      (slideId: string) => {\r\n        const index = slidesList.findIndex(s => s.id === slideId);\r\n        if (index !== -1) {\r\n          goToSlide(index);\r\n        }\r\n      },\r\n      [slidesList, goToSlide]\r\n    );\r\n\r\n    const setActiveIndex = useCallback(\r\n      (index: number) => {\r\n        goToSlide(index);\r\n      },\r\n      [goToSlide]\r\n    );\r\n\r\n    const getActiveId = useCallback(() => {\r\n      return slidesList[currentIndex]?.id || '';\r\n    }, [slidesList, currentIndex]);\r\n\r\n    const getActiveIndex = useCallback(() => {\r\n      return currentIndex;\r\n    }, [currentIndex]);\r\n\r\n    const addView = useCallback((slide: AvakioCarouselSlide, position?: number) => {\r\n      setSlidesList(prev => {\r\n        if (position !== undefined && position >= 0 && position <= prev.length) {\r\n          return [...prev.slice(0, position), slide, ...prev.slice(position)];\r\n        }\r\n        return [...prev, slide];\r\n      });\r\n    }, []);\r\n\r\n    const removeView = useCallback((slideId: string) => {\r\n      setSlidesList(prev => {\r\n        const newSlides = prev.filter(s => s.id !== slideId);\r\n        if (currentIndex >= newSlides.length && newSlides.length > 0) {\r\n          setCurrentIndex(newSlides.length - 1);\r\n        }\r\n        return newSlides;\r\n      });\r\n    }, [currentIndex]);\r\n\r\n    useImperativeHandle(ref, () => ({\r\n      showNext,\r\n      showPrev,\r\n      setActive,\r\n      setActiveIndex,\r\n      getActiveId,\r\n      getActiveIndex,\r\n      addView,\r\n      removeView,\r\n    }));\r\n\r\n    // Autoplay effect\r\n    useEffect(() => {\r\n      if (autoplay && slidesList.length > 1) {\r\n        autoplayTimerRef.current = setInterval(() => {\r\n          showNext();\r\n        }, autoplayDelay);\r\n\r\n        return () => {\r\n          if (autoplayTimerRef.current) {\r\n            clearInterval(autoplayTimerRef.current);\r\n          }\r\n        };\r\n      }\r\n    }, [autoplay, autoplayDelay, showNext, slidesList.length]);\r\n\r\n    // Touch handlers\r\n    const onTouchStart = (e: React.TouchEvent) => {\r\n      setTouchEnd(null);\r\n      setTouchStart(e.targetTouches[0].clientX);\r\n    };\r\n\r\n    const onTouchMove = (e: React.TouchEvent) => {\r\n      setTouchEnd(e.targetTouches[0].clientX);\r\n    };\r\n\r\n    const onTouchEnd = () => {\r\n      if (!touchStart || !touchEnd) return;\r\n      \r\n      const distance = touchStart - touchEnd;\r\n      const isLeftSwipe = distance > minSwipeDistance;\r\n      const isRightSwipe = distance < -minSwipeDistance;\r\n\r\n      if (isLeftSwipe) {\r\n        showNext();\r\n      }\r\n      if (isRightSwipe) {\r\n        showPrev();\r\n      }\r\n    };\r\n\r\n    // Keyboard navigation\r\n    useEffect(() => {\r\n      const handleKeyDown = (e: KeyboardEvent) => {\r\n        if (e.key === 'ArrowLeft') {\r\n          showPrev();\r\n        } else if (e.key === 'ArrowRight') {\r\n          showNext();\r\n        }\r\n      };\r\n\r\n      window.addEventListener('keydown', handleKeyDown);\r\n      return () => window.removeEventListener('keydown', handleKeyDown);\r\n    }, [showNext, showPrev]);\r\n\r\n    const containerStyle: React.CSSProperties = {\r\n      width: typeof width === 'number' ? `${width}px` : width,\r\n      height: typeof height === 'number' ? `${height}px` : height,\r\n      ...(css && typeof css === 'object' && !Array.isArray(css) ? css : {}),\r\n    };\r\n\r\n    const isSideNavigation = navigation.type === 'side';\r\n    const showButtons = navigation.buttons !== false;\r\n    const showItems = navigation.items !== false;\r\n\r\n    return (\r\n      <div\r\n        ref={containerRef}\r\n        id={id}\r\n        data-testid={testId}\r\n        className={`avakio-carousel avakio-carousel-theme-${theme}`}\r\n        style={containerStyle}\r\n        onTouchStart={onTouchStart}\r\n        onTouchMove={onTouchMove}\r\n        onTouchEnd={onTouchEnd}\r\n      >\r\n        {/* Left Navigation Button (Side Type) */}\r\n        {isSideNavigation && showButtons && (\r\n          <button\r\n            className=\"avakio-carousel-nav-button avakio-carousel-nav-prev\"\r\n            onClick={showPrev}\r\n            disabled={!loop && currentIndex === 0}\r\n            aria-label=\"Previous slide\"\r\n          >\r\n            <ChevronLeft size={24} />\r\n          </button>\r\n        )}\r\n\r\n        {/* Slides Container */}\r\n        <div className=\"avakio-carousel-viewport\">\r\n          <div\r\n            className=\"avakio-carousel-track\"\r\n            style={{\r\n              transform: `translateX(-${currentIndex * 100}%)`,\r\n              transition: isTransitioning ? `transform ${scrollSpeed}ms ease-in-out` : 'none',\r\n            }}\r\n          >\r\n            {slidesList.map((slide) => (\r\n              <div key={slide.id} className=\"avakio-carousel-slide\">\r\n                {slide.content}\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Right Navigation Button (Side Type) */}\r\n        {isSideNavigation && showButtons && (\r\n          <button\r\n            className=\"avakio-carousel-nav-button avakio-carousel-nav-next\"\r\n            onClick={showNext}\r\n            disabled={!loop && currentIndex === slidesList.length - 1}\r\n            aria-label=\"Next slide\"\r\n          >\r\n            <ChevronRight size={24} />\r\n          </button>\r\n        )}\r\n\r\n        {/* Bottom Navigation */}\r\n        {!isSideNavigation && (showButtons || showItems) && (\r\n          <div className={`avakio-carousel-nav-bottom avakio-carousel-nav-${navigation.position || 'center'}`}>\r\n            {/* Navigation Buttons */}\r\n            {showButtons && (\r\n              <div className=\"avakio-carousel-nav-buttons\">\r\n                <button\r\n                  className=\"avakio-carousel-nav-button\"\r\n                  onClick={showPrev}\r\n                  disabled={!loop && currentIndex === 0}\r\n                  aria-label=\"Previous slide\"\r\n                >\r\n                  <ChevronLeft size={20} />\r\n                </button>\r\n                <button\r\n                  className=\"avakio-carousel-nav-button\"\r\n                  onClick={showNext}\r\n                  disabled={!loop && currentIndex === slidesList.length - 1}\r\n                  aria-label=\"Next slide\"\r\n                >\r\n                  <ChevronRight size={20} />\r\n                </button>\r\n              </div>\r\n            )}\r\n\r\n            {/* Navigation Indicators */}\r\n            {showItems && (\r\n              <div className=\"avakio-carousel-indicators\">\r\n                {slidesList.map((slide, index) => (\r\n                  <button\r\n                    key={slide.id}\r\n                    className={`avakio-carousel-indicator ${\r\n                      index === currentIndex ? 'avakio-carousel-indicator-active' : ''\r\n                    }`}\r\n                    onClick={() => goToSlide(index)}\r\n                    aria-label={`Go to slide ${index + 1}`}\r\n                  />\r\n                ))}\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nAvakioCarousel.displayName = 'AvakioCarousel';\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { forwardRef, useImperativeHandle, useState, useRef, useEffect, useCallback, useMemo } from 'react';\r\nimport './avakio-chart.css';\r\n\r\nexport type AvakioChartTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\n\r\nexport type AvakioChartType = \r\n  | 'line' \r\n  | 'spline' \r\n  | 'area' \r\n  | 'splineArea'\r\n  | 'bar' \r\n  | 'barH'\r\n  | 'stackedBar'\r\n  | 'stackedBarH'\r\n  | 'pie' \r\n  | 'pie3D'\r\n  | 'donut' \r\n  | 'scatter' \r\n  | 'radar';\r\n\r\nexport interface AvakioChartDataPoint {\r\n  /** X-axis value or label */\r\n  x?: string | number;\r\n  /** Y-axis value */\r\n  y: number;\r\n  /** Label for pie/donut charts */\r\n  label?: string;\r\n  /** Color override for this data point */\r\n  color?: string;\r\n  /** Tooltip text */\r\n  tooltip?: string;\r\n  /** Any additional custom data */\r\n  [key: string]: any;\r\n}\r\n\r\nexport interface AvakioChartSeries {\r\n  /** Unique identifier for the series */\r\n  id?: string;\r\n  /** Series name (shown in legend) */\r\n  name: string;\r\n  /** Data points */\r\n  data: AvakioChartDataPoint[];\r\n  /** Series color */\r\n  color?: string;\r\n  /** Series type override */\r\n  type?: AvakioChartType;\r\n  /** Line width (for line/spline/area) */\r\n  lineWidth?: number;\r\n  /** Fill opacity (for area charts) */\r\n  fillOpacity?: number;\r\n  /** Show data labels */\r\n  showLabels?: boolean;\r\n  /** Show data points/markers */\r\n  showMarkers?: boolean;\r\n  /** Marker size */\r\n  markerSize?: number;\r\n  /** Hidden initially */\r\n  hidden?: boolean;\r\n}\r\n\r\nexport interface AvakioChartAxis {\r\n  /** Axis title */\r\n  title?: string;\r\n  /** Minimum value */\r\n  min?: number;\r\n  /** Maximum value */\r\n  max?: number;\r\n  /** Step between ticks */\r\n  step?: number;\r\n  /** Format function for labels */\r\n  format?: (value: number | string) => string;\r\n  /** Show grid lines */\r\n  showGrid?: boolean;\r\n  /** Show axis line */\r\n  showLine?: boolean;\r\n  /** Show tick marks */\r\n  showTicks?: boolean;\r\n  /** Rotation angle for labels */\r\n  labelRotation?: number;\r\n}\r\n\r\nexport interface AvakioChartLegend {\r\n  /** Show legend */\r\n  show?: boolean;\r\n  /** Legend position */\r\n  position?: 'top' | 'bottom' | 'left' | 'right';\r\n  /** Legend alignment */\r\n  align?: 'start' | 'center' | 'end';\r\n  /** Allow clicking to toggle series */\r\n  toggle?: boolean;\r\n}\r\n\r\nexport interface AvakioChartTooltip {\r\n  /** Show tooltip */\r\n  show?: boolean;\r\n  /** Tooltip format function */\r\n  format?: (point: AvakioChartDataPoint, series: AvakioChartSeries) => string;\r\n  /** Share tooltip across series */\r\n  shared?: boolean;\r\n}\r\n\r\nexport interface AvakioChartPadding {\r\n  top?: number;\r\n  right?: number;\r\n  bottom?: number;\r\n  left?: number;\r\n}\r\n\r\nexport interface AvakioChartProps {\r\n  /** Unique identifier */\r\n  id?: string;\r\n  /** Test ID for testing */\r\n  testId?: string;\r\n  /** Chart type */\r\n  type?: AvakioChartType;\r\n  /** Chart data series */\r\n  series: AvakioChartSeries[];\r\n  /** X-axis configuration */\r\n  xAxis?: AvakioChartAxis;\r\n  /** Y-axis configuration */\r\n  yAxis?: AvakioChartAxis;\r\n  /** Legend configuration */\r\n  legend?: AvakioChartLegend;\r\n  /** Tooltip configuration */\r\n  tooltip?: AvakioChartTooltip;\r\n  /** Chart title */\r\n  title?: string;\r\n  /** Chart subtitle */\r\n  subtitle?: string;\r\n  /** Color palette */\r\n  colors?: string[];\r\n  /** Theme */\r\n  theme?: AvakioChartTheme;\r\n  /** Width */\r\n  width?: number | string;\r\n  /** Height */\r\n  height?: number | string;\r\n  /** Padding */\r\n  padding?: AvakioChartPadding;\r\n  /** Enable animation */\r\n  animate?: boolean;\r\n  /** Animation duration in ms */\r\n  animateDuration?: number;\r\n  /** Show gradient fills */\r\n  gradient?: boolean | 'horizontal' | 'vertical' | 'falling' | 'rising';\r\n  /** Bar width (for bar charts) */\r\n  barWidth?: number;\r\n  /** Bar offset between groups */\r\n  barOffset?: number;\r\n  /** Border radius for bars */\r\n  borderRadius?: number;\r\n  /** Inner radius for donut chart (0-1) */\r\n  donutInnerRadius?: number;\r\n  /** Start angle for pie/donut (degrees) */\r\n  pieStartAngle?: number;\r\n  /** Show pie labels */\r\n  pieLabels?: boolean;\r\n  /** Inner text for donut */\r\n  donutInnerText?: string;\r\n  /** Stacked mode */\r\n  stacked?: boolean;\r\n  /** CSS class */\r\n  className?: string;\r\n  /** Inline styles */\r\n  style?: React.CSSProperties;\r\n  /** Callback when data point is clicked */\r\n  onClick?: (point: AvakioChartDataPoint, series: AvakioChartSeries, index: number) => void;\r\n  /** Callback when data point is hovered */\r\n  onHover?: (point: AvakioChartDataPoint | null, series: AvakioChartSeries | null, index: number | null) => void;\r\n  /** Callback when legend item is clicked */\r\n  onLegendClick?: (series: AvakioChartSeries, visible: boolean) => void;\r\n}\r\n\r\nexport interface AvakioChartRef {\r\n  /** Get chart container */\r\n  getNode: () => HTMLDivElement | null;\r\n  /** Show a series */\r\n  showSeries: (id: string) => void;\r\n  /** Hide a series */\r\n  hideSeries: (id: string) => void;\r\n  /** Toggle series visibility */\r\n  toggleSeries: (id: string) => void;\r\n  /** Get visible series IDs */\r\n  getVisibleSeries: () => string[];\r\n  /** Export chart as base64 image */\r\n  exportImage: (format?: 'png' | 'jpeg') => Promise<string>;\r\n  /** Refresh chart */\r\n  refresh: () => void;\r\n}\r\n\r\n// Default colors palette\r\nconst DEFAULT_COLORS = [\r\n  '#4285F4', // Blue\r\n  '#EA4335', // Red\r\n  '#FBBC05', // Yellow\r\n  '#34A853', // Green\r\n  '#8E24AA', // Purple\r\n  '#00ACC1', // Cyan\r\n  '#FF7043', // Orange\r\n  '#5C6BC0', // Indigo\r\n  '#26A69A', // Teal\r\n  '#D81B60', // Pink\r\n];\r\n\r\n// Helper to calculate nice axis bounds\r\nfunction calculateAxisBounds(data: number[], step?: number): { min: number; max: number; step: number; ticks: number[] } {\r\n  const dataMin = Math.min(...data);\r\n  const dataMax = Math.max(...data);\r\n  const range = dataMax - dataMin || 1;\r\n  \r\n  // Calculate a nice step\r\n  const magnitude = Math.pow(10, Math.floor(Math.log10(range)));\r\n  const residual = range / magnitude;\r\n  \r\n  let niceStep: number;\r\n  if (residual <= 1.5) niceStep = magnitude * 0.2;\r\n  else if (residual <= 3) niceStep = magnitude * 0.5;\r\n  else if (residual <= 7) niceStep = magnitude;\r\n  else niceStep = magnitude * 2;\r\n  \r\n  if (step) niceStep = step;\r\n  \r\n  const min = Math.floor(dataMin / niceStep) * niceStep;\r\n  const max = Math.ceil(dataMax / niceStep) * niceStep;\r\n  \r\n  const ticks: number[] = [];\r\n  for (let tick = min; tick <= max; tick += niceStep) {\r\n    ticks.push(Math.round(tick * 1000) / 1000);\r\n  }\r\n  \r\n  return { min, max, step: niceStep, ticks };\r\n}\r\n\r\n// Generate spline path using Catmull-Rom\r\nfunction createSplinePath(points: { x: number; y: number }[]): string {\r\n  if (points.length < 2) return '';\r\n  if (points.length === 2) {\r\n    return `M ${points[0].x} ${points[0].y} L ${points[1].x} ${points[1].y}`;\r\n  }\r\n  \r\n  const tension = 0.3;\r\n  let path = `M ${points[0].x} ${points[0].y}`;\r\n  \r\n  for (let i = 0; i < points.length - 1; i++) {\r\n    const p0 = points[Math.max(0, i - 1)];\r\n    const p1 = points[i];\r\n    const p2 = points[i + 1];\r\n    const p3 = points[Math.min(points.length - 1, i + 2)];\r\n    \r\n    const cp1x = p1.x + (p2.x - p0.x) * tension;\r\n    const cp1y = p1.y + (p2.y - p0.y) * tension;\r\n    const cp2x = p2.x - (p3.x - p1.x) * tension;\r\n    const cp2y = p2.y - (p3.y - p1.y) * tension;\r\n    \r\n    path += ` C ${cp1x} ${cp1y}, ${cp2x} ${cp2y}, ${p2.x} ${p2.y}`;\r\n  }\r\n  \r\n  return path;\r\n}\r\n\r\n// Create pie/donut arc path\r\nfunction describeArc(cx: number, cy: number, r: number, startAngle: number, endAngle: number): string {\r\n  const start = {\r\n    x: cx + r * Math.cos((startAngle - 90) * Math.PI / 180),\r\n    y: cy + r * Math.sin((startAngle - 90) * Math.PI / 180),\r\n  };\r\n  const end = {\r\n    x: cx + r * Math.cos((endAngle - 90) * Math.PI / 180),\r\n    y: cy + r * Math.sin((endAngle - 90) * Math.PI / 180),\r\n  };\r\n  const largeArcFlag = endAngle - startAngle <= 180 ? 0 : 1;\r\n  \r\n  return `M ${start.x} ${start.y} A ${r} ${r} 0 ${largeArcFlag} 1 ${end.x} ${end.y}`;\r\n}\r\n\r\nfunction describePieSlice(cx: number, cy: number, r: number, innerR: number, startAngle: number, endAngle: number): string {\r\n  const startOuter = {\r\n    x: cx + r * Math.cos((startAngle - 90) * Math.PI / 180),\r\n    y: cy + r * Math.sin((startAngle - 90) * Math.PI / 180),\r\n  };\r\n  const endOuter = {\r\n    x: cx + r * Math.cos((endAngle - 90) * Math.PI / 180),\r\n    y: cy + r * Math.sin((endAngle - 90) * Math.PI / 180),\r\n  };\r\n  const startInner = {\r\n    x: cx + innerR * Math.cos((endAngle - 90) * Math.PI / 180),\r\n    y: cy + innerR * Math.sin((endAngle - 90) * Math.PI / 180),\r\n  };\r\n  const endInner = {\r\n    x: cx + innerR * Math.cos((startAngle - 90) * Math.PI / 180),\r\n    y: cy + innerR * Math.sin((startAngle - 90) * Math.PI / 180),\r\n  };\r\n  \r\n  const largeArcFlag = endAngle - startAngle <= 180 ? 0 : 1;\r\n  \r\n  if (innerR === 0) {\r\n    return `M ${cx} ${cy} L ${startOuter.x} ${startOuter.y} A ${r} ${r} 0 ${largeArcFlag} 1 ${endOuter.x} ${endOuter.y} Z`;\r\n  }\r\n  \r\n  return `M ${startOuter.x} ${startOuter.y} A ${r} ${r} 0 ${largeArcFlag} 1 ${endOuter.x} ${endOuter.y} L ${startInner.x} ${startInner.y} A ${innerR} ${innerR} 0 ${largeArcFlag} 0 ${endInner.x} ${endInner.y} Z`;\r\n}\r\n\r\nexport const AvakioChart = forwardRef<AvakioChartRef, AvakioChartProps>((props, ref) => {\r\n  const {\r\n    id,\r\n    testId,\r\n    type = 'line',\r\n    series,\r\n    xAxis = {},\r\n    yAxis = {},\r\n    legend = { show: true, position: 'bottom', toggle: true },\r\n    tooltip = { show: true },\r\n    title,\r\n    subtitle,\r\n    colors = DEFAULT_COLORS,\r\n    theme = 'material',\r\n    width = '100%',\r\n    height = 400,\r\n    padding = { top: 40, right: 40, bottom: 60, left: 60 },\r\n    animate = true,\r\n    animateDuration = 500,\r\n    gradient = false,\r\n    barWidth = 24,\r\n    barOffset = 8,\r\n    borderRadius = 4,\r\n    donutInnerRadius = 0.5,\r\n    pieStartAngle = 0,\r\n    pieLabels = true,\r\n    donutInnerText,\r\n    stacked = false,\r\n    className,\r\n    style,\r\n    onClick,\r\n    onHover,\r\n    onLegendClick,\r\n  } = props;\r\n\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n  const svgRef = useRef<SVGSVGElement>(null);\r\n  const [dimensions, setDimensions] = useState({ width: 0, height: 0 });\r\n  const [hiddenSeries, setHiddenSeries] = useState<Set<string>>(new Set());\r\n  const [hoveredPoint, setHoveredPoint] = useState<{ seriesId: string; index: number } | null>(null);\r\n  const [tooltipData, setTooltipData] = useState<{ x: number; y: number; content: string } | null>(null);\r\n  const [animationProgress, setAnimationProgress] = useState(animate ? 0 : 1);\r\n\r\n  // Measure container\r\n  useEffect(() => {\r\n    const container = containerRef.current;\r\n    if (!container) return;\r\n\r\n    const observer = new ResizeObserver((entries) => {\r\n      const entry = entries[0];\r\n      if (entry) {\r\n        setDimensions({\r\n          width: Math.max(0, entry.contentRect.width),\r\n          height: Math.max(0, typeof height === 'number' ? height : entry.contentRect.height),\r\n        });\r\n      }\r\n    });\r\n\r\n    observer.observe(container);\r\n    return () => observer.disconnect();\r\n  }, [height]);\r\n\r\n  // Animation\r\n  useEffect(() => {\r\n    if (!animate) {\r\n      setAnimationProgress(1);\r\n      return;\r\n    }\r\n\r\n    setAnimationProgress(0);\r\n    const startTime = performance.now();\r\n    \r\n    const animateFrame = (currentTime: number) => {\r\n      const elapsed = currentTime - startTime;\r\n      const progress = Math.min(elapsed / animateDuration, 1);\r\n      setAnimationProgress(easeOutCubic(progress));\r\n      \r\n      if (progress < 1) {\r\n        requestAnimationFrame(animateFrame);\r\n      }\r\n    };\r\n\r\n    requestAnimationFrame(animateFrame);\r\n  }, [animate, animateDuration, series]);\r\n\r\n  const easeOutCubic = (t: number): number => 1 - Math.pow(1 - t, 3);\r\n\r\n  // Calculate chart area\r\n  const chartArea = useMemo(() => {\r\n    const pad = {\r\n      top: padding.top ?? 40,\r\n      right: padding.right ?? 40,\r\n      bottom: padding.bottom ?? 60,\r\n      left: padding.left ?? 60,\r\n    };\r\n\r\n    // Adjust for legend\r\n    if (legend.show) {\r\n      switch (legend.position) {\r\n        case 'top':\r\n          pad.top += 30;\r\n          break;\r\n        case 'bottom':\r\n          pad.bottom += 30;\r\n          break;\r\n        case 'left':\r\n          pad.left += 100;\r\n          break;\r\n        case 'right':\r\n          pad.right += 100;\r\n          break;\r\n      }\r\n    }\r\n\r\n    // Adjust for title\r\n    if (title) {\r\n      pad.top += 24;\r\n      if (subtitle) pad.top += 16;\r\n    }\r\n\r\n    return {\r\n      x: pad.left,\r\n      y: pad.top,\r\n      width: Math.max(0, dimensions.width - pad.left - pad.right),\r\n      height: Math.max(0, dimensions.height - pad.top - pad.bottom),\r\n    };\r\n  }, [dimensions, padding, legend, title, subtitle]);\r\n\r\n  // Get visible series\r\n  const visibleSeries = useMemo(() => {\r\n    return series.filter((s) => {\r\n      const seriesId = s.id || s.name;\r\n      return !hiddenSeries.has(seriesId);\r\n    });\r\n  }, [series, hiddenSeries]);\r\n\r\n  // Calculate scales\r\n  const scales = useMemo(() => {\r\n    const isPie = type === 'pie' || type === 'pie3D' || type === 'donut';\r\n    const isRadar = type === 'radar';\r\n    const isHorizontalBar = type === 'barH' || type === 'stackedBarH';\r\n\r\n    if (isPie || isRadar) {\r\n      return { xScale: null, yScale: null };\r\n    }\r\n\r\n    // Collect all data points\r\n    const allXValues: (string | number)[] = [];\r\n    const allYValues: number[] = [];\r\n\r\n    visibleSeries.forEach((s) => {\r\n      s.data.forEach((d) => {\r\n        if (d.x !== undefined) allXValues.push(d.x);\r\n        allYValues.push(d.y);\r\n      });\r\n    });\r\n\r\n    // Get unique x values (for categorical)\r\n    const uniqueXValues = Array.from(new Set(allXValues));\r\n    const isXNumeric = uniqueXValues.every((v) => typeof v === 'number');\r\n\r\n    // Y-axis bounds\r\n    const yBounds = calculateAxisBounds(\r\n      stacked ? calculateStackedMaxValues(visibleSeries) : allYValues,\r\n      yAxis.step\r\n    );\r\n\r\n    if (yAxis.min !== undefined) yBounds.min = yAxis.min;\r\n    if (yAxis.max !== undefined) yBounds.max = yAxis.max;\r\n\r\n    return {\r\n      xValues: uniqueXValues,\r\n      isXNumeric,\r\n      yBounds,\r\n      xScale: (value: string | number): number => {\r\n        if (isXNumeric) {\r\n          const numValue = value as number;\r\n          const min = Math.min(...(uniqueXValues as number[]));\r\n          const max = Math.max(...(uniqueXValues as number[]));\r\n          return chartArea.x + ((numValue - min) / (max - min || 1)) * chartArea.width;\r\n        }\r\n        const index = uniqueXValues.indexOf(value);\r\n        return chartArea.x + (index + 0.5) * (chartArea.width / uniqueXValues.length);\r\n      },\r\n      yScale: (value: number): number => {\r\n        const range = yBounds.max - yBounds.min || 1;\r\n        return chartArea.y + chartArea.height - ((value - yBounds.min) / range) * chartArea.height;\r\n      },\r\n    };\r\n  }, [visibleSeries, chartArea, type, xAxis, yAxis, stacked]);\r\n\r\n  // Helper for stacked values\r\n  function calculateStackedMaxValues(series: AvakioChartSeries[]): number[] {\r\n    const maxValues: number[] = [];\r\n    if (series.length === 0) return [0];\r\n    \r\n    const numPoints = series[0].data.length;\r\n    for (let i = 0; i < numPoints; i++) {\r\n      let sum = 0;\r\n      series.forEach((s) => {\r\n        if (s.data[i]) sum += s.data[i].y;\r\n      });\r\n      maxValues.push(sum);\r\n    }\r\n    return maxValues;\r\n  }\r\n\r\n  // Handle legend click\r\n  const handleLegendClick = (seriesItem: AvakioChartSeries) => {\r\n    if (!legend.toggle) return;\r\n    \r\n    const seriesId = seriesItem.id || seriesItem.name;\r\n    const newHidden = new Set(hiddenSeries);\r\n    \r\n    if (newHidden.has(seriesId)) {\r\n      newHidden.delete(seriesId);\r\n    } else {\r\n      newHidden.add(seriesId);\r\n    }\r\n    \r\n    setHiddenSeries(newHidden);\r\n    onLegendClick?.(seriesItem, !newHidden.has(seriesId));\r\n  };\r\n\r\n  // Handle point hover\r\n  const handlePointHover = (seriesItem: AvakioChartSeries | null, point: AvakioChartDataPoint | null, index: number | null, event: React.MouseEvent) => {\r\n    if (point && seriesItem && index !== null) {\r\n      const seriesId = seriesItem.id || seriesItem.name;\r\n      setHoveredPoint({ seriesId, index });\r\n      \r\n      if (tooltip.show) {\r\n        const content = tooltip.format \r\n          ? tooltip.format(point, seriesItem)\r\n          : `${seriesItem.name}: ${point.y}`;\r\n        \r\n        const rect = containerRef.current?.getBoundingClientRect();\r\n        if (rect) {\r\n          setTooltipData({\r\n            x: event.clientX - rect.left,\r\n            y: event.clientY - rect.top,\r\n            content,\r\n          });\r\n        }\r\n      }\r\n      \r\n      onHover?.(point, seriesItem, index);\r\n    } else {\r\n      setHoveredPoint(null);\r\n      setTooltipData(null);\r\n      onHover?.(null, null, null);\r\n    }\r\n  };\r\n\r\n  // Handle point click\r\n  const handlePointClick = (seriesItem: AvakioChartSeries, point: AvakioChartDataPoint, index: number) => {\r\n    onClick?.(point, seriesItem, index);\r\n  };\r\n\r\n  // Imperative handle\r\n  useImperativeHandle(ref, () => ({\r\n    getNode: () => containerRef.current,\r\n    showSeries: (seriesId: string) => {\r\n      setHiddenSeries((prev) => {\r\n        const next = new Set(prev);\r\n        next.delete(seriesId);\r\n        return next;\r\n      });\r\n    },\r\n    hideSeries: (seriesId: string) => {\r\n      setHiddenSeries((prev) => new Set(prev).add(seriesId));\r\n    },\r\n    toggleSeries: (seriesId: string) => {\r\n      setHiddenSeries((prev) => {\r\n        const next = new Set(prev);\r\n        if (next.has(seriesId)) {\r\n          next.delete(seriesId);\r\n        } else {\r\n          next.add(seriesId);\r\n        }\r\n        return next;\r\n      });\r\n    },\r\n    getVisibleSeries: () => {\r\n      return series\r\n        .filter((s) => !hiddenSeries.has(s.id || s.name))\r\n        .map((s) => s.id || s.name);\r\n    },\r\n    exportImage: async (format = 'png') => {\r\n      if (!svgRef.current) return '';\r\n      \r\n      const svgData = new XMLSerializer().serializeToString(svgRef.current);\r\n      const canvas = document.createElement('canvas');\r\n      canvas.width = dimensions.width;\r\n      canvas.height = dimensions.height;\r\n      const ctx = canvas.getContext('2d');\r\n      \r\n      return new Promise((resolve) => {\r\n        const img = new Image();\r\n        img.onload = () => {\r\n          ctx?.drawImage(img, 0, 0);\r\n          resolve(canvas.toDataURL(`image/${format}`));\r\n        };\r\n        img.src = 'data:image/svg+xml;base64,' + btoa(unescape(encodeURIComponent(svgData)));\r\n      });\r\n    },\r\n    refresh: () => {\r\n      setAnimationProgress(0);\r\n      setTimeout(() => setAnimationProgress(1), 10);\r\n    },\r\n  }), [series, hiddenSeries, dimensions]);\r\n\r\n  // Render functions\r\n  const renderTitle = () => {\r\n    if (!title) return null;\r\n    \r\n    return (\r\n      <g className=\"avakio-chart__title\">\r\n        <text\r\n          x={dimensions.width / 2}\r\n          y={24}\r\n          textAnchor=\"middle\"\r\n          className=\"avakio-chart__title-text\"\r\n        >\r\n          {title}\r\n        </text>\r\n        {subtitle && (\r\n          <text\r\n            x={dimensions.width / 2}\r\n            y={44}\r\n            textAnchor=\"middle\"\r\n            className=\"avakio-chart__subtitle-text\"\r\n          >\r\n            {subtitle}\r\n          </text>\r\n        )}\r\n      </g>\r\n    );\r\n  };\r\n\r\n  const renderAxis = () => {\r\n    if (type === 'pie' || type === 'pie3D' || type === 'donut' || type === 'radar') {\r\n      return null;\r\n    }\r\n\r\n    if (!scales.xValues || !scales.yBounds) return null;\r\n\r\n    const xAxisY = chartArea.y + chartArea.height;\r\n    const yAxisX = chartArea.x;\r\n\r\n    return (\r\n      <g className=\"avakio-chart__axes\">\r\n        {/* X Axis */}\r\n        {(xAxis.showLine !== false) && (\r\n          <line\r\n            x1={chartArea.x}\r\n            y1={xAxisY}\r\n            x2={chartArea.x + chartArea.width}\r\n            y2={xAxisY}\r\n            className=\"avakio-chart__axis-line\"\r\n          />\r\n        )}\r\n        \r\n        {/* X Axis Labels */}\r\n        {scales.xValues.map((value, i) => {\r\n          const x = scales.xScale!(value);\r\n          return (\r\n            <g key={`x-${i}`}>\r\n              {(xAxis.showTicks !== false) && (\r\n                <line\r\n                  x1={x}\r\n                  y1={xAxisY}\r\n                  x2={x}\r\n                  y2={xAxisY + 6}\r\n                  className=\"avakio-chart__tick\"\r\n                />\r\n              )}\r\n              <text\r\n                x={x}\r\n                y={xAxisY + 20}\r\n                textAnchor=\"middle\"\r\n                className=\"avakio-chart__axis-label\"\r\n                transform={xAxis.labelRotation ? `rotate(${xAxis.labelRotation}, ${x}, ${xAxisY + 20})` : undefined}\r\n              >\r\n                {xAxis.format ? xAxis.format(value) : String(value)}\r\n              </text>\r\n            </g>\r\n          );\r\n        })}\r\n        \r\n        {/* X Axis Title */}\r\n        {xAxis.title && (\r\n          <text\r\n            x={chartArea.x + chartArea.width / 2}\r\n            y={xAxisY + 45}\r\n            textAnchor=\"middle\"\r\n            className=\"avakio-chart__axis-title\"\r\n          >\r\n            {xAxis.title}\r\n          </text>\r\n        )}\r\n\r\n        {/* Y Axis */}\r\n        {(yAxis.showLine !== false) && (\r\n          <line\r\n            x1={yAxisX}\r\n            y1={chartArea.y}\r\n            x2={yAxisX}\r\n            y2={chartArea.y + chartArea.height}\r\n            className=\"avakio-chart__axis-line\"\r\n          />\r\n        )}\r\n        \r\n        {/* Y Axis Labels and Grid */}\r\n        {scales.yBounds.ticks.map((value, i) => {\r\n          const y = scales.yScale!(value);\r\n          return (\r\n            <g key={`y-${i}`}>\r\n              {(yAxis.showGrid !== false) && (\r\n                <line\r\n                  x1={chartArea.x}\r\n                  y1={y}\r\n                  x2={chartArea.x + chartArea.width}\r\n                  y2={y}\r\n                  className=\"avakio-chart__grid-line\"\r\n                />\r\n              )}\r\n              {(yAxis.showTicks !== false) && (\r\n                <line\r\n                  x1={yAxisX - 6}\r\n                  y1={y}\r\n                  x2={yAxisX}\r\n                  y2={y}\r\n                  className=\"avakio-chart__tick\"\r\n                />\r\n              )}\r\n              <text\r\n                x={yAxisX - 12}\r\n                y={y + 4}\r\n                textAnchor=\"end\"\r\n                className=\"avakio-chart__axis-label\"\r\n              >\r\n                {yAxis.format ? yAxis.format(value) : String(value)}\r\n              </text>\r\n            </g>\r\n          );\r\n        })}\r\n        \r\n        {/* Y Axis Title */}\r\n        {yAxis.title && (\r\n          <text\r\n            x={20}\r\n            y={chartArea.y + chartArea.height / 2}\r\n            textAnchor=\"middle\"\r\n            className=\"avakio-chart__axis-title\"\r\n            transform={`rotate(-90, 20, ${chartArea.y + chartArea.height / 2})`}\r\n          >\r\n            {yAxis.title}\r\n          </text>\r\n        )}\r\n      </g>\r\n    );\r\n  };\r\n\r\n  const renderLineChart = (isSpline: boolean = false, isArea: boolean = false) => {\r\n    if (!scales.xScale || !scales.yScale) return null;\r\n\r\n    return (\r\n      <g className=\"avakio-chart__series\">\r\n        {visibleSeries.map((s, seriesIdx) => {\r\n          const seriesId = s.id || s.name;\r\n          const color = s.color || colors[seriesIdx % colors.length];\r\n          const points = s.data.map((d) => ({\r\n            x: scales.xScale!(d.x ?? seriesIdx),\r\n            y: scales.yScale!(d.y * animationProgress),\r\n          }));\r\n\r\n          const linePath = isSpline\r\n            ? createSplinePath(points)\r\n            : `M ${points.map((p) => `${p.x} ${p.y}`).join(' L ')}`;\r\n\r\n          const areaPath = isArea\r\n            ? `${linePath} L ${points[points.length - 1]?.x ?? 0} ${chartArea.y + chartArea.height} L ${points[0]?.x ?? 0} ${chartArea.y + chartArea.height} Z`\r\n            : '';\r\n\r\n          return (\r\n            <g key={seriesId} className=\"avakio-chart__series-group\">\r\n              {/* Gradient definition */}\r\n              {gradient && isArea && (\r\n                <defs>\r\n                  <linearGradient id={`gradient-${seriesId}`} x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\">\r\n                    <stop offset=\"0%\" stopColor={color} stopOpacity=\"0.6\" />\r\n                    <stop offset=\"100%\" stopColor={color} stopOpacity=\"0.05\" />\r\n                  </linearGradient>\r\n                </defs>\r\n              )}\r\n              \r\n              {/* Area fill */}\r\n              {isArea && (\r\n                <path\r\n                  d={areaPath}\r\n                  fill={gradient ? `url(#gradient-${seriesId})` : color}\r\n                  fillOpacity={gradient ? 1 : s.fillOpacity ?? 0.2}\r\n                  className=\"avakio-chart__area\"\r\n                />\r\n              )}\r\n              \r\n              {/* Line */}\r\n              <path\r\n                d={linePath}\r\n                stroke={color}\r\n                strokeWidth={s.lineWidth ?? 2}\r\n                fill=\"none\"\r\n                className=\"avakio-chart__line\"\r\n              />\r\n              \r\n              {/* Data points */}\r\n              {(s.showMarkers !== false) && points.map((point, i) => (\r\n                <circle\r\n                  key={i}\r\n                  cx={point.x}\r\n                  cy={point.y}\r\n                  r={hoveredPoint?.seriesId === seriesId && hoveredPoint?.index === i \r\n                    ? (s.markerSize ?? 4) + 2 \r\n                    : s.markerSize ?? 4}\r\n                  fill={color}\r\n                  stroke=\"#fff\"\r\n                  strokeWidth={2}\r\n                  className=\"avakio-chart__marker\"\r\n                  onMouseEnter={(e) => handlePointHover(s, s.data[i], i, e)}\r\n                  onMouseLeave={() => handlePointHover(null, null, null, {} as React.MouseEvent)}\r\n                  onClick={() => handlePointClick(s, s.data[i], i)}\r\n                  style={{ cursor: onClick ? 'pointer' : 'default' }}\r\n                />\r\n              ))}\r\n              \r\n              {/* Labels */}\r\n              {s.showLabels && points.map((point, i) => (\r\n                <text\r\n                  key={`label-${i}`}\r\n                  x={point.x}\r\n                  y={point.y - 10}\r\n                  textAnchor=\"middle\"\r\n                  className=\"avakio-chart__data-label\"\r\n                >\r\n                  {s.data[i].y}\r\n                </text>\r\n              ))}\r\n            </g>\r\n          );\r\n        })}\r\n      </g>\r\n    );\r\n  };\r\n\r\n  const renderBarChart = (horizontal: boolean = false) => {\r\n    if (!scales.xScale || !scales.yScale || !scales.xValues) return null;\r\n\r\n    const numSeries = visibleSeries.length;\r\n    const groupWidth = chartArea.width / Math.max(1, scales.xValues.length);\r\n    const effectiveBarWidth = Math.max(1, Math.min(barWidth, (groupWidth - barOffset * 2) / Math.max(1, numSeries)));\r\n    const totalBarWidth = effectiveBarWidth * numSeries;\r\n    const groupOffset = Math.max(0, (groupWidth - totalBarWidth) / 2);\r\n\r\n    return (\r\n      <g className=\"avakio-chart__series\">\r\n        {scales.xValues.map((xVal, xIdx) => {\r\n          const groupX = chartArea.x + xIdx * groupWidth;\r\n          \r\n          let stackedY = chartArea.y + chartArea.height;\r\n          \r\n          return (\r\n            <g key={`group-${xIdx}`} className=\"avakio-chart__bar-group\">\r\n              {visibleSeries.map((s, seriesIdx) => {\r\n                const seriesId = s.id || s.name;\r\n                const color = s.color || colors[seriesIdx % colors.length];\r\n                const dataPoint = s.data.find((d) => d.x === xVal) || s.data[xIdx];\r\n                \r\n                if (!dataPoint) return null;\r\n\r\n                const value = dataPoint.y * animationProgress;\r\n                const yRange = Math.max(1, scales.yBounds.max - scales.yBounds.min);\r\n                const barHeight = Math.max(0, (value / yRange) * chartArea.height);\r\n                \r\n                let x: number, y: number, w: number, h: number;\r\n                \r\n                if (stacked) {\r\n                  x = groupX + groupOffset;\r\n                  h = barHeight;\r\n                  y = stackedY - h;\r\n                  w = Math.max(1, totalBarWidth);\r\n                  stackedY = y;\r\n                } else {\r\n                  x = groupX + groupOffset + seriesIdx * effectiveBarWidth;\r\n                  y = scales.yScale!(value);\r\n                  w = Math.max(1, effectiveBarWidth - 2);\r\n                  h = Math.max(0, chartArea.y + chartArea.height - y);\r\n                }\r\n\r\n                const isHovered = hoveredPoint?.seriesId === seriesId && hoveredPoint?.index === xIdx;\r\n\r\n                return (\r\n                  <g key={seriesId}>\r\n                    {/* Gradient definition */}\r\n                    {gradient && (\r\n                      <defs>\r\n                        <linearGradient id={`bar-gradient-${seriesId}-${xIdx}`} x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\">\r\n                          <stop offset=\"0%\" stopColor={color} stopOpacity=\"1\" />\r\n                          <stop offset=\"100%\" stopColor={color} stopOpacity=\"0.7\" />\r\n                        </linearGradient>\r\n                      </defs>\r\n                    )}\r\n                    <rect\r\n                      x={x}\r\n                      y={y}\r\n                      width={w}\r\n                      height={Math.max(0, h)}\r\n                      rx={borderRadius}\r\n                      fill={gradient ? `url(#bar-gradient-${seriesId}-${xIdx})` : color}\r\n                      className={`avakio-chart__bar ${isHovered ? 'avakio-chart__bar--hovered' : ''}`}\r\n                      onMouseEnter={(e) => handlePointHover(s, dataPoint, xIdx, e)}\r\n                      onMouseLeave={() => handlePointHover(null, null, null, {} as React.MouseEvent)}\r\n                      onClick={() => handlePointClick(s, dataPoint, xIdx)}\r\n                      style={{ cursor: onClick ? 'pointer' : 'default' }}\r\n                    />\r\n                    {s.showLabels && (\r\n                      <text\r\n                        x={x + w / 2}\r\n                        y={y - 5}\r\n                        textAnchor=\"middle\"\r\n                        className=\"avakio-chart__data-label\"\r\n                      >\r\n                        {dataPoint.y}\r\n                      </text>\r\n                    )}\r\n                  </g>\r\n                );\r\n              })}\r\n            </g>\r\n          );\r\n        })}\r\n      </g>\r\n    );\r\n  };\r\n\r\n  const renderPieChart = (isDonut: boolean = false) => {\r\n    // Use first series for pie/donut\r\n    const seriesData = visibleSeries[0];\r\n    if (!seriesData) return null;\r\n\r\n    const cx = chartArea.x + chartArea.width / 2;\r\n    const cy = chartArea.y + chartArea.height / 2;\r\n    const radius = Math.min(chartArea.width, chartArea.height) / 2 - 20;\r\n    const innerRadius = isDonut ? radius * donutInnerRadius : 0;\r\n\r\n    const total = seriesData.data.reduce((sum, d) => sum + d.y, 0);\r\n    let currentAngle = pieStartAngle;\r\n\r\n    return (\r\n      <g className=\"avakio-chart__pie\">\r\n        {seriesData.data.map((d, i) => {\r\n          const sliceAngle = (d.y / total) * 360 * animationProgress;\r\n          const startAngle = currentAngle;\r\n          const endAngle = currentAngle + sliceAngle;\r\n          currentAngle = endAngle;\r\n\r\n          const color = d.color || colors[i % colors.length];\r\n          const midAngle = (startAngle + endAngle) / 2;\r\n          const isHovered = hoveredPoint?.seriesId === (seriesData.id || seriesData.name) && hoveredPoint?.index === i;\r\n          \r\n          // Calculate label position\r\n          const labelRadius = radius + 25;\r\n          const labelX = cx + labelRadius * Math.cos((midAngle - 90) * Math.PI / 180);\r\n          const labelY = cy + labelRadius * Math.sin((midAngle - 90) * Math.PI / 180);\r\n\r\n          // Hover offset\r\n          const offsetDistance = isHovered ? 8 : 0;\r\n          const offsetX = offsetDistance * Math.cos((midAngle - 90) * Math.PI / 180);\r\n          const offsetY = offsetDistance * Math.sin((midAngle - 90) * Math.PI / 180);\r\n\r\n          return (\r\n            <g key={i} transform={`translate(${offsetX}, ${offsetY})`}>\r\n              {/* Gradient definition */}\r\n              {gradient && (\r\n                <defs>\r\n                  <radialGradient id={`pie-gradient-${i}`} cx=\"30%\" cy=\"30%\">\r\n                    <stop offset=\"0%\" stopColor={color} stopOpacity=\"1\" />\r\n                    <stop offset=\"100%\" stopColor={color} stopOpacity=\"0.8\" />\r\n                  </radialGradient>\r\n                </defs>\r\n              )}\r\n              <path\r\n                d={describePieSlice(cx, cy, radius, innerRadius, startAngle, endAngle)}\r\n                fill={gradient ? `url(#pie-gradient-${i})` : color}\r\n                stroke=\"#fff\"\r\n                strokeWidth={2}\r\n                className={`avakio-chart__pie-slice ${isHovered ? 'avakio-chart__pie-slice--hovered' : ''}`}\r\n                onMouseEnter={(e) => handlePointHover(seriesData, d, i, e)}\r\n                onMouseLeave={() => handlePointHover(null, null, null, {} as React.MouseEvent)}\r\n                onClick={() => handlePointClick(seriesData, d, i)}\r\n                style={{ cursor: onClick ? 'pointer' : 'default' }}\r\n              />\r\n              {pieLabels && sliceAngle > 15 && (\r\n                <text\r\n                  x={labelX}\r\n                  y={labelY}\r\n                  textAnchor={labelX > cx ? 'start' : 'end'}\r\n                  className=\"avakio-chart__pie-label\"\r\n                >\r\n                  {d.label || d.x || ''} ({((d.y / total) * 100).toFixed(1)}%)\r\n                </text>\r\n              )}\r\n            </g>\r\n          );\r\n        })}\r\n        \r\n        {/* Donut inner text */}\r\n        {isDonut && donutInnerText && (\r\n          <text\r\n            x={cx}\r\n            y={cy}\r\n            textAnchor=\"middle\"\r\n            dominantBaseline=\"middle\"\r\n            className=\"avakio-chart__donut-text\"\r\n          >\r\n            {donutInnerText}\r\n          </text>\r\n        )}\r\n      </g>\r\n    );\r\n  };\r\n\r\n  const renderScatterChart = () => {\r\n    if (!scales.xScale || !scales.yScale) return null;\r\n\r\n    return (\r\n      <g className=\"avakio-chart__series\">\r\n        {visibleSeries.map((s, seriesIdx) => {\r\n          const seriesId = s.id || s.name;\r\n          const color = s.color || colors[seriesIdx % colors.length];\r\n\r\n          return (\r\n            <g key={seriesId} className=\"avakio-chart__scatter-group\">\r\n              {s.data.map((d, i) => {\r\n                const x = scales.xScale!(d.x ?? i);\r\n                const y = scales.yScale!(d.y * animationProgress);\r\n                const isHovered = hoveredPoint?.seriesId === seriesId && hoveredPoint?.index === i;\r\n\r\n                return (\r\n                  <circle\r\n                    key={i}\r\n                    cx={x}\r\n                    cy={y}\r\n                    r={isHovered ? (s.markerSize ?? 6) + 2 : s.markerSize ?? 6}\r\n                    fill={d.color || color}\r\n                    fillOpacity={0.7}\r\n                    stroke={d.color || color}\r\n                    strokeWidth={2}\r\n                    className=\"avakio-chart__scatter-point\"\r\n                    onMouseEnter={(e) => handlePointHover(s, d, i, e)}\r\n                    onMouseLeave={() => handlePointHover(null, null, null, {} as React.MouseEvent)}\r\n                    onClick={() => handlePointClick(s, d, i)}\r\n                    style={{ cursor: onClick ? 'pointer' : 'default' }}\r\n                  />\r\n                );\r\n              })}\r\n            </g>\r\n          );\r\n        })}\r\n      </g>\r\n    );\r\n  };\r\n\r\n  const renderRadarChart = () => {\r\n    // Use first series to get categories from x values\r\n    if (visibleSeries.length === 0) return null;\r\n    \r\n    const categories = visibleSeries[0].data.map((d) => String(d.label || d.x || ''));\r\n    const numCategories = categories.length;\r\n    const angleStep = (Math.PI * 2) / numCategories;\r\n    \r\n    const cx = chartArea.x + chartArea.width / 2;\r\n    const cy = chartArea.y + chartArea.height / 2;\r\n    const radius = Math.min(chartArea.width, chartArea.height) / 2 - 40;\r\n    \r\n    // Calculate max value for scaling\r\n    const maxValue = Math.max(...visibleSeries.flatMap((s) => s.data.map((d) => d.y)));\r\n    const numLevels = 5;\r\n\r\n    return (\r\n      <g className=\"avakio-chart__radar\">\r\n        {/* Background levels */}\r\n        {Array.from({ length: numLevels }).map((_, levelIdx) => {\r\n          const levelRadius = (radius * (levelIdx + 1)) / numLevels;\r\n          const points = Array.from({ length: numCategories }).map((_, i) => {\r\n            const angle = i * angleStep - Math.PI / 2;\r\n            return {\r\n              x: cx + levelRadius * Math.cos(angle),\r\n              y: cy + levelRadius * Math.sin(angle),\r\n            };\r\n          });\r\n          \r\n          return (\r\n            <polygon\r\n              key={levelIdx}\r\n              points={points.map((p) => `${p.x},${p.y}`).join(' ')}\r\n              fill=\"none\"\r\n              stroke=\"currentColor\"\r\n              strokeOpacity={0.2}\r\n              className=\"avakio-chart__radar-level\"\r\n            />\r\n          );\r\n        })}\r\n        \r\n        {/* Axis lines */}\r\n        {categories.map((_, i) => {\r\n          const angle = i * angleStep - Math.PI / 2;\r\n          const x = cx + radius * Math.cos(angle);\r\n          const y = cy + radius * Math.sin(angle);\r\n          \r\n          return (\r\n            <line\r\n              key={i}\r\n              x1={cx}\r\n              y1={cy}\r\n              x2={x}\r\n              y2={y}\r\n              stroke=\"currentColor\"\r\n              strokeOpacity={0.2}\r\n              className=\"avakio-chart__radar-axis\"\r\n            />\r\n          );\r\n        })}\r\n        \r\n        {/* Category labels */}\r\n        {categories.map((cat, i) => {\r\n          const angle = i * angleStep - Math.PI / 2;\r\n          const x = cx + (radius + 20) * Math.cos(angle);\r\n          const y = cy + (radius + 20) * Math.sin(angle);\r\n          \r\n          return (\r\n            <text\r\n              key={i}\r\n              x={x}\r\n              y={y}\r\n              textAnchor=\"middle\"\r\n              dominantBaseline=\"middle\"\r\n              className=\"avakio-chart__radar-label\"\r\n            >\r\n              {cat}\r\n            </text>\r\n          );\r\n        })}\r\n        \r\n        {/* Data polygons */}\r\n        {visibleSeries.map((s, seriesIdx) => {\r\n          const seriesId = s.id || s.name;\r\n          const color = s.color || colors[seriesIdx % colors.length];\r\n          \r\n          const points = s.data.map((d, i) => {\r\n            const angle = i * angleStep - Math.PI / 2;\r\n            const r = (d.y / maxValue) * radius * animationProgress;\r\n            return {\r\n              x: cx + r * Math.cos(angle),\r\n              y: cy + r * Math.sin(angle),\r\n            };\r\n          });\r\n          \r\n          return (\r\n            <g key={seriesId}>\r\n              <polygon\r\n                points={points.map((p) => `${p.x},${p.y}`).join(' ')}\r\n                fill={color}\r\n                fillOpacity={0.2}\r\n                stroke={color}\r\n                strokeWidth={2}\r\n                className=\"avakio-chart__radar-polygon\"\r\n              />\r\n              {points.map((point, i) => (\r\n                <circle\r\n                  key={i}\r\n                  cx={point.x}\r\n                  cy={point.y}\r\n                  r={s.markerSize ?? 4}\r\n                  fill={color}\r\n                  stroke=\"#fff\"\r\n                  strokeWidth={2}\r\n                  className=\"avakio-chart__radar-point\"\r\n                  onMouseEnter={(e) => handlePointHover(s, s.data[i], i, e)}\r\n                  onMouseLeave={() => handlePointHover(null, null, null, {} as React.MouseEvent)}\r\n                  onClick={() => handlePointClick(s, s.data[i], i)}\r\n                  style={{ cursor: onClick ? 'pointer' : 'default' }}\r\n                />\r\n              ))}\r\n            </g>\r\n          );\r\n        })}\r\n      </g>\r\n    );\r\n  };\r\n\r\n  const renderLegend = () => {\r\n    if (!legend.show) return null;\r\n\r\n    const isVertical = legend.position === 'left' || legend.position === 'right';\r\n    \r\n    let x: number, y: number;\r\n    switch (legend.position) {\r\n      case 'top':\r\n        x = dimensions.width / 2;\r\n        y = title ? 60 : 20;\r\n        break;\r\n      case 'bottom':\r\n        x = dimensions.width / 2;\r\n        y = dimensions.height - 15;\r\n        break;\r\n      case 'left':\r\n        x = 20;\r\n        y = chartArea.y + 20;\r\n        break;\r\n      case 'right':\r\n        x = dimensions.width - 100;\r\n        y = chartArea.y + 20;\r\n        break;\r\n      default:\r\n        x = dimensions.width / 2;\r\n        y = dimensions.height - 15;\r\n    }\r\n\r\n    return (\r\n      <g \r\n        className=\"avakio-chart__legend\"\r\n        transform={`translate(${x}, ${y})`}\r\n      >\r\n        {series.map((s, i) => {\r\n          const seriesId = s.id || s.name;\r\n          const color = s.color || colors[i % colors.length];\r\n          const isHidden = hiddenSeries.has(seriesId);\r\n          \r\n          const itemX = isVertical ? 0 : (i - series.length / 2) * 100;\r\n          const itemY = isVertical ? i * 24 : 0;\r\n          \r\n          return (\r\n            <g\r\n              key={seriesId}\r\n              className={`avakio-chart__legend-item ${isHidden ? 'avakio-chart__legend-item--hidden' : ''}`}\r\n              transform={`translate(${itemX}, ${itemY})`}\r\n              onClick={() => handleLegendClick(s)}\r\n              style={{ cursor: legend.toggle ? 'pointer' : 'default' }}\r\n            >\r\n              <rect\r\n                x={0}\r\n                y={-8}\r\n                width={12}\r\n                height={12}\r\n                rx={2}\r\n                fill={isHidden ? 'transparent' : color}\r\n                stroke={color}\r\n                strokeWidth={2}\r\n              />\r\n              <text\r\n                x={18}\r\n                y={0}\r\n                dominantBaseline=\"middle\"\r\n                className=\"avakio-chart__legend-text\"\r\n                style={{ opacity: isHidden ? 0.5 : 1 }}\r\n              >\r\n                {s.name}\r\n              </text>\r\n            </g>\r\n          );\r\n        })}\r\n      </g>\r\n    );\r\n  };\r\n\r\n  const renderTooltip = () => {\r\n    if (!tooltipData) return null;\r\n\r\n    return (\r\n      <div\r\n        className=\"avakio-chart__tooltip\"\r\n        style={{\r\n          left: tooltipData.x + 10,\r\n          top: tooltipData.y - 10,\r\n        }}\r\n      >\r\n        {tooltipData.content}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const renderChartContent = () => {\r\n    switch (type) {\r\n      case 'line':\r\n        return renderLineChart(false, false);\r\n      case 'spline':\r\n        return renderLineChart(true, false);\r\n      case 'area':\r\n        return renderLineChart(false, true);\r\n      case 'splineArea':\r\n        return renderLineChart(true, true);\r\n      case 'bar':\r\n      case 'stackedBar':\r\n        return renderBarChart(false);\r\n      case 'barH':\r\n      case 'stackedBarH':\r\n        return renderBarChart(true);\r\n      case 'pie':\r\n      case 'pie3D':\r\n        return renderPieChart(false);\r\n      case 'donut':\r\n        return renderPieChart(true);\r\n      case 'scatter':\r\n        return renderScatterChart();\r\n      case 'radar':\r\n        return renderRadarChart();\r\n      default:\r\n        return renderLineChart(false, false);\r\n    }\r\n  };\r\n\r\n  const containerStyle: React.CSSProperties = {\r\n    width,\r\n    height,\r\n    ...style,\r\n  };\r\n\r\n  return (\r\n    <div\r\n      ref={containerRef}\r\n      id={id}\r\n      data-testid={testId}\r\n      className={`avakio-chart avakio-chart--${theme} avakio-chart--${type} ${className || ''}`}\r\n      style={containerStyle}\r\n    >\r\n      <svg\r\n        ref={svgRef}\r\n        width={dimensions.width}\r\n        height={dimensions.height}\r\n        className=\"avakio-chart__svg\"\r\n      >\r\n        {renderTitle()}\r\n        {renderAxis()}\r\n        {renderChartContent()}\r\n        {renderLegend()}\r\n      </svg>\r\n      {renderTooltip()}\r\n    </div>\r\n  );\r\n});\r\n\r\nAvakioChart.displayName = 'AvakioChart';\r\n\r\nexport default AvakioChart;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, {\r\n  CSSProperties,\r\n  forwardRef,\r\n  useCallback,\r\n  useEffect,\r\n  useImperativeHandle,\r\n  useMemo,\r\n  useRef,\r\n  useState,\r\n} from 'react';\r\nimport { AvakioGrid, AvakioGridCell, AvakioGridRef } from '../../layouts/avakio-grid/avakio-grid';\r\nimport './avakio-dashboard.css';\r\n\r\nexport type AvakioDashboardTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\n\r\nexport interface AvakioDashboardWidget {\r\n  id: string;\r\n\r\n  x: number;\r\n  y: number;\r\n  dx?: number;\r\n  dy?: number;\r\n\r\n  header?: React.ReactNode;\r\n  icon?: React.ReactNode;\r\n  body?: React.ReactNode;\r\n\r\n  /** Whether this widget can be dragged (when `editable` is true) */\r\n  draggable?: boolean;\r\n  /** Whether this widget can be resized (when `editable` is true) */\r\n  resizable?: boolean;\r\n\r\n  minDx?: number;\r\n  minDy?: number;\r\n\r\n  /** Optional custom class for the widget panel */\r\n  className?: string;\r\n  /** Optional inline styles for the widget panel */\r\n  style?: React.CSSProperties;\r\n}\r\n\r\nexport interface AvakioDashboardLayoutItem {\r\n  id: string;\r\n  x: number;\r\n  y: number;\r\n  dx: number;\r\n  dy: number;\r\n}\r\n\r\nexport interface AvakioDashboardProps {\r\n  id?: string;\r\n  testId?: string;\r\n\r\n  /** Number of columns in the dashboard grid */\r\n  gridColumns?: number;\r\n  /** Number of rows in the dashboard grid */\r\n  gridRows?: number;\r\n\r\n  /** Fixed cell width in px (optional; auto-calculated if not set) */\r\n  cellWidth?: number;\r\n  /** Fixed cell height in px (optional; auto-calculated if not set) */\r\n  cellHeight?: number;\r\n\r\n  /** Margin (gap) between cells in px */\r\n  cellMargin?: number;\r\n\r\n  /** Outer margin around the dashboard container */\r\n  margin?: number;\r\n\r\n  /** Padding around the dashboard content */\r\n  padding?: number | [number, number, number, number];\r\n  paddingX?: number;\r\n  paddingY?: number;\r\n\r\n  width?: number | string;\r\n  height?: number | string;\r\n\r\n  theme?: AvakioDashboardTheme;\r\n\r\n  /** Widgets to render */\r\n  widgets: AvakioDashboardWidget[];\r\n\r\n  /** When true, enables drag and resize interactions */\r\n  editable?: boolean;\r\n\r\n  /** Drag handle behavior */\r\n  dragHandle?: 'any' | 'header';\r\n\r\n  className?: string;\r\n  style?: React.CSSProperties;\r\n\r\n  onChange?: (widgets: AvakioDashboardWidget[]) => void;\r\n  onWidgetClick?: (widget: AvakioDashboardWidget) => void;\r\n  onDragStart?: (widget: AvakioDashboardWidget) => void;\r\n  onDragEnd?: (widget: AvakioDashboardWidget, newPosition: { x: number; y: number }) => void;\r\n  onResizeStart?: (widget: AvakioDashboardWidget) => void;\r\n  onResizeEnd?: (widget: AvakioDashboardWidget, newSize: { dx: number; dy: number }) => void;\r\n}\r\n\r\nexport interface AvakioDashboardRef {\r\n  addWidget: (widget: AvakioDashboardWidget, index?: number) => void;\r\n  removeWidget: (id: string) => void;\r\n  moveWidget: (id: string, position: { x?: number; y?: number; dx?: number; dy?: number }) => void;\r\n  getWidgets: () => AvakioDashboardWidget[];\r\n  getWidget: (id: string) => AvakioDashboardWidget | undefined;\r\n  serialize: () => AvakioDashboardLayoutItem[];\r\n  restore: (layout: AvakioDashboardLayoutItem[]) => void;\r\n}\r\n\r\ntype ResizeState = {\r\n  widgetId: string;\r\n  startClientX: number;\r\n  startClientY: number;\r\n  startDx: number;\r\n  startDy: number;\r\n};\r\n\r\nfunction asBoxPadding(padding: number | [number, number, number, number] | undefined): [number, number, number, number] {\r\n  if (Array.isArray(padding)) return padding;\r\n  if (typeof padding === 'number') return [padding, padding, padding, padding];\r\n  return [0, 0, 0, 0];\r\n}\r\n\r\nfunction intersects(a: { x: number; y: number; dx: number; dy: number }, b: { x: number; y: number; dx: number; dy: number }): boolean {\r\n  return a.x < b.x + b.dx && a.x + a.dx > b.x && a.y < b.y + b.dy && a.y + a.dy > b.y;\r\n}\r\n\r\nexport const AvakioDashboard = forwardRef<AvakioDashboardRef, AvakioDashboardProps>(\r\n  (\r\n    {\r\n      id,\r\n      testId,\r\n      gridColumns = 2,\r\n      gridRows = 2,\r\n      cellWidth,\r\n      cellHeight,\r\n      cellMargin = 10,\r\n      margin,\r\n      padding = 10,\r\n      paddingX,\r\n      paddingY,\r\n      width,\r\n      height,\r\n      theme = 'material',\r\n      widgets: widgetsProp,\r\n      editable = true,\r\n      dragHandle = 'any',\r\n      className = '',\r\n      style,\r\n      onChange,\r\n      onWidgetClick,\r\n      onDragStart,\r\n      onDragEnd,\r\n      onResizeStart,\r\n      onResizeEnd,\r\n    },\r\n    ref\r\n  ) => {\r\n    const gridRef = useRef<AvakioGridRef>(null);\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n\r\n    const [widgets, setWidgets] = useState<AvakioDashboardWidget[]>(widgetsProp);\r\n    const widgetsRef = useRef<AvakioDashboardWidget[]>(widgetsProp);\r\n\r\n    // Resize measuring (for dx/dy updates during interactive resize)\r\n    const [containerSize, setContainerSize] = useState({ width: 0, height: 0 });\r\n    const resizeStateRef = useRef<ResizeState | null>(null);\r\n\r\n    // Keep in sync with prop\r\n    useEffect(() => {\r\n      setWidgets(widgetsProp);\r\n    }, [widgetsProp]);\r\n\r\n    useEffect(() => {\r\n      widgetsRef.current = widgets;\r\n    }, [widgets]);\r\n\r\n    // Observe container size\r\n    useEffect(() => {\r\n      const el = containerRef.current;\r\n      if (!el) return;\r\n\r\n      const update = () => {\r\n        setContainerSize({ width: el.clientWidth, height: el.clientHeight });\r\n      };\r\n      update();\r\n\r\n      let rafId: number | null = null;\r\n      const ro = new ResizeObserver(() => {\r\n        if (rafId !== null) return;\r\n        rafId = requestAnimationFrame(() => {\r\n          rafId = null;\r\n          update();\r\n        });\r\n      });\r\n\r\n      ro.observe(el);\r\n      return () => {\r\n        ro.disconnect();\r\n        if (rafId !== null) cancelAnimationFrame(rafId);\r\n      };\r\n    }, []);\r\n\r\n    const resolvedUnitWidth = useMemo(() => {\r\n      if (cellWidth) return cellWidth;\r\n      const base = asBoxPadding(padding);\r\n      const px = paddingX !== undefined ? paddingX : base[1];\r\n      const availableWidth = containerSize.width - px * 2 - cellMargin * (gridColumns - 1);\r\n      return Math.max(50, availableWidth / Math.max(1, gridColumns));\r\n    }, [cellWidth, containerSize.width, padding, paddingX, cellMargin, gridColumns]);\r\n\r\n    const resolvedUnitHeight = useMemo(() => {\r\n      if (cellHeight) return cellHeight;\r\n      const base = asBoxPadding(padding);\r\n      const py = paddingY !== undefined ? paddingY : base[0];\r\n      const availableHeight = containerSize.height - py * 2 - cellMargin * (gridRows - 1);\r\n      return Math.max(50, availableHeight / Math.max(1, gridRows));\r\n    }, [cellHeight, containerSize.height, padding, paddingY, cellMargin, gridRows]);\r\n\r\n    const updateWidgets = useCallback(\r\n      (\r\n        nextOrUpdater:\r\n          | AvakioDashboardWidget[]\r\n          | ((prev: AvakioDashboardWidget[]) => AvakioDashboardWidget[])\r\n      ) => {\r\n        setWidgets((prev) => {\r\n          const next = typeof nextOrUpdater === 'function' ? nextOrUpdater(prev) : nextOrUpdater;\r\n          onChange?.(next);\r\n          return next;\r\n        });\r\n      },\r\n      [onChange]\r\n    );\r\n\r\n    const getWidgetById = useCallback(\r\n      (wid: string) => widgetsRef.current.find((w) => w.id === wid),\r\n      []\r\n    );\r\n\r\n    const canPlaceRect = useCallback(\r\n      (rect: { id?: string; x: number; y: number; dx: number; dy: number }) => {\r\n        if (rect.x < 0 || rect.y < 0) return false;\r\n        if (rect.x + rect.dx > gridColumns) return false;\r\n        if (rect.y + rect.dy > gridRows) return false;\r\n\r\n        for (const w of widgetsRef.current) {\r\n          if (rect.id && w.id === rect.id) continue;\r\n          const other = { x: w.x, y: w.y, dx: w.dx ?? 1, dy: w.dy ?? 1 };\r\n          if (intersects({ x: rect.x, y: rect.y, dx: rect.dx, dy: rect.dy }, other)) return false;\r\n        }\r\n        return true;\r\n      },\r\n      [gridColumns, gridRows]\r\n    );\r\n\r\n    const findFirstFreeSpot = useCallback(\r\n      (dx: number, dy: number) => {\r\n        for (let y = 0; y <= gridRows - dy; y++) {\r\n          for (let x = 0; x <= gridColumns - dx; x++) {\r\n            if (canPlaceRect({ x, y, dx, dy })) {\r\n              return { x, y };\r\n            }\r\n          }\r\n        }\r\n        return null;\r\n      },\r\n      [gridRows, gridColumns, canPlaceRect]\r\n    );\r\n\r\n    useImperativeHandle(\r\n      ref,\r\n      () => ({\r\n        addWidget: (widget, index) => {\r\n          const dx = widget.dx ?? 1;\r\n          const dy = widget.dy ?? 1;\r\n          const spot = findFirstFreeSpot(dx, dy);\r\n          const placed = spot ? { ...widget, x: spot.x, y: spot.y, dx, dy } : { ...widget, dx, dy };\r\n\r\n          updateWidgets((prev) => {\r\n            const next = [...prev];\r\n            if (typeof index === 'number') next.splice(index, 0, placed);\r\n            else next.push(placed);\r\n            return next;\r\n          });\r\n        },\r\n        removeWidget: (wid) => {\r\n          updateWidgets((prev) => prev.filter((w) => w.id !== wid));\r\n        },\r\n        moveWidget: (wid, position) => {\r\n          const current = getWidgetById(wid);\r\n          if (!current) return;\r\n\r\n          const nextRect = {\r\n            id: wid,\r\n            x: position.x ?? current.x,\r\n            y: position.y ?? current.y,\r\n            dx: position.dx ?? (current.dx ?? 1),\r\n            dy: position.dy ?? (current.dy ?? 1),\r\n          };\r\n\r\n          if (!canPlaceRect(nextRect)) return;\r\n\r\n          updateWidgets((prev) => prev.map((w) => (w.id === wid ? { ...w, ...position } : w)));\r\n        },\r\n        getWidgets: () => [...widgetsRef.current],\r\n        getWidget: (wid) => widgetsRef.current.find((w) => w.id === wid),\r\n        serialize: () =>\r\n          widgetsRef.current.map((w) => ({\r\n            id: w.id,\r\n            x: w.x,\r\n            y: w.y,\r\n            dx: w.dx ?? 1,\r\n            dy: w.dy ?? 1,\r\n          })),\r\n        restore: (layout) => {\r\n          const byId = new Map(layout.map((l) => [l.id, l] as const));\r\n          updateWidgets((prev) =>\r\n            prev.map((w) => {\r\n              const l = byId.get(w.id);\r\n              if (!l) return w;\r\n              return { ...w, x: l.x, y: l.y, dx: l.dx, dy: l.dy };\r\n            })\r\n          );\r\n        },\r\n      }),\r\n      [updateWidgets, getWidgetById, canPlaceRect, findFirstFreeSpot]\r\n    );\r\n\r\n    const handleGridChange = useCallback(\r\n      (cells: AvakioGridCell[]) => {\r\n        updateWidgets((prev) =>\r\n          prev.map((w) => {\r\n            const c = cells.find((x) => x.id === w.id);\r\n            if (!c) return w;\r\n            return { ...w, x: c.x, y: c.y, dx: c.dx ?? 1, dy: c.dy ?? 1 };\r\n          })\r\n        );\r\n      },\r\n      [updateWidgets]\r\n    );\r\n\r\n    const handleDragStartInternal = useCallback(\r\n      (cell: AvakioGridCell) => {\r\n        const w = getWidgetById(cell.id);\r\n        if (w) onDragStart?.(w);\r\n      },\r\n      [getWidgetById, onDragStart]\r\n    );\r\n\r\n    const handleDragEndInternal = useCallback(\r\n      (cell: AvakioGridCell, pos: { x: number; y: number }) => {\r\n        const w = getWidgetById(cell.id);\r\n        if (w) onDragEnd?.({ ...w, x: pos.x, y: pos.y }, pos);\r\n      },\r\n      [getWidgetById, onDragEnd]\r\n    );\r\n\r\n    const beginResize = useCallback(\r\n      (e: React.PointerEvent, widgetId: string) => {\r\n        if (!editable) return;\r\n\r\n        const w = getWidgetById(widgetId);\r\n        if (!w || w.resizable !== true) return;\r\n\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n\r\n        resizeStateRef.current = {\r\n          widgetId,\r\n          startClientX: e.clientX,\r\n          startClientY: e.clientY,\r\n          startDx: w.dx ?? 1,\r\n          startDy: w.dy ?? 1,\r\n        };\r\n\r\n        onResizeStart?.(w);\r\n\r\n        (e.currentTarget as HTMLElement).setPointerCapture?.(e.pointerId);\r\n      },\r\n      [editable, getWidgetById, onResizeStart]\r\n    );\r\n\r\n    const handlePointerMove = useCallback(\r\n      (e: React.PointerEvent) => {\r\n        const state = resizeStateRef.current;\r\n        if (!state) return;\r\n\r\n        const w = getWidgetById(state.widgetId);\r\n        if (!w) return;\r\n\r\n        const unitW = resolvedUnitWidth + cellMargin;\r\n        const unitH = resolvedUnitHeight + cellMargin;\r\n\r\n        const deltaX = e.clientX - state.startClientX;\r\n        const deltaY = e.clientY - state.startClientY;\r\n\r\n        const minDx = Math.max(1, w.minDx ?? 1);\r\n        const minDy = Math.max(1, w.minDy ?? 1);\r\n\r\n        const maxDx = Math.max(1, gridColumns - w.x);\r\n        const maxDy = Math.max(1, gridRows - w.y);\r\n\r\n        const nextDx = Math.max(minDx, Math.min(maxDx, state.startDx + Math.round(deltaX / unitW)));\r\n        const nextDy = Math.max(minDy, Math.min(maxDy, state.startDy + Math.round(deltaY / unitH)));\r\n\r\n        const rect = { id: w.id, x: w.x, y: w.y, dx: nextDx, dy: nextDy };\r\n        if (!canPlaceRect(rect)) return;\r\n\r\n        if ((w.dx ?? 1) === nextDx && (w.dy ?? 1) === nextDy) return;\r\n\r\n        updateWidgets((prev) => prev.map((x) => (x.id === w.id ? { ...x, dx: nextDx, dy: nextDy } : x)));\r\n      },\r\n      [getWidgetById, resolvedUnitWidth, resolvedUnitHeight, cellMargin, gridColumns, gridRows, canPlaceRect, updateWidgets]\r\n    );\r\n\r\n    const handlePointerUp = useCallback(\r\n      () => {\r\n        const state = resizeStateRef.current;\r\n        if (!state) return;\r\n\r\n        const w = getWidgetById(state.widgetId);\r\n        if (w) {\r\n          onResizeEnd?.(w, { dx: w.dx ?? 1, dy: w.dy ?? 1 });\r\n        }\r\n\r\n        resizeStateRef.current = null;\r\n      },\r\n      [getWidgetById, onResizeEnd]\r\n    );\r\n\r\n    const gridCells: AvakioGridCell[] = useMemo(() => {\r\n      return widgets.map((w) => {\r\n        const dx = w.dx ?? 1;\r\n        const dy = w.dy ?? 1;\r\n\r\n        const header = w.header ?? null;\r\n        const hasHeader = header !== null && header !== undefined;\r\n\r\n        const stopBodyDrag = dragHandle === 'header' && editable;\r\n\r\n        return {\r\n          id: w.id,\r\n          x: w.x,\r\n          y: w.y,\r\n          dx,\r\n          dy,\r\n          draggable: w.draggable !== false,\r\n          content: (\r\n            <div\r\n              className={[\r\n                'avakio-dashboard__panel',\r\n                hasHeader ? 'avakio-dashboard__panel--with-header' : 'avakio-dashboard__panel--no-header',\r\n                editable ? 'avakio-dashboard__panel--editable' : 'avakio-dashboard__panel--readonly',\r\n                w.className,\r\n              ]\r\n                .filter(Boolean)\r\n                .join(' ')}\r\n              style={w.style}\r\n              data-widget-id={w.id}\r\n            >\r\n              {hasHeader && (\r\n                <div className=\"avakio-dashboard__panel-header\">\r\n                  {w.icon && <span className=\"avakio-dashboard__panel-icon\">{w.icon}</span>}\r\n                  <div className=\"avakio-dashboard__panel-title\">{header}</div>\r\n                </div>\r\n              )}\r\n\r\n              <div\r\n                className=\"avakio-dashboard__panel-body\"\r\n                onMouseDown={stopBodyDrag ? (e) => e.stopPropagation() : undefined}\r\n                onTouchStart={stopBodyDrag ? (e) => e.stopPropagation() : undefined}\r\n              >\r\n                {w.body}\r\n              </div>\r\n\r\n              {editable && w.resizable === true && (\r\n                <div\r\n                  className=\"avakio-dashboard__resize-handle\"\r\n                  onPointerDown={(e) => beginResize(e, w.id)}\r\n                  onMouseDown={(e) => e.stopPropagation()}\r\n                  onTouchStart={(e) => e.stopPropagation()}\r\n                />\r\n              )}\r\n            </div>\r\n          ),\r\n        };\r\n      });\r\n    }, [widgets, dragHandle, editable, beginResize]);\r\n\r\n    const containerStyle: CSSProperties = {\r\n      width,\r\n      height,\r\n      ...(style && typeof style === 'object' && !Array.isArray(style) ? style : {}),\r\n    };\r\n\r\n    return (\r\n      <div\r\n        ref={containerRef}\r\n        id={id}\r\n        data-testid={testId}\r\n        className={['avakio-dashboard', `avakio-dashboard--${theme}`, className].filter(Boolean).join(' ')}\r\n        data-admin-theme={theme}\r\n        style={containerStyle}\r\n        onPointerMove={handlePointerMove}\r\n        onPointerUp={handlePointerUp}\r\n        onPointerCancel={handlePointerUp}\r\n      >\r\n        <AvakioGrid\r\n          ref={gridRef}\r\n          id={id ? `${id}__grid` : undefined}\r\n          testId={testId ? `${testId}__grid` : undefined}\r\n          gridColumns={gridColumns}\r\n          gridRows={gridRows}\r\n          cellWidth={cellWidth}\r\n          cellHeight={cellHeight}\r\n          cellMargin={cellMargin}\r\n          margin={margin}\r\n          padding={padding}\r\n          paddingX={paddingX}\r\n          paddingY={paddingY}\r\n          width={'100%'}\r\n          height={'100%'}\r\n          theme={theme}\r\n          borderless\r\n          cellBorderless\r\n          isDraggable={editable}\r\n          cells={gridCells}\r\n          onChange={handleGridChange}\r\n          onCellClick={(cell) => {\r\n            const w = getWidgetById(cell.id);\r\n            if (w) onWidgetClick?.(w);\r\n          }}\r\n          onDragStart={handleDragStartInternal}\r\n          onDragEnd={handleDragEndInternal}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nAvakioDashboard.displayName = 'AvakioDashboard';\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useState, useEffect, useCallback, forwardRef, useImperativeHandle, useRef } from 'react';\r\nimport './avakio-excel-viewer.css';\r\n\r\nexport type AvakioExcelViewerTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\n\r\n/**\r\n * Column configuration for Excel Viewer\r\n */\r\nexport interface AvakioExcelViewerColumn {\r\n  /** Unique column ID */\r\n  id: string;\r\n  /** Column header text */\r\n  header?: string;\r\n  /** Column width in pixels */\r\n  width?: number;\r\n  /** Minimum column width */\r\n  minWidth?: number;\r\n  /** Maximum column width */\r\n  maxWidth?: number;\r\n  /** CSS class for the column */\r\n  css?: string;\r\n  /** Custom cell renderer */\r\n  template?: (row: any, col: AvakioExcelViewerColumn) => React.ReactNode;\r\n  /** Whether the column is editable */\r\n  editable?: boolean;\r\n  /** Cell editor type */\r\n  editor?: 'text' | 'number' | 'select' | 'date';\r\n  /** Options for select editor */\r\n  options?: { id: string | number; value: string }[];\r\n  /** Text alignment */\r\n  align?: 'left' | 'center' | 'right';\r\n  /** Column sort function or boolean */\r\n  sort?: boolean | 'string' | 'number' | 'date' | ((a: any, b: any) => number);\r\n  /** Whether the column is hidden */\r\n  hidden?: boolean;\r\n}\r\n\r\n/**\r\n * Sheet configuration for Excel Viewer\r\n */\r\nexport interface AvakioExcelViewerSheet {\r\n  /** Sheet name */\r\n  name: string;\r\n  /** Sheet data rows */\r\n  data: Record<string, any>[];\r\n  /** Optional column configuration (auto-generated from data if not provided) */\r\n  columns?: AvakioExcelViewerColumn[];\r\n}\r\n\r\n/**\r\n * Cell span configuration\r\n */\r\nexport interface AvakioExcelViewerSpan {\r\n  /** Row index (0-based) */\r\n  row: number;\r\n  /** Column ID */\r\n  column: string;\r\n  /** Number of rows to span */\r\n  rowspan?: number;\r\n  /** Number of columns to span */\r\n  colspan?: number;\r\n  /** Custom CSS class for the spanned cell */\r\n  css?: string;\r\n}\r\n\r\n/**\r\n * Selection area configuration\r\n */\r\nexport interface AvakioExcelViewerSelection {\r\n  /** Start row index */\r\n  row: number;\r\n  /** Start column index */\r\n  column: number;\r\n  /** End row index (for range selection) */\r\n  endRow?: number;\r\n  /** End column index (for range selection) */\r\n  endColumn?: number;\r\n}\r\n\r\nexport interface AvakioExcelViewerProps {\r\n  /** Unique identifier */\r\n  id?: string;\r\n  /** Test ID for testing */\r\n  testId?: string;\r\n  /** Theme to apply */\r\n  theme?: AvakioExcelViewerTheme;\r\n  /** Array of sheets */\r\n  sheets?: AvakioExcelViewerSheet[];\r\n  /** Single sheet data (for simple use cases) */\r\n  data?: Record<string, any>[];\r\n  /** Column configuration (for single sheet mode) */\r\n  columns?: AvakioExcelViewerColumn[];\r\n  /** Whether to use first row as header */\r\n  excelHeader?: boolean;\r\n  /** Whether to show the toolbar with sheet tabs */\r\n  toolbar?: boolean;\r\n  /** Default column width */\r\n  columnWidth?: number;\r\n  /** Default row height */\r\n  rowHeight?: number;\r\n  /** Header row height */\r\n  headerRowHeight?: number;\r\n  /** Whether to show row numbers */\r\n  showRowNumbers?: boolean;\r\n  /** Whether to enable column resizing */\r\n  resizeColumn?: boolean;\r\n  /** Whether to enable row resizing */\r\n  resizeRow?: boolean;\r\n  /** Whether to enable editing */\r\n  editable?: boolean;\r\n  /** Edit action: 'click' or 'dblclick' */\r\n  editAction?: 'click' | 'dblclick';\r\n  /** Whether to enable cell selection */\r\n  select?: boolean | 'cell' | 'row' | 'column' | 'area';\r\n  /** Whether to enable multi-selection */\r\n  multiselect?: boolean;\r\n  /** Whether to enable block/area selection */\r\n  blockselect?: boolean;\r\n  /** Whether to show grid lines */\r\n  gridLines?: boolean;\r\n  /** Whether to enable keyboard navigation */\r\n  navigation?: boolean;\r\n  /** Whether to freeze header row */\r\n  freezeHeader?: boolean;\r\n  /** Number of columns frozen to left */\r\n  leftSplit?: number;\r\n  /** Number of rows frozen to top */\r\n  topSplit?: number;\r\n  /** Whether the component is disabled */\r\n  disabled?: boolean;\r\n  /** Whether to auto-size columns to fit content */\r\n  autowidth?: boolean;\r\n  /** Whether to auto-size height to fit content */\r\n  autoheight?: boolean;\r\n  /** Maximum visible rows */\r\n  yCount?: number;\r\n  /** Custom CSS class */\r\n  css?: string;\r\n  /** Cell spans configuration */\r\n  spans?: AvakioExcelViewerSpan[];\r\n  /** Callback when cell is clicked */\r\n  onCellClick?: (row: Record<string, any>, column: AvakioExcelViewerColumn, rowIndex: number, colIndex: number) => void;\r\n  /** Callback when cell is double-clicked */\r\n  onCellDoubleClick?: (row: Record<string, any>, column: AvakioExcelViewerColumn, rowIndex: number, colIndex: number) => void;\r\n  /** Callback when cell value changes */\r\n  onCellChange?: (row: Record<string, any>, column: AvakioExcelViewerColumn, oldValue: any, newValue: any, rowIndex: number) => void;\r\n  /** Callback when selection changes */\r\n  onSelectionChange?: (selection: AvakioExcelViewerSelection | null) => void;\r\n  /** Callback when sheet changes */\r\n  onSheetChange?: (sheetName: string, sheetIndex: number) => void;\r\n  /** Callback when column is resized */\r\n  onColumnResize?: (column: AvakioExcelViewerColumn, newWidth: number) => void;\r\n  /** Callback when row is resized */\r\n  onRowResize?: (rowIndex: number, newHeight: number) => void;\r\n  /** Callback when data is sorted */\r\n  onSort?: (column: AvakioExcelViewerColumn, direction: 'asc' | 'desc') => void;\r\n  /** Callback when data is loaded */\r\n  onDataLoad?: (data: Record<string, any>[]) => void;\r\n}\r\n\r\nexport interface AvakioExcelViewerRef {\r\n  /** Get all sheet names */\r\n  getSheets: () => string[];\r\n  /** Switch to a specific sheet */\r\n  showSheet: (name: string) => void;\r\n  /** Get current sheet name */\r\n  getCurrentSheet: () => string;\r\n  /** Get data from current sheet */\r\n  getData: () => Record<string, any>[];\r\n  /** Set data for current sheet */\r\n  setData: (data: Record<string, any>[]) => void;\r\n  /** Get column configuration */\r\n  getColumns: () => AvakioExcelViewerColumn[];\r\n  /** Set column configuration */\r\n  setColumns: (columns: AvakioExcelViewerColumn[]) => void;\r\n  /** Get selected cells */\r\n  getSelectedId: () => AvakioExcelViewerSelection | null;\r\n  /** Select a cell or range */\r\n  select: (row: number, column: number, endRow?: number, endColumn?: number) => void;\r\n  /** Clear selection */\r\n  clearSelection: () => void;\r\n  /** Get cell value */\r\n  getCellValue: (rowIndex: number, columnId: string) => any;\r\n  /** Set cell value */\r\n  setCellValue: (rowIndex: number, columnId: string, value: any) => void;\r\n  /** Add a row */\r\n  addRow: (row: Record<string, any>, index?: number) => void;\r\n  /** Remove a row */\r\n  removeRow: (index: number) => void;\r\n  /** Refresh the view */\r\n  refresh: () => void;\r\n  /** Get row by index */\r\n  getItem: (index: number) => Record<string, any> | undefined;\r\n  /** Get total row count */\r\n  count: () => number;\r\n  /** Scroll to a specific cell */\r\n  showCell: (rowIndex: number, columnId: string) => void;\r\n  /** Hide a column */\r\n  hideColumn: (columnId: string) => void;\r\n  /** Show a hidden column */\r\n  showColumn: (columnId: string) => void;\r\n  /** Check if column is visible */\r\n  isColumnVisible: (columnId: string) => boolean;\r\n  /** Sort data */\r\n  sort: (columnId: string, direction?: 'asc' | 'desc') => void;\r\n  /** Filter data */\r\n  filter: (columnId: string, value: any, compare?: (cellValue: any, filterValue: any) => boolean) => void;\r\n  /** Clear all filters */\r\n  clearFilter: () => void;\r\n}\r\n\r\n// Helper to generate column letter (A, B, C, ..., Z, AA, AB, ...)\r\nconst getColumnLetter = (index: number): string => {\r\n  let letter = '';\r\n  let tempIndex = index;\r\n  while (tempIndex >= 0) {\r\n    letter = String.fromCharCode((tempIndex % 26) + 65) + letter;\r\n    tempIndex = Math.floor(tempIndex / 26) - 1;\r\n  }\r\n  return letter;\r\n};\r\n\r\n// Helper to auto-generate columns from data\r\nconst generateColumnsFromData = (data: Record<string, any>[], excelHeader?: boolean): AvakioExcelViewerColumn[] => {\r\n  if (!data || data.length === 0) return [];\r\n  \r\n  const firstRow = data[0];\r\n  const keys = Object.keys(firstRow);\r\n  \r\n  return keys.map((key, index) => ({\r\n    id: key,\r\n    header: excelHeader ? String(firstRow[key] || getColumnLetter(index)) : key,\r\n    width: 100,\r\n  }));\r\n};\r\n\r\nexport const AvakioExcelViewer = forwardRef<AvakioExcelViewerRef, AvakioExcelViewerProps>((props, ref) => {\r\n  const {\r\n    id,\r\n    testId,\r\n    theme = 'material',\r\n    sheets: initialSheets,\r\n    data: initialData,\r\n    columns: initialColumns,\r\n    excelHeader = false,\r\n    toolbar = true,\r\n    columnWidth = 100,\r\n    rowHeight = 32,\r\n    headerRowHeight = 36,\r\n    showRowNumbers = true,\r\n    resizeColumn = true,\r\n    resizeRow = false,\r\n    editable = false,\r\n    editAction = 'dblclick',\r\n    select = 'cell',\r\n    multiselect = false,\r\n    blockselect = false,\r\n    gridLines = true,\r\n    navigation = true,\r\n    freezeHeader = true,\r\n    leftSplit = 0,\r\n    topSplit = 0,\r\n    disabled = false,\r\n    autowidth = false,\r\n    autoheight = false,\r\n    yCount,\r\n    css,\r\n    spans = [],\r\n    onCellClick,\r\n    onCellDoubleClick,\r\n    onCellChange,\r\n    onSelectionChange,\r\n    onSheetChange,\r\n    onColumnResize,\r\n    onRowResize,\r\n    onSort,\r\n    onDataLoad,\r\n  } = props;\r\n\r\n  // State\r\n  const [sheets, setSheets] = useState<AvakioExcelViewerSheet[]>(() => {\r\n    if (initialSheets && initialSheets.length > 0) {\r\n      return initialSheets;\r\n    }\r\n    if (initialData) {\r\n      const cols = initialColumns || generateColumnsFromData(initialData, excelHeader);\r\n      return [{ name: 'Sheet1', data: excelHeader ? initialData.slice(1) : initialData, columns: cols }];\r\n    }\r\n    return [{ name: 'Sheet1', data: [], columns: [] }];\r\n  });\r\n  \r\n  const [activeSheet, setActiveSheet] = useState(0);\r\n  const [columns, setColumns] = useState<AvakioExcelViewerColumn[]>(() => {\r\n    const sheet = sheets[0];\r\n    return sheet?.columns || generateColumnsFromData(sheet?.data || [], excelHeader);\r\n  });\r\n  const [data, setData] = useState<Record<string, any>[]>(() => sheets[0]?.data || []);\r\n  const [selection, setSelection] = useState<AvakioExcelViewerSelection | null>(null);\r\n  const [editingCell, setEditingCell] = useState<{ row: number; col: number } | null>(null);\r\n  const [editValue, setEditValue] = useState<string>('');\r\n  const [sortConfig, setSortConfig] = useState<{ columnId: string; direction: 'asc' | 'desc' } | null>(null);\r\n  const [columnWidths, setColumnWidths] = useState<Record<string, number>>({});\r\n  const [rowHeights, setRowHeights] = useState<Record<number, number>>({});\r\n  const [hiddenColumns, setHiddenColumns] = useState<Set<string>>(new Set());\r\n  const [filterConfig, setFilterConfig] = useState<{ columnId: string; value: any; compare?: (cellValue: any, filterValue: any) => boolean } | null>(null);\r\n  \r\n  // Refs\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n  const tableRef = useRef<HTMLTableElement>(null);\r\n  const resizeRef = useRef<{ columnId: string; startX: number; startWidth: number } | null>(null);\r\n  const selectionStartRef = useRef<{ row: number; col: number } | null>(null);\r\n  \r\n  // Update sheets when props change\r\n  useEffect(() => {\r\n    if (initialSheets && initialSheets.length > 0) {\r\n      setSheets(initialSheets);\r\n      const sheet = initialSheets[activeSheet] || initialSheets[0];\r\n      setData(sheet.data);\r\n      setColumns(sheet.columns || generateColumnsFromData(sheet.data, excelHeader));\r\n    }\r\n  }, [initialSheets, activeSheet, excelHeader]);\r\n  \r\n  useEffect(() => {\r\n    if (initialData && !initialSheets) {\r\n      const cols = initialColumns || generateColumnsFromData(initialData, excelHeader);\r\n      const processedData = excelHeader ? initialData.slice(1) : initialData;\r\n      setSheets([{ name: 'Sheet1', data: processedData, columns: cols }]);\r\n      setData(processedData);\r\n      setColumns(cols);\r\n    }\r\n  }, [initialData, initialColumns, initialSheets, excelHeader]);\r\n\r\n  // Get visible columns\r\n  const visibleColumns = columns.filter(col => !col.hidden && !hiddenColumns.has(col.id));\r\n  \r\n  // Get filtered and sorted data\r\n  const processedData = React.useMemo(() => {\r\n    let result = [...data];\r\n    \r\n    // Apply filter\r\n    if (filterConfig) {\r\n      const { columnId, value, compare } = filterConfig;\r\n      result = result.filter(row => {\r\n        const cellValue = row[columnId];\r\n        if (compare) {\r\n          return compare(cellValue, value);\r\n        }\r\n        if (value === '' || value === null || value === undefined) return true;\r\n        return String(cellValue).toLowerCase().includes(String(value).toLowerCase());\r\n      });\r\n    }\r\n    \r\n    // Apply sort\r\n    if (sortConfig) {\r\n      const { columnId, direction } = sortConfig;\r\n      const column = columns.find(c => c.id === columnId);\r\n      \r\n      result.sort((a, b) => {\r\n        const aVal = a[columnId];\r\n        const bVal = b[columnId];\r\n        \r\n        let comparison = 0;\r\n        \r\n        if (typeof column?.sort === 'function') {\r\n          comparison = column.sort(aVal, bVal);\r\n        } else if (column?.sort === 'number') {\r\n          comparison = (Number(aVal) || 0) - (Number(bVal) || 0);\r\n        } else if (column?.sort === 'date') {\r\n          comparison = new Date(aVal).getTime() - new Date(bVal).getTime();\r\n        } else {\r\n          comparison = String(aVal || '').localeCompare(String(bVal || ''));\r\n        }\r\n        \r\n        return direction === 'desc' ? -comparison : comparison;\r\n      });\r\n    }\r\n    \r\n    return result;\r\n  }, [data, filterConfig, sortConfig, columns]);\r\n\r\n  // Handle sheet change\r\n  const handleSheetChange = useCallback((index: number) => {\r\n    if (index >= 0 && index < sheets.length) {\r\n      setActiveSheet(index);\r\n      const sheet = sheets[index];\r\n      setData(sheet.data);\r\n      setColumns(sheet.columns || generateColumnsFromData(sheet.data, excelHeader));\r\n      setSelection(null);\r\n      setEditingCell(null);\r\n      setSortConfig(null);\r\n      setFilterConfig(null);\r\n      onSheetChange?.(sheet.name, index);\r\n    }\r\n  }, [sheets, excelHeader, onSheetChange]);\r\n\r\n  // Handle cell click\r\n  const handleCellClick = useCallback((rowIndex: number, colIndex: number, e: React.MouseEvent) => {\r\n    if (disabled) return;\r\n    \r\n    const column = visibleColumns[colIndex];\r\n    const row = processedData[rowIndex];\r\n    \r\n    if (select) {\r\n      if (blockselect && e.shiftKey && selection) {\r\n        // Extend selection\r\n        setSelection({\r\n          ...selection,\r\n          endRow: rowIndex,\r\n          endColumn: colIndex,\r\n        });\r\n      } else {\r\n        setSelection({ row: rowIndex, column: colIndex });\r\n        selectionStartRef.current = { row: rowIndex, col: colIndex };\r\n      }\r\n      onSelectionChange?.({ row: rowIndex, column: colIndex });\r\n    }\r\n    \r\n    if (editable && editAction === 'click' && column?.editable !== false) {\r\n      setEditingCell({ row: rowIndex, col: colIndex });\r\n      setEditValue(String(row?.[column?.id] || ''));\r\n    }\r\n    \r\n    onCellClick?.(row, column, rowIndex, colIndex);\r\n  }, [disabled, select, blockselect, selection, editable, editAction, visibleColumns, processedData, onSelectionChange, onCellClick]);\r\n\r\n  // Handle cell double click\r\n  const handleCellDoubleClick = useCallback((rowIndex: number, colIndex: number) => {\r\n    if (disabled) return;\r\n    \r\n    const column = visibleColumns[colIndex];\r\n    const row = processedData[rowIndex];\r\n    \r\n    if (editable && editAction === 'dblclick' && column?.editable !== false) {\r\n      setEditingCell({ row: rowIndex, col: colIndex });\r\n      setEditValue(String(row?.[column?.id] || ''));\r\n    }\r\n    \r\n    onCellDoubleClick?.(row, column, rowIndex, colIndex);\r\n  }, [disabled, editable, editAction, visibleColumns, processedData, onCellDoubleClick]);\r\n\r\n  // Handle edit complete\r\n  const handleEditComplete = useCallback(() => {\r\n    if (!editingCell) return;\r\n    \r\n    const { row: rowIndex, col: colIndex } = editingCell;\r\n    const column = visibleColumns[colIndex];\r\n    const row = processedData[rowIndex];\r\n    const oldValue = row?.[column?.id];\r\n    \r\n    if (editValue !== String(oldValue || '')) {\r\n      const newData = [...data];\r\n      const originalIndex = data.indexOf(row);\r\n      if (originalIndex >= 0) {\r\n        newData[originalIndex] = { ...newData[originalIndex], [column.id]: editValue };\r\n        setData(newData);\r\n        onCellChange?.(row, column, oldValue, editValue, originalIndex);\r\n      }\r\n    }\r\n    \r\n    setEditingCell(null);\r\n    setEditValue('');\r\n  }, [editingCell, editValue, visibleColumns, processedData, data, onCellChange]);\r\n\r\n  // Handle column resize\r\n  const handleColumnResizeStart = useCallback((columnId: string, e: React.MouseEvent) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    \r\n    const column = columns.find(c => c.id === columnId);\r\n    const currentWidth = columnWidths[columnId] || column?.width || columnWidth;\r\n    \r\n    resizeRef.current = { columnId, startX: e.clientX, startWidth: currentWidth };\r\n    \r\n    const handleMouseMove = (moveEvent: MouseEvent) => {\r\n      if (!resizeRef.current) return;\r\n      \r\n      const diff = moveEvent.clientX - resizeRef.current.startX;\r\n      const newWidth = Math.max(50, resizeRef.current.startWidth + diff);\r\n      \r\n      setColumnWidths(prev => ({ ...prev, [columnId]: newWidth }));\r\n    };\r\n    \r\n    const handleMouseUp = () => {\r\n      if (resizeRef.current) {\r\n        const column = columns.find(c => c.id === resizeRef.current!.columnId);\r\n        const newWidth = columnWidths[resizeRef.current.columnId] || column?.width || columnWidth;\r\n        onColumnResize?.(column!, newWidth);\r\n      }\r\n      resizeRef.current = null;\r\n      document.removeEventListener('mousemove', handleMouseMove);\r\n      document.removeEventListener('mouseup', handleMouseUp);\r\n    };\r\n    \r\n    document.addEventListener('mousemove', handleMouseMove);\r\n    document.addEventListener('mouseup', handleMouseUp);\r\n  }, [columns, columnWidths, columnWidth, onColumnResize]);\r\n\r\n  // Handle sort\r\n  const handleHeaderClick = useCallback((column: AvakioExcelViewerColumn) => {\r\n    if (!column.sort) return;\r\n    \r\n    let direction: 'asc' | 'desc' = 'asc';\r\n    if (sortConfig?.columnId === column.id) {\r\n      direction = sortConfig.direction === 'asc' ? 'desc' : 'asc';\r\n    }\r\n    \r\n    setSortConfig({ columnId: column.id, direction });\r\n    onSort?.(column, direction);\r\n  }, [sortConfig, onSort]);\r\n\r\n  // Handle keyboard navigation\r\n  const handleKeyDown = useCallback((e: React.KeyboardEvent) => {\r\n    if (disabled || !navigation || !selection) return;\r\n    \r\n    const { row, column } = selection;\r\n    let newRow = row;\r\n    let newCol = column;\r\n    \r\n    switch (e.key) {\r\n      case 'ArrowUp':\r\n        newRow = Math.max(0, row - 1);\r\n        break;\r\n      case 'ArrowDown':\r\n        newRow = Math.min(processedData.length - 1, row + 1);\r\n        break;\r\n      case 'ArrowLeft':\r\n        newCol = Math.max(0, column - 1);\r\n        break;\r\n      case 'ArrowRight':\r\n        newCol = Math.min(visibleColumns.length - 1, column + 1);\r\n        break;\r\n      case 'Tab':\r\n        e.preventDefault();\r\n        if (e.shiftKey) {\r\n          newCol = column - 1;\r\n          if (newCol < 0) {\r\n            newCol = visibleColumns.length - 1;\r\n            newRow = Math.max(0, row - 1);\r\n          }\r\n        } else {\r\n          newCol = column + 1;\r\n          if (newCol >= visibleColumns.length) {\r\n            newCol = 0;\r\n            newRow = Math.min(processedData.length - 1, row + 1);\r\n          }\r\n        }\r\n        break;\r\n      case 'Enter':\r\n        if (editingCell) {\r\n          handleEditComplete();\r\n          newRow = Math.min(processedData.length - 1, row + 1);\r\n        } else if (editable) {\r\n          const col = visibleColumns[column];\r\n          if (col?.editable !== false) {\r\n            setEditingCell({ row, col: column });\r\n            setEditValue(String(processedData[row]?.[col?.id] || ''));\r\n            return;\r\n          }\r\n        }\r\n        break;\r\n      case 'Escape':\r\n        if (editingCell) {\r\n          setEditingCell(null);\r\n          setEditValue('');\r\n          return;\r\n        }\r\n        break;\r\n      case 'Home':\r\n        if (e.ctrlKey) {\r\n          newRow = 0;\r\n          newCol = 0;\r\n        } else {\r\n          newCol = 0;\r\n        }\r\n        break;\r\n      case 'End':\r\n        if (e.ctrlKey) {\r\n          newRow = processedData.length - 1;\r\n          newCol = visibleColumns.length - 1;\r\n        } else {\r\n          newCol = visibleColumns.length - 1;\r\n        }\r\n        break;\r\n      default:\r\n        return;\r\n    }\r\n    \r\n    if (newRow !== row || newCol !== column) {\r\n      e.preventDefault();\r\n      setSelection({ row: newRow, column: newCol });\r\n      onSelectionChange?.({ row: newRow, column: newCol });\r\n    }\r\n  }, [disabled, navigation, selection, processedData, visibleColumns, editingCell, editable, handleEditComplete, onSelectionChange]);\r\n\r\n  // Check if cell is in selection range\r\n  const isCellSelected = useCallback((rowIndex: number, colIndex: number): boolean => {\r\n    if (!selection) return false;\r\n    \r\n    const { row, column, endRow, endColumn } = selection;\r\n    \r\n    if (endRow !== undefined && endColumn !== undefined) {\r\n      const minRow = Math.min(row, endRow);\r\n      const maxRow = Math.max(row, endRow);\r\n      const minCol = Math.min(column, endColumn);\r\n      const maxCol = Math.max(column, endColumn);\r\n      \r\n      return rowIndex >= minRow && rowIndex <= maxRow && colIndex >= minCol && colIndex <= maxCol;\r\n    }\r\n    \r\n    return row === rowIndex && column === colIndex;\r\n  }, [selection]);\r\n\r\n  // Check if cell is spanned\r\n  const getCellSpan = useCallback((rowIndex: number, columnId: string): { rowspan?: number; colspan?: number; hidden?: boolean } => {\r\n    for (const span of spans) {\r\n      if (span.row === rowIndex && span.column === columnId) {\r\n        return { rowspan: span.rowspan, colspan: span.colspan };\r\n      }\r\n      \r\n      // Check if this cell is hidden by a span\r\n      if (span.rowspan && span.colspan) {\r\n        const spanEndRow = span.row + (span.rowspan - 1);\r\n        const colIndex = visibleColumns.findIndex(c => c.id === span.column);\r\n        const spanEndCol = colIndex + (span.colspan - 1);\r\n        const currentColIndex = visibleColumns.findIndex(c => c.id === columnId);\r\n        \r\n        if (\r\n          rowIndex >= span.row && rowIndex <= spanEndRow &&\r\n          currentColIndex >= colIndex && currentColIndex <= spanEndCol &&\r\n          !(rowIndex === span.row && columnId === span.column)\r\n        ) {\r\n          return { hidden: true };\r\n        }\r\n      }\r\n    }\r\n    return {};\r\n  }, [spans, visibleColumns]);\r\n\r\n  // Imperative handle\r\n  useImperativeHandle(ref, () => ({\r\n    getSheets: () => sheets.map(s => s.name),\r\n    showSheet: (name: string) => {\r\n      const index = sheets.findIndex(s => s.name === name);\r\n      if (index >= 0) handleSheetChange(index);\r\n    },\r\n    getCurrentSheet: () => sheets[activeSheet]?.name || '',\r\n    getData: () => data,\r\n    setData: (newData: Record<string, any>[]) => {\r\n      setData(newData);\r\n      onDataLoad?.(newData);\r\n    },\r\n    getColumns: () => columns,\r\n    setColumns: (newColumns: AvakioExcelViewerColumn[]) => setColumns(newColumns),\r\n    getSelectedId: () => selection,\r\n    select: (row: number, column: number, endRow?: number, endColumn?: number) => {\r\n      setSelection({ row, column, endRow, endColumn });\r\n      onSelectionChange?.({ row, column, endRow, endColumn });\r\n    },\r\n    clearSelection: () => {\r\n      setSelection(null);\r\n      onSelectionChange?.(null);\r\n    },\r\n    getCellValue: (rowIndex: number, columnId: string) => data[rowIndex]?.[columnId],\r\n    setCellValue: (rowIndex: number, columnId: string, value: any) => {\r\n      const newData = [...data];\r\n      if (newData[rowIndex]) {\r\n        newData[rowIndex] = { ...newData[rowIndex], [columnId]: value };\r\n        setData(newData);\r\n      }\r\n    },\r\n    addRow: (row: Record<string, any>, index?: number) => {\r\n      const newData = [...data];\r\n      if (index !== undefined) {\r\n        newData.splice(index, 0, row);\r\n      } else {\r\n        newData.push(row);\r\n      }\r\n      setData(newData);\r\n    },\r\n    removeRow: (index: number) => {\r\n      const newData = [...data];\r\n      newData.splice(index, 1);\r\n      setData(newData);\r\n    },\r\n    refresh: () => {\r\n      setData([...data]);\r\n    },\r\n    getItem: (index: number) => data[index],\r\n    count: () => data.length,\r\n    showCell: (rowIndex: number, columnId: string) => {\r\n      const cell = containerRef.current?.querySelector(`[data-row=\"${rowIndex}\"][data-col=\"${columnId}\"]`);\r\n      cell?.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'nearest' });\r\n    },\r\n    hideColumn: (columnId: string) => {\r\n      setHiddenColumns(prev => new Set([...Array.from(prev), columnId]));\r\n    },\r\n    showColumn: (columnId: string) => {\r\n      setHiddenColumns(prev => {\r\n        const next = new Set(prev);\r\n        next.delete(columnId);\r\n        return next;\r\n      });\r\n    },\r\n    isColumnVisible: (columnId: string) => !hiddenColumns.has(columnId),\r\n    sort: (columnId: string, direction?: 'asc' | 'desc') => {\r\n      const column = columns.find(c => c.id === columnId);\r\n      if (column) {\r\n        const dir = direction || (sortConfig?.columnId === columnId && sortConfig?.direction === 'asc' ? 'desc' : 'asc');\r\n        setSortConfig({ columnId, direction: dir });\r\n        onSort?.(column, dir);\r\n      }\r\n    },\r\n    filter: (columnId: string, value: any, compare?: (cellValue: any, filterValue: any) => boolean) => {\r\n      setFilterConfig({ columnId, value, compare });\r\n    },\r\n    clearFilter: () => {\r\n      setFilterConfig(null);\r\n    },\r\n  }), [sheets, activeSheet, data, columns, selection, hiddenColumns, sortConfig, handleSheetChange, onDataLoad, onSelectionChange, onSort]);\r\n\r\n  // Calculate table height\r\n  const tableHeight = yCount ? yCount * rowHeight + headerRowHeight : undefined;\r\n\r\n  return (\r\n    <div\r\n      ref={containerRef}\r\n      id={id}\r\n      data-testid={testId}\r\n      className={`avakio-excel-viewer avakio-excel-viewer-theme-${theme} ${css || ''} ${disabled ? 'avakio-excel-viewer-disabled' : ''} ${gridLines ? 'avakio-excel-viewer-grid-lines' : ''}`}\r\n      tabIndex={navigation ? 0 : -1}\r\n      onKeyDown={handleKeyDown}\r\n    >\r\n      {toolbar && sheets.length > 1 && (\r\n        <div className=\"avakio-excel-viewer-toolbar\">\r\n          {sheets.map((sheet, index) => (\r\n            <button\r\n              key={sheet.name}\r\n              className={`avakio-excel-viewer-sheet-tab ${index === activeSheet ? 'active' : ''}`}\r\n              onClick={() => handleSheetChange(index)}\r\n              disabled={disabled}\r\n            >\r\n              {sheet.name}\r\n            </button>\r\n          ))}\r\n        </div>\r\n      )}\r\n      \r\n      <div \r\n        className=\"avakio-excel-viewer-table-container\"\r\n        style={{ maxHeight: tableHeight }}\r\n      >\r\n        <table \r\n          ref={tableRef}\r\n          className=\"avakio-excel-viewer-table\"\r\n        >\r\n          <thead className={freezeHeader ? 'avakio-excel-viewer-sticky-header' : ''}>\r\n            <tr style={{ height: headerRowHeight }}>\r\n              {showRowNumbers && (\r\n                <th className=\"avakio-excel-viewer-row-number-header\">#</th>\r\n              )}\r\n              {visibleColumns.map((column, colIndex) => (\r\n                <th\r\n                  key={column.id}\r\n                  className={`avakio-excel-viewer-header-cell ${column.css || ''} ${column.sort ? 'sortable' : ''} ${sortConfig?.columnId === column.id ? `sorted-${sortConfig.direction}` : ''}`}\r\n                  style={{\r\n                    width: columnWidths[column.id] || column.width || columnWidth,\r\n                    minWidth: column.minWidth,\r\n                    maxWidth: column.maxWidth,\r\n                    textAlign: column.align || 'left',\r\n                  }}\r\n                  onClick={() => handleHeaderClick(column)}\r\n                >\r\n                  <span className=\"avakio-excel-viewer-header-text\">{column.header || column.id}</span>\r\n                  {column.sort && sortConfig?.columnId === column.id && (\r\n                    <span className=\"avakio-excel-viewer-sort-icon\">\r\n                      {sortConfig.direction === 'asc' ? 'â–²' : 'â–¼'}\r\n                    </span>\r\n                  )}\r\n                  {resizeColumn && (\r\n                    <div\r\n                      className=\"avakio-excel-viewer-resize-handle\"\r\n                      onMouseDown={(e) => handleColumnResizeStart(column.id, e)}\r\n                    />\r\n                  )}\r\n                </th>\r\n              ))}\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {processedData.length === 0 ? (\r\n              <tr>\r\n                <td \r\n                  colSpan={visibleColumns.length + (showRowNumbers ? 1 : 0)}\r\n                  className=\"avakio-excel-viewer-empty\"\r\n                >\r\n                  No data available\r\n                </td>\r\n              </tr>\r\n            ) : (\r\n              processedData.map((row, rowIndex) => (\r\n                <tr\r\n                  key={rowIndex}\r\n                  style={{ height: rowHeights[rowIndex] || rowHeight }}\r\n                  className={select === 'row' && selection?.row === rowIndex ? 'selected-row' : ''}\r\n                >\r\n                  {showRowNumbers && (\r\n                    <td className=\"avakio-excel-viewer-row-number\">{rowIndex + 1}</td>\r\n                  )}\r\n                  {visibleColumns.map((column, colIndex) => {\r\n                    const span = getCellSpan(rowIndex, column.id);\r\n                    if (span.hidden) return null;\r\n                    \r\n                    const isEditing = editingCell?.row === rowIndex && editingCell?.col === colIndex;\r\n                    const isSelected = isCellSelected(rowIndex, colIndex);\r\n                    const cellValue = row[column.id];\r\n                    \r\n                    return (\r\n                      <td\r\n                        key={column.id}\r\n                        data-row={rowIndex}\r\n                        data-col={column.id}\r\n                        className={`avakio-excel-viewer-cell ${column.css || ''} ${isSelected ? 'selected' : ''} ${isEditing ? 'editing' : ''}`}\r\n                        style={{\r\n                          textAlign: column.align || 'left',\r\n                          width: columnWidths[column.id] || column.width || columnWidth,\r\n                        }}\r\n                        rowSpan={span.rowspan}\r\n                        colSpan={span.colspan}\r\n                        onClick={(e) => handleCellClick(rowIndex, colIndex, e)}\r\n                        onDoubleClick={() => handleCellDoubleClick(rowIndex, colIndex)}\r\n                      >\r\n                        {isEditing ? (\r\n                          <input\r\n                            type={column.editor === 'number' ? 'number' : 'text'}\r\n                            className=\"avakio-excel-viewer-editor\"\r\n                            value={editValue}\r\n                            onChange={(e) => setEditValue(e.target.value)}\r\n                            onBlur={handleEditComplete}\r\n                            onKeyDown={(e) => {\r\n                              if (e.key === 'Enter') {\r\n                                handleEditComplete();\r\n                              } else if (e.key === 'Escape') {\r\n                                setEditingCell(null);\r\n                                setEditValue('');\r\n                              }\r\n                              e.stopPropagation();\r\n                            }}\r\n                            autoFocus\r\n                          />\r\n                        ) : column.template ? (\r\n                          column.template(row, column)\r\n                        ) : (\r\n                          <span className=\"avakio-excel-viewer-cell-text\">\r\n                            {cellValue !== undefined && cellValue !== null ? String(cellValue) : ''}\r\n                          </span>\r\n                        )}\r\n                      </td>\r\n                    );\r\n                  })}\r\n                </tr>\r\n              ))\r\n            )}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    </div>\r\n  );\r\n});\r\n\r\nAvakioExcelViewer.displayName = 'AvakioExcelViewer';\r\n\r\nexport default AvakioExcelViewer;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, {\r\n  forwardRef,\r\n  useImperativeHandle,\r\n  useRef,\r\n  useState,\r\n  useCallback,\r\n  useEffect,\r\n  ReactNode,\r\n  CSSProperties,\r\n} from 'react';\r\nimport './avakio-form.css';\r\n\r\n// ============================================================================\r\n// Types and Interfaces\r\n// ============================================================================\r\n\r\nexport type AvakioFormTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\n\r\n/** Validation rule function - returns true if valid, false or error message if invalid */\r\nexport type ValidationRule<T = any> = (value: T, name: string, values: FormValues) => boolean | string;\r\n\r\n/** Built-in validation rules */\r\nexport const FormRules = {\r\n  /** Field is required (not empty) */\r\n  isRequired: (value: any) => {\r\n    if (value === null || value === undefined) return false;\r\n    if (typeof value === 'string') return value.trim().length > 0;\r\n    if (Array.isArray(value)) return value.length > 0;\r\n    return true;\r\n  },\r\n  /** Must be a valid email */\r\n  isEmail: (value: any) => {\r\n    if (!value) return true; // Allow empty - combine with isRequired if needed\r\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n    return emailRegex.test(String(value));\r\n  },\r\n  /** Must be a valid number */\r\n  isNumber: (value: any) => {\r\n    if (!value && value !== 0) return true;\r\n    return !isNaN(Number(value));\r\n  },\r\n  /** Must be a positive number */\r\n  isPositive: (value: any) => {\r\n    if (!value && value !== 0) return true;\r\n    const num = Number(value);\r\n    return !isNaN(num) && num > 0;\r\n  },\r\n  /** Must be an integer */\r\n  isInteger: (value: any) => {\r\n    if (!value && value !== 0) return true;\r\n    return Number.isInteger(Number(value));\r\n  },\r\n  /** Must match given regex pattern */\r\n  pattern: (regex: RegExp) => (value: any) => {\r\n    if (!value) return true;\r\n    return regex.test(String(value));\r\n  },\r\n  /** Minimum length */\r\n  minLength: (min: number) => (value: any) => {\r\n    if (!value) return true;\r\n    return String(value).length >= min;\r\n  },\r\n  /** Maximum length */\r\n  maxLength: (max: number) => (value: any) => {\r\n    if (!value) return true;\r\n    return String(value).length <= max;\r\n  },\r\n  /** Minimum value (for numbers) */\r\n  minValue: (min: number) => (value: any) => {\r\n    if (!value && value !== 0) return true;\r\n    return Number(value) >= min;\r\n  },\r\n  /** Maximum value (for numbers) */\r\n  maxValue: (max: number) => (value: any) => {\r\n    if (!value && value !== 0) return true;\r\n    return Number(value) <= max;\r\n  },\r\n  /** Custom validation function */\r\n  custom: (fn: (value: any) => boolean | string) => fn,\r\n};\r\n\r\n/** Form values object */\r\nexport type FormValues = Record<string, any>;\r\n\r\n/** Validation rules configuration */\r\nexport type FormValidationRules = Record<string, ValidationRule | ValidationRule[]>;\r\n\r\n/** Validation errors object */\r\nexport type FormErrors = Record<string, string | undefined>;\r\n\r\n/** Form element configuration */\r\nexport interface FormElement {\r\n  /** Unique name for the element - used for value binding */\r\n  name?: string;\r\n  /** Form control component */\r\n  view?: ReactNode;\r\n  /** Nested columns layout */\r\n  cols?: FormElement[];\r\n  /** Nested rows layout */\r\n  rows?: FormElement[];\r\n  /** Element label (for section headers) */\r\n  label?: string;\r\n  /** Element type - 'section' for section headers */\r\n  type?: 'section' | 'clean';\r\n  /** CSS class */\r\n  css?: string;\r\n  /** Width */\r\n  width?: number | string;\r\n  /** Height */\r\n  height?: number | string;\r\n  /** Gravity (flex grow) */\r\n  gravity?: number;\r\n  /** Padding */\r\n  padding?: number | string;\r\n  /** Margin */\r\n  margin?: number | string;\r\n  /** Hidden */\r\n  hidden?: boolean;\r\n  /** Disabled */\r\n  disabled?: boolean;\r\n  /** Batch name for visibility toggling */\r\n  batch?: string;\r\n}\r\n\r\nexport interface AvakioFormProps {\r\n  /** Child elements (React children) */\r\n  children?: ReactNode;\r\n  /** Form elements configuration (alternative to children) */\r\n  elements?: FormElement[];\r\n  /** Initial form values */\r\n  values?: FormValues;\r\n  /** Default values (used by getCleanValues and isDirty) */\r\n  defaultValues?: FormValues;\r\n  /** Validation rules */\r\n  rules?: FormValidationRules;\r\n  /** Whether to parse complex data (dot notation in names) */\r\n  complexData?: boolean;\r\n  /** Auto height based on content */\r\n  autoHeight?: boolean;\r\n  /** Remove borders */\r\n  borderless?: boolean;\r\n  /** Disabled state */\r\n  disabled?: boolean;\r\n  /** Width */\r\n  width?: number | string;\r\n  /** Height */\r\n  height?: number | string;\r\n  /** Min width */\r\n  minWidth?: number | string;\r\n  /** Max width */\r\n  maxWidth?: number | string;\r\n  /** Min height */\r\n  minHeight?: number | string;\r\n  /** Max height */\r\n  maxHeight?: number | string;\r\n  /** Padding (applies to all sides) */\r\n  padding?: number | string;\r\n  /** Horizontal padding */\r\n  paddingX?: number | string;\r\n  /** Vertical padding */\r\n  paddingY?: number | string;\r\n  /** Margin between elements */\r\n  margin?: number | string;\r\n  /** Enable scroll */\r\n  scroll?: boolean | 'x' | 'y' | 'xy';\r\n  /** Layout type */\r\n  type?: 'clean' | 'line' | 'wide' | 'space' | 'form';\r\n  /** Theme variant */\r\n  theme?: AvakioFormTheme;\r\n  /** Custom class name */\r\n  className?: string;\r\n  /** Custom style */\r\n  style?: CSSProperties;\r\n  /** Currently visible batch */\r\n  visibleBatch?: string;\r\n  /** Callback when form values change */\r\n  onChange?: (name: string, value: any, values: FormValues) => void;\r\n  /** Callback after validation */\r\n  onValidation?: (isValid: boolean, errors: FormErrors) => void;\r\n  /** Callback on validation error */\r\n  onValidationError?: (name: string, error: string) => void;\r\n  /** Callback on validation success */\r\n  onValidationSuccess?: (name: string) => void;\r\n  /** Callback when form is submitted (Enter pressed) */\r\n  onSubmit?: (values: FormValues) => void;\r\n  /** Callback when values are set */\r\n  onValues?: (values: FormValues) => void;\r\n}\r\n\r\nexport interface AvakioFormRef {\r\n  /** Get the DOM node */\r\n  getNode: () => HTMLFormElement | null;\r\n  /** Get all form values */\r\n  getValues: () => FormValues;\r\n  /** Set form values */\r\n  setValues: (values: FormValues, updateDirty?: boolean) => void;\r\n  /** Get clean (unchanged) values */\r\n  getCleanValues: () => FormValues;\r\n  /** Get dirty (changed) values */\r\n  getDirtyValues: () => FormValues;\r\n  /** Check if form has changes */\r\n  isDirty: () => boolean;\r\n  /** Set dirty state */\r\n  setDirty: (dirty: boolean) => void;\r\n  /** Validate the form */\r\n  validate: () => boolean;\r\n  /** Clear validation errors */\r\n  clearValidation: () => void;\r\n  /** Mark a field as invalid */\r\n  markInvalid: (name: string, message?: string) => void;\r\n  /** Clear all form values */\r\n  clear: () => void;\r\n  /** Focus a specific field or first field */\r\n  focus: (name?: string) => void;\r\n  /** Check if form is enabled */\r\n  isEnabled: () => boolean;\r\n  /** Enable the form */\r\n  enable: () => void;\r\n  /** Disable the form */\r\n  disable: () => void;\r\n  /** Show a batch of elements */\r\n  showBatch: (batchName: string) => void;\r\n  /** Get validation errors */\r\n  getErrors: () => FormErrors;\r\n}\r\n\r\n// ============================================================================\r\n// Form Context\r\n// ============================================================================\r\n\r\ninterface FormContextValue {\r\n  values: FormValues;\r\n  errors: FormErrors;\r\n  disabled: boolean;\r\n  onChange: (name: string, value: any) => void;\r\n  registerField: (name: string, element: HTMLElement | null) => void;\r\n  unregisterField: (name: string) => void;\r\n}\r\n\r\nconst FormContext = React.createContext<FormContextValue | null>(null);\r\n\r\nexport const useFormContext = () => {\r\n  const context = React.useContext(FormContext);\r\n  return context;\r\n};\r\n\r\n// ============================================================================\r\n// Helper Functions\r\n// ============================================================================\r\n\r\n/** Parse dot notation path and set value in object */\r\nfunction setNestedValue(obj: FormValues, path: string, value: any): FormValues {\r\n  const keys = path.split('.');\r\n  const result = { ...obj };\r\n  let current: any = result;\r\n\r\n  for (let i = 0; i < keys.length - 1; i++) {\r\n    const key = keys[i];\r\n    current[key] = current[key] ? { ...current[key] } : {};\r\n    current = current[key];\r\n  }\r\n\r\n  current[keys[keys.length - 1]] = value;\r\n  return result;\r\n}\r\n\r\n/** Get nested value from object using dot notation */\r\nfunction getNestedValue(obj: FormValues, path: string): any {\r\n  return path.split('.').reduce((acc, key) => acc?.[key], obj);\r\n}\r\n\r\n/** Flatten nested object to dot notation keys */\r\nfunction flattenObject(obj: any, prefix = ''): FormValues {\r\n  const result: FormValues = {};\r\n\r\n  for (const key in obj) {\r\n    const newKey = prefix ? `${prefix}.${key}` : key;\r\n    if (obj[key] && typeof obj[key] === 'object' && !Array.isArray(obj[key]) && !(obj[key] instanceof Date)) {\r\n      Object.assign(result, flattenObject(obj[key], newKey));\r\n    } else {\r\n      result[newKey] = obj[key];\r\n    }\r\n  }\r\n\r\n  return result;\r\n}\r\n\r\n// ============================================================================\r\n// Main Component\r\n// ============================================================================\r\n\r\nexport const AvakioForm = forwardRef<AvakioFormRef, AvakioFormProps>((props, ref) => {\r\n  const {\r\n    children,\r\n    elements,\r\n    values: initialValues = {},\r\n    defaultValues: initialDefaultValues,\r\n    rules = {},\r\n    complexData = false,\r\n    autoHeight = false,\r\n    borderless = false,\r\n    disabled: initialDisabled = false,\r\n    width,\r\n    height,\r\n    minWidth,\r\n    maxWidth,\r\n    minHeight,\r\n    maxHeight,\r\n    padding,\r\n    paddingX,\r\n    paddingY,\r\n    margin,\r\n    scroll,\r\n    type = 'form',\r\n    theme,\r\n    className,\r\n    style,\r\n    visibleBatch: initialVisibleBatch,\r\n    onChange,\r\n    onValidation,\r\n    onValidationError,\r\n    onValidationSuccess,\r\n    onSubmit,\r\n    onValues,\r\n  } = props;\r\n\r\n  const formRef = useRef<HTMLFormElement>(null);\r\n  const fieldsRef = useRef<Map<string, HTMLElement | null>>(new Map());\r\n  \r\n  const [values, setValues] = useState<FormValues>(() => {\r\n    if (complexData) {\r\n      return flattenObject(initialValues);\r\n    }\r\n    return { ...initialValues };\r\n  });\r\n  \r\n  const [defaultValues, setDefaultValues] = useState<FormValues>(() => {\r\n    const defaults = initialDefaultValues || initialValues;\r\n    if (complexData) {\r\n      return flattenObject(defaults);\r\n    }\r\n    return { ...defaults };\r\n  });\r\n  \r\n  const [errors, setErrors] = useState<FormErrors>({});\r\n  const [disabled, setDisabled] = useState(initialDisabled);\r\n  const [dirty, setDirtyState] = useState(false);\r\n  const [visibleBatch, setVisibleBatch] = useState<string | undefined>(initialVisibleBatch);\r\n\r\n  // Update disabled when prop changes\r\n  useEffect(() => {\r\n    setDisabled(initialDisabled);\r\n  }, [initialDisabled]);\r\n\r\n  // Handle field value change\r\n  const handleChange = useCallback((name: string, value: any) => {\r\n    setValues(prev => {\r\n      const newValues = complexData \r\n        ? setNestedValue(prev, name, value)\r\n        : { ...prev, [name]: value };\r\n      \r\n      // Trigger onChange callback\r\n      onChange?.(name, value, newValues);\r\n      \r\n      return newValues;\r\n    });\r\n    \r\n    // Mark as dirty\r\n    setDirtyState(true);\r\n    \r\n    // Clear error for this field\r\n    setErrors(prev => {\r\n      if (prev[name]) {\r\n        const newErrors = { ...prev };\r\n        delete newErrors[name];\r\n        return newErrors;\r\n      }\r\n      return prev;\r\n    });\r\n  }, [complexData, onChange]);\r\n\r\n  // Register field reference\r\n  const registerField = useCallback((name: string, element: HTMLElement | null) => {\r\n    if (element) {\r\n      fieldsRef.current.set(name, element);\r\n    }\r\n  }, []);\r\n\r\n  // Unregister field reference\r\n  const unregisterField = useCallback((name: string) => {\r\n    fieldsRef.current.delete(name);\r\n  }, []);\r\n\r\n  // Validate a single field\r\n  const validateField = useCallback((name: string, value: any): string | undefined => {\r\n    const fieldRules = rules[name];\r\n    if (!fieldRules) return undefined;\r\n\r\n    const rulesArray = Array.isArray(fieldRules) ? fieldRules : [fieldRules];\r\n    \r\n    for (const rule of rulesArray) {\r\n      const result = rule(value, name, values);\r\n      if (result === false) {\r\n        return 'Invalid value';\r\n      }\r\n      if (typeof result === 'string') {\r\n        return result;\r\n      }\r\n    }\r\n    \r\n    return undefined;\r\n  }, [rules, values]);\r\n\r\n  // Validate all fields\r\n  const validate = useCallback((): boolean => {\r\n    const newErrors: FormErrors = {};\r\n    let isValid = true;\r\n\r\n    for (const name in rules) {\r\n      const value = complexData ? getNestedValue(values, name) : values[name];\r\n      const error = validateField(name, value);\r\n      \r\n      if (error) {\r\n        newErrors[name] = error;\r\n        isValid = false;\r\n        onValidationError?.(name, error);\r\n      } else {\r\n        onValidationSuccess?.(name);\r\n      }\r\n    }\r\n\r\n    setErrors(newErrors);\r\n    onValidation?.(isValid, newErrors);\r\n    \r\n    return isValid;\r\n  }, [rules, values, complexData, validateField, onValidation, onValidationError, onValidationSuccess]);\r\n\r\n  // Get values (with complex data reconstruction if needed)\r\n  const getFormValues = useCallback((): FormValues => {\r\n    if (!complexData) return { ...values };\r\n    \r\n    // Reconstruct nested object from flat values\r\n    const result: FormValues = {};\r\n    for (const key in values) {\r\n      if (key.includes('.')) {\r\n        const keys = key.split('.');\r\n        let current = result;\r\n        for (let i = 0; i < keys.length - 1; i++) {\r\n          if (!current[keys[i]]) current[keys[i]] = {};\r\n          current = current[keys[i]];\r\n        }\r\n        current[keys[keys.length - 1]] = values[key];\r\n      } else {\r\n        result[key] = values[key];\r\n      }\r\n    }\r\n    return result;\r\n  }, [values, complexData]);\r\n\r\n  // Set form values\r\n  const setFormValues = useCallback((newValues: FormValues, updateDirty = true) => {\r\n    const processedValues = complexData ? flattenObject(newValues) : { ...newValues };\r\n    setValues(processedValues);\r\n    \r\n    if (updateDirty) {\r\n      setDefaultValues(processedValues);\r\n      setDirtyState(false);\r\n    }\r\n    \r\n    onValues?.(newValues);\r\n  }, [complexData, onValues]);\r\n\r\n  // Get clean (unchanged) values\r\n  const getCleanValues = useCallback((): FormValues => {\r\n    const result: FormValues = {};\r\n    for (const key in values) {\r\n      if (values[key] === defaultValues[key]) {\r\n        result[key] = values[key];\r\n      }\r\n    }\r\n    return result;\r\n  }, [values, defaultValues]);\r\n\r\n  // Get dirty (changed) values\r\n  const getDirtyValues = useCallback((): FormValues => {\r\n    const result: FormValues = {};\r\n    for (const key in values) {\r\n      if (values[key] !== defaultValues[key]) {\r\n        result[key] = values[key];\r\n      }\r\n    }\r\n    return result;\r\n  }, [values, defaultValues]);\r\n\r\n  // Check if form is dirty\r\n  const isDirty = useCallback((): boolean => {\r\n    for (const key in values) {\r\n      if (values[key] !== defaultValues[key]) {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }, [values, defaultValues]);\r\n\r\n  // Clear validation\r\n  const clearValidation = useCallback(() => {\r\n    setErrors({});\r\n  }, []);\r\n\r\n  // Mark field invalid\r\n  const markInvalid = useCallback((name: string, message = 'Invalid value') => {\r\n    setErrors(prev => ({ ...prev, [name]: message }));\r\n  }, []);\r\n\r\n  // Clear form\r\n  const clear = useCallback(() => {\r\n    setValues({});\r\n    setErrors({});\r\n    setDirtyState(false);\r\n  }, []);\r\n\r\n  // Focus field\r\n  const focus = useCallback((name?: string) => {\r\n    if (name) {\r\n      const field = fieldsRef.current.get(name);\r\n      if (field) {\r\n        const input = field.querySelector('input, textarea, select, [tabindex]') as HTMLElement;\r\n        (input || field).focus();\r\n      }\r\n    } else {\r\n      // Focus first field\r\n      const firstField = fieldsRef.current.values().next().value;\r\n      if (firstField) {\r\n        const input = firstField.querySelector('input, textarea, select, [tabindex]') as HTMLElement;\r\n        (input || firstField).focus();\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  // Handle form submit\r\n  const handleSubmit = useCallback((e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    \r\n    if (validate()) {\r\n      onSubmit?.(getFormValues());\r\n    }\r\n  }, [validate, onSubmit, getFormValues]);\r\n\r\n  // Handle keydown for submit on Enter\r\n  const handleKeyDown = useCallback((e: React.KeyboardEvent) => {\r\n    if (e.key === 'Enter' && !e.shiftKey) {\r\n      const target = e.target as HTMLElement;\r\n      // Don't submit if in textarea\r\n      if (target.tagName !== 'TEXTAREA') {\r\n        // Check if there's an explicit submit button\r\n        const form = formRef.current;\r\n        if (form) {\r\n          const submitButton = form.querySelector('button[type=\"submit\"]');\r\n          if (!submitButton) {\r\n            e.preventDefault();\r\n            if (validate()) {\r\n              onSubmit?.(getFormValues());\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }, [validate, onSubmit, getFormValues]);\r\n\r\n  // Expose ref methods\r\n  useImperativeHandle(ref, () => ({\r\n    getNode: () => formRef.current,\r\n    getValues: getFormValues,\r\n    setValues: setFormValues,\r\n    getCleanValues,\r\n    getDirtyValues,\r\n    isDirty,\r\n    setDirty: setDirtyState,\r\n    validate,\r\n    clearValidation,\r\n    markInvalid,\r\n    clear,\r\n    focus,\r\n    isEnabled: () => !disabled,\r\n    enable: () => setDisabled(false),\r\n    disable: () => setDisabled(true),\r\n    showBatch: setVisibleBatch,\r\n    getErrors: () => ({ ...errors }),\r\n  }), [\r\n    getFormValues,\r\n    setFormValues,\r\n    getCleanValues,\r\n    getDirtyValues,\r\n    isDirty,\r\n    validate,\r\n    clearValidation,\r\n    markInvalid,\r\n    clear,\r\n    focus,\r\n    disabled,\r\n    errors,\r\n  ]);\r\n\r\n  // Build style object\r\n  const formStyle: CSSProperties = {\r\n    ...style,\r\n    width: typeof width === 'number' ? `${width}px` : width,\r\n    height: autoHeight ? 'auto' : (typeof height === 'number' ? `${height}px` : height),\r\n    minWidth: typeof minWidth === 'number' ? `${minWidth}px` : minWidth,\r\n    maxWidth: typeof maxWidth === 'number' ? `${maxWidth}px` : maxWidth,\r\n    minHeight: typeof minHeight === 'number' ? `${minHeight}px` : minHeight,\r\n    maxHeight: typeof maxHeight === 'number' ? `${maxHeight}px` : maxHeight,\r\n  };\r\n\r\n  // Build padding styles\r\n  if (padding !== undefined) {\r\n    formStyle.padding = typeof padding === 'number' ? `${padding}px` : padding;\r\n  }\r\n  if (paddingX !== undefined) {\r\n    const px = typeof paddingX === 'number' ? `${paddingX}px` : paddingX;\r\n    formStyle.paddingLeft = px;\r\n    formStyle.paddingRight = px;\r\n  }\r\n  if (paddingY !== undefined) {\r\n    const py = typeof paddingY === 'number' ? `${paddingY}px` : paddingY;\r\n    formStyle.paddingTop = py;\r\n    formStyle.paddingBottom = py;\r\n  }\r\n\r\n  // Build class names\r\n  const classNames = [\r\n    'avakio-form',\r\n    `avakio-form--type-${type}`,\r\n    borderless && 'avakio-form--borderless',\r\n    disabled && 'avakio-form--disabled',\r\n    scroll === true && 'avakio-form--scroll',\r\n    scroll === 'x' && 'avakio-form--scroll-x',\r\n    scroll === 'y' && 'avakio-form--scroll-y',\r\n    scroll === 'xy' && 'avakio-form--scroll',\r\n    theme && `avakio-form--theme-${theme}`,\r\n    className,\r\n  ].filter(Boolean).join(' ');\r\n\r\n  // Context value\r\n  const contextValue: FormContextValue = {\r\n    values,\r\n    errors,\r\n    disabled,\r\n    onChange: handleChange,\r\n    registerField,\r\n    unregisterField,\r\n  };\r\n\r\n  // Render elements from configuration\r\n  const renderElement = (element: FormElement, index: number): ReactNode => {\r\n    if (element.hidden) return null;\r\n    \r\n    // Check batch visibility\r\n    if (element.batch && visibleBatch && element.batch !== visibleBatch) {\r\n      return null;\r\n    }\r\n\r\n    // Section header\r\n    if (element.type === 'section') {\r\n      return (\r\n        <div key={index} className=\"avakio-form__section\">\r\n          <div className=\"avakio-form__section-header\">\r\n            {element.label}\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    // Columns layout\r\n    if (element.cols) {\r\n      const colStyle: CSSProperties = {};\r\n      if (element.margin !== undefined) {\r\n        colStyle.gap = typeof element.margin === 'number' ? `${element.margin}px` : element.margin;\r\n      }\r\n      \r\n      return (\r\n        <div \r\n          key={index} \r\n          className={`avakio-form__cols ${element.css || ''}`}\r\n          style={colStyle}\r\n        >\r\n          {element.cols.map((col, colIndex) => renderElement(col, colIndex))}\r\n        </div>\r\n      );\r\n    }\r\n\r\n    // Rows layout\r\n    if (element.rows) {\r\n      const rowStyle: CSSProperties = {};\r\n      if (element.margin !== undefined) {\r\n        rowStyle.gap = typeof element.margin === 'number' ? `${element.margin}px` : element.margin;\r\n      }\r\n      \r\n      return (\r\n        <div \r\n          key={index} \r\n          className={`avakio-form__rows ${element.css || ''}`}\r\n          style={rowStyle}\r\n        >\r\n          {element.rows.map((row, rowIndex) => renderElement(row, rowIndex))}\r\n        </div>\r\n      );\r\n    }\r\n\r\n    // Single element with view\r\n    if (element.view) {\r\n      const elementStyle: CSSProperties = {};\r\n      if (element.width !== undefined) {\r\n        elementStyle.width = typeof element.width === 'number' ? `${element.width}px` : element.width;\r\n      }\r\n      if (element.height !== undefined) {\r\n        elementStyle.height = typeof element.height === 'number' ? `${element.height}px` : element.height;\r\n      }\r\n      if (element.gravity !== undefined) {\r\n        elementStyle.flex = element.gravity;\r\n      }\r\n      if (element.padding !== undefined) {\r\n        elementStyle.padding = typeof element.padding === 'number' ? `${element.padding}px` : element.padding;\r\n      }\r\n\r\n      return (\r\n        <div \r\n          key={index} \r\n          className={`avakio-form__element ${element.css || ''}`}\r\n          style={elementStyle}\r\n        >\r\n          {element.view}\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return null;\r\n  };\r\n\r\n  // Render form elements with margin\r\n  const contentStyle: CSSProperties = {};\r\n  if (margin !== undefined) {\r\n    contentStyle.gap = typeof margin === 'number' ? `${margin}px` : margin;\r\n  }\r\n\r\n  return (\r\n    <FormContext.Provider value={contextValue}>\r\n      <form\r\n        ref={formRef}\r\n        className={classNames}\r\n        style={formStyle}\r\n        onSubmit={handleSubmit}\r\n        onKeyDown={handleKeyDown}\r\n        data-admin-theme={theme}\r\n      >\r\n        <div className=\"avakio-form__content\" style={contentStyle}>\r\n          {elements ? elements.map((el, i) => renderElement(el, i)) : children}\r\n        </div>\r\n      </form>\r\n    </FormContext.Provider>\r\n  );\r\n});\r\n\r\nAvakioForm.displayName = 'AvakioForm';\r\n\r\n// ============================================================================\r\n// Form Field Wrapper Component\r\n// ============================================================================\r\n\r\nexport interface AvakioFormFieldProps {\r\n  /** Field name - must match a key in form values */\r\n  name: string;\r\n  /** The form control component */\r\n  children: ReactNode;\r\n  /** Custom render function for more control */\r\n  render?: (props: {\r\n    value: any;\r\n    error?: string;\r\n    onChange: (value: any) => void;\r\n    disabled: boolean;\r\n  }) => ReactNode;\r\n}\r\n\r\nexport const AvakioFormField: React.FC<AvakioFormFieldProps> = ({ name, children, render }) => {\r\n  const context = useFormContext();\r\n  const fieldRef = useRef<HTMLDivElement>(null);\r\n\r\n  useEffect(() => {\r\n    if (context && fieldRef.current) {\r\n      context.registerField(name, fieldRef.current);\r\n      return () => context.unregisterField(name);\r\n    }\r\n  }, [context, name]);\r\n\r\n  if (!context) {\r\n    // Render without form context\r\n    return <div ref={fieldRef} className=\"avakio-form__field\">{children}</div>;\r\n  }\r\n\r\n  const { values, errors, disabled, onChange } = context;\r\n  const value = values[name];\r\n  const error = errors[name];\r\n\r\n  const handleChange = (newValue: any) => {\r\n    onChange(name, newValue);\r\n  };\r\n\r\n  if (render) {\r\n    return (\r\n      <div ref={fieldRef} className=\"avakio-form__field\">\r\n        {render({ value, error, onChange: handleChange, disabled })}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Clone children and inject props\r\n  const enhancedChildren = React.Children.map(children, child => {\r\n    if (React.isValidElement(child)) {\r\n      return React.cloneElement(child as React.ReactElement<any>, {\r\n        value,\r\n        error,\r\n        onChange: handleChange,\r\n        disabled: disabled || (child.props as any).disabled,\r\n        invalid: !!error,\r\n        invalidMessage: error,\r\n      });\r\n    }\r\n    return child;\r\n  });\r\n\r\n  return (\r\n    <div ref={fieldRef} className=\"avakio-form__field\">\r\n      {enhancedChildren}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AvakioForm;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useMemo } from \"react\";\r\nimport \"./avakio-gage.css\";\r\n\r\nexport interface AvakioGageProps {\r\n  value?: number;\r\n  defaultValue?: number;\r\n  min?: number;\r\n  max?: number;\r\n  label?: string;\r\n  subLabel?: string;\r\n  size?: \"sm\" | \"md\" | \"lg\";\r\n  thickness?: number;\r\n  prefix?: string;\r\n  suffix?: string;\r\n  formatValue?: (value: number) => string;\r\n  showValue?: boolean;\r\n  showMinMax?: boolean;\r\n  trackColor?: string;\r\n  color?: string;\r\n  target?: number;\r\n  className?: string;\r\n  style?: React.CSSProperties;\r\n  /** ID of the component */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n}\r\n\r\nexport function AvakioGage({\r\n  value,\r\n  defaultValue,\r\n  min = 0,\r\n  max = 100,\r\n  label,\r\n  subLabel,\r\n  size = \"md\",\r\n  thickness,\r\n  prefix = \"\",\r\n  suffix = \"\",\r\n  formatValue,\r\n  showValue = true,\r\n  showMinMax = true,\r\n  trackColor,\r\n  color,\r\n  target,\r\n  className,\r\n  style,\r\n  id,\r\n  testId,\r\n}: AvakioGageProps) {\r\n  const safeRange = max - min === 0 ? 1 : max - min;\r\n  const rawValue = value ?? defaultValue ?? min;\r\n  const clamped = Math.min(Math.max(rawValue, min), max);\r\n  const percent = ((clamped - min) / safeRange) * 100;\r\n\r\n  const strokeWidth = thickness ?? (size === \"sm\" ? 10 : size === \"lg\" ? 14 : 12);\r\n  const radius = 88;\r\n  const circumference = 2 * Math.PI * radius;\r\n  const dashOffset = circumference * (1 - percent / 100);\r\n\r\n  const targetPosition = useMemo(() => {\r\n    if (target === undefined || target === null) return null;\r\n    const targetPercent = ((Math.min(Math.max(target, min), max) - min) / safeRange) * 100;\r\n    const angle = (targetPercent / 100) * 2 * Math.PI - Math.PI / 2;\r\n    const x = 100 + (radius * Math.cos(angle));\r\n    const y = 100 + (radius * Math.sin(angle));\r\n    return { x, y };\r\n  }, [target, min, max, safeRange]);\r\n\r\n  const displayValue = useMemo(() => {\r\n    if (!showValue) return \"\";\r\n    const base = formatValue ? formatValue(clamped) : clamped.toString();\r\n    return `${prefix}${base}${suffix}`;\r\n  }, [clamped, formatValue, prefix, suffix, showValue]);\r\n\r\n  const mergedClass = [\"avakio-gage\", `avakio-gage-${size}`, className].filter(Boolean).join(\" \");\r\n  const styleVars: React.CSSProperties = {\r\n    ...style,\r\n    ...(color ? { [\"--gg-fill\" as string]: color } : null),\r\n    ...(trackColor ? { [\"--gg-track\" as string]: trackColor } : null),\r\n  };\r\n\r\n  return (\r\n    <div id={id} data-testid={testId} className={mergedClass} style={styleVars} data-percent={percent.toFixed(1)}>\r\n      {label && <div className=\"avakio-gage-label\">{label}</div>}\r\n      <div className=\"avakio-gage-shell\">\r\n        <svg viewBox=\"0 0 200 200\" role=\"img\" aria-label={label ? `${label} ${displayValue}` : displayValue}>\r\n          <circle\r\n            className=\"avakio-gage-track\"\r\n            cx=\"100\"\r\n            cy=\"100\"\r\n            r={radius}\r\n            strokeWidth={strokeWidth}\r\n          />\r\n          <circle\r\n            className=\"avakio-gage-value\"\r\n            cx=\"100\"\r\n            cy=\"100\"\r\n            r={radius}\r\n            strokeWidth={strokeWidth}\r\n            strokeDasharray={`${circumference} ${circumference}`}\r\n            strokeDashoffset={dashOffset}\r\n          />\r\n          {targetPosition && (\r\n            <circle\r\n              className=\"avakio-gage-target\"\r\n              cx={targetPosition.x}\r\n              cy={targetPosition.y}\r\n              r={6}\r\n              strokeWidth={2}\r\n            />\r\n          )}\r\n        </svg>\r\n        {showValue && (\r\n          <div className=\"avakio-gage-center\">\r\n            <div className=\"avakio-gage-value-text\">{displayValue}</div>\r\n            {subLabel && <div className=\"avakio-gage-sublabel\">{subLabel}</div>}\r\n          </div>\r\n        )}\r\n      </div>\r\n      {showMinMax && (\r\n        <div className=\"avakio-gage-minmax\">\r\n          <span>{min}</span>\r\n          <span>{max}</span>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useEffect, useMemo, useRef } from \"react\";\r\nimport \"./avakio-googlemap.css\";\r\n\r\ntype LatLng = { lat: number; lng: number };\r\n\r\ntype MapMarker = {\r\n  id?: string;\r\n  label?: string;\r\n  position: LatLng;\r\n};\r\n\r\nexport const avakioThemes = [\"material\", \"flat\", \"compact\", \"dark\", \"ocean\", \"sunset\"] as const;\r\nexport type AvakioTheme = (typeof avakioThemes)[number];\r\n\r\ndeclare global {\r\n  interface Window {\r\n    google?: any;\r\n    __avakioGooglePromise?: Promise<any>;\r\n  }\r\n}\r\n\r\nconst GOOGLE_SCRIPT_ID = \"avakio-googlemaps-script\";\r\n\r\nfunction loadGoogleMaps(apiKey: string) {\r\n  if (typeof window === \"undefined\") return Promise.reject(new Error(\"window not available\"));\r\n  if (window.google?.maps) return Promise.resolve(window.google);\r\n  if (window.__avakioGooglePromise) return window.__avakioGooglePromise;\r\n\r\n  window.__avakioGooglePromise = new Promise((resolve, reject) => {\r\n    const existing = document.getElementById(GOOGLE_SCRIPT_ID) as HTMLScriptElement | null;\r\n    if (existing) {\r\n      existing.addEventListener(\"load\", () => resolve(window.google));\r\n      existing.addEventListener(\"error\", reject);\r\n      return;\r\n    }\r\n\r\n    const script = document.createElement(\"script\");\r\n    script.id = GOOGLE_SCRIPT_ID;\r\n    script.src = `https://maps.googleapis.com/maps/api/js?key=${encodeURIComponent(apiKey)}`;\r\n    script.async = true;\r\n    script.defer = true;\r\n    script.onload = () => resolve(window.google);\r\n    script.onerror = reject;\r\n    document.head.appendChild(script);\r\n  });\r\n\r\n  return window.__avakioGooglePromise;\r\n}\r\n\r\nexport interface AvakioGoogleMapProps {\r\n  center: LatLng;\r\n  zoom?: number;\r\n  markers?: MapMarker[];\r\n  mapType?: \"roadmap\" | \"satellite\" | \"hybrid\" | \"terrain\";\r\n  height?: number | string;\r\n  className?: string;\r\n  style?: React.CSSProperties;\r\n  apiKey?: string | null;\r\n  theme?: AvakioTheme;\r\n  /** ID of the component */\r\n  id?: string;\r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n}\r\n\r\nexport function AvakioGoogleMap({\r\n  center,\r\n  zoom = 12,\r\n  markers = [],\r\n  mapType = \"roadmap\",\r\n  height = 360,\r\n  className,\r\n  style,\r\n  apiKey,\r\n  theme,\r\n  id,\r\n  testId,\r\n}: AvakioGoogleMapProps) {\r\n  const containerRef = useRef<HTMLDivElement | null>(null);\r\n  const mapRef = useRef<any>(null);\r\n  const markerRefs = useRef<any[]>([]);\r\n\r\n  const resolvedApiKey = apiKey ?? (typeof import.meta !== \"undefined\" ? (import.meta as any).env?.VITE_GOOGLE_MAPS_API_KEY : undefined) ?? null;\r\n\r\n  const iframeSrc = useMemo(() => {\r\n    const lat = center.lat.toFixed(6);\r\n    const lng = center.lng.toFixed(6);\r\n    const urlZoom = zoom ?? 12;\r\n    return `https://www.google.com/maps?q=${lat},${lng}&z=${urlZoom}&output=embed`;\r\n  }, [center.lat, center.lng, zoom]);\r\n\r\n  // Initialize interactive map when an API key is available.\r\n  useEffect(() => {\r\n    if (!resolvedApiKey || typeof window === \"undefined\") return;\r\n    let cancelled = false;\r\n\r\n    loadGoogleMaps(resolvedApiKey)\r\n      .then((google) => {\r\n        if (cancelled || !containerRef.current) return;\r\n\r\n        if (!mapRef.current) {\r\n          mapRef.current = new google.maps.Map(containerRef.current, {\r\n            center,\r\n            zoom,\r\n            mapTypeId: mapType,\r\n            streetViewControl: false,\r\n            fullscreenControl: false,\r\n          });\r\n        } else {\r\n          mapRef.current.setOptions({ center, zoom, mapTypeId: mapType });\r\n        }\r\n\r\n        // Reset markers\r\n        markerRefs.current.forEach((m) => m.setMap(null));\r\n        markerRefs.current = markers.map((marker) => new google.maps.Marker({\r\n          position: marker.position,\r\n          title: marker.label,\r\n          map: mapRef.current,\r\n        }));\r\n      })\r\n      .catch(() => {\r\n        // If script load fails we silently fall back to the embed iframe.\r\n      });\r\n\r\n    return () => {\r\n      cancelled = true;\r\n      markerRefs.current.forEach((m) => m.setMap(null));\r\n      markerRefs.current = [];\r\n    };\r\n  }, [resolvedApiKey, center.lat, center.lng, zoom, mapType, markers]);\r\n\r\n  const heightValue = typeof height === \"number\" ? `${height}px` : height;\r\n\r\n  return (\r\n    <div\r\n      id={id}\r\n      data-testid={testId}\r\n      className={[\"avakio-googlemap\", className].filter(Boolean).join(\" \")}\r\n      style={{ ...style, [\"--agm-height\" as string]: heightValue }}\r\n      data-admin-theme={theme}\r\n    >\r\n      {resolvedApiKey ? (\r\n        <div ref={containerRef} data-testid=\"avakio-googlemap-interactive\" className=\"avakio-googlemap-canvas\" />\r\n      ) : (\r\n        <iframe\r\n          data-testid=\"avakio-googlemap-embed\"\r\n          title=\"Google Map\"\r\n          src={iframeSrc}\r\n          className=\"avakio-googlemap-embed\"\r\n          allowFullScreen\r\n          loading=\"lazy\"\r\n          referrerPolicy=\"no-referrer-when-downgrade\"\r\n        />\r\n      )}\r\n\r\n      {markers.length > 0 && (\r\n        <div className=\"avakio-googlemap-markerlist\" aria-label=\"Markers\">\r\n          {markers.map((marker, idx) => (\r\n            <div key={marker.id ?? idx} className=\"avakio-googlemap-markeritem\">\r\n              <span className=\"avakio-googlemap-markerbadge\">{idx + 1}</span>\r\n              <div className=\"avakio-googlemap-markertext\">\r\n                <strong>{marker.label ?? `Marker ${idx + 1}`}</strong>\r\n                <span>{marker.position.lat}, {marker.position.lng}</span>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useState, useCallback, useMemo, useRef, useEffect } from \"react\";\r\nimport { ChevronRight, ChevronLeft } from \"lucide-react\";\r\nimport \"./avakio-grouplist.css\";\r\n\r\nexport interface GroupListItem {\r\n  /** Unique identifier for the item */\r\n  id: string | number;\r\n  /** Display value/label for the item */\r\n  value: string;\r\n  /** Optional icon to display */\r\n  icon?: React.ReactNode;\r\n  /** Child items - presence indicates this is a group header */\r\n  data?: GroupListItem[];\r\n  /** Whether the item is disabled */\r\n  disabled?: boolean;\r\n  /** Additional CSS class */\r\n  className?: string;\r\n  /** Any additional data to store */\r\n  [key: string]: any;\r\n}\r\n\r\nexport interface GroupListOpenState {\r\n  /** Array of parent IDs from root to current level */\r\n  parents: (string | number)[];\r\n  /** Items in the currently displayed branch */\r\n  branch: GroupListItem[];\r\n}\r\n\r\nexport interface AvakioGroupListProps {\r\n  /** Data source - hierarchical array of items */\r\n  data: GroupListItem[];\r\n  /** Currently selected item ID */\r\n  value?: string | number | null;\r\n  /** Default selected item ID (uncontrolled) */\r\n  defaultValue?: string | number | null;\r\n  /** Callback when an item is selected */\r\n  onSelect?: (item: GroupListItem) => void;\r\n  /** Callback when selection changes (item or null if navigating) */\r\n  onChange?: (value: string | number | null, item: GroupListItem | null) => void;\r\n  /** Callback when navigation state changes */\r\n  onNavigate?: (state: GroupListOpenState) => void;\r\n  /** Custom template for rendering items (leaf nodes) */\r\n  templateItem?: (item: GroupListItem) => React.ReactNode;\r\n  /** Custom template for rendering group headers (collapsed state - shows arrow) */\r\n  templateGroup?: (item: GroupListItem, count: number) => React.ReactNode;\r\n  /** Custom template for back button header (expanded state) */\r\n  templateBack?: (item: GroupListItem, count: number) => React.ReactNode;\r\n  /** Enable/disable item selection */\r\n  select?: boolean;\r\n  /** Enable animation when navigating */\r\n  animate?: boolean;\r\n  /** Animation duration in ms */\r\n  animationDuration?: number;\r\n  /** Show back navigation button */\r\n  showBack?: boolean;\r\n  /** Custom back button label */\r\n  backLabel?: string;\r\n  /** Width of the component */\r\n  width?: number | string;\r\n  /** Height of the component */\r\n  height?: number | string;\r\n  /** Enable scrolling */\r\n  scroll?: boolean;\r\n  /** Additional CSS class */\r\n  className?: string;\r\n  /** Inline styles */\r\n  style?: React.CSSProperties;\r\n  /** Component ID */\r\n  id?: string;\r\n  /** Test ID for testing */\r\n  testId?: string;\r\n}\r\n\r\nexport function AvakioGroupList({\r\n  data,\r\n  value: controlledValue,\r\n  defaultValue,\r\n  onSelect,\r\n  onChange,\r\n  onNavigate,\r\n  templateItem,\r\n  templateGroup,\r\n  templateBack,\r\n  select = true,\r\n  animate = true,\r\n  animationDuration = 250,\r\n  showBack = true,\r\n  backLabel = \"Back\",\r\n  width,\r\n  height,\r\n  scroll = true,\r\n  className,\r\n  style,\r\n  id,\r\n  testId,\r\n}: AvakioGroupListProps) {\r\n  // Track navigation stack (array of parent IDs)\r\n  const [parentStack, setParentStack] = useState<(string | number)[]>([]);\r\n  // Track current branch items\r\n  const [currentBranch, setCurrentBranch] = useState<GroupListItem[]>(data);\r\n  // Internal selected value for uncontrolled mode\r\n  const [internalValue, setInternalValue] = useState<string | number | null>(defaultValue ?? null);\r\n  // Animation state\r\n  const [animating, setAnimating] = useState(false);\r\n  const [animationDirection, setAnimationDirection] = useState<'forward' | 'backward'>('forward');\r\n  \r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n\r\n  // Controlled vs uncontrolled\r\n  const selectedValue = controlledValue !== undefined ? controlledValue : internalValue;\r\n\r\n  // Get items at a specific path\r\n  const getItemsAtPath = useCallback((path: (string | number)[]): GroupListItem[] => {\r\n    let items = data;\r\n    for (const parentId of path) {\r\n      const parent = items.find(item => item.id === parentId);\r\n      if (parent?.data) {\r\n        items = parent.data;\r\n      } else {\r\n        return [];\r\n      }\r\n    }\r\n    return items;\r\n  }, [data]);\r\n\r\n  // Get parent item at current level\r\n  const getCurrentParent = useCallback((): GroupListItem | null => {\r\n    if (parentStack.length === 0) return null;\r\n    \r\n    let items = data;\r\n    let parent: GroupListItem | null = null;\r\n    \r\n    for (const parentId of parentStack) {\r\n      parent = items.find(item => item.id === parentId) || null;\r\n      if (parent?.data) {\r\n        items = parent.data;\r\n      }\r\n    }\r\n    \r\n    return parent;\r\n  }, [data, parentStack]);\r\n\r\n  // Navigate into a group\r\n  const navigateInto = useCallback((item: GroupListItem) => {\r\n    if (!item.data || item.disabled) return;\r\n    \r\n    if (animate) {\r\n      setAnimating(true);\r\n      setAnimationDirection('forward');\r\n    }\r\n    \r\n    const newStack = [...parentStack, item.id];\r\n    setParentStack(newStack);\r\n    \r\n    setTimeout(() => {\r\n      setCurrentBranch(item.data!);\r\n      setAnimating(false);\r\n      \r\n      onNavigate?.({\r\n        parents: newStack,\r\n        branch: item.data!,\r\n      });\r\n    }, animate ? animationDuration : 0);\r\n  }, [parentStack, animate, animationDuration, onNavigate]);\r\n\r\n  // Navigate back one level\r\n  const navigateBack = useCallback(() => {\r\n    if (parentStack.length === 0) return;\r\n    \r\n    if (animate) {\r\n      setAnimating(true);\r\n      setAnimationDirection('backward');\r\n    }\r\n    \r\n    const newStack = parentStack.slice(0, -1);\r\n    setParentStack(newStack);\r\n    \r\n    setTimeout(() => {\r\n      const items = getItemsAtPath(newStack);\r\n      setCurrentBranch(items);\r\n      setAnimating(false);\r\n      \r\n      onNavigate?.({\r\n        parents: newStack,\r\n        branch: items,\r\n      });\r\n    }, animate ? animationDuration : 0);\r\n  }, [parentStack, animate, animationDuration, getItemsAtPath, onNavigate]);\r\n\r\n  // Handle item click\r\n  const handleItemClick = useCallback((item: GroupListItem) => {\r\n    if (item.disabled) return;\r\n    \r\n    // If item has children, navigate into it\r\n    if (item.data && item.data.length > 0) {\r\n      navigateInto(item);\r\n    } else if (select) {\r\n      // Select the item\r\n      setInternalValue(item.id);\r\n      onSelect?.(item);\r\n      onChange?.(item.id, item);\r\n    }\r\n  }, [navigateInto, select, onSelect, onChange]);\r\n\r\n  // Get open state\r\n  const getOpenState = useCallback((): GroupListOpenState => ({\r\n    parents: parentStack,\r\n    branch: currentBranch,\r\n  }), [parentStack, currentBranch]);\r\n\r\n  // Set open state programmatically\r\n  const setOpenState = useCallback((itemId: string | number) => {\r\n    // Find path to item\r\n    const findPath = (items: GroupListItem[], targetId: string | number, path: (string | number)[]): (string | number)[] | null => {\r\n      for (const item of items) {\r\n        if (item.id === targetId) {\r\n          return path;\r\n        }\r\n        if (item.data) {\r\n          const result = findPath(item.data, targetId, [...path, item.id]);\r\n          if (result) return result;\r\n        }\r\n      }\r\n      return null;\r\n    };\r\n    \r\n    const path = findPath(data, itemId, []);\r\n    if (path) {\r\n      setParentStack(path);\r\n      const items = getItemsAtPath(path);\r\n      setCurrentBranch(items);\r\n    }\r\n  }, [data, getItemsAtPath]);\r\n\r\n  // Reset to root level when data changes\r\n  useEffect(() => {\r\n    setParentStack([]);\r\n    setCurrentBranch(data);\r\n  }, [data]);\r\n\r\n  // Render a single item\r\n  const renderItem = useCallback((item: GroupListItem) => {\r\n    const isGroup = item.data && item.data.length > 0;\r\n    const isSelected = selectedValue === item.id;\r\n    const itemCount = item.data?.length || 0;\r\n    \r\n    const itemClass = [\r\n      'avakio-grouplist-item',\r\n      isGroup && 'avakio-grouplist-item-group',\r\n      isSelected && 'avakio-grouplist-item-selected',\r\n      item.disabled && 'avakio-grouplist-item-disabled',\r\n      item.className,\r\n    ].filter(Boolean).join(' ');\r\n\r\n    return (\r\n      <div\r\n        key={item.id}\r\n        className={itemClass}\r\n        onClick={() => handleItemClick(item)}\r\n        role={isGroup ? 'button' : 'option'}\r\n        aria-selected={isSelected}\r\n        aria-disabled={item.disabled}\r\n        tabIndex={item.disabled ? -1 : 0}\r\n        onKeyDown={(e) => {\r\n          if (e.key === 'Enter' || e.key === ' ') {\r\n            e.preventDefault();\r\n            handleItemClick(item);\r\n          }\r\n        }}\r\n      >\r\n        <div className=\"avakio-grouplist-item-content\">\r\n          {item.icon && <span className=\"avakio-grouplist-item-icon\">{item.icon}</span>}\r\n          <span className=\"avakio-grouplist-item-value\">\r\n            {isGroup\r\n              ? (templateGroup ? templateGroup(item, itemCount) : item.value)\r\n              : (templateItem ? templateItem(item) : item.value)\r\n            }\r\n          </span>\r\n          {isGroup && <span className=\"avakio-grouplist-item-count\">({itemCount})</span>}\r\n        </div>\r\n        {isGroup && (\r\n          <ChevronRight className=\"avakio-grouplist-item-arrow\" size={18} />\r\n        )}\r\n      </div>\r\n    );\r\n  }, [selectedValue, templateItem, templateGroup, handleItemClick]);\r\n\r\n  // Render back header\r\n  const renderBackHeader = useCallback(() => {\r\n    if (!showBack || parentStack.length === 0) return null;\r\n    \r\n    const currentParent = getCurrentParent();\r\n    const itemCount = currentBranch.length;\r\n    \r\n    return (\r\n      <div\r\n        className=\"avakio-grouplist-back\"\r\n        onClick={navigateBack}\r\n        role=\"button\"\r\n        tabIndex={0}\r\n        onKeyDown={(e) => {\r\n          if (e.key === 'Enter' || e.key === ' ') {\r\n            e.preventDefault();\r\n            navigateBack();\r\n          }\r\n        }}\r\n      >\r\n        <ChevronLeft className=\"avakio-grouplist-back-arrow\" size={18} />\r\n        <span className=\"avakio-grouplist-back-content\">\r\n          {currentParent && templateBack\r\n            ? templateBack(currentParent, itemCount)\r\n            : (currentParent?.value || backLabel)\r\n          }\r\n        </span>\r\n        <span className=\"avakio-grouplist-back-count\">({itemCount})</span>\r\n      </div>\r\n    );\r\n  }, [showBack, parentStack, currentBranch, getCurrentParent, navigateBack, templateBack, backLabel]);\r\n\r\n  // Build class names\r\n  const containerClass = useMemo(() => [\r\n    'avakio-grouplist',\r\n    animating && `avakio-grouplist-animating avakio-grouplist-${animationDirection}`,\r\n    scroll && 'avakio-grouplist-scroll',\r\n    className,\r\n  ].filter(Boolean).join(' '), [animating, animationDirection, scroll, className]);\r\n\r\n  // Build styles\r\n  const containerStyle: React.CSSProperties = useMemo(() => ({\r\n    ...style,\r\n    ...(width !== undefined ? { width: typeof width === 'number' ? `${width}px` : width } : {}),\r\n    ...(height !== undefined ? { height: typeof height === 'number' ? `${height}px` : height } : {}),\r\n    ...(animate ? { '--grouplist-animation-duration': `${animationDuration}ms` } as React.CSSProperties : {}),\r\n  }), [style, width, height, animate, animationDuration]);\r\n\r\n  return (\r\n    <div\r\n      ref={containerRef}\r\n      id={id}\r\n      data-testid={testId}\r\n      className={containerClass}\r\n      style={containerStyle}\r\n      role=\"listbox\"\r\n      aria-label=\"Group list\"\r\n    >\r\n      {renderBackHeader()}\r\n      <div className=\"avakio-grouplist-items\">\r\n        {currentBranch.map(renderItem)}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useState, useEffect, useCallback, useRef, forwardRef, useImperativeHandle } from 'react';\r\nimport { createPortal } from 'react-dom';\r\nimport './avakio-hint.css';\r\n\r\nexport type AvakioHintTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\n\r\n/**\r\n * Step configuration for AvakioHint\r\n */\r\nexport interface AvakioHintStep {\r\n  /** CSS selector or element ID (without #) for the element to highlight */\r\n  el: string;\r\n  /** Title of the hint step */\r\n  title?: string;\r\n  /** Description/instruction text */\r\n  text?: string | React.ReactNode;\r\n  /** Event that triggers moving to the next step: 'click' or 'enter' */\r\n  event?: 'click' | 'enter' | 'none';\r\n  /** Optional selector for the element that triggers the event (defaults to el) */\r\n  eventEl?: string;\r\n  /** Padding around the highlighted element - can be a number (all sides) or array [top, right, bottom, left] */\r\n  padding?: number | [number, number, number, number];\r\n  /** Custom position for the hint popup */\r\n  position?: 'top' | 'bottom' | 'left' | 'right' | 'auto';\r\n  /** Custom top offset for the hint popup */\r\n  top?: number;\r\n  /** Custom left offset for the hint popup */\r\n  left?: number;\r\n}\r\n\r\nexport interface AvakioHintProps {\r\n  /** Unique identifier */\r\n  id?: string;\r\n  /** Test ID for testing */\r\n  testId?: string;\r\n  /** Array of hint steps */\r\n  steps: AvakioHintStep[];\r\n  /** Theme to apply */\r\n  theme?: AvakioHintTheme;\r\n  /** Whether to show the Previous button */\r\n  prevButton?: boolean | string;\r\n  /** Whether to show the Next button */\r\n  nextButton?: boolean | string;\r\n  /** Label for the last step's Next button */\r\n  endLabel?: string;\r\n  /** Time in ms before auto-advancing to next step (0 = manual only) */\r\n  stepTimeout?: number;\r\n  /** Whether the hint is visible */\r\n  visible?: boolean;\r\n  /** Callback when hint starts */\r\n  onStart?: () => void;\r\n  /** Callback before hint starts */\r\n  onBeforeStart?: () => boolean | void;\r\n  /** Callback after hint starts */\r\n  onAfterStart?: () => void;\r\n  /** Callback when hint ends (last step completed) */\r\n  onEnd?: (step: number) => void;\r\n  /** Callback when hint is skipped/closed */\r\n  onSkip?: (step: number) => void;\r\n  /** Callback when moving to next step */\r\n  onNext?: (step: number) => void;\r\n  /** Callback when moving to previous step */\r\n  onPrevious?: (step: number) => void;\r\n  /** Callback when step changes */\r\n  onStepChange?: (step: number) => void;\r\n}\r\n\r\nexport interface AvakioHintRef {\r\n  /** Start showing hints from the beginning */\r\n  start: () => void;\r\n  /** End the hint tour */\r\n  end: () => void;\r\n  /** Resume from a specific step (1-indexed) */\r\n  resume: (step?: number) => void;\r\n  /** Get current step number (1-indexed) */\r\n  getCurrentStep: () => number;\r\n  /** Get all steps */\r\n  getSteps: () => AvakioHintStep[];\r\n  /** Set new steps */\r\n  setSteps: (steps: AvakioHintStep[]) => void;\r\n  /** Show the hint */\r\n  show: () => void;\r\n  /** Hide the hint */\r\n  hide: () => void;\r\n  /** Check if hint is visible */\r\n  isVisible: () => boolean;\r\n}\r\n\r\nexport const AvakioHint = forwardRef<AvakioHintRef, AvakioHintProps>((props, ref) => {\r\n  const {\r\n    id,\r\n    testId,\r\n    steps: initialSteps,\r\n    theme = 'material',\r\n    prevButton = true,\r\n    nextButton = true,\r\n    endLabel = 'End Tour',\r\n    stepTimeout = 0,\r\n    visible: controlledVisible,\r\n    onStart,\r\n    onBeforeStart,\r\n    onAfterStart,\r\n    onEnd,\r\n    onSkip,\r\n    onNext,\r\n    onPrevious,\r\n    onStepChange,\r\n  } = props;\r\n\r\n  const [steps, setSteps] = useState<AvakioHintStep[]>(initialSteps);\r\n  const [currentStep, setCurrentStep] = useState(0); // 0-indexed internally\r\n  const [isVisible, setIsVisible] = useState(false);\r\n  const [highlightRect, setHighlightRect] = useState<DOMRect | null>(null);\r\n  const [popupPosition, setPopupPosition] = useState({ top: 0, left: 0 });\r\n  const popupRef = useRef<HTMLDivElement>(null);\r\n  const timeoutRef = useRef<NodeJS.Timeout | null>(null);\r\n\r\n  // Sync with controlled visible prop\r\n  useEffect(() => {\r\n    if (controlledVisible !== undefined) {\r\n      setIsVisible(controlledVisible);\r\n    }\r\n  }, [controlledVisible]);\r\n\r\n  // Update steps when props change\r\n  useEffect(() => {\r\n    setSteps(initialSteps);\r\n  }, [initialSteps]);\r\n\r\n  // Get the target element for the current step\r\n  const getTargetElement = useCallback((selector: string): Element | null => {\r\n    if (!selector) return null;\r\n    \r\n    // Try as CSS selector first\r\n    let element = document.querySelector(selector);\r\n    if (element) return element;\r\n    \r\n    // Try as ID (without #)\r\n    element = document.getElementById(selector);\r\n    if (element) return element;\r\n    \r\n    // Try with # prefix\r\n    if (!selector.startsWith('#') && !selector.startsWith('.')) {\r\n      element = document.querySelector(`#${selector}`);\r\n      if (element) return element;\r\n    }\r\n    \r\n    return null;\r\n  }, []);\r\n\r\n  // Calculate highlight rectangle for current step\r\n  const updateHighlight = useCallback(() => {\r\n    if (!isVisible || currentStep >= steps.length) {\r\n      setHighlightRect(null);\r\n      return;\r\n    }\r\n\r\n    const step = steps[currentStep];\r\n    const element = getTargetElement(step.el);\r\n    \r\n    if (element) {\r\n      const rect = element.getBoundingClientRect();\r\n      const padding = step.padding || 8;\r\n      \r\n      // Handle array padding [top, right, bottom, left]\r\n      const [pTop, pRight, pBottom, pLeft] = Array.isArray(padding) \r\n        ? padding \r\n        : [padding, padding, padding, padding];\r\n      \r\n      setHighlightRect(new DOMRect(\r\n        rect.left - pLeft + window.scrollX,\r\n        rect.top - pTop + window.scrollY,\r\n        rect.width + pLeft + pRight,\r\n        rect.height + pTop + pBottom\r\n      ));\r\n    } else {\r\n      setHighlightRect(null);\r\n    }\r\n  }, [isVisible, currentStep, steps, getTargetElement]);\r\n\r\n  // Calculate popup position\r\n  const updatePopupPosition = useCallback(() => {\r\n    if (!highlightRect || !popupRef.current) return;\r\n\r\n    const popup = popupRef.current;\r\n    const popupRect = popup.getBoundingClientRect();\r\n    const step = steps[currentStep];\r\n    const viewportWidth = window.innerWidth;\r\n    const viewportHeight = window.innerHeight;\r\n    \r\n    let top = 0;\r\n    let left = 0;\r\n    \r\n    // Calculate based on position preference or auto\r\n    const position = step.position || 'auto';\r\n    const scrollTop = window.scrollY;\r\n    const scrollLeft = window.scrollX;\r\n    \r\n    // Adjust highlightRect for scroll position for calculations\r\n    const highlightTop = highlightRect.top - scrollTop;\r\n    const highlightLeft = highlightRect.left - scrollLeft;\r\n    const highlightBottom = highlightTop + highlightRect.height;\r\n    const highlightRight = highlightLeft + highlightRect.width;\r\n    \r\n    const gap = 16; // Gap between highlight and popup\r\n    \r\n    if (position === 'auto') {\r\n      // Prefer bottom, then top, then right, then left\r\n      const spaceBelow = viewportHeight - highlightBottom;\r\n      const spaceAbove = highlightTop;\r\n      const spaceRight = viewportWidth - highlightRight;\r\n      const spaceLeft = highlightLeft;\r\n      \r\n      if (spaceBelow >= popupRect.height + gap) {\r\n        // Position below\r\n        top = highlightRect.top + highlightRect.height + gap;\r\n        left = highlightRect.left + (highlightRect.width - popupRect.width) / 2;\r\n      } else if (spaceAbove >= popupRect.height + gap) {\r\n        // Position above\r\n        top = highlightRect.top - popupRect.height - gap;\r\n        left = highlightRect.left + (highlightRect.width - popupRect.width) / 2;\r\n      } else if (spaceRight >= popupRect.width + gap) {\r\n        // Position right\r\n        top = highlightRect.top + (highlightRect.height - popupRect.height) / 2;\r\n        left = highlightRect.left + highlightRect.width + gap;\r\n      } else {\r\n        // Position left\r\n        top = highlightRect.top + (highlightRect.height - popupRect.height) / 2;\r\n        left = highlightRect.left - popupRect.width - gap;\r\n      }\r\n    } else {\r\n      switch (position) {\r\n        case 'bottom':\r\n          top = highlightRect.top + highlightRect.height + gap;\r\n          left = highlightRect.left + (highlightRect.width - popupRect.width) / 2;\r\n          break;\r\n        case 'top':\r\n          top = highlightRect.top - popupRect.height - gap;\r\n          left = highlightRect.left + (highlightRect.width - popupRect.width) / 2;\r\n          break;\r\n        case 'right':\r\n          top = highlightRect.top + (highlightRect.height - popupRect.height) / 2;\r\n          left = highlightRect.left + highlightRect.width + gap;\r\n          break;\r\n        case 'left':\r\n          top = highlightRect.top + (highlightRect.height - popupRect.height) / 2;\r\n          left = highlightRect.left - popupRect.width - gap;\r\n          break;\r\n      }\r\n    }\r\n    \r\n    // Apply custom offsets if provided\r\n    if (step.top !== undefined) top = step.top + scrollTop;\r\n    if (step.left !== undefined) left = step.left + scrollLeft;\r\n    \r\n    // Keep popup within viewport\r\n    top = Math.max(scrollTop + 16, Math.min(top, scrollTop + viewportHeight - popupRect.height - 16));\r\n    left = Math.max(scrollLeft + 16, Math.min(left, scrollLeft + viewportWidth - popupRect.width - 16));\r\n    \r\n    setPopupPosition({ top, left });\r\n  }, [highlightRect, currentStep, steps]);\r\n\r\n  // Update highlight and popup position\r\n  useEffect(() => {\r\n    updateHighlight();\r\n  }, [updateHighlight]);\r\n\r\n  useEffect(() => {\r\n    if (highlightRect) {\r\n      // Use requestAnimationFrame to ensure popup is rendered before calculating position\r\n      requestAnimationFrame(() => {\r\n        updatePopupPosition();\r\n      });\r\n    }\r\n  }, [highlightRect, updatePopupPosition]);\r\n\r\n  // Handle window resize and scroll\r\n  useEffect(() => {\r\n    if (!isVisible) return;\r\n\r\n    const handleUpdate = () => {\r\n      updateHighlight();\r\n    };\r\n\r\n    window.addEventListener('resize', handleUpdate);\r\n    window.addEventListener('scroll', handleUpdate, true);\r\n\r\n    return () => {\r\n      window.removeEventListener('resize', handleUpdate);\r\n      window.removeEventListener('scroll', handleUpdate, true);\r\n    };\r\n  }, [isVisible, updateHighlight]);\r\n\r\n  // Go to next step function (defined before event listeners)\r\n  const goToNextStep = useCallback(() => {\r\n    if (currentStep >= steps.length - 1) {\r\n      // Last step completed\r\n      onEnd?.(currentStep + 1);\r\n      setIsVisible(false);\r\n      setCurrentStep(0);\r\n    } else {\r\n      const nextStep = currentStep + 1;\r\n      onNext?.(currentStep + 1);\r\n      onStepChange?.(nextStep + 1);\r\n      setCurrentStep(nextStep);\r\n    }\r\n  }, [currentStep, steps.length, onEnd, onNext, onStepChange]);\r\n\r\n  // Handle step event listeners\r\n  useEffect(() => {\r\n    if (!isVisible || currentStep >= steps.length) return;\r\n\r\n    const step = steps[currentStep];\r\n    if (step.event === 'none' || !step.event) return;\r\n\r\n    const eventSelector = step.eventEl || step.el;\r\n    const element = getTargetElement(eventSelector);\r\n    \r\n    if (!element) return;\r\n\r\n    const handleClick = () => {\r\n      if (step.event === 'click') {\r\n        goToNextStep();\r\n      }\r\n    };\r\n\r\n    const handleKeyDown = (e: Event) => {\r\n      if (step.event === 'enter' && (e as KeyboardEvent).key === 'Enter') {\r\n        goToNextStep();\r\n      }\r\n    };\r\n\r\n    if (step.event === 'click') {\r\n      element.addEventListener('click', handleClick, true); // Use capture phase\r\n    } else if (step.event === 'enter') {\r\n      element.addEventListener('keydown', handleKeyDown);\r\n    }\r\n\r\n    return () => {\r\n      element.removeEventListener('click', handleClick, true);\r\n      element.removeEventListener('keydown', handleKeyDown);\r\n    };\r\n  }, [isVisible, currentStep, steps, getTargetElement, goToNextStep]);\r\n\r\n  // Handle step timeout\r\n  useEffect(() => {\r\n    if (!isVisible || stepTimeout <= 0 || currentStep >= steps.length) return;\r\n\r\n    timeoutRef.current = setTimeout(() => {\r\n      goToNextStep();\r\n    }, stepTimeout);\r\n\r\n    return () => {\r\n      if (timeoutRef.current) {\r\n        clearTimeout(timeoutRef.current);\r\n      }\r\n    };\r\n  }, [isVisible, stepTimeout, currentStep, steps.length, goToNextStep]);\r\n\r\n  // Handle keyboard events (Escape to close)\r\n  useEffect(() => {\r\n    if (!isVisible) return;\r\n\r\n    const handleKeyDown = (e: KeyboardEvent) => {\r\n      if (e.key === 'Escape') {\r\n        handleSkip();\r\n      }\r\n    };\r\n\r\n    document.addEventListener('keydown', handleKeyDown);\r\n    return () => document.removeEventListener('keydown', handleKeyDown);\r\n  }, [isVisible]);\r\n\r\n  const goToPreviousStep = useCallback(() => {\r\n    if (currentStep > 0) {\r\n      const prevStep = currentStep - 1;\r\n      onPrevious?.(currentStep + 1);\r\n      onStepChange?.(prevStep + 1);\r\n      setCurrentStep(prevStep);\r\n    }\r\n  }, [currentStep, onPrevious, onStepChange]);\r\n\r\n  const handleSkip = useCallback(() => {\r\n    onSkip?.(currentStep + 1);\r\n    setIsVisible(false);\r\n    setCurrentStep(0);\r\n  }, [currentStep, onSkip]);\r\n\r\n  const start = useCallback(() => {\r\n    const shouldStart = onBeforeStart?.();\r\n    if (shouldStart === false) return;\r\n    \r\n    onStart?.();\r\n    setCurrentStep(0);\r\n    setIsVisible(true);\r\n    onAfterStart?.();\r\n  }, [onBeforeStart, onStart, onAfterStart]);\r\n\r\n  const end = useCallback(() => {\r\n    onEnd?.(currentStep + 1);\r\n    setIsVisible(false);\r\n    setCurrentStep(0);\r\n  }, [currentStep, onEnd]);\r\n\r\n  const resume = useCallback((step?: number) => {\r\n    const targetStep = step !== undefined ? Math.max(1, Math.min(step, steps.length)) - 1 : 0;\r\n    setCurrentStep(targetStep);\r\n    setIsVisible(true);\r\n    onStepChange?.(targetStep + 1);\r\n  }, [steps.length, onStepChange]);\r\n\r\n  // Expose methods via ref\r\n  useImperativeHandle(ref, () => ({\r\n    start,\r\n    end,\r\n    resume,\r\n    getCurrentStep: () => currentStep + 1,\r\n    getSteps: () => [...steps],\r\n    setSteps: (newSteps: AvakioHintStep[]) => setSteps(newSteps),\r\n    show: () => setIsVisible(true),\r\n    hide: () => setIsVisible(false),\r\n    isVisible: () => isVisible,\r\n  }), [start, end, resume, currentStep, steps, isVisible]);\r\n\r\n  if (!isVisible || steps.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  const step = steps[currentStep];\r\n  const isFirstStep = currentStep === 0;\r\n  const isLastStep = currentStep === steps.length - 1;\r\n\r\n  const prevLabel = typeof prevButton === 'string' ? prevButton : 'Previous';\r\n  const nextLabel = typeof nextButton === 'string' ? nextButton : (isLastStep ? endLabel : 'Next');\r\n  const showPrev = prevButton !== false && !isFirstStep;\r\n  const showNext = nextButton !== false;\r\n\r\n  return createPortal(\r\n    <div\r\n      id={id}\r\n      data-testid={testId}\r\n      className={`avakio-hint avakio-hint-theme-${theme}`}\r\n    >\r\n      {/* Overlay with cutout */}\r\n      <div className=\"avakio-hint-overlay\">\r\n        <svg className=\"avakio-hint-mask\" width=\"100%\" height=\"100%\">\r\n          <defs>\r\n            <mask id={`avakio-hint-mask-${id || 'default'}`}>\r\n              <rect x=\"0\" y=\"0\" width=\"100%\" height=\"100%\" fill=\"white\" />\r\n              {highlightRect && (\r\n                <rect\r\n                  x={highlightRect.left}\r\n                  y={highlightRect.top}\r\n                  width={highlightRect.width}\r\n                  height={highlightRect.height}\r\n                  rx=\"8\"\r\n                  ry=\"8\"\r\n                  fill=\"black\"\r\n                />\r\n              )}\r\n            </mask>\r\n          </defs>\r\n          <rect\r\n            x=\"0\"\r\n            y=\"0\"\r\n            width=\"100%\"\r\n            height=\"100%\"\r\n            fill=\"rgba(0, 0, 0, 0.5)\"\r\n            mask={`url(#avakio-hint-mask-${id || 'default'})`}\r\n          />\r\n        </svg>\r\n      </div>\r\n\r\n      {/* Highlight border */}\r\n      {highlightRect && (\r\n        <div\r\n          className=\"avakio-hint-highlight\"\r\n          style={{\r\n            top: highlightRect.top,\r\n            left: highlightRect.left,\r\n            width: highlightRect.width,\r\n            height: highlightRect.height,\r\n          }}\r\n        />\r\n      )}\r\n\r\n      {/* Popup */}\r\n      <div\r\n        ref={popupRef}\r\n        className=\"avakio-hint-popup\"\r\n        style={{\r\n          top: popupPosition.top,\r\n          left: popupPosition.left,\r\n        }}\r\n      >\r\n        <button\r\n          className=\"avakio-hint-close\"\r\n          onClick={handleSkip}\r\n          aria-label=\"Close hint\"\r\n        >\r\n          Ã—\r\n        </button>\r\n\r\n        {step.title && (\r\n          <div className=\"avakio-hint-title\">{step.title}</div>\r\n        )}\r\n\r\n        {step.text && (\r\n          <div className=\"avakio-hint-text\">\r\n            {typeof step.text === 'string' ? step.text : step.text}\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"avakio-hint-footer\">\r\n          <div className=\"avakio-hint-step-indicator\">\r\n            {currentStep + 1} / {steps.length}\r\n          </div>\r\n          <div className=\"avakio-hint-buttons\">\r\n            {showPrev && (\r\n              <button\r\n                className=\"avakio-hint-btn avakio-hint-btn-prev\"\r\n                onClick={goToPreviousStep}\r\n              >\r\n                {prevLabel}\r\n              </button>\r\n            )}\r\n            {showNext && (\r\n              <button\r\n                className=\"avakio-hint-btn avakio-hint-btn-next\"\r\n                onClick={goToNextStep}\r\n              >\r\n                {nextLabel}\r\n              </button>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>,\r\n    document.body\r\n  );\r\n});\r\n\r\nAvakioHint.displayName = 'AvakioHint';\r\n\r\nexport default AvakioHint;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { useEffect, useRef, useState, useCallback } from 'react';\r\nimport './avakio-view.css';\r\n\r\nexport interface AvakioViewProps {\r\n  /** The content to display inside the view */\r\n  children?: React.ReactNode;\r\n  \r\n  /** Custom CSS class name */\r\n  className?: string;\r\n  \r\n  /** Custom CSS styles object */\r\n  css?: React.CSSProperties;\r\n  \r\n  /** Width of the view */\r\n  width?: number | string;\r\n  \r\n  /** Height of the view */\r\n  height?: number | string;\r\n  \r\n  /** Minimum width */\r\n  minWidth?: number | string;\r\n  \r\n  /** Minimum height */\r\n  minHeight?: number | string;\r\n  \r\n  /** Maximum width */\r\n  maxWidth?: number | string;\r\n  \r\n  /** Maximum height */\r\n  maxHeight?: number | string;\r\n  \r\n  /** Whether to remove borders */\r\n  borderless?: boolean;\r\n  \r\n  /** Whether the view is initially hidden */\r\n  hidden?: boolean;\r\n  \r\n  /** Whether the view is disabled */\r\n  disabled?: boolean;\r\n  \r\n  /** View gravity for flexible layouts */\r\n  gravity?: number;\r\n  \r\n  /** ID of the view */\r\n  id?: string;\r\n  \r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n  \r\n  /** Animation type for showing/hiding */\r\n  animate?: boolean | 'fade' | 'slide' | 'flip';\r\n  \r\n  /** Container element or selector */\r\n  container?: string | HTMLElement;\r\n  \r\n  /** Padding inside the view - can be a number (all sides), string, or array [top, right, bottom, left] */\r\n  padding?: number | string | [number, number, number, number];\r\n  \r\n  /** Theme to apply */\r\n  theme?: 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\n  \r\n  /** View type (header, section, clean) */\r\n  type?: 'header' | 'section' | 'clean';\r\n  \r\n  /** Event handlers */\r\n  onShow?: () => void;\r\n  onHide?: () => void;\r\n  onResize?: (width: number, height: number) => void;\r\n  onClick?: (e: React.MouseEvent) => void;\r\n  onFocus?: () => void;\r\n  onBlur?: () => void;\r\n  onKeyPress?: (e: React.KeyboardEvent) => void;\r\n}\r\n\r\nexport function AvakioView({\r\n  children,\r\n  className = '',\r\n  css,\r\n  width,\r\n  height,\r\n  minWidth,\r\n  minHeight,\r\n  maxWidth,\r\n  maxHeight,\r\n  borderless = false,\r\n  hidden = false,\r\n  disabled = false,\r\n  gravity,\r\n  id,\r\n  testId,\r\n  animate = false,\r\n  padding,\r\n  theme = 'material',\r\n  type = 'clean',\r\n  onShow,\r\n  onHide,\r\n  onResize,\r\n  onClick,\r\n  onFocus,\r\n  onBlur,\r\n  onKeyPress,\r\n}: AvakioViewProps) {\r\n  const viewRef = useRef<HTMLDivElement>(null);\r\n  const [isVisible, setIsVisible] = useState(!hidden);\r\n  const [isEnabled, setIsEnabled] = useState(!disabled);\r\n  const [dimensions, setDimensions] = useState({ width: 0, height: 0 });\r\n\r\n  // Handle visibility\r\n  useEffect(() => {\r\n    setIsVisible(!hidden);\r\n  }, [hidden]);\r\n\r\n  // Handle disabled state\r\n  useEffect(() => {\r\n    setIsEnabled(!disabled);\r\n  }, [disabled]);\r\n\r\n  // Resize observer\r\n  useEffect(() => {\r\n    if (!viewRef.current) return;\r\n\r\n    const resizeObserver = new ResizeObserver((entries) => {\r\n      for (const entry of entries) {\r\n        const { width, height } = entry.contentRect;\r\n        setDimensions({ width, height });\r\n        if (onResize) {\r\n          onResize(width, height);\r\n        }\r\n      }\r\n    });\r\n\r\n    resizeObserver.observe(viewRef.current);\r\n\r\n    return () => {\r\n      resizeObserver.disconnect();\r\n    };\r\n  }, [onResize]);\r\n\r\n  // Show/hide callbacks\r\n  useEffect(() => {\r\n    if (isVisible && onShow) {\r\n      onShow();\r\n    } else if (!isVisible && onHide) {\r\n      onHide();\r\n    }\r\n  }, [isVisible, onShow, onHide]);\r\n\r\n  // Public methods via ref (can be exposed if needed)\r\n  const show = useCallback(() => {\r\n    setIsVisible(true);\r\n  }, []);\r\n\r\n  const hide = useCallback(() => {\r\n    setIsVisible(false);\r\n  }, []);\r\n\r\n  const enable = useCallback(() => {\r\n    setIsEnabled(true);\r\n  }, []);\r\n\r\n  const disable = useCallback(() => {\r\n    setIsEnabled(false);\r\n  }, []);\r\n\r\n  const resize = useCallback((newWidth?: number | string, newHeight?: number | string) => {\r\n    if (viewRef.current) {\r\n      if (newWidth) viewRef.current.style.width = typeof newWidth === 'number' ? `${newWidth}px` : newWidth;\r\n      if (newHeight) viewRef.current.style.height = typeof newHeight === 'number' ? `${newHeight}px` : newHeight;\r\n    }\r\n  }, []);\r\n\r\n  // Build inline styles\r\n  const inlineStyles: React.CSSProperties = {\r\n    ...(css && typeof css === 'object' && !Array.isArray(css) ? css : {}),\r\n    ...(typeof width !== 'undefined' && { width: typeof width === 'number' ? `${width}px` : width }),\r\n    ...(typeof height !== 'undefined' && { height: typeof height === 'number' ? `${height}px` : height }),\r\n    ...(typeof minWidth !== 'undefined' && { minWidth: typeof minWidth === 'number' ? `${minWidth}px` : minWidth }),\r\n    ...(typeof minHeight !== 'undefined' && { minHeight: typeof minHeight === 'number' ? `${minHeight}px` : minHeight }),\r\n    ...(typeof maxWidth !== 'undefined' && { maxWidth: typeof maxWidth === 'number' ? `${maxWidth}px` : maxWidth }),\r\n    ...(typeof maxHeight !== 'undefined' && { maxHeight: typeof maxHeight === 'number' ? `${maxHeight}px` : maxHeight }),\r\n    ...(typeof padding !== 'undefined' && { \r\n      padding: Array.isArray(padding) \r\n        ? `${padding[0]}px ${padding[1]}px ${padding[2]}px ${padding[3]}px`\r\n        : typeof padding === 'number' ? `${padding}px` : padding \r\n    }),\r\n    ...(typeof gravity !== 'undefined' && { flex: gravity }),\r\n  };\r\n\r\n  // Build class names\r\n  const getAnimationClass = () => {\r\n    if (!animate) return '';\r\n    if (animate === true) return 'avakio-view-animate-fade';\r\n    if (animate === 'fade') return 'avakio-view-animate-fade';\r\n    if (animate === 'slide') return 'avakio-view-animate-slide';\r\n    if (animate === 'flip') return 'avakio-view-animate-flip';\r\n    return '';\r\n  };\r\n\r\n  const classNames = [\r\n    'avakio-view',\r\n    `avakio-view-theme-${theme}`,\r\n    type ? `avakio-view-type-${type}` : '',\r\n    borderless ? 'avakio-view-borderless' : '',\r\n    !isVisible ? 'avakio-view-hidden' : '',\r\n    !isEnabled ? 'avakio-view-disabled' : '',\r\n    getAnimationClass(),\r\n    className,\r\n  ]\r\n    .filter(Boolean)\r\n    .join(' ');\r\n\r\n  // Handle focus\r\n  const handleFocus = useCallback(() => {\r\n    if (onFocus && isEnabled) {\r\n      onFocus();\r\n    }\r\n  }, [onFocus, isEnabled]);\r\n\r\n  const handleBlur = useCallback(() => {\r\n    if (onBlur && isEnabled) {\r\n      onBlur();\r\n    }\r\n  }, [onBlur, isEnabled]);\r\n\r\n  const handleClick = useCallback(\r\n    (e: React.MouseEvent) => {\r\n      if (onClick && isEnabled) {\r\n        onClick(e);\r\n      }\r\n    },\r\n    [onClick, isEnabled]\r\n  );\r\n\r\n  const handleKeyPress = useCallback(\r\n    (e: React.KeyboardEvent) => {\r\n      if (onKeyPress && isEnabled) {\r\n        onKeyPress(e);\r\n      }\r\n    },\r\n    [onKeyPress, isEnabled]\r\n  );\r\n\r\n  if (!isVisible) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div\r\n      ref={viewRef}\r\n      id={id}\r\n      data-testid={testId}\r\n      className={classNames}\r\n      style={inlineStyles}\r\n      onClick={handleClick}\r\n      onFocus={handleFocus}\r\n      onBlur={handleBlur}\r\n      onKeyDown={handleKeyPress}\r\n      tabIndex={isEnabled ? 0 : -1}\r\n      role=\"region\"\r\n      aria-disabled={!isEnabled}\r\n    >\r\n      {children}\r\n    </div>\r\n  );\r\n}\r\n\r\n// Export a version with imperative handle for advanced usage\r\nexport interface AvakioViewHandle {\r\n  show: () => void;\r\n  hide: () => void;\r\n  enable: () => void;\r\n  disable: () => void;\r\n  resize: (width?: number | string, height?: number | string) => void;\r\n  getNode: () => HTMLDivElement | null;\r\n  isVisible: () => boolean;\r\n  isEnabled: () => boolean;\r\n}\r\n\r\nexport const AvakioViewWithRef = React.forwardRef<AvakioViewHandle, AvakioViewProps>(\r\n  (props, ref) => {\r\n    const viewRef = useRef<HTMLDivElement>(null);\r\n    const [isVisible, setIsVisible] = useState(!props.hidden);\r\n    const [isEnabled, setIsEnabled] = useState(!props.disabled);\r\n\r\n    React.useImperativeHandle(ref, () => ({\r\n      show: () => setIsVisible(true),\r\n      hide: () => setIsVisible(false),\r\n      enable: () => setIsEnabled(true),\r\n      disable: () => setIsEnabled(false),\r\n      resize: (newWidth?: number | string, newHeight?: number | string) => {\r\n        if (viewRef.current) {\r\n          if (newWidth) viewRef.current.style.width = typeof newWidth === 'number' ? `${newWidth}px` : newWidth;\r\n          if (newHeight) viewRef.current.style.height = typeof newHeight === 'number' ? `${newHeight}px` : newHeight;\r\n        }\r\n      },\r\n      getNode: () => viewRef.current,\r\n      isVisible: () => isVisible,\r\n      isEnabled: () => isEnabled,\r\n    }));\r\n\r\n    return <AvakioView {...props} hidden={!isVisible} disabled={!isEnabled} />;\r\n  }\r\n);\r\n\r\nAvakioViewWithRef.displayName = 'AvakioViewWithRef';\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React from 'react';\r\nimport { AvakioView } from '../../views/avakio-view/avakio-view';\r\n\r\nexport interface AvakioViewHeaderProps {\r\n  /** Component ID */\r\n  id?: string;\r\n  /** Test ID for testing */\r\n  testId?: string;\r\n  /** Show/hide the label */\r\n  showLabel?: boolean;\r\n  /** Show/hide the title */\r\n  showTitle?: boolean;\r\n  /** Show/hide the subtitle */\r\n  showSubTitle?: boolean;\r\n  /** Label text */\r\n  label?: string;\r\n  /** Title text */\r\n  title?: string;\r\n  /** Subtitle text */\r\n  subTitle?: string;\r\n  /** Theme (material, flat, compact, dark, ocean, sunset) */\r\n  theme?: string;\r\n  /** Custom CSS class */\r\n  className?: string;\r\n  /** Custom styles */\r\n  style?: React.CSSProperties;\r\n  /** Whether the header should stick to the top when scrolling */\r\n  isSticky?: boolean;\r\n}\r\n\r\nexport const AvakioViewHeader: React.FC<AvakioViewHeaderProps> = ({\r\n  id,\r\n  testId,\r\n  showLabel = true,\r\n  showTitle = true,\r\n  showSubTitle = true,\r\n  label = '',\r\n  title = '',\r\n  subTitle = '',\r\n  theme,\r\n  className = '',\r\n  style = {},\r\n  isSticky = true,\r\n}) => {\r\n  const wrapperStyle = isSticky ? { position: 'sticky' as const, top: 0, zIndex: 1000 } : {};\r\n  \r\n  // Only set data-admin-theme if theme is explicitly provided\r\n  const wrapperProps: React.HTMLAttributes<HTMLDivElement> & { 'data-admin-theme'?: string } = {\r\n    style: wrapperStyle,\r\n  };\r\n  if (theme) {\r\n    wrapperProps['data-admin-theme'] = theme;\r\n  }\r\n  \r\n  return (\r\n    <div {...wrapperProps}>\r\n    <AvakioView\r\n        theme={theme as any}\r\n        type=\"header\"\r\n        borderless={false}\r\n        id={id}\r\n        testId={testId}\r\n        css={{ \r\n          ...style, \r\n          display: 'flex', \r\n          justifyContent: 'flex-start', \r\n          alignItems: 'flex-start',\r\n          background: 'var(--view-focus-color)',\r\n          color: '#ffffff'\r\n        }}\r\n        className={className}\r\n    >\r\n        <div style={{ textAlign: 'left' }}>\r\n            {showLabel && label && (\r\n                <div style={{ \r\n                    margin: 0, \r\n                    marginBottom: '8px', \r\n                    fontSize: '14px', \r\n                    fontWeight: 500,\r\n                    lineHeight: '1.5',\r\n                    fontFamily: '-apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, sans-serif',\r\n                    color: 'inherit'\r\n                }}>\r\n                    {label}\r\n                </div>\r\n            )}\r\n            {showTitle && title && (\r\n                <h1 style={{ \r\n                    margin: 0, \r\n                    fontSize: '24px', \r\n                    fontWeight: 600,                    \r\n                    letterSpacing: '0.01em',\r\n                    lineHeight: '1.2',\r\n                    fontFamily: '-apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, sans-serif',\r\n                    WebkitFontSmoothing: 'antialiased',\r\n                    color: 'inherit'\r\n                }}>\r\n                    {title}\r\n                </h1>\r\n            )}\r\n            {showSubTitle && subTitle && (\r\n                <p style={{ \r\n                    margin: 0, \r\n                    marginTop: '8px', \r\n                    fontSize: '14px', \r\n                    fontWeight: 500,\r\n                    lineHeight: '1.5',\r\n                    fontFamily: '-apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, sans-serif',\r\n                    color: 'inherit'\r\n                }}>\r\n                    {subTitle}\r\n                </p>\r\n            )}  \r\n        </div>                            \r\n    </AvakioView>\r\n    </div>\r\n  );\r\n};\r\n\r\nAvakioViewHeader.displayName = 'AvakioViewHeader';\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, {\r\n  forwardRef,\r\n  useImperativeHandle,\r\n  useState,\r\n  useRef,\r\n  useEffect,\r\n  useMemo,\r\n  CSSProperties,\r\n  ReactNode,\r\n} from 'react';\r\nimport './avakio-multiview.css';\r\n\r\n// Types\r\nexport type AvakioMultiviewTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\nexport type AvakioMultiviewAnimationType = 'slide' | 'flip' | 'none';\r\nexport type AvakioMultiviewSlideDirection = 'left' | 'right' | 'top' | 'bottom';\r\nexport type AvakioMultiviewFlipDirection = 'horizontal' | 'vertical';\r\n\r\nexport interface AvakioMultiviewCell {\r\n  /** Unique identifier for the cell */\r\n  id: string;\r\n  /** Content to render in this cell */\r\n  content: ReactNode;\r\n  /** Optional CSS class for this cell */\r\n  className?: string;\r\n  /** Optional inline styles for this cell */\r\n  css?: CSSProperties;\r\n}\r\n\r\nexport interface AvakioMultiviewAnimateConfig {\r\n  /** Animation type */\r\n  type?: AvakioMultiviewAnimationType;\r\n  /** Animation duration in ms */\r\n  duration?: number;\r\n  /** Animation direction for slide (left, right, top, bottom) */\r\n  direction?: AvakioMultiviewSlideDirection;\r\n  /** Animation direction for flip (horizontal, vertical) */\r\n  flipDirection?: AvakioMultiviewFlipDirection;\r\n}\r\n\r\nexport interface AvakioMultiviewProps {\r\n  /** Unique identifier */\r\n  id?: string;\r\n  /** Test ID for testing */\r\n  testId?: string;\r\n  /** Array of view cells */\r\n  cells: AvakioMultiviewCell[];\r\n  /** Initially active view ID (defaults to first cell) */\r\n  activeView?: string;\r\n  /** Animation configuration */\r\n  animate?: boolean | AvakioMultiviewAnimateConfig;\r\n  /** Keep inactive views in DOM */\r\n  keepViews?: boolean;\r\n  /** Size container to biggest cell */\r\n  fitBiggest?: boolean;\r\n  /** Theme */\r\n  theme?: AvakioMultiviewTheme;\r\n  /** Custom CSS class */\r\n  className?: string;\r\n  /** Inline styles */\r\n  css?: CSSProperties;\r\n  /** Width */\r\n  width?: number | string;\r\n  /** Height */\r\n  height?: number | string;\r\n  /** Fired when view changes */\r\n  onViewChange?: (newViewId: string, oldViewId: string) => void;\r\n  /** Fired when a view is shown */\r\n  onViewShow?: (viewId: string) => void;\r\n  /** Fired before going back */\r\n  onBeforeBack?: (currentViewId: string) => boolean | void;\r\n}\r\n\r\nexport interface AvakioMultiviewRef {\r\n  /** Get the ID of the currently active view */\r\n  getValue: () => string;\r\n  /** Alias for getValue */\r\n  getActiveId: () => string;\r\n  /** Switch to a specific view */\r\n  setValue: (viewId: string) => void;\r\n  /** Go back to the previous view */\r\n  back: () => boolean;\r\n  /** Add a new view dynamically */\r\n  addView: (cell: AvakioMultiviewCell, index?: number) => void;\r\n  /** Remove a view by ID */\r\n  removeView: (viewId: string) => boolean;\r\n  /** Get all view IDs */\r\n  getViews: () => string[];\r\n  /** Check if a view exists */\r\n  hasView: (viewId: string) => boolean;\r\n  /** Get the view history */\r\n  getHistory: () => string[];\r\n  /** Clear navigation history */\r\n  clearHistory: () => void;\r\n  /** Show the component */\r\n  show: () => void;\r\n  /** Hide the component */\r\n  hide: () => void;\r\n  /** Check if visible */\r\n  isVisible: () => boolean;\r\n}\r\n\r\n/**\r\n * Get the opposite direction for back navigation\r\n */\r\nfunction getOppositeDirection(direction: AvakioMultiviewSlideDirection): AvakioMultiviewSlideDirection {\r\n  const opposites: Record<AvakioMultiviewSlideDirection, AvakioMultiviewSlideDirection> = {\r\n    left: 'right',\r\n    right: 'left',\r\n    top: 'bottom',\r\n    bottom: 'top',\r\n  };\r\n  return opposites[direction];\r\n}\r\n\r\nexport const AvakioMultiview = forwardRef<AvakioMultiviewRef, AvakioMultiviewProps>(\r\n  (\r\n    {\r\n      id,\r\n      testId,\r\n      cells: initialCells,\r\n      activeView,\r\n      animate = true,\r\n      keepViews = false,\r\n      fitBiggest = false,\r\n      theme = 'material',\r\n      className,\r\n      css,\r\n      width,\r\n      height,\r\n      onViewChange,\r\n      onViewShow,\r\n      onBeforeBack,\r\n    },\r\n    ref\r\n  ) => {\r\n    // Compute animation config directly from props (no memoization to avoid stale values)\r\n    let animationType: AvakioMultiviewAnimationType = 'slide';\r\n    let animationDuration = 300;\r\n    let animationDirection: AvakioMultiviewSlideDirection = 'left';\r\n    let animationFlipDirection: AvakioMultiviewFlipDirection = 'horizontal';\r\n    \r\n    if (typeof animate === 'object' && animate !== null) {\r\n      animationType = animate.type ?? 'slide';\r\n      animationDuration = animate.duration ?? 300;\r\n      animationDirection = animate.direction ?? 'left';\r\n      animationFlipDirection = animate.flipDirection ?? 'horizontal';\r\n    } else if (typeof animate === 'boolean') {\r\n      animationType = animate ? 'slide' : 'none';\r\n    }\r\n    \r\n    // Validate animation type\r\n    if (!['slide', 'flip', 'none'].includes(animationType)) {\r\n      animationType = 'slide';\r\n    }\r\n    \r\n    // Ensure minimum duration\r\n    animationDuration = Math.max(animationDuration, 200);\r\n    \r\n    const animateConfig: AvakioMultiviewAnimateConfig = {\r\n      type: animationType,\r\n      duration: animationDuration,\r\n      direction: animationDirection,\r\n      flipDirection: animationFlipDirection,\r\n    };\r\n\r\n    // State\r\n    const [cells, setCells] = useState<AvakioMultiviewCell[]>(initialCells);\r\n    const [currentViewId, setCurrentViewId] = useState<string>(\r\n      activeView || initialCells[0]?.id || ''\r\n    );\r\n    const [previousViewId, setPreviousViewId] = useState<string | null>(null);\r\n    const [isAnimating, setIsAnimating] = useState(false);\r\n    const [activeDirection, setActiveDirection] = useState<AvakioMultiviewSlideDirection>(\r\n      animateConfig.direction || 'left'\r\n    );\r\n    const [hidden, setHidden] = useState(false);\r\n\r\n    // Refs for avoiding stale closures\r\n    const historyRef = useRef<string[]>([activeView || initialCells[0]?.id || '']);\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n    const cellsRef = useRef<AvakioMultiviewCell[]>(initialCells);\r\n    const currentViewIdRef = useRef<string>(activeView || initialCells[0]?.id || '');\r\n    const isAnimatingRef = useRef(false);\r\n    const animationTimeoutRef = useRef<ReturnType<typeof setTimeout> | null>(null);\r\n    const animateConfigRef = useRef(animateConfig);\r\n\r\n    // Keep animateConfig ref updated\r\n    useEffect(() => {\r\n      animateConfigRef.current = animateConfig;\r\n    }, [animateConfig.type, animateConfig.direction, animateConfig.duration]);\r\n\r\n    // Update cells if prop changes\r\n    useEffect(() => {\r\n      setCells(initialCells);\r\n      cellsRef.current = initialCells;\r\n    }, [initialCells]);\r\n\r\n    // Keep refs in sync with state\r\n    useEffect(() => {\r\n      cellsRef.current = cells;\r\n    }, [cells]);\r\n\r\n    useEffect(() => {\r\n      currentViewIdRef.current = currentViewId;\r\n    }, [currentViewId]);\r\n\r\n    // Cleanup animation timeout on unmount\r\n    useEffect(() => {\r\n      return () => {\r\n        if (animationTimeoutRef.current) {\r\n          clearTimeout(animationTimeoutRef.current);\r\n        }\r\n      };\r\n    }, []);\r\n\r\n    /**\r\n     * Core view switching function with animation\r\n     */\r\n    const switchView = (\r\n      newViewId: string,\r\n      direction: AvakioMultiviewSlideDirection\r\n    ) => {\r\n      // Guard: same view or already animating\r\n      const currentId = currentViewIdRef.current;\r\n      if (newViewId === currentId || isAnimatingRef.current) return;\r\n\r\n      // Guard: view must exist\r\n      if (!cellsRef.current.find((c) => c.id === newViewId)) return;\r\n\r\n      const oldViewId = currentId;\r\n\r\n      // Clear any pending animation timeout\r\n      if (animationTimeoutRef.current) {\r\n        clearTimeout(animationTimeoutRef.current);\r\n      }\r\n\r\n      // Add to history\r\n      historyRef.current.push(newViewId);\r\n\r\n      // Start animation\r\n      setActiveDirection(direction);\r\n      setPreviousViewId(oldViewId);\r\n      setCurrentViewId(newViewId);\r\n      currentViewIdRef.current = newViewId;\r\n      setIsAnimating(true);\r\n      isAnimatingRef.current = true;\r\n\r\n      // Fire callbacks\r\n      onViewChange?.(newViewId, oldViewId);\r\n      onViewShow?.(newViewId);\r\n\r\n      // End animation after duration\r\n      animationTimeoutRef.current = setTimeout(() => {\r\n        setIsAnimating(false);\r\n        isAnimatingRef.current = false;\r\n        setPreviousViewId(null);\r\n      }, animationDuration);\r\n    };\r\n\r\n    // Imperative methods\r\n    useImperativeHandle(ref, () => ({\r\n      getValue: () => currentViewIdRef.current,\r\n      getActiveId: () => currentViewIdRef.current,\r\n\r\n      setValue: (viewId: string) => {\r\n        // Use the configured direction from animate prop\r\n        switchView(viewId, animateConfigRef.current.direction || 'left');\r\n      },\r\n\r\n      back: () => {\r\n        if (historyRef.current.length <= 1) return false;\r\n\r\n        const currentId = currentViewIdRef.current;\r\n        const shouldProceed = onBeforeBack?.(currentId);\r\n        if (shouldProceed === false) return false;\r\n\r\n        // Remove current from history\r\n        historyRef.current.pop();\r\n        const targetId = historyRef.current[historyRef.current.length - 1];\r\n\r\n        if (targetId) {\r\n          // Clear any pending animation timeout\r\n          if (animationTimeoutRef.current) {\r\n            clearTimeout(animationTimeoutRef.current);\r\n          }\r\n\r\n          const oldViewId = currentId;\r\n          // Use opposite direction for back navigation\r\n          const backDirection = getOppositeDirection(animateConfigRef.current.direction || 'left');\r\n\r\n          // Start animation\r\n          setActiveDirection(backDirection);\r\n          setPreviousViewId(oldViewId);\r\n          setCurrentViewId(targetId);\r\n          currentViewIdRef.current = targetId;\r\n          setIsAnimating(true);\r\n          isAnimatingRef.current = true;\r\n\r\n          // Fire callbacks\r\n          onViewChange?.(targetId, oldViewId);\r\n          onViewShow?.(targetId);\r\n\r\n          // End animation after duration\r\n          animationTimeoutRef.current = setTimeout(() => {\r\n            setIsAnimating(false);\r\n            isAnimatingRef.current = false;\r\n            setPreviousViewId(null);\r\n          }, animationDuration);\r\n\r\n          return true;\r\n        }\r\n        return false;\r\n      },\r\n\r\n      addView: (cell: AvakioMultiviewCell, index?: number) => {\r\n        if (cellsRef.current.find((c) => c.id === cell.id)) return;\r\n\r\n        if (index !== undefined) {\r\n          const newCells = [...cellsRef.current];\r\n          newCells.splice(index, 0, cell);\r\n          cellsRef.current = newCells;\r\n        } else {\r\n          cellsRef.current = [...cellsRef.current, cell];\r\n        }\r\n\r\n        setCells([...cellsRef.current]);\r\n      },\r\n\r\n      removeView: (viewId: string) => {\r\n        if (viewId === currentViewIdRef.current) return false;\r\n        const newCells = cellsRef.current.filter((c) => c.id !== viewId);\r\n        cellsRef.current = newCells;\r\n        setCells(newCells);\r\n        historyRef.current = historyRef.current.filter((id) => id !== viewId);\r\n        return true;\r\n      },\r\n\r\n      getViews: () => cellsRef.current.map((c) => c.id),\r\n\r\n      hasView: (viewId: string) => cellsRef.current.some((c) => c.id === viewId),\r\n\r\n      getHistory: () => [...historyRef.current],\r\n\r\n      clearHistory: () => {\r\n        historyRef.current = [currentViewIdRef.current];\r\n      },\r\n\r\n      show: () => setHidden(false),\r\n      hide: () => setHidden(true),\r\n      isVisible: () => !hidden,\r\n    }));\r\n\r\n    // Build class names\r\n    const containerClasses = [\r\n      'avakio-multiview',\r\n      `avakio-multiview-theme-${theme}`,\r\n      `avakio-multiview-animate-${animateConfig.type}`,\r\n      animateConfig.type === 'flip' && `avakio-multiview-flip-${animateConfig.flipDirection}`,\r\n      fitBiggest && 'avakio-multiview-fit-biggest',\r\n      isAnimating && 'avakio-multiview-animating',\r\n      hidden && 'avakio-multiview-hidden',\r\n      className,\r\n    ]\r\n      .filter(Boolean)\r\n      .join(' ');\r\n\r\n    // Build styles\r\n    const containerStyle: CSSProperties = {\r\n      ...(css && typeof css === 'object' && !Array.isArray(css) ? css : {}),\r\n      width: width,\r\n      height: height,\r\n      '--animation-duration': `${animationDuration}ms`,\r\n    } as CSSProperties;\r\n\r\n    // Determine which cells to render\r\n    const allCells = cellsRef.current;\r\n    const activeViewId = currentViewId;\r\n    const cellsToRender = keepViews\r\n      ? allCells\r\n      : allCells.filter(\r\n          (c) =>\r\n            c.id === activeViewId || (isAnimating && c.id === previousViewId)\r\n        );\r\n\r\n    return (\r\n      <div\r\n        ref={containerRef}\r\n        id={id}\r\n        data-testid={testId}\r\n        className={containerClasses}\r\n        style={containerStyle}\r\n      >\r\n        <div className=\"avakio-multiview-cells\">\r\n          {cellsToRender.map((cell) => {\r\n            const isActive = cell.id === activeViewId;\r\n            const isLeaving = isAnimating && cell.id === previousViewId;\r\n            const isEntering = isAnimating && isActive;\r\n\r\n            const cellClasses = [\r\n              'avakio-multiview-cell',\r\n              isActive && !isEntering && 'avakio-multiview-cell-active',\r\n              isEntering && `avakio-multiview-cell-entering-${activeDirection}`,\r\n              isLeaving && `avakio-multiview-cell-leaving-${activeDirection}`,\r\n              !isActive && !isLeaving && 'avakio-multiview-cell-hidden',\r\n              cell.className,\r\n            ]\r\n              .filter(Boolean)\r\n              .join(' ');\r\n\r\n            const cellStyle: CSSProperties = { ...cell.css };\r\n            if (isEntering || isLeaving) {\r\n              cellStyle.animationDuration = `${animationDuration}ms`;\r\n              cellStyle.animationTimingFunction = 'ease-out';\r\n              cellStyle.animationFillMode = 'both';\r\n              cellStyle.animationPlayState = 'running';\r\n            }\r\n\r\n            return (\r\n              <div\r\n                key={cell.id}\r\n                data-view-id={cell.id}\r\n                className={cellClasses}\r\n                style={cellStyle}\r\n              >\r\n                {cell.content}\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nAvakioMultiview.displayName = 'AvakioMultiview';\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React, { forwardRef, useImperativeHandle, useState, useRef, useEffect } from 'react';\r\nimport './avakio-template.css';\r\n\r\nexport type AvakioTemplateTheme = 'material' | 'flat' | 'compact' | 'dark' | 'ocean' | 'sunset';\r\nexport type AvakioTemplateBorderType = 'space' | 'wide' | 'clean' | 'line' | 'material';\r\nexport type AvakioTemplateType = 'header' | 'section' | 'clean';\r\n\r\nexport interface AvakioTemplateProps {\r\n  /** Template string or function that returns HTML/JSX */\r\n  template?: string | ((data: any) => React.ReactNode);\r\n  \r\n  /** Data object to populate the template */\r\n  data?: Record<string, any>;\r\n  \r\n  /** Direct HTML content (alternative to template) */\r\n  content?: React.ReactNode;\r\n  \r\n  /** URL to load content from */\r\n  url?: string;\r\n  \r\n  /** Theme to apply */\r\n  theme?: AvakioTemplateTheme;\r\n  \r\n  /** Border type */\r\n  borderType?: AvakioTemplateBorderType;\r\n  \r\n  /** Template type (header, section, clean) */\r\n  type?: AvakioTemplateType;\r\n  \r\n  /** Whether to remove borders */\r\n  borderless?: boolean;\r\n  \r\n  /** Auto-height based on content */\r\n  autoheight?: boolean;\r\n  \r\n  /** Enable scrolling */\r\n  scroll?: boolean | 'x' | 'y' | 'xy';\r\n  \r\n  /** Width of the template */\r\n  width?: number | string;\r\n  \r\n  /** Height of the template */\r\n  height?: number | string;\r\n  \r\n  /** Minimum width */\r\n  minWidth?: number | string;\r\n  \r\n  /** Minimum height */\r\n  minHeight?: number | string;\r\n  \r\n  /** Maximum width */\r\n  maxWidth?: number | string;\r\n  \r\n  /** Maximum height */\r\n  maxHeight?: number | string;\r\n  \r\n  /** Padding around content - can be a number (all sides), string, or array [top, right, bottom, left] */\r\n  padding?: number | string | [number, number, number, number];\r\n  \r\n  /** Margin around template - can be a number (all sides), string, or array [top, right, bottom, left] */\r\n  margin?: number | string | [number, number, number, number];\r\n  \r\n  /** Custom CSS class */\r\n  className?: string;\r\n  \r\n  /** Custom CSS styles */\r\n  css?: React.CSSProperties;\r\n  \r\n  /** Whether the template is hidden */\r\n  hidden?: boolean;\r\n  \r\n  /** Whether the template is disabled */\r\n  disabled?: boolean;\r\n  \r\n  /** ID of the template */\r\n  id?: string;\r\n  \r\n  /** Test ID for testing purposes */\r\n  testId?: string;\r\n  \r\n  /** Callback when content is loaded */\r\n  onLoad?: () => void;\r\n  \r\n  /** Callback when content changes */\r\n  onChange?: (data: any) => void;\r\n  \r\n  /** Callback on click */\r\n  onClick?: (e: React.MouseEvent) => void;\r\n}\r\n\r\nexport interface AvakioTemplateRef {\r\n  /** Set values/data for the template */\r\n  setValues: (data: Record<string, any>) => void;\r\n  \r\n  /** Get current values/data */\r\n  getValues: () => Record<string, any>;\r\n  \r\n  /** Set HTML content directly */\r\n  setHTML: (html: string) => void;\r\n  \r\n  /** Get current HTML content */\r\n  getHTML: () => string;\r\n  \r\n  /** Refresh/re-render the template */\r\n  refresh: () => void;\r\n  \r\n  /** Parse and apply new data */\r\n  parse: (data: Record<string, any>) => void;\r\n  \r\n  /** Show the template */\r\n  show: () => void;\r\n  \r\n  /** Hide the template */\r\n  hide: () => void;\r\n  \r\n  /** Enable the template */\r\n  enable: () => void;\r\n  \r\n  /** Disable the template */\r\n  disable: () => void;\r\n  \r\n  /** Get the DOM node */\r\n  getNode: () => HTMLDivElement | null;\r\n}\r\n\r\nexport const AvakioTemplate = forwardRef<AvakioTemplateRef, AvakioTemplateProps>(\r\n  (\r\n    {\r\n      template,\r\n      data = {},\r\n      content,\r\n      url,\r\n      theme = 'material',\r\n      borderType = 'space',\r\n      type = 'clean',\r\n      borderless = false,\r\n      autoheight = false,\r\n      scroll = false,\r\n      width,\r\n      height,\r\n      minWidth,\r\n      minHeight,\r\n      maxWidth,\r\n      maxHeight,\r\n      padding,\r\n      margin,\r\n      className = '',\r\n      css,\r\n      hidden = false,\r\n      disabled = false,\r\n      id,\r\n      testId,\r\n      onLoad,\r\n      onChange,\r\n      onClick,\r\n    },\r\n    ref\r\n  ) => {\r\n    const [internalData, setInternalData] = useState<Record<string, any>>(data);\r\n    const [internalContent, setInternalContent] = useState<React.ReactNode>(content);\r\n    const [internalHtml, setInternalHtml] = useState<string>('');\r\n    const [isHidden, setIsHidden] = useState(hidden);\r\n    const [isDisabled, setIsDisabled] = useState(disabled);\r\n    const [loadedContent, setLoadedContent] = useState<string>('');\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n    const onLoadRef = useRef(onLoad);\r\n\r\n    // Keep onLoad ref in sync\r\n    useEffect(() => {\r\n      onLoadRef.current = onLoad;\r\n    }, [onLoad]);\r\n\r\n    // Sync hidden and disabled props\r\n    useEffect(() => {\r\n      setIsHidden(hidden);\r\n    }, [hidden]);\r\n\r\n    useEffect(() => {\r\n      setIsDisabled(disabled);\r\n    }, [disabled]);\r\n\r\n    // Load content from URL\r\n    useEffect(() => {\r\n      if (url) {\r\n        fetch(url)\r\n          .then((res) => res.text())\r\n          .then((html) => {\r\n            setLoadedContent(html);\r\n            onLoadRef.current?.();\r\n          })\r\n          .catch((err) => console.error('Failed to load template from URL:', err));\r\n      }\r\n    }, [url]);\r\n\r\n    // Update internal data when prop changes (use JSON comparison for objects)\r\n    const dataJsonRef = useRef<string>(JSON.stringify(data));\r\n    useEffect(() => {\r\n      const newDataJson = JSON.stringify(data);\r\n      if (newDataJson !== dataJsonRef.current) {\r\n        dataJsonRef.current = newDataJson;\r\n        setInternalData(data);\r\n      }\r\n    }, [data]);\r\n\r\n    // Update internal content when prop changes (only for primitive content)\r\n    const prevContentRef = useRef(content);\r\n    useEffect(() => {\r\n      // Only update if content is a primitive or actually different\r\n      if (content !== prevContentRef.current) {\r\n        prevContentRef.current = content;\r\n        setInternalContent(content);\r\n      }\r\n    }, [content]);\r\n\r\n    // Process template with data\r\n    const processTemplate = (tmpl: string, dataObj: Record<string, any>): string => {\r\n      return tmpl.replace(/#(\\w+)#/g, (match, key) => {\r\n        return dataObj[key] !== undefined ? String(dataObj[key]) : match;\r\n      });\r\n    };\r\n\r\n    // Render content based on template, content, or URL\r\n    const renderContent = () => {\r\n      // If HTML was set via setHTML\r\n      if (internalHtml) {\r\n        return <div dangerouslySetInnerHTML={{ __html: internalHtml }} />;\r\n      }\r\n\r\n      // If URL content was loaded\r\n      if (loadedContent) {\r\n        return <div dangerouslySetInnerHTML={{ __html: processTemplate(loadedContent, internalData) }} />;\r\n      }\r\n\r\n      // If template is a function\r\n      if (typeof template === 'function') {\r\n        return template(internalData);\r\n      }\r\n\r\n      // If template is a string\r\n      if (typeof template === 'string') {\r\n        const processedHtml = processTemplate(template, internalData);\r\n        return <div dangerouslySetInnerHTML={{ __html: processedHtml }} />;\r\n      }\r\n\r\n      // If direct content is provided\r\n      if (internalContent) {\r\n        return internalContent;\r\n      }\r\n\r\n      return null;\r\n    };\r\n\r\n    // Imperative handle for ref methods\r\n    useImperativeHandle(ref, () => ({\r\n      setValues: (newData: Record<string, any>) => {\r\n        setInternalData(newData);\r\n        onChange?.(newData);\r\n      },\r\n      getValues: () => internalData,\r\n      setHTML: (html: string) => {\r\n        setInternalHtml(html);\r\n      },\r\n      getHTML: () => {\r\n        return containerRef.current?.innerHTML || '';\r\n      },\r\n      refresh: () => {\r\n        setInternalData({ ...internalData });\r\n      },\r\n      parse: (newData: Record<string, any>) => {\r\n        setInternalData(newData);\r\n        onChange?.(newData);\r\n      },\r\n      show: () => {\r\n        setIsHidden(false);\r\n      },\r\n      hide: () => {\r\n        setIsHidden(true);\r\n      },\r\n      enable: () => {\r\n        setIsDisabled(false);\r\n      },\r\n      disable: () => {\r\n        setIsDisabled(true);\r\n      },\r\n      getNode: () => containerRef.current,\r\n    }));\r\n\r\n    // Build CSS classes\r\n    const classes = [\r\n      'avakio-template',\r\n      `avakio-template-theme-${theme}`,\r\n      `avakio-template-border-${borderType}`,\r\n      `avakio-template-type-${type}`,\r\n      borderless ? 'avakio-template-borderless' : '',\r\n      autoheight ? 'avakio-template-autoheight' : '',\r\n      scroll === true || scroll === 'xy' ? 'avakio-template-scroll-xy' : '',\r\n      scroll === 'x' ? 'avakio-template-scroll-x' : '',\r\n      scroll === 'y' ? 'avakio-template-scroll-y' : '',\r\n      isHidden ? 'avakio-template-hidden' : '',\r\n      isDisabled ? 'avakio-template-disabled' : '',\r\n      className,\r\n    ]\r\n      .filter(Boolean)\r\n      .join(' ');\r\n\r\n    // Build inline styles\r\n    const styles: React.CSSProperties = {\r\n      width: typeof width === 'number' ? `${width}px` : width,\r\n      height: typeof height === 'number' ? `${height}px` : height,\r\n      minWidth: typeof minWidth === 'number' ? `${minWidth}px` : minWidth,\r\n      minHeight: typeof minHeight === 'number' ? `${minHeight}px` : minHeight,\r\n      maxWidth: typeof maxWidth === 'number' ? `${maxWidth}px` : maxWidth,\r\n      maxHeight: typeof maxHeight === 'number' ? `${maxHeight}px` : maxHeight,\r\n      padding: Array.isArray(padding) \r\n        ? `${padding[0]}px ${padding[1]}px ${padding[2]}px ${padding[3]}px`\r\n        : typeof padding === 'number' ? `${padding}px` : padding,\r\n      margin: Array.isArray(margin) \r\n        ? `${margin[0]}px ${margin[1]}px ${margin[2]}px ${margin[3]}px`\r\n        : typeof margin === 'number' ? `${margin}px` : margin,\r\n      ...(css && typeof css === 'object' && !Array.isArray(css) ? css : {}),\r\n    };\r\n\r\n    return (\r\n      <div\r\n        ref={containerRef}\r\n        id={id}\r\n        data-testid={testId}\r\n        className={classes}\r\n        style={styles}\r\n        onClick={onClick}\r\n      >\r\n        <div className=\"avakio-template-content\">{renderContent()}</div>\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nAvakioTemplate.displayName = 'AvakioTemplate';\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],"names":["clamp","value","min","max","AvakioPopup","open","anchorRef","anchorRect","x","y","offset","width","height","theme","modal","closeOnOutside","closeOnEsc","onClose","className","style","children","id","testId","popupRef","useRef","coords","setCoords","useState","numericWidth","useMemo","parsed","useEffect","updatePosition","nextLeft","nextTop","rect","maxLeft","onKey","e","handleClick","popupNode","jsxs","Fragment","jsx","createPortal","avakioPortletThemes","AvakioPortletBoard","columns","items","onMove","draggingId","setDraggingId","grouped","map","c","item","handleDragStart","ev","handleDragOver","handleDrop","columnId","itemId","col","dragging","toKebabCase","string","toCamelCase","match","p1","p2","toPascalCase","camelCase","mergeClasses","classes","index","array","hasA11yProp","props","prop","defaultAttributes","Icon","forwardRef","color","size","strokeWidth","absoluteStrokeWidth","iconNode","rest","ref","createElement","tag","attrs","createLucideIcon","iconName","Component","__iconNode","Calendar","Check","ChevronDown","ChevronLeft","ChevronRight","ChevronUp","ChevronsLeft","ChevronsRight","ChevronsUpDown","Clock","Copy","EllipsisVertical","EyeOff","Eye","File","FolderOpen","Folder","GripVertical","Minus","Pen","Plus","Search","Send","Trash2","X","Button","Input","Popover","PopoverTrigger","PopoverContent","cn","formatDisplayDate","showTime","d","AvakioDatePickerCalendar","onChange","selectedDate","viewDate","setViewDate","monthNames","weekDays","year","month","calendarDays","firstDay","lastDay","startDay","daysInMonth","daysInPrevMonth","days","i","remainingDays","handlePrevMonth","handleNextMonth","handleDateSelect","date","newDate","day","handleTimeChange","hours","minutes","handleToday","now","handleClear","isSelected","isToday","today","dayInfo","ampm","AvakioDatePicker","label","placeholder","inline","setOpen","rootRef","themeAttr","setThemeAttr","host","nearest","observer","displayValue","CalendarIcon","val","AvakioCheckbox","name","checked","defaultChecked","indeterminate","description","disabled","error","required","padding","margin","isControlled","internalChecked","setInternalChecked","checkboxRef","isChecked","status","handleToggle","prev","handleKeyDown","handleIconClick","paddingStyle","marginStyle","containerStyle","AvakioButton","icon","iconRight","variant","block","loading","badge","autowidth","tooltip","buttonType","align","image","hotkey","popup","onClick","isDisabled","buttonRef","React","keys","ctrl","shift","alt","key","buttonTypeClass","normalizeHex","hex","cleaned","AvakioColorPicker","defaultValue","readOnly","presets","allowCustomInput","showPreview","internal","setInternal","inputRef","currentColor","allPresets","handleSelect","normalized","handleInputChange","handleNativeChange","preset","AvakioCombo","options","onInputChange","labelAlign","labelWidth","readonly","filterMode","customFilter","template","maxHeight","isOpen","setIsOpen","inputValue","setInputValue","highlightedIndex","setHighlightedIndex","selectedOption","setSelectedOption","dropdownRef","containerRef","normalizedOptions","opt","option","filteredOptions","searchValue","optionValue","newValue","handleSelectOption","highlightedElement","handleClickOutside","event","renderOption","AvakioCounter","step","labelPosition","allowInput","next","current","emitChange","handleStep","delta","handleInput","raw","canDecrement","canIncrement","formatDate","normalize","range","allowSingleDay","s","AvakioDateRangePicker","internalRange","setInternalRange","applyRange","presetItems","iso","end","start","handleStart","handleEnd","display","p","AvakioGridSuggest","data","textValue","body","editable","firstItem","getDisplayText","rendered","_","firstCol","k","cellValue","highlightedRow","showHeader","showBorderless","enableScroll","rowIndex","AvakioMultiCombo","showCount","maxDisplayItems","searchQuery","setSearchQuery","query","selectedOptions","handleToggleOption","v","handleRemoveItem","handleClearAll","handleInputClick","handleSelectAll","allFilteredValues","newValues","renderSelectedItems","displayItems","remainingCount","allFilteredSelected","AvakioRichSelect","yCount","clearable","currentIndex","calculatedMaxHeight","AvakioRichSelectAPI","AvakioSlider","showValue","formatValue","marks","normalizeToRange","defaultMin","defaultMax","normalizeToSingle","defaultVal","internalSingle","setInternalSingle","currentRange","currentSingle","lowPercent","highPercent","formattedLow","formattedHigh","safeMarks","m","handleSingleChange","useCallback","clamped","handleRangeChange","newRange","trackRef","handleTrackClick","percent","clickValue","snappedValue","distToLow","distToHigh","sliderStyle","isInRange","AvakioProperty","dense","showBorders","rows","setRows","lastChanged","setLastChanged","openDateId","setOpenDateId","openDatePlacement","setOpenDatePlacement","dateBtnRefs","evt","computeDatePlacement","btn","viewportHeight","estimatedHeight","spaceBelow","spaceAbove","coerceDate","formatDisplayValue","groupedRows","groups","row","handleChange","r","changed","renderControl","common","richOptions","propOpt","inputVal","numericVal","el","placement","text","vals","rootClass","group","rowsInGroup","isSameDay","date1","date2","formatDateKey","parseDate","str","AvakioCalendar","mode","minDate","maxDate","disabledDates","markers","showWeekNumbers","monthsToShow","weekStart","onMonthChange","getInitialViewDate","firstDate","safeMonthsToShow","selectedDates","disabledDatesSet","markersByDate","marker","getMonthGrid","baseDate","getWeekNumber","dayNum","yearStart","isDateDisabled","isDateSelected","selected","isDateInRange","a","b","handleDateClick","dateKey","currentDates","newDates","sorted","todayKey","renderMonth","monthOffset","displayDate","dayMarkers","showWeekNum","uniqueKey","displayWeekNumber","idx","startOfWeek","addDays","parseDateKey","formatTime","formatDay","AvakioScheduler","events","defaultView","defaultDate","userId","dataUrl","eventsUrl","loadRemoteOnNavigate","fetchOptions","transformEvent","buildEventsQuery","mutationUrl","buildMutationUrl","mutationMethod","onNavigate","onViewChange","onEventClick","onEventCreate","view","setView","anchor","setAnchor","selectedDateKey","setSelectedDateKey","isMobile","setIsMobile","remoteEvents","setRemoteEvents","setLoading","setError","hasFetchedOnce","setHasFetchedOnce","morePopup","setMorePopup","eventsEndpoint","rangeForView","currentView","currentAnchor","cancelled","url","mapEvent","hasLegacyShape","res","json","mapped","err","detect","onResize","monthGrid","first","cells","weekGrid","dayGrid","filteredEvents","monthAgenda","visibleEvents","go","changeView","createEvent","target","saved","eventsForDay","eventsForDayKey","eventsForDateKey","mobileMarkers","selectedDateEvents","renderEventPill","renderEventsForDay","nextKey","AvakioSidebar","collapsed","position","collapsedWidth","activeTitle","titleHeight","multipleOpen","onSelect","onToggle","mobileBreakpoint","tabletBreakpoint","autoCloseMobile","showOverlay","onOverlayClick","showMobileDongle","dongleIcon","isCollapsed","setIsCollapsed","openItems","setOpenItems","hoveredItem","setHoveredItem","selectedItem","setSelectedItem","isTablet","setIsTablet","checkScreenSize","isMobileScreen","isTabletScreen","newCollapsed","toggleItem","hasChildren","handleItemClick","level","parentId","handleOverlayClick","renderIcon","renderArrow","renderItem","isHovered","child","AvakioSidebarToggleButton","defaultDateFormatter","diff","generateId","AvakioComment","initialData","users","currentUser","sendAction","moreButtonLabel","hasMore","mentions","keepButtonVisible","borderless","css","disabledProp","onAdd","onDelete","onEdit","onLoadMore","onUserMentioned","dateFormatter","renderAvatar","listRef","comments","setComments","setDisabled","editingId","setEditingId","editValue","setEditValue","activeMenuId","setActiveMenuId","showMentions","setShowMentions","mentionSearch","setMentionSearch","currentUserId","setCurrentUserId","sortedComments","dateA","dateB","getUserById","u","filteredMentionUsers","search","handleSend","newComment","mentionRegex","mentionedUser","atIndex","insertMention","user","handleDelete","commentId","handleEditStart","comment","handleEditSave","updatedComment","handleEditCancel","defaultRenderAvatar","initials","n","renderText","part","useImperativeHandle","containerClassNames","containerStyles","isOwner","isEditing","MoreVertical","Edit2","SelectContext","Select","onValueChange","internalValue","setInternalValue","currentValue","handleValueChange","SelectTrigger","context","SelectValue","SelectContent","SelectItem","AvakioDataTable","spans","select","multiselect","rowHeight","headerHeight","fixedRowNumber","hover","resizable","sortable","filterable","paging","pageSize","autoConfig","scroll","serverSide","onRowClick","onRowDoubleClick","onSelectChange","onSort","onFilter","emptyText","totalCount","currentPage","onPageChange","onPageSizeChange","selectedRows","setSelectedRows","sortColumn","setSortColumn","sortDirection","setSortDirection","spanMap","rowId","colspan","rowspan","cssClass","rowKey","cellKey","colIndex","nextCol","allRowIds","nextRowIndex","nextRowKey","filters","setFilters","columnWidths","setColumnWidths","page","setPage","localPageSize","setLocalPageSize","resizingColumn","setResizingColumn","resizeStartX","setResizeStartX","resizeStartWidth","setResizeStartWidth","filteredData","result","filterValue","column","stringValue","fv","filterStringValue","rowDate","filterDate","sortedData","aVal","bVal","comparison","paginatedData","startIndex","totalPages","handleSort","newDirection","handleFilter","newFilters","handleRowClick","newSet","handleRowDoubleClick","handleResizeStart","currentWidth","handleMouseMove","newWidth","handleMouseUp","getColumnWidth","customWidth","renderCell","visibleColumns","spanInfo","cellClasses","newPageSize","newPage","AvakioTimeline","onItemClick","orientation","rootClasses","vertical","isLast","dotClass","showDateInCard","leftLabel","showConnector","clickable","handleKey","horizontal","isFirst","isColorBand","topLabel","positionClass","buildNodeMap","nodes","depth","node","getDescendantIds","ids","getAllNodeIds","AvakioTree","checkbox","threeState","showIcons","showToggle","showLines","navigation","drag","itemHeight","onDblClick","onOpen","onCheck","onContext","autoId","useId","treeId","selectedIds","setSelectedIds","openIds","setOpenIds","initialOpen","collectOpen","checkedIds","setCheckedIds","initialChecked","collectChecked","focusedId","setFocusedId","filterFn","setFilterFn","forceUpdate","nodeMap","getCheckState","nodeId","entry","descendantIds","checkedCount","handleCheckToggle","newChecked","parentEntry","parentNode","childIds","allChecked","handleNodeClick","handleNodeDblClick","handleEditSubmit","handleContextMenu","visibleIds","allBranchIds","allIds","fn","toOpen","renderNode","isBranch","isFocused","checkState","nodeClasses","indent","detectedTheme","setDetectedTheme","globalTheme","newTheme","containerClasses","toCssValue","AvakioAbsoluteLayout","initialCells","minWidth","minHeight","maxWidth","initialHidden","initialDisabled","initialVisibleBatch","background","onCellClick","setCells","isHidden","setIsHidden","setIsDisabled","visibleBatch","setVisibleBatch","resizeObserverRef","entries","handleCellClick","cell","isCellVisible","newCells","idOrIndex","batchName","cellId","cellStyle","AvakioGrid","gridColumns","gridRows","cellWidth","cellHeight","cellMargin","paddingX","paddingY","cellBorderless","hidden","autoplace","factory","isDraggable","onDragStart","onDragEnd","containerSize","setContainerSize","cellsRef","draggingCell","setDraggingCell","dragOffset","setDragOffset","dragPosition","setDragPosition","initialWidth","initialHeight","rafId","pendingSize","resizeObserver","calculatedCellWidth","basePadding","paddingHorizontal","totalMargin","availableWidth","cellHeights","acc","paddingVertical","availableHeight","fixedHeightTotal","flexibleRowCount","rowHeights","fixedHeightCell","remainingHeight","flexRowHeight","heights","dy","totalHeight","rowH","rowPositions","positions","h","getCellStyle","dx","px","py","left","top","renderCellContent","getGridPositionFromPixels","pixelX","pixelY","adjustedX","colWidth","gridX","adjustedY","gridY","rowMid","excludeCellId","clientX","clientY","cellLeft","cellTop","handleDragMove","handleDragEnd","newGridPos","canPlace","j","checkX","checkY","positionChanged","isSingleColumn","allCellsSimple","oldY","newY","updated","targetCell","cDx","cDy","handleMove","handleUp","findNextPosition","occupied","newCell","marginValue","isDragging","AvakioLayout","cols","type","gravity","responsive","gap","justify","autoResize","layoutRef","responsiveMode","setResponsiveMode","isRows","checkResponsive","handleResize","layoutClasses","layoutStyles","shouldItemFlex","itemClasses","AvakioResizer","direction","onResizeStart","onResizeEnd","resizerRef","startPosRef","setIsDragging","currentPos","handleMouseDown","AvakioDoubleList","labelLeft","labelRight","labelBottomLeft","labelBottomRight","showButtons","searchable","draggable","listHeight","leftSearch","setLeftSearch","rightSearch","setRightSearch","leftSelection","setLeftSelection","rightSelection","setRightSelection","draggedItem","setDraggedItem","dragOverSide","setDragOverSide","leftListRef","rightListRef","selectedSet","leftItems","rightItems","filteredLeftItems","filteredRightItems","moveToRight","validIds","moveToLeft","idsToRemove","moveAllToRight","newIds","moveAllToLeft","disabledIds","side","setSelection","selection","lastSelected","lastIndex","rangeIds","handleItemDoubleClick","handleDragLeave","isCurrentlySelected","listStyle","AvakioFieldset","collapsible","defaultCollapsed","collapsedProp","onCollapse","fieldsetRef","bodyRef","isControlledCollapse","internalCollapsed","setInternalCollapsed","handleCollapseToggle","bodyStyles","AvakioLabel","html","fontSize","fontWeight","backgroundColor","border","borderRadius","currentLabel","setCurrentLabel","currentHtml","setCurrentHtml","isVisible","setIsVisible","htmlContent","inlineStyles","fieldIdCounter","generateFieldId","AvakioMultitext","invalidMessage","bottomLabel","inputAlign","inputWidth","iconWidth","maxFields","separator","subConfig","showNumbers","addButtonLabel","addButtonTooltip","validate","validateEvent","maxLength","pattern","autoComplete","onSectionAdd","onSectionRemove","onFocus","onBlur","onEnter","parseValue","values","fields","setFields","isInvalid","setIsInvalid","validationMessage","setValidationMessage","refreshKey","setRefreshKey","inputRefs","getCombinedValue","f","getValuesArray","validateFields","handleFieldChange","fieldId","combined","handleAddSection","initialValue","newFieldId","newField","handleRemoveSection","targetId","fieldToRemove","handleKeyPress","field","handleFocus","handleBlur","primary","primaryField","input","canAddMore","normalizeOptions","AvakioRadio","optionsProp","invalid","customRadio","optionHeight","radioName","optionStates","setOptionStates","getOptionState","override","firstEnabled","optId","optionId","visibleOptions","currentVisibleIndex","nextIndex","nextOption","optState","optionClasses","AvakioSegmentedButton","fill","optionWidth","multiview","inputHeight","onBeforeTabClick","onAfterTabClick","onOptionAdd","onOptionRemove","segmentRefs","internalOptions","setInternalOptions","visible","setVisible","hiddenOptions","setHiddenOptions","disabledOptions","setDisabledOptions","fallback","handleSegmentClick","targetIndex","newOptions","focusIndex","inputContainerStyles","hasError","isActive","AvakioSwitchButton","onLabel","offLabel","switchRef","normalizeValue","isOn","switchClassNames","labelStyles","AvakioTabBar","renderTab","closable","scrollable","closedIds","setClosedIds","canScrollLeft","setCanScrollLeft","canScrollRight","setCanScrollRight","tabRefs","checkScrollButtons","track","scrollLeft","scrollWidth","clientWidth","scrollRight","setTabRef","focusTabById","selectTab","handleClose","nextActive","moveFocus","enabled","currentIdx","safeIdx","active","closeButton","defaultContent","tabContent","AvakioText","clear","enableValueCopyButton","enablePlaceHolderCopyButton","iconPosition","multiline","onKeyPress","textWidth","setCurrentValue","setIsFocused","showPassword","setShowPassword","validateInput","num","togglePasswordVisibility","handleCopyToClipboard","handleCopyPlaceholder","labelStyle","inputType","hasActionButton","inputClasses","wrapperStyle","AvakioToggleButton","onIcon","offIcon","onImage","offImage","isPressed","currentIcon","currentImage","AvakioAccordion","multi","collapseIcon","expandIcon","animate","onExpand","generatedId","accordionId","contentRefs","getInitialExpandedIds","expanded","expandedIds","setExpandedIds","setDisabledIds","isCurrentlyExpanded","newExpandedIds","otherItem","enabledItems","nextItem","prevItem","lastItem","firstExpanded","renderToggleIcon","isExpanded","headerVisible","headerId","panelId","DEFAULT_BANDS","AvakioBulletGraph","minRange","maxRange","markerColor","bands","stroke","scale","tickSize","flowTime","smoothFlow","layout","labelHeight","showLabel","showScale","animatedValue","setAnimatedValue","animationRef","prevValueRef","clampedValue","startValue","endValue","startTime","currentTime","elapsed","progress","easeProgress","getPercentage","barColor","scaleTicks","ticks","sortedBands","formattedPlaceholder","isVertical","band","tick","AvakioCarousel","slides","autoplay","autoplayDelay","scrollSpeed","loop","activeIndex","onShow","onSlideChange","setCurrentIndex","slidesList","setSlidesList","isTransitioning","setIsTransitioning","touchStart","setTouchStart","touchEnd","setTouchEnd","autoplayTimerRef","minSwipeDistance","goToSlide","skipTransition","slide","showNext","showPrev","setActive","slideId","setActiveIndex","getActiveId","getActiveIndex","addView","removeView","newSlides","onTouchStart","onTouchMove","onTouchEnd","distance","isLeftSwipe","isRightSwipe","isSideNavigation","showItems","DEFAULT_COLORS","calculateAxisBounds","dataMin","dataMax","magnitude","residual","niceStep","createSplinePath","points","tension","path","p0","p3","cp1x","cp1y","cp2x","cp2y","describePieSlice","cx","cy","innerR","startAngle","endAngle","startOuter","endOuter","startInner","endInner","largeArcFlag","AvakioChart","series","xAxis","yAxis","legend","title","subtitle","colors","animateDuration","gradient","barWidth","barOffset","donutInnerRadius","pieStartAngle","pieLabels","donutInnerText","stacked","onHover","onLegendClick","svgRef","dimensions","setDimensions","hiddenSeries","setHiddenSeries","hoveredPoint","setHoveredPoint","tooltipData","setTooltipData","animationProgress","setAnimationProgress","container","animateFrame","easeOutCubic","t","chartArea","pad","visibleSeries","seriesId","scales","allXValues","allYValues","uniqueXValues","isXNumeric","yBounds","calculateStackedMaxValues","numValue","maxValues","numPoints","sum","handleLegendClick","seriesItem","newHidden","handlePointHover","point","content","handlePointClick","format","svgData","canvas","ctx","resolve","img","renderTitle","renderAxis","xAxisY","yAxisX","renderLineChart","isSpline","isArea","seriesIdx","linePath","areaPath","renderBarChart","numSeries","groupWidth","effectiveBarWidth","totalBarWidth","groupOffset","xVal","xIdx","groupX","stackedY","dataPoint","yRange","barHeight","w","renderPieChart","isDonut","seriesData","radius","innerRadius","total","currentAngle","sliceAngle","midAngle","labelRadius","labelX","labelY","offsetDistance","offsetX","offsetY","renderScatterChart","renderRadarChart","categories","numCategories","angleStep","maxValue","numLevels","levelIdx","levelRadius","angle","cat","renderLegend","itemX","itemY","renderTooltip","renderChartContent","asBoxPadding","intersects","AvakioDashboard","widgetsProp","dragHandle","onWidgetClick","gridRef","widgets","setWidgets","widgetsRef","resizeStateRef","update","ro","resolvedUnitWidth","base","resolvedUnitHeight","updateWidgets","nextOrUpdater","getWidgetById","wid","canPlaceRect","other","findFirstFreeSpot","widget","spot","placed","nextRect","byId","l","handleGridChange","handleDragStartInternal","handleDragEndInternal","pos","beginResize","widgetId","handlePointerMove","state","unitW","unitH","deltaX","deltaY","minDx","minDy","maxDx","maxDy","nextDx","nextDy","handlePointerUp","gridCells","header","hasHeader","stopBodyDrag","getColumnLetter","letter","tempIndex","generateColumnsFromData","excelHeader","firstRow","AvakioExcelViewer","initialSheets","initialColumns","toolbar","columnWidth","headerRowHeight","showRowNumbers","resizeColumn","resizeRow","editAction","blockselect","gridLines","freezeHeader","leftSplit","topSplit","autoheight","onCellDoubleClick","onCellChange","onSelectionChange","onSheetChange","onColumnResize","onRowResize","onDataLoad","sheets","setSheets","activeSheet","setActiveSheet","setColumns","sheet","setData","editingCell","setEditingCell","sortConfig","setSortConfig","setRowHeights","hiddenColumns","setHiddenColumns","filterConfig","setFilterConfig","tableRef","resizeRef","selectionStartRef","processedData","compare","handleSheetChange","handleCellDoubleClick","handleEditComplete","oldValue","newData","originalIndex","handleColumnResizeStart","moveEvent","handleHeaderClick","newRow","newCol","isCellSelected","endRow","endColumn","minRow","maxRow","minCol","maxCol","getCellSpan","span","spanEndRow","spanEndCol","currentColIndex","newColumns","dir","tableHeight","FormRules","regex","FormContext","useFormContext","setNestedValue","obj","getNestedValue","flattenObject","prefix","newKey","AvakioForm","elements","initialValues","initialDefaultValues","rules","complexData","autoHeight","onValidation","onValidationError","onValidationSuccess","onSubmit","onValues","formRef","fieldsRef","setValues","defaultValues","setDefaultValues","defaults","errors","setErrors","dirty","setDirtyState","newErrors","registerField","element","unregisterField","validateField","fieldRules","rulesArray","rule","isValid","getFormValues","setFormValues","updateDirty","processedValues","getCleanValues","getDirtyValues","isDirty","clearValidation","markInvalid","message","focus","firstField","handleSubmit","form","formStyle","classNames","contextValue","renderElement","colStyle","rowStyle","elementStyle","contentStyle","AvakioFormField","render","fieldRef","enhancedChildren","AvakioGage","subLabel","thickness","suffix","showMinMax","trackColor","safeRange","circumference","dashOffset","targetPosition","mergedClass","styleVars","avakioThemes","GOOGLE_SCRIPT_ID","loadGoogleMaps","apiKey","reject","existing","script","AvakioGoogleMap","center","zoom","mapType","mapRef","markerRefs","resolvedApiKey","__vite_import_meta_env__","iframeSrc","lat","lng","google","heightValue","AvakioGroupList","controlledValue","templateItem","templateGroup","templateBack","animationDuration","showBack","backLabel","parentStack","setParentStack","currentBranch","setCurrentBranch","animating","setAnimating","animationDirection","setAnimationDirection","selectedValue","getItemsAtPath","parent","getCurrentParent","navigateInto","newStack","navigateBack","findPath","isGroup","itemCount","itemClass","renderBackHeader","currentParent","containerClass","AvakioHint","initialSteps","prevButton","nextButton","endLabel","stepTimeout","controlledVisible","onStart","onBeforeStart","onAfterStart","onEnd","onSkip","onNext","onPrevious","onStepChange","steps","setSteps","currentStep","setCurrentStep","highlightRect","setHighlightRect","popupPosition","setPopupPosition","timeoutRef","getTargetElement","selector","updateHighlight","pTop","pRight","pBottom","pLeft","updatePopupPosition","popupRect","viewportWidth","scrollTop","highlightTop","highlightLeft","highlightBottom","highlightRight","spaceRight","handleUpdate","goToNextStep","nextStep","eventSelector","handleSkip","goToPreviousStep","prevStep","resume","targetStep","newSteps","isFirstStep","isLastStep","prevLabel","nextLabel","AvakioView","onHide","viewRef","isEnabled","setIsEnabled","newHeight","getAnimationClass","AvakioViewWithRef","AvakioViewHeader","showTitle","showSubTitle","subTitle","isSticky","wrapperProps","getOppositeDirection","AvakioMultiview","activeView","keepViews","fitBiggest","onViewShow","onBeforeBack","animationType","animationFlipDirection","animateConfig","currentViewId","setCurrentViewId","previousViewId","setPreviousViewId","isAnimating","setIsAnimating","activeDirection","setActiveDirection","setHidden","historyRef","currentViewIdRef","isAnimatingRef","animationTimeoutRef","animateConfigRef","switchView","newViewId","currentId","oldViewId","viewId","backDirection","allCells","activeViewId","cellsToRender","isLeaving","isEntering","AvakioTemplate","borderType","onLoad","internalData","setInternalData","internalContent","setInternalContent","internalHtml","setInternalHtml","loadedContent","setLoadedContent","onLoadRef","dataJsonRef","newDataJson","prevContentRef","processTemplate","tmpl","dataObj","renderContent","processedHtml","styles"],"mappings":"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","x_google_ignoreList":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30]}